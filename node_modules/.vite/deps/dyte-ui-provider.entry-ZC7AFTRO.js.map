{
  "version": 3,
  "sources": ["../../@dytesdk/ui-kit/dist/esm/dyte-ui-provider.entry.js"],
  "sourcesContent": ["import { r as registerInstance, c as createEvent, h, H as Host, a as getElement } from './index-08f4416b.js';\nimport { d as defaultConfig, l as uiState, u as uiStore } from './ui-store-9dd5dd86.js';\nimport { g as generateConfig, p as provideDyteDesignSystem, d as deepMerge } from './config-12515769.js';\nimport { g as getSize } from './size-505ade24.js';\nimport './keysIn-310f65c1.js';\nimport './isObjectLike-773b9473.js';\n\nconst dyteUiProviderCss = \"dyte-ui-provider{display:block;width:100%;height:100%}\";\nconst DyteUiProviderStyle0 = dyteUiProviderCss;\n\nconst LEAVE_ROOM_TIMER = 10000;\nconst DyteUiProvider = class {\n    constructor(hostRef) {\n        registerInstance(this, hostRef);\n        this.statesUpdate = createEvent(this, \"dyteStatesUpdate\", 7);\n        /** Config */\n        this.config = defaultConfig;\n        /** Whether to show setup screen or not */\n        this.showSetupScreen = false;\n        /**\n         * Do not render children until meeting is initialized\n         * @default false\n         */\n        this.noRenderUntilMeeting = false;\n        this.handleResize = () => {\n            this.size = getSize(this.host.clientWidth);\n        };\n        this.loadTheme = () => {\n            var _a;\n            if (this.config === defaultConfig) {\n                const { config } = generateConfig(this.meeting.self.config, this.meeting);\n                this.config = config;\n            }\n            if ((_a = this.config) === null || _a === void 0 ? void 0 : _a.designTokens) {\n                provideDyteDesignSystem(document.documentElement, this.config.designTokens);\n            }\n        };\n        this.roomJoinedListener = () => {\n            this.updateStates({ meeting: 'joined' });\n        };\n        this.waitlistedListener = () => {\n            this.updateStates({ meeting: 'waiting' });\n        };\n        this.roomLeftListener = ({ state }) => {\n            // Let socketConnectionUpdate listener handle this case.\n            if (state === 'disconnected' || state === 'failed')\n                return;\n            this.updateStates({ meeting: 'ended', roomLeftState: state });\n        };\n        this.mediaPermissionUpdateListener = ({ kind, message }) => {\n            if (['audio', 'video'].includes(kind)) {\n                if ((message === 'DENIED' || message === 'SYSTEM_DENIED') &&\n                    uiState.states.activeDebugger !== true) {\n                    const permissionModalSettings = {\n                        enabled: true,\n                        kind,\n                    };\n                    this.updateStates({ activePermissionsMessage: permissionModalSettings });\n                }\n            }\n        };\n        this.socketConnectionUpdateListener = ({ state }) => {\n            if (state === 'failed') {\n                setTimeout(() => {\n                    this.meeting.leave('disconnected');\n                }, LEAVE_ROOM_TIMER);\n            }\n        };\n        this.handleChangingMeeting = (destinationMeetingId) => {\n            this.updateStates({\n                activeBreakoutRoomsManager: Object.assign(Object.assign({}, uiState.states.activeBreakoutRoomsManager), { destinationMeetingId }),\n            });\n        };\n    }\n    listenState(e) {\n        this.updateStates(e.detail);\n    }\n    updateStates(states) {\n        const newStates = Object.assign({}, uiState.states);\n        uiState.states = deepMerge(newStates, states);\n        this.statesUpdate.emit(uiState.states);\n    }\n    connectedCallback() {\n        if (typeof window !== 'undefined') {\n            this.authErrorListener = (ev) => {\n                if (ev.detail.message.includes('401')) {\n                    this.updateStates({ meeting: 'ended', roomLeftState: 'unauthorized' });\n                }\n            };\n            window.addEventListener('dyteError', this.authErrorListener);\n        }\n        this.onMeetingChange(this.meeting);\n        this.onIconPackChange(this.iconPack);\n        this.onTChange(this.t);\n        this.onConfigChange(this.config);\n        this.onSizeChange(this.size);\n        this.resizeObserver = new ResizeObserver(() => this.handleResize());\n        this.resizeObserver.observe(this.host);\n    }\n    disconnectedCallback() {\n        this.resizeObserver.disconnect();\n        window.removeEventListener('dyteError', this.authErrorListener);\n        if (!this.meeting)\n            return;\n        this.meeting.self.removeListener('roomLeft', this.roomLeftListener);\n        this.meeting.self.removeListener('roomJoined', this.roomJoinedListener);\n        this.meeting.self.removeListener('waitlisted', this.waitlistedListener);\n        this.meeting.self.removeListener('mediaPermissionUpdate', this.mediaPermissionUpdateListener);\n        this.meeting.meta.removeListener('socketConnectionUpdate', this.socketConnectionUpdateListener);\n    }\n    onMeetingChange(meeting) {\n        uiStore.state.meeting = meeting;\n        if (!meeting)\n            return;\n        this.updateStates({ viewType: meeting.meta.viewType });\n        this.loadTheme();\n        meeting.self.addListener('roomJoined', this.roomJoinedListener);\n        meeting.self.addListener('waitlisted', this.waitlistedListener);\n        meeting.self.addListener('roomLeft', this.roomLeftListener);\n        meeting.self.addListener('mediaPermissionUpdate', this.mediaPermissionUpdateListener);\n        meeting.meta.addListener('socketConnectionUpdate', this.socketConnectionUpdateListener);\n        if (meeting.connectedMeetings.supportsConnectedMeetings) {\n            meeting.connectedMeetings.once('changingMeeting', this.handleChangingMeeting);\n        }\n        if (meeting.self.roomJoined) {\n            this.updateStates({ meeting: 'joined' });\n        }\n        else {\n            if (this.showSetupScreen) {\n                this.updateStates({ meeting: 'setup' });\n            }\n            else {\n                meeting.joinRoom();\n            }\n        }\n        window.removeEventListener('dyteError', this.authErrorListener);\n    }\n    onIconPackChange(newIconPack) {\n        uiStore.state.iconPack = newIconPack;\n    }\n    onTChange(newT) {\n        uiStore.state.t = newT;\n    }\n    onConfigChange(config) {\n        uiStore.state.config = config;\n    }\n    onSizeChange(newSize) {\n        uiStore.state.size = newSize;\n    }\n    render() {\n        return h(Host, { key: 'aa4172c4b0395a5262697346a2731c1829edb369' }, this.noRenderUntilMeeting && !this.meeting ? null : h(\"slot\", null));\n    }\n    get host() { return getElement(this); }\n    static get watchers() { return {\n        \"meeting\": [\"onMeetingChange\"],\n        \"iconPack\": [\"onIconPackChange\"],\n        \"t\": [\"onTChange\"],\n        \"config\": [\"onConfigChange\"],\n        \"size\": [\"onSizeChange\"]\n    }; }\n};\nDyteUiProvider.style = DyteUiProviderStyle0;\n\nexport { DyteUiProvider as dyte_ui_provider };\n"],
  "mappings": "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",
  "names": []
}
