{
  "version": 3,
  "sources": ["../../@dytesdk/ui-kit/dist/esm/dyte-transcripts.entry.js"],
  "sourcesContent": ["import { r as registerInstance, w as writeTask, h, H as Host, a as getElement } from './index-08f4416b.js';\nimport { d as defaultConfig, c as useLanguage } from './ui-store-9dd5dd86.js';\nimport { S as SyncWithStore } from './index-39fa23f1.js';\nimport { c as clone } from './clone-acd4af50.js';\nimport './keysIn-310f65c1.js';\nimport './isObjectLike-773b9473.js';\n\nconst dyteTranscriptsCss = \":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:absolute;top:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);bottom:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);top:auto;display:flex;flex-direction:column;pointer-events:none;justify-content:center;width:100%;z-index:5}dyte-transcript{margin-top:var(--dyte-space-2, 8px)}\";\nconst DyteTranscriptsStyle0 = dyteTranscriptsCss;\n\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\")\n        r = Reflect.decorate(decorators, target, key, desc);\n    else\n        for (var i = decorators.length - 1; i >= 0; i--)\n            if (d = decorators[i])\n                r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nconst DyteTranscripts = class {\n    constructor(hostRef) {\n        registerInstance(this, hostRef);\n        /** Config object */\n        this.config = defaultConfig;\n        /** Language */\n        this.t = useLanguage();\n        this.transcripts = [];\n        this.listenerAttached = false;\n        this.onTranscript = (transcript) => {\n            if (transcript.transcript) {\n                this.add(transcript);\n            }\n        };\n    }\n    connectedCallback() {\n        this.meetingChanged(this.meeting);\n    }\n    addListener(meeting) {\n        var _a;\n        (_a = meeting === null || meeting === void 0 ? void 0 : meeting.ai) === null || _a === void 0 ? void 0 : _a.addListener('transcript', this.onTranscript);\n        this.listenerAttached = true;\n    }\n    clearListeners(meeting) {\n        var _a;\n        this.onTranscript && ((_a = meeting === null || meeting === void 0 ? void 0 : meeting.ai) === null || _a === void 0 ? void 0 : _a.removeListener('transcript', this.onTranscript));\n        this.listenerAttached = false;\n        clearTimeout(this.disconnectTimeout);\n        this.transcripts = [];\n    }\n    disconnectedCallback() {\n        if (this.meeting == null)\n            return;\n        this.clearListeners(this.meeting);\n    }\n    meetingChanged(meeting, oldMeeting) {\n        clearTimeout(this.disconnectTimeout);\n        if (oldMeeting !== undefined)\n            this.clearListeners(oldMeeting);\n        if (meeting == null)\n            return;\n        if (this.states.activeCaptions) {\n            this.addListener(meeting);\n        }\n    }\n    statesChanged(states) {\n        if (!states)\n            return;\n        if (states.activeCaptions && !this.listenerAttached) {\n            this.addListener(this.meeting);\n        }\n        if (!states.activeCaptions && this.listenerAttached) {\n            this.clearListeners(this.meeting);\n        }\n    }\n    transcriptionsReducer(acc, t) {\n        if (!acc.length) {\n            return [t];\n        }\n        let lastElement = acc[acc.length - 1];\n        if (lastElement.peerId !== t.peerId) {\n            return acc.concat(t);\n        }\n        if (lastElement.id === t.id) {\n            lastElement.transcript = t.transcript;\n            acc.pop();\n            return acc.concat(clone(lastElement));\n        }\n        return acc.concat(t);\n    }\n    add(transcript) {\n        // show transcripts only if tab is in focus and a maximum of 3 at a time\n        // this.transcripts.splice(0, this.transcripts.length - 2);\n        this.transcripts = this.transcriptionsReducer(this.transcripts, transcript);\n    }\n    remove(renderedId) {\n        this.transcripts = this.transcripts.filter((transcript) => transcript.renderedId !== renderedId);\n    }\n    handleDismiss(e) {\n        e.stopPropagation();\n        const { id, renderedId } = e.detail;\n        const el = this.host.shadowRoot.querySelector(`[data-id=\"${id}\"]`);\n        // exit animation\n        el === null || el === void 0 ? void 0 : el.classList.add('exit');\n        setTimeout(() => {\n            writeTask(() => {\n                this.remove(renderedId);\n            });\n        }, 400);\n    }\n    renderTranscripts() {\n        const renderedTranscripts = [];\n        this.transcripts.forEach((transcript) => {\n            const t = {\n                name: transcript.name,\n                date: transcript.date,\n                peerId: transcript.peerId,\n                transcript: transcript.transcript,\n                id: transcript.id,\n                renderedId: transcript.id,\n            };\n            if (!renderedTranscripts.length) {\n                transcript.renderedId = t.renderedId;\n                renderedTranscripts.push(t);\n                return;\n            }\n            const lastTranscript = renderedTranscripts[renderedTranscripts.length - 1];\n            const maxTranscriptLength = 400;\n            if (lastTranscript.transcript.length + t.transcript.length > maxTranscriptLength ||\n                lastTranscript.peerId !== transcript.peerId) {\n                transcript.renderedId = t.renderedId;\n                renderedTranscripts.push(t);\n                return;\n            }\n            lastTranscript.transcript += ' ' + transcript.transcript;\n            transcript.renderedId = lastTranscript.renderedId;\n        });\n        renderedTranscripts.splice(0, renderedTranscripts.length - 2);\n        return renderedTranscripts === null || renderedTranscripts === void 0 ? void 0 : renderedTranscripts.map((transcript) => (h(\"dyte-transcript\", { key: transcript.id, \"data-id\": transcript.id, transcript: transcript, onDyteTranscriptDismiss: (e) => this.handleDismiss(e), t: this.t })));\n    }\n    render() {\n        if (!this.states.activeCaptions)\n            return;\n        return h(Host, null, this.renderTranscripts());\n    }\n    get host() { return getElement(this); }\n    static get watchers() { return {\n        \"meeting\": [\"meetingChanged\"],\n        \"states\": [\"statesChanged\"]\n    }; }\n};\n__decorate([\n    SyncWithStore()\n], DyteTranscripts.prototype, \"meeting\", void 0);\n__decorate([\n    SyncWithStore()\n], DyteTranscripts.prototype, \"states\", void 0);\n__decorate([\n    SyncWithStore()\n], DyteTranscripts.prototype, \"t\", void 0);\nDyteTranscripts.style = DyteTranscriptsStyle0;\n\nexport { DyteTranscripts as dyte_transcripts };\n"],
  "mappings": "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",
  "names": []
}
