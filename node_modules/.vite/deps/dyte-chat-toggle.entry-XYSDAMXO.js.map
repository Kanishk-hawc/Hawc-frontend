{
  "version": 3,
  "sources": ["../../@dytesdk/ui-kit/dist/esm/dyte-chat-toggle.entry.js"],
  "sourcesContent": ["import { r as registerInstance, c as createEvent, h, H as Host } from './index-08f4416b.js';\nimport { a as defaultIconPack, c as useLanguage, j as usePaginatedChat } from './ui-store-9dd5dd86.js';\nimport { c as canViewChat } from './sidebar-17cf5f23.js';\nimport { S as SyncWithStore } from './index-39fa23f1.js';\n\nconst dyteChatToggleCss = \":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:block}:host([data-hidden]){display:none}.unread-count{position:absolute;right:var(--dyte-space-3, 12px);box-sizing:border-box;padding:var(--dyte-space-0\\\\.5, 2px);-webkit-user-select:none;-moz-user-select:none;user-select:none;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));font-size:12px;color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));display:flex;height:var(--dyte-space-5, 20px);min-width:var(--dyte-space-5, 20px);align-items:center;justify-content:center;border-radius:9999px;z-index:1}.unread-count-dot{position:absolute;right:var(--dyte-space-3, 12px);z-index:10;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));border-radius:50%;display:flex;height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);align-items:center;justify-content:center}:host([variant='horizontal']) .unread-count{right:var(--dyte-space-4, 16px);top:auto}\";\nconst DyteChatToggleStyle0 = dyteChatToggleCss;\n\nvar __decorate = (undefined && undefined.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\")\n        r = Reflect.decorate(decorators, target, key, desc);\n    else\n        for (var i = decorators.length - 1; i >= 0; i--)\n            if (d = decorators[i])\n                r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nconst DyteChatToggle = class {\n    constructor(hostRef) {\n        registerInstance(this, hostRef);\n        this.stateUpdate = createEvent(this, \"dyteStateUpdate\", 7);\n        this.unreadMessageCount = 0;\n        /** Variant */\n        this.variant = 'button';\n        /** Icon pack */\n        this.iconPack = defaultIconPack;\n        /** Language */\n        this.t = useLanguage();\n        this.chatActive = false;\n        this.canViewChat = false;\n        /**\n         * Only used when paginated chat is enabled\n         */\n        this.hasNewMessages = false;\n        this.onChatUpdate = ({ action, message }) => {\n            var _a;\n            if (this.chatActive)\n                return;\n            if (action === 'add' && message.userId !== ((_a = this.meeting) === null || _a === void 0 ? void 0 : _a.self.userId)) {\n                this.hasNewMessages = true;\n                this.unreadMessageCount += 1;\n            }\n        };\n        this.toggleChat = () => {\n            const states = this.states;\n            this.chatActive = !((states === null || states === void 0 ? void 0 : states.activeSidebar) && (states === null || states === void 0 ? void 0 : states.sidebar) === 'chat');\n            if (this.chatActive) {\n                this.unreadMessageCount = 0;\n                this.hasNewMessages = false;\n            }\n            this.stateUpdate.emit({\n                activeSidebar: this.chatActive,\n                sidebar: this.chatActive ? 'chat' : undefined,\n                activeMoreMenu: false,\n                activeAI: false,\n            });\n        };\n        this.updateCanView = () => {\n            this.canViewChat = canViewChat(this.meeting);\n        };\n    }\n    connectedCallback() {\n        this.meetingChanged(this.meeting);\n        this.statesChanged(this.states);\n    }\n    disconnectedCallback() {\n        var _a, _b, _c, _d, _e, _f;\n        (_b = (_a = this.meeting) === null || _a === void 0 ? void 0 : _a.chat) === null || _b === void 0 ? void 0 : _b.removeListener('chatUpdate', this.onChatUpdate);\n        (_d = (_c = this.meeting) === null || _c === void 0 ? void 0 : _c.stage) === null || _d === void 0 ? void 0 : _d.removeListener('stageStatusUpdate', this.updateCanView);\n        (_f = (_e = this.meeting) === null || _e === void 0 ? void 0 : _e.self) === null || _f === void 0 ? void 0 : _f.permissions.removeListener('chatUpdate', this.updateCanView);\n    }\n    meetingChanged(meeting) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        if (meeting == null)\n            return;\n        if (usePaginatedChat(meeting)) {\n            (_a = meeting.chat) === null || _a === void 0 ? void 0 : _a.getMessages(new Date().getTime(), 1, true).then((res) => {\n                var _a;\n                if ((_a = res === null || res === void 0 ? void 0 : res.messages) === null || _a === void 0 ? void 0 : _a.length)\n                    this.hasNewMessages = true;\n            });\n        }\n        const meetingStartedTimeMs = (_c = (_b = meeting.meta) === null || _b === void 0 ? void 0 : _b.meetingStartedTimestamp.getTime()) !== null && _c !== void 0 ? _c : 0;\n        const newMessages = (_d = meeting.chat) === null || _d === void 0 ? void 0 : _d.messages.filter((m) => m.timeMs > meetingStartedTimeMs);\n        this.unreadMessageCount = newMessages.length || 0;\n        (_e = meeting.chat) === null || _e === void 0 ? void 0 : _e.addListener('chatUpdate', this.onChatUpdate);\n        this.canViewChat = canViewChat(meeting);\n        (_f = meeting === null || meeting === void 0 ? void 0 : meeting.stage) === null || _f === void 0 ? void 0 : _f.on('stageStatusUpdate', this.updateCanView);\n        (_g = meeting === null || meeting === void 0 ? void 0 : meeting.self) === null || _g === void 0 ? void 0 : _g.permissions.on('chatUpdate', this.updateCanView);\n    }\n    statesChanged(states) {\n        if (states != null) {\n            this.chatActive = states.activeSidebar === true && states.sidebar === 'chat';\n        }\n    }\n    render() {\n        if (!this.canViewChat)\n            return h(Host, { \"data-hidden\": true });\n        return (h(Host, { title: this.t('chat') }, usePaginatedChat(this.meeting)\n            ? this.hasNewMessages && h(\"div\", { class: \"unread-count-dot\", part: \"unread-count-dot\" })\n            : this.unreadMessageCount !== 0 &&\n                !this.chatActive && (h(\"div\", { class: \"unread-count\", part: \"unread-count\" }, h(\"span\", null, this.unreadMessageCount <= 100 ? this.unreadMessageCount : '99+'))), h(\"dyte-controlbar-button\", { part: \"controlbar-button\", size: this.size, iconPack: this.iconPack, class: { active: this.chatActive }, onClick: this.toggleChat, icon: this.iconPack.chat, label: this.t('chat'), variant: this.variant })));\n    }\n    static get watchers() { return {\n        \"meeting\": [\"meetingChanged\"],\n        \"states\": [\"statesChanged\"]\n    }; }\n};\n__decorate([\n    SyncWithStore()\n], DyteChatToggle.prototype, \"meeting\", void 0);\n__decorate([\n    SyncWithStore()\n], DyteChatToggle.prototype, \"states\", void 0);\n__decorate([\n    SyncWithStore()\n], DyteChatToggle.prototype, \"size\", void 0);\n__decorate([\n    SyncWithStore()\n], DyteChatToggle.prototype, \"iconPack\", void 0);\n__decorate([\n    SyncWithStore()\n], DyteChatToggle.prototype, \"t\", void 0);\nDyteChatToggle.style = DyteChatToggleStyle0;\n\nexport { DyteChatToggle as dyte_chat_toggle };\n"],
  "mappings": "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",
  "names": ["_a"]
}
