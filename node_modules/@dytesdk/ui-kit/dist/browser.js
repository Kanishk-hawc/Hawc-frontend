var DyteUIKit=function(e){"use strict";const t="hydrated",i=!0,s=!0,a=!0;var r=Object.defineProperty,n=e=>{if(e.__stencil__getHostRef)return e.__stencil__getHostRef()},o=(e,t)=>{e.__stencil__getHostRef=()=>t,t.$lazyInstance$=e},d=(e,t)=>t in e,l=(e,t)=>(0,console.error)(e,t),c=new Map,h=new Map,p="slot-fb{display:contents}slot-fb[hidden]{display:none}",u="http://www.w3.org/1999/xlink",g="undefined"!=typeof window?window:{},f={$flags$:0,$resourcesUrl$:"",jmp:e=>e(),raf:e=>requestAnimationFrame(e),ael:(e,t,i,s)=>e.addEventListener(t,i,s),rel:(e,t,i,s)=>e.removeEventListener(t,i,s),ce:(e,t)=>new CustomEvent(e,t)},m=(()=>{var e;let t=!1;try{null==(e=g.document)||e.addEventListener("e",null,Object.defineProperty({},"passive",{get(){t=!0}}))}catch(e){}return t})(),v=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch(e){}return!1})(),y=!1,b=[],w=[],x=(e,t)=>t=>{e.push(t),y||(y=!0,4&f.$flags$?E(S):f.raf(S))},k=e=>{for(let t=0;t<e.length;t++)try{e[t](performance.now())}catch(e){l(e)}e.length=0},S=()=>{k(b),k(w),(y=b.length>0)&&f.raf(S)},E=e=>{return Promise.resolve(t).then(e);var t},P=x(w),T=e=>"object"===(e=typeof e)||"function"===e;function L(e){var t,i,s;return null!=(s=null==(i=null==(t=e.head)?void 0:t.querySelector('meta[name="csp-nonce"]'))?void 0:i.getAttribute("content"))?s:void 0}((e,t)=>{for(var i in t)r(e,i,{get:t[i],enumerable:!0})})({},{err:()=>_,map:()=>A,ok:()=>C,unwrap:()=>R,unwrapErr:()=>I});var C=e=>({isOk:!0,isErr:!1,value:e}),_=e=>({isOk:!1,isErr:!0,value:e});function A(e,t){if(e.isOk){const i=t(e.value);return i instanceof Promise?i.then(e=>C(e)):C(i)}if(e.isErr){const t=e.value;return _(t)}throw"should never get here"}var R=e=>{if(e.isOk)return e.value;throw e.value},I=e=>{if(e.isErr)return e.value;throw e.value},D=e=>{const t=F(e,"childNodes");e.tagName&&e.tagName.includes("-")&&e["s-cr"]&&"SLOT-FB"!==e.tagName&&M(t,e.tagName).forEach(e=>{1===e.nodeType&&"SLOT-FB"===e.tagName&&(O(e,$(e),!1).length?e.hidden=!0:e.hidden=!1)});let i=0;for(i=0;i<t.length;i++){const e=t[i];1===e.nodeType&&F(e,"childNodes").length&&D(e)}};function M(e,t,i){let s,a=0,r=[];for(;a<e.length;a++)s=e[a],!s["s-sr"]||t&&s["s-hn"]!==t||void 0!==i||r.push(s),r=[...r,...M(s.childNodes,t,i)];return r}var O=(e,t,i=!0)=>{const s=[];(i&&e["s-sr"]||!e["s-sr"])&&s.push(e);let a=e;for(;a=a.nextSibling;)$(a)!==t||!i&&a["s-sr"]||s.push(a);return s},U=(e,t)=>1===e.nodeType?null===e.getAttribute("slot")&&""===t||e.getAttribute("slot")===t:e["s-sn"]===t||""===t,$=e=>"string"==typeof e["s-sn"]?e["s-sn"]:1===e.nodeType&&e.getAttribute("slot")||void 0;function F(e,t){if("__"+t in e){const i=e["__"+t];return"function"!=typeof i?i:i.bind(e)}return"function"!=typeof e[t]?e[t]:e[t].bind(e)}var N,j,z=(e,t,...i)=>{let s=null,a=null,r=null,n=!1,o=!1;const d=[],l=t=>{for(let i=0;i<t.length;i++)s=t[i],Array.isArray(s)?l(s):null!=s&&"boolean"!=typeof s&&((n="function"!=typeof e&&!T(s))&&(s=String(s)),n&&o?d[d.length-1].$text$+=s:d.push(n?B(null,s):s),o=n)};if(l(i),t){t.key&&(a=t.key),t.name&&(r=t.name);{const e=t.className||t.class;e&&(t.class="object"!=typeof e?e:Object.keys(e).filter(t=>e[t]).join(" "))}}if("function"==typeof e)return e(null===t?{}:t,d,H);const c=B(e,null);return c.$attrs$=t,d.length>0&&(c.$children$=d),c.$key$=a,c.$name$=r,c},B=(e,t)=>{const i={$flags$:0,$tag$:e,$text$:t,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null};return i},G={},H={forEach:(e,t)=>e.map(V).forEach(t),map:(e,t)=>e.map(V).map(t).map(q)},V=e=>({vattrs:e.$attrs$,vchildren:e.$children$,vkey:e.$key$,vname:e.$name$,vtag:e.$tag$,vtext:e.$text$}),q=e=>{if("function"==typeof e.vtag){const t={...e.vattrs};return e.vkey&&(t.key=e.vkey),e.vname&&(t.name=e.vname),z(e.vtag,t,...e.vchildren||[])}const t=B(e.vtag,e.vtext);return t.$attrs$=e.vattrs,t.$children$=e.vchildren,t.$key$=e.vkey,t.$name$=e.vname,t},K=(e,t)=>null==e||T(e)?e:4&t?"false"!==e&&(""===e||!!e):2&t?parseFloat(e):1&t?String(e):e,Y=e=>n(e).$hostElement$,W=(e,t,i)=>{const s=Y(e);return{emit:e=>Z(s,t,{bubbles:!!(4&i),composed:!!(2&i),cancelable:!!(1&i),detail:e})}},Z=(e,t,i)=>{const s=f.ce(t,i);return e.dispatchEvent(s),s},Q=new WeakMap,X=e=>{const t=e.$cmpMeta$,i=e.$hostElement$,s=t.$flags$,a=(t.$tagName$,()=>{}),r=((e,t)=>{var i;const s=J(t),a=h.get(s);if(!g.document)return s;if(e=11===e.nodeType?e:g.document,a)if("string"==typeof a){e=e.head||e;let r,n=Q.get(e);if(n||Q.set(e,n=new Set),!n.has(s)){{r=document.querySelector(`[sty-id="${s}"]`)||g.document.createElement("style"),r.innerHTML=a;const n=null!=(i=f.$nonce$)?i:L(g.document);if(null!=n&&r.setAttribute("nonce",n),!(1&t.$flags$))if("HEAD"===e.nodeName){const t=e.querySelectorAll("link[rel=preconnect]"),i=t.length>0?t[t.length-1].nextSibling:e.querySelector("style");e.insertBefore(r,(null==i?void 0:i.parentNode)===e?i:null)}else if("host"in e)if(v){const t=new CSSStyleSheet;t.replaceSync(a),e.adoptedStyleSheets=[t,...e.adoptedStyleSheets]}else{const t=e.querySelector("style");t?t.innerHTML=a+t.innerHTML:e.prepend(r)}else e.append(r);1&t.$flags$&&e.insertBefore(r,null)}4&t.$flags$&&(r.innerHTML+=p),n&&n.add(s)}}else e.adoptedStyleSheets.includes(a)||(e.adoptedStyleSheets=[...e.adoptedStyleSheets,a]);return s})(i.shadowRoot?i.shadowRoot:i.getRootNode(),t);(10&s&&2&s||128&s)&&(i["s-sc"]=r,i.classList.add(r+"-h")),a()},J=(e,t)=>"sc-"+e.$tagName$,ee=(e,t,i,s,a,r,n)=>{if(i===s)return;let o=d(e,t),l=t.toLowerCase();if("class"===t){const t=e.classList,a=ie(i);let r=ie(s);t.remove(...a.filter(e=>e&&!r.includes(e))),t.add(...r.filter(e=>e&&!a.includes(e)))}else if("style"===t){for(const t in i)s&&null!=s[t]||(t.includes("-")?e.style.removeProperty(t):e.style[t]="");for(const t in s)i&&s[t]===i[t]||(t.includes("-")?e.style.setProperty(t,s[t]):e.style[t]=s[t])}else if("key"===t);else if("ref"===t)s&&s(e);else if(o||"o"!==t[0]||"n"!==t[1]){const n=T(s);if((o||n&&null!==s)&&!a)try{if(e.tagName.includes("-"))e[t]!==s&&(e[t]=s);else{const a=null==s?"":s;"list"===t?o=!1:null!=i&&e[t]==a||("function"==typeof e.__lookupSetter__(t)?e[t]=a:e.setAttribute(t,a))}}catch(e){}let d=!1;l!==(l=l.replace(/^xlink\:?/,""))&&(t=l,d=!0),null==s||!1===s?!1===s&&""!==e.getAttribute(t)||(d?e.removeAttributeNS(u,t):e.removeAttribute(t)):(!o||4&r||a)&&!n&&1===e.nodeType&&(s=!0===s?"":s,d?e.setAttributeNS(u,t,s):e.setAttribute(t,s))}else if(t="-"===t[2]?t.slice(3):d(g,l)?l.slice(2):l[2]+t.slice(3),i||s){const a=t.endsWith(se);t=t.replace(ae,""),i&&f.rel(e,t,i,a),s&&f.ael(e,t,s,a)}},te=/\s/,ie=e=>("object"==typeof e&&e&&"baseVal"in e&&(e=e.baseVal),e&&"string"==typeof e?e.split(te):[]),se="Capture",ae=new RegExp(se+"$"),re=(e,t,i,s)=>{const a=11===t.$elm$.nodeType&&t.$elm$.host?t.$elm$.host:t.$elm$,r=e&&e.$attrs$||{},n=t.$attrs$||{};for(const e of ne(Object.keys(r)))e in n||ee(a,e,r[e],void 0,i,t.$flags$);for(const e of ne(Object.keys(n)))ee(a,e,r[e],n[e],i,t.$flags$)};function ne(e){return e.includes("ref")?[...e.filter(e=>"ref"!==e),"ref"]:e}var oe=!1,de=!1,le=!1,ce=!1,he=(e,t,i)=>{var a;const r=t.$children$[i];let n,o,d,l=0;if(oe||(le=!0,"slot"===r.$tag$&&(r.$flags$|=r.$children$?2:1)),null!==r.$text$)n=r.$elm$=g.document.createTextNode(r.$text$);else if(1&r.$flags$)n=r.$elm$=g.document.createTextNode(""),re(null,r,ce);else{if(!g.document)throw new Error("You are trying to render a Stencil component in an environment that doesn't support the DOM. Make sure to populate the [`window`](https://developer.mozilla.org/en-US/docs/Web/API/Window/window) object before rendering a component.");if(n=r.$elm$=g.document.createElement(!oe&&s&&2&r.$flags$?"slot-fb":r.$tag$),re(null,r,ce),r.$children$)for(l=0;l<r.$children$.length;++l)o=he(e,r,l),o&&n.appendChild(o)}return n["s-hn"]=j,3&r.$flags$&&(n["s-sr"]=!0,n["s-cr"]=N,n["s-sn"]=r.$name$||"",n["s-rf"]=null==(a=r.$attrs$)?void 0:a.ref,function(e){if(e.assignedElements||e.assignedNodes||!e["s-sr"])return;const t=t=>function(e){const i=[],s=this["s-sn"];(null==e?void 0:e.flatten)&&console.error("\n          Flattening is not supported for Stencil non-shadow slots. \n          You can use `.childNodes` to nested slot fallback content.\n          If you have a particular use case, please open an issue on the Stencil repo.\n        ");const a=this["s-cr"].parentElement;return(a.__childNodes?a.childNodes:(e=>{const t=[];for(let i=0;i<e.length;i++){const s=e[i]["s-nr"]||void 0;s&&s.isConnected&&t.push(s)}return t})(a.childNodes)).forEach(e=>{s===$(e)&&i.push(e)}),t?i.filter(e=>1===e.nodeType):i}.bind(e);e.assignedElements=t(!0),e.assignedNodes=t(!1)}(n),d=e&&e.$children$&&e.$children$[i],d&&d.$tag$===r.$tag$&&e.$elm$&&pe(e.$elm$,!1)),n},pe=(e,t)=>{f.$flags$|=1;const i=Array.from(e.__childNodes||e.childNodes);e["s-sr"];for(let e=i.length-1;e>=0;e--){const s=i[e];s["s-hn"]!==j&&s["s-ol"]&&(xe(me(s).parentNode,s,me(s)),s["s-ol"].remove(),s["s-ol"]=void 0,s["s-sh"]=void 0,le=!0),t&&pe(s,t)}f.$flags$&=-2},ue=(e,t,i,s,a,r)=>{let n,o=e["s-cr"]&&e["s-cr"].parentNode||e;for(o.shadowRoot&&o.tagName===j&&(o=o.shadowRoot);a<=r;++a)s[a]&&(n=he(null,i,a),n&&(s[a].$elm$=n,xe(o,n,me(t))))},ge=(e,t,i)=>{for(let s=t;s<=i;++s){const t=e[s];if(t){const e=t.$elm$;we(t),e&&(de=!0,e["s-ol"]?e["s-ol"].remove():pe(e,!0),e.remove())}}},fe=(e,t,i=!1)=>e.$tag$===t.$tag$&&("slot"===e.$tag$?e.$name$===t.$name$:i?(i&&!e.$key$&&t.$key$&&(e.$key$=t.$key$),!0):e.$key$===t.$key$),me=e=>e&&e["s-ol"]||e,ve=(e,t,i=!1)=>{const s=t.$elm$=e.$elm$,r=e.$children$,n=t.$children$,o=t.$text$;let d;null===o?(re(e,t,ce),null!==r&&null!==n?((e,t,i,s,a=!1)=>{let r,n,o=0,d=0,l=0,c=0,h=t.length-1,p=t[0],u=t[h],g=s.length-1,f=s[0],m=s[g];for(;o<=h&&d<=g;)if(null==p)p=t[++o];else if(null==u)u=t[--h];else if(null==f)f=s[++d];else if(null==m)m=s[--g];else if(fe(p,f,a))ve(p,f,a),p=t[++o],f=s[++d];else if(fe(u,m,a))ve(u,m,a),u=t[--h],m=s[--g];else if(fe(p,m,a))"slot"!==p.$tag$&&"slot"!==m.$tag$||pe(p.$elm$.parentNode,!1),ve(p,m,a),xe(e,p.$elm$,u.$elm$.nextSibling),p=t[++o],m=s[--g];else if(fe(u,f,a))"slot"!==p.$tag$&&"slot"!==m.$tag$||pe(u.$elm$.parentNode,!1),ve(u,f,a),xe(e,u.$elm$,p.$elm$),u=t[--h],f=s[++d];else{for(l=-1,c=o;c<=h;++c)if(t[c]&&null!==t[c].$key$&&t[c].$key$===f.$key$){l=c;break}l>=0?(n=t[l],n.$tag$!==f.$tag$?r=he(t&&t[d],i,l):(ve(n,f,a),t[l]=void 0,r=n.$elm$),f=s[++d]):(r=he(t&&t[d],i,d),f=s[++d]),r&&xe(me(p.$elm$).parentNode,r,me(p.$elm$))}o>h?ue(e,null==s[g+1]?null:s[g+1].$elm$,i,s,d,g):d>g&&ge(t,o,h)})(s,r,t,n,i):null!==n?(null!==e.$text$&&(s.textContent=""),ue(s,null,t,n,0,n.length-1)):!i&&a&&null!==r&&ge(r,0,r.length-1)):(d=s["s-cr"])?d.parentNode.textContent=o:e.$text$!==o&&(s.data=o)},ye=[],be=e=>{let t,i,s;const a=e.__childNodes||e.childNodes;for(const e of a){if(e["s-sr"]&&(t=e["s-cr"])&&t.parentNode){i=t.parentNode.__childNodes||t.parentNode.childNodes;const a=e["s-sn"];for(s=i.length-1;s>=0;s--)if(t=i[s],!t["s-cn"]&&!t["s-nr"]&&t["s-hn"]!==e["s-hn"])if(U(t,a)){let i=ye.find(e=>e.$nodeToRelocate$===t);de=!0,t["s-sn"]=t["s-sn"]||a,i?(i.$nodeToRelocate$["s-sh"]=e["s-hn"],i.$slotRefNode$=e):(t["s-sh"]=e["s-hn"],ye.push({$slotRefNode$:e,$nodeToRelocate$:t})),t["s-sr"]&&ye.map(e=>{U(e.$nodeToRelocate$,t["s-sn"])&&(i=ye.find(e=>e.$nodeToRelocate$===t),i&&!e.$slotRefNode$&&(e.$slotRefNode$=i.$slotRefNode$))})}else ye.some(e=>e.$nodeToRelocate$===t)||ye.push({$nodeToRelocate$:t})}1===e.nodeType&&be(e)}},we=e=>{e.$attrs$&&e.$attrs$.ref&&e.$attrs$.ref(null),e.$children$&&e.$children$.map(we)},xe=(e,t,i)=>null==e?void 0:e.insertBefore(t,i),ke=(e,t,i=!1)=>{var s,a,r,n;const o=e.$hostElement$,d=e.$cmpMeta$,l=e.$vnode$||B(null,null),c=(h=t)&&h.$tag$===G?t:z(null,null,t);var h;if(j=o.tagName,d.$attrsToReflect$&&(c.$attrs$=c.$attrs$||{},d.$attrsToReflect$.map(([e,t])=>c.$attrs$[t]=o[e])),i&&c.$attrs$)for(const e of Object.keys(c.$attrs$))o.hasAttribute(e)&&!["key","ref","style","class"].includes(e)&&(c.$attrs$[e]=o[e]);if(c.$tag$=null,c.$flags$|=4,e.$vnode$=c,c.$elm$=l.$elm$=o.shadowRoot||o,oe=!(!(1&d.$flags$)||128&d.$flags$),N=o["s-cr"],de=!1,ve(l,c,i),f.$flags$|=1,le){be(c.$elm$);for(const e of ye){const t=e.$nodeToRelocate$;if(!t["s-ol"]&&g.document){const e=g.document.createTextNode("");e["s-nr"]=t,xe(t.parentNode,t["s-ol"]=e,t)}}for(const e of ye){const t=e.$nodeToRelocate$,o=e.$slotRefNode$;if(o){const e=o.parentNode;let i=o.nextSibling;{let r=null==(s=t["s-ol"])?void 0:s.previousSibling;for(;r;){let s=null!=(a=r["s-nr"])?a:null;if(s&&s["s-sn"]===t["s-sn"]&&e===(s.__parentNode||s.parentNode)){for(s=s.nextSibling;s===t||(null==s?void 0:s["s-sr"]);)s=null==s?void 0:s.nextSibling;if(!s||!s["s-nr"]){i=s;break}}r=r.previousSibling}}const n=t.__parentNode||t.parentNode,d=t.__nextSibling||t.nextSibling;(!i&&e!==n||d!==i)&&t!==i&&(!t["s-hn"]&&t["s-ol"]&&(t["s-hn"]=t["s-ol"].parentNode.nodeName),xe(e,t,i),1===t.nodeType&&"SLOT-FB"!==t.tagName&&(t.hidden=null!=(r=t["s-ih"])&&r)),t&&"function"==typeof o["s-rf"]&&o["s-rf"](o)}else 1===t.nodeType&&(i&&(t["s-ih"]=null!=(n=t.hidden)&&n),t.hidden=!0)}}de&&D(c.$elm$),f.$flags$&=-2,ye.length=0,N=void 0},Se=(e,t)=>{if(t&&!e.$onRenderResolve$&&t["s-p"]){const i=t["s-p"].push(new Promise(s=>e.$onRenderResolve$=()=>{t["s-p"].splice(i-1,1),s()}))}},Ee=(e,t)=>{if(e.$flags$|=16,4&e.$flags$)return void(e.$flags$|=512);Se(e,e.$ancestorComponent$);return P(()=>Pe(e,t))},Pe=(e,t)=>{const i=e.$hostElement$,s=(e.$cmpMeta$.$tagName$,()=>{}),a=e.$lazyInstance$;if(!a)throw new Error(`Can't render component <${i.tagName.toLowerCase()} /> with invalid Stencil runtime! Make sure this imported component is compiled with a \`externalRuntime: true\` flag. For more information, please refer to https://stenciljs.com/docs/custom-elements#externalruntime`);let r;return t?(e.$flags$|=256,e.$queuedListeners$&&(e.$queuedListeners$.map(([e,t])=>Oe(a,e,t,i)),e.$queuedListeners$=void 0),r=Oe(a,"componentWillLoad",void 0,i)):r=Oe(a,"componentWillUpdate",void 0,i),r=Te(r,()=>Oe(a,"componentWillRender",void 0,i)),s(),Te(r,()=>Ce(e,a,t))},Te=(e,t)=>Le(e)?e.then(t).catch(e=>{console.error(e),t()}):t(),Le=e=>e instanceof Promise||e&&e.then&&"function"==typeof e.then,Ce=async(e,t,i)=>{var s;const a=e.$hostElement$,r=(e.$cmpMeta$.$tagName$,()=>{}),n=a["s-rc"];i&&X(e);const o=(e.$cmpMeta$.$tagName$,()=>{});Ae(e,t,a,i),n&&(n.map(e=>e()),a["s-rc"]=void 0),o(),r();{const t=null!=(s=a["s-p"])?s:[],i=()=>Ie(e);0===t.length?i():(Promise.all(t).then(i),e.$flags$|=4,t.length=0)}},_e=null,Ae=(e,t,i,s)=>{try{_e=t,t=t.render(),e.$flags$&=-17,e.$flags$|=2,ke(e,t,s)}catch(t){l(t,e.$hostElement$)}return _e=null,null},Re=()=>_e,Ie=e=>{e.$cmpMeta$.$tagName$;const t=e.$hostElement$,i=()=>{},s=e.$lazyInstance$,a=e.$ancestorComponent$;Oe(s,"componentDidRender",void 0,t),64&e.$flags$?(Oe(s,"componentDidUpdate",void 0,t),i()):(e.$flags$|=64,Ue(t),Oe(s,"componentDidLoad",void 0,t),i(),e.$onReadyResolve$(t),a||Me()),e.$onInstanceResolve$(t),e.$onRenderResolve$&&(e.$onRenderResolve$(),e.$onRenderResolve$=void 0),512&e.$flags$&&E(()=>Ee(e,!1)),e.$flags$&=-517},De=e=>{{const t=n(e),i=t.$hostElement$.isConnected;return i&&2==(18&t.$flags$)&&Ee(t,!1),i}},Me=e=>{E(()=>Z(g,"appload",{detail:{namespace:"dyte-ui-kit"}}))},Oe=(e,t,i,s)=>{if(e&&e[t])try{return e[t](i)}catch(e){l(e,s)}},Ue=e=>{var i;return e.classList.add(null!=(i=t)?i:"hydrated")},$e=(e,t,i,s)=>{const a=n(e);if(!a)throw new Error(`Couldn't find host element for "${s.$tagName$}" as it is unknown to this Stencil runtime. This usually happens when integrating a 3rd party Stencil component with another Stencil component or application. Please reach out to the maintainers of the 3rd party Stencil component or report this on the Stencil Discord server (https://chat.stenciljs.com) or comment on this similar [GitHub issue](https://github.com/stenciljs/core/issues/5457).`);const r=a.$hostElement$,o=a.$instanceValues$.get(t),d=a.$flags$,c=a.$lazyInstance$;i=K(i,s.$members$[t][0]);const h=Number.isNaN(o)&&Number.isNaN(i);if((!(8&d)||void 0===o)&&(i!==o&&!h)&&(a.$instanceValues$.set(t,i),c)){if(s.$watchers$&&128&d){const e=s.$watchers$[t];e&&e.map(e=>{try{c[e](i,o,t)}catch(e){l(e,r)}})}if(2==(18&d)){if(c.componentShouldUpdate&&!1===c.componentShouldUpdate(i,o,t))return;Ee(a,!1)}}},Fe=(e,t,s)=>{var a,r;const o=e.prototype;if(t.$members$||t.$watchers$||e.watchers){e.watchers&&!t.$watchers$&&(t.$watchers$=e.watchers);const d=Object.entries(null!=(a=t.$members$)?a:{});if(d.map(([e,[i]])=>{if(31&i||2&s&&32&i){const{get:a,set:r}=Object.getOwnPropertyDescriptor(o,e)||{};a&&(t.$members$[e][0]|=2048),r&&(t.$members$[e][0]|=4096),(1&s||!a)&&Object.defineProperty(o,e,{get(){{if(!(2048&t.$members$[e][0]))return((e,t)=>n(e).$instanceValues$.get(t))(this,e);const i=n(this),s=i?i.$lazyInstance$:o;if(!s)return;return s[e]}},configurable:!0,enumerable:!0}),Object.defineProperty(o,e,{set(a){const o=n(this);if(r){const s=32&i?this[e]:o.$hostElement$[e];return void 0===s&&o.$instanceValues$.get(e)?a=o.$instanceValues$.get(e):!o.$instanceValues$.get(e)&&s&&o.$instanceValues$.set(e,s),r.apply(this,[K(a,i)]),a=32&i?this[e]:o.$hostElement$[e],void $e(this,e,a,t)}{if(!(1&s&&4096&t.$members$[e][0]))return $e(this,e,a,t),void(1&s&&!o.$lazyInstance$&&o.$onReadyPromise$.then(()=>{4096&t.$members$[e][0]&&o.$lazyInstance$[e]!==o.$instanceValues$.get(e)&&(o.$lazyInstance$[e]=a)}));const r=()=>{const s=o.$lazyInstance$[e];!o.$instanceValues$.get(e)&&s&&o.$instanceValues$.set(e,s),o.$lazyInstance$[e]=K(a,i),$e(this,e,o.$lazyInstance$[e],t)};o.$lazyInstance$?r():o.$onReadyPromise$.then(()=>r())}}})}else 1&s&&64&i&&Object.defineProperty(o,e,{value(...t){var i;const s=n(this);return null==(i=null==s?void 0:s.$onInstancePromise$)?void 0:i.then(()=>{var i;return null==(i=s.$lazyInstance$)?void 0:i[e](...t)})}})}),1&s){const s=new Map;o.attributeChangedCallback=function(e,a,r){f.jmp(()=>{var d;const l=s.get(e);if(this.hasOwnProperty(l)&&i)r=this[l],delete this[l];else{if(o.hasOwnProperty(l)&&"number"==typeof this[l]&&this[l]==r)return;if(null==l){const i=n(this),s=null==i?void 0:i.$flags$;if(s&&!(8&s)&&128&s&&r!==a){const s=i.$lazyInstance$,n=null==(d=t.$watchers$)?void 0:d[e];null==n||n.forEach(t=>{null!=s[t]&&s[t].call(s,r,a,e)})}return}}const c=Object.getOwnPropertyDescriptor(o,l);(r=(null!==r||"boolean"!=typeof this[l])&&r)===this[l]||c.get&&!c.set||(this[l]=r)})},e.observedAttributes=Array.from(new Set([...Object.keys(null!=(r=t.$watchers$)?r:{}),...d.filter(([e,t])=>15&t[0]).map(([e,i])=>{var a;const r=i[1]||e;return s.set(r,e),512&i[0]&&(null==(a=t.$attrsToReflect$)||a.push([e,r])),r})]))}}return e},Ne=async(e,t,i,s)=>{let a;if(!(32&t.$flags$)){t.$flags$|=32;if(i.$lazyBundleId$){const s=((e,t)=>{const i=e.$tagName$.replace(/-/g,"_"),s=e.$lazyBundleId$;if(!s)return;const a=c.get(s);if(a)return a[i];{const e=e=>(c.set(s,e),e[i]);switch(s){case"dyte-audio-visualizer_64":return Promise.resolve().then(function(){return Ol}).then(e,l);case"dyte-ai":return Promise.resolve().then(function(){return Fl}).then(e,l);case"dyte-ai-toggle":return Promise.resolve().then(function(){return zl}).then(e,l);case"dyte-audio-grid":return Promise.resolve().then(function(){return Hl}).then(e,l);case"dyte-audio-tile":return Promise.resolve().then(function(){return Kl}).then(e,l);case"dyte-breakout-rooms-toggle":return Promise.resolve().then(function(){return Zl}).then(e,l);case"dyte-camera-toggle":return Promise.resolve().then(function(){return Jl}).then(e,l);case"dyte-caption-toggle":return Promise.resolve().then(function(){return ic}).then(e,l);case"dyte-channel-selector-ui":return Promise.resolve().then(function(){return rc}).then(e,l);case"dyte-chat-composer-ui":return Promise.resolve().then(function(){return lc}).then(e,l);case"dyte-chat-selector-ui":return Promise.resolve().then(function(){return pc}).then(e,l);case"dyte-chat-toggle":return Promise.resolve().then(function(){return bc}).then(e,l);case"dyte-clock":return Promise.resolve().then(function(){return Sc}).then(e,l);case"dyte-controlbar":return Promise.resolve().then(function(){return Tc}).then(e,l);case"dyte-debugger-toggle":return Promise.resolve().then(function(){return _c}).then(e,l);case"dyte-ended-screen":return Promise.resolve().then(function(){return Ic}).then(e,l);case"dyte-file-dropzone":return Promise.resolve().then(function(){return Oc}).then(e,l);case"dyte-grid":return Promise.resolve().then(function(){return Th}).then(e,l);case"dyte-grid-pagination":return Promise.resolve().then(function(){return _h}).then(e,l);case"dyte-header":return Promise.resolve().then(function(){return Ih}).then(e,l);case"dyte-idle-screen":return Promise.resolve().then(function(){return Oh}).then(e,l);case"dyte-information-tooltip":return Promise.resolve().then(function(){return $h}).then(e,l);case"dyte-leave-button":return Promise.resolve().then(function(){return jh}).then(e,l);case"dyte-livestream-toggle":return Promise.resolve().then(function(){return Gh}).then(e,l);case"dyte-meeting-title":return Promise.resolve().then(function(){return qh}).then(e,l);case"dyte-message-list-view":return Promise.resolve().then(function(){return Yh}).then(e,l);case"dyte-mic-toggle":return Promise.resolve().then(function(){return Qh}).then(e,l);case"dyte-mixed-grid":return Promise.resolve().then(function(){return ep}).then(e,l);case"dyte-more-toggle":return Promise.resolve().then(function(){return sp}).then(e,l);case"dyte-mute-all-button":return Promise.resolve().then(function(){return np}).then(e,l);case"dyte-network-indicator":return Promise.resolve().then(function(){return lp}).then(e,l);case"dyte-participant-count":return Promise.resolve().then(function(){return pp}).then(e,l);case"dyte-participant-setup":return Promise.resolve().then(function(){return fp}).then(e,l);case"dyte-participants":return Promise.resolve().then(function(){return yp}).then(e,l);case"dyte-participants-audio":return Promise.resolve().then(function(){return kp}).then(e,l);case"dyte-participants-toggle":return Promise.resolve().then(function(){return Pp}).then(e,l);case"dyte-pip-toggle":return Promise.resolve().then(function(){return Cp}).then(e,l);case"dyte-plugins-toggle":return Promise.resolve().then(function(){return Rp}).then(e,l);case"dyte-polls-toggle":return Promise.resolve().then(function(){return Mp}).then(e,l);case"dyte-recording-indicator":return Promise.resolve().then(function(){return $p}).then(e,l);case"dyte-recording-toggle":return Promise.resolve().then(function(){return jp}).then(e,l);case"dyte-screen-share-toggle":return Promise.resolve().then(function(){return Hp}).then(e,l);case"dyte-screenshare-view":return Promise.resolve().then(function(){return Qp}).then(e,l);case"dyte-settings-toggle":return Promise.resolve().then(function(){return eu}).then(e,l);case"dyte-setup-screen":return Promise.resolve().then(function(){return su}).then(e,l);case"dyte-sidebar":return Promise.resolve().then(function(){return nu}).then(e,l);case"dyte-simple-grid":return Promise.resolve().then(function(){return lu}).then(e,l);case"dyte-spotlight-grid":return Promise.resolve().then(function(){return pu}).then(e,l);case"dyte-stage":return Promise.resolve().then(function(){return fu}).then(e,l);case"dyte-stage-toggle":return Promise.resolve().then(function(){return yu}).then(e,l);case"dyte-transcripts":return Promise.resolve().then(function(){return ng}).then(e,l);case"dyte-ui-provider":return Promise.resolve().then(function(){return dg}).then(e,l);case"dyte-waiting-screen":return Promise.resolve().then(function(){return hg}).then(e,l);case"dyte-ai-transcriptions":return Promise.resolve().then(function(){return gg}).then(e,l);case"dyte-livestream-indicator_3":return Promise.resolve().then(function(){return Jk}).then(e,l);case"dyte-name-tag":return Promise.resolve().then(function(){return iS}).then(e,l);case"dyte-participants-stage-list_4":return Promise.resolve().then(function(){return hS}).then(e,l);case"dyte-plugin-main_2":return Promise.resolve().then(function(){return mS}).then(e,l);case"dyte-plugins_2":return Promise.resolve().then(function(){return xS}).then(e,l);case"dyte-transcript":return Promise.resolve().then(function(){return SS}).then(e,l);case"dyte-fullscreen-toggle":return Promise.resolve().then(function(){return TS}).then(e,l);case"dyte-participant_2":return Promise.resolve().then(function(){return AS}).then(e,l);case"dyte-poll_2":return Promise.resolve().then(function(){return OS}).then(e,l);case"dyte-sidebar-ui":return Promise.resolve().then(function(){return $S}).then(e,l);case"dyte-spotlight-indicator":return Promise.resolve().then(function(){return jS}).then(e,l);case"dyte-controlbar-button":return Promise.resolve().then(function(){return GS}).then(e,l)}}return import(`./${s}.entry.js`).then(e=>(c.set(s,e),e[i]),e=>{l(e,t.$hostElement$)})})(i,t);if(s&&"then"in s){const e=()=>{};a=await s,e()}else a=s;if(!a)throw new Error(`Constructor for "${i.$tagName$}#${t.$modeName$}" was not found`);a.isProxied||(i.$watchers$=a.watchers,Fe(a,i,2),a.isProxied=!0);const r=(i.$tagName$,()=>{});t.$flags$|=8;try{new a(t)}catch(t){l(t,e)}t.$flags$&=-9,t.$flags$|=128,r(),je(t.$lazyInstance$,e)}else{a=e.constructor;const i=e.localName;customElements.whenDefined(i).then(()=>t.$flags$|=128)}if(a&&a.style){let e;"string"==typeof a.style&&(e=a.style);const t=J(i);if(!h.has(t)){const s=(i.$tagName$,()=>{});((e,t,i)=>{let s=h.get(e);v&&i?(s=s||new CSSStyleSheet,"string"==typeof s?s=t:s.replaceSync(t)):s=t,h.set(e,s)})(t,e,!!(1&i.$flags$)),s()}}}const r=t.$ancestorComponent$,n=()=>Ee(t,!0);r&&r["s-rc"]?r["s-rc"].push(n):n()},je=(e,t)=>{Oe(e,"connectedCallback",void 0,t)},ze=e=>{if(!g.document)return;const t=e["s-cr"]=g.document.createComment("");t["s-cn"]=!0,xe(e,t,e.firstChild)},Be=(e,t)=>{Oe(e,"disconnectedCallback",void 0,t||e)},Ge=(e,t={})=>{var i;if(!g.document)return void console.warn("Stencil: No document found. Skipping bootstrapping lazy components.");const s=()=>{},a=[],r=t.exclude||[],o=g.customElements,d=g.document.head,l=d.querySelector("meta[charset]"),c=g.document.createElement("style"),h=[];let u,m=!0;Object.assign(f,t),f.$resourcesUrl$=new URL(t.resourcesUrl||"./",g.document.baseURI).href;let v=!1;if(e.map(e=>{e[1].map(t=>{var i;const s={$flags$:t[0],$tagName$:t[1],$members$:t[2],$listeners$:t[3]};4&s.$flags$&&(v=!0),s.$members$=t[2],s.$listeners$=t[3],s.$attrsToReflect$=[],s.$watchers$=null!=(i=t[4])?i:{};const d=s.$tagName$,l=class extends HTMLElement{constructor(e){if(super(e),this.hasRegisteredEventListeners=!1,((e,t)=>{const i={$flags$:0,$hostElement$:e,$cmpMeta$:t,$instanceValues$:new Map};i.$onInstancePromise$=new Promise(e=>i.$onInstanceResolve$=e),i.$onReadyPromise$=new Promise(e=>i.$onReadyResolve$=e),e["s-p"]=[],e["s-rc"]=[];const s=i;e.__stencil__getHostRef=()=>s})(e=this,s),1&s.$flags$)if(e.shadowRoot){if("open"!==e.shadowRoot.mode)throw new Error(`Unable to re-use existing shadow root for ${s.$tagName$}! Mode is set to ${e.shadowRoot.mode} but Stencil only supports open shadow roots.`)}else e.attachShadow({mode:"open"})}connectedCallback(){const e=n(this);this.hasRegisteredEventListeners||(this.hasRegisteredEventListeners=!0,Ve(this,e,s.$listeners$)),u&&(clearTimeout(u),u=null),m?h.push(this):f.jmp(()=>(e=>{if(!(1&f.$flags$)){const t=n(e),i=t.$cmpMeta$,s=(i.$tagName$,()=>{});if(1&t.$flags$)Ve(e,t,i.$listeners$),(null==t?void 0:t.$lazyInstance$)?je(t.$lazyInstance$,e):(null==t?void 0:t.$onReadyPromise$)&&t.$onReadyPromise$.then(()=>je(t.$lazyInstance$,e));else{t.$flags$|=1,12&i.$flags$&&ze(e);{let i=e;for(;i=i.parentNode||i.host;)if(i["s-p"]){Se(t,t.$ancestorComponent$=i);break}}i.$members$&&Object.entries(i.$members$).map(([t,[i]])=>{if(31&i&&e.hasOwnProperty(t)){const i=e[t];delete e[t],e[t]=i}}),Ne(e,t,i)}s()}})(this))}disconnectedCallback(){f.jmp(()=>(async e=>{if(!(1&f.$flags$)){const t=n(e);t.$rmListeners$&&(t.$rmListeners$.map(e=>e()),t.$rmListeners$=void 0),(null==t?void 0:t.$lazyInstance$)?Be(t.$lazyInstance$,e):(null==t?void 0:t.$onReadyPromise$)&&t.$onReadyPromise$.then(()=>Be(t.$lazyInstance$,e))}Q.has(e)&&Q.delete(e),e.shadowRoot&&Q.has(e.shadowRoot)&&Q.delete(e.shadowRoot)})(this)),f.raf(()=>{var e;const t=n(this),i=h.findIndex(e=>e===this);i>-1&&h.splice(i,1),(null==(e=null==t?void 0:t.$vnode$)?void 0:e.$elm$)instanceof Node&&!t.$vnode$.$elm$.isConnected&&delete t.$vnode$.$elm$})}componentOnReady(){return n(this).$onReadyPromise$}};s.$lazyBundleId$=e[0],r.includes(d)||o.get(d)||(a.push(d),o.define(d,Fe(l,s,1)))})}),a.length>0&&(v&&(c.textContent+=p),c.textContent+=a.sort()+"{visibility:hidden}.hydrated{visibility:inherit}",c.innerHTML.length)){c.setAttribute("data-styles","");const e=null!=(i=f.$nonce$)?i:L(g.document);null!=e&&c.setAttribute("nonce",e),d.insertBefore(c,l?l.nextSibling:d.firstChild)}m=!1,h.length?h.map(e=>e.connectedCallback()):f.jmp(()=>u=setTimeout(Me,30)),s()},He=(e,t)=>t,Ve=(e,t,i,s)=>{i&&g.document&&i.map(([i,s,a])=>{const r=Ke(g.document,e,i),n=qe(t,a),o=Ye(i);f.ael(r,s,n,o),(t.$rmListeners$=t.$rmListeners$||[]).push(()=>f.rel(r,s,n,o))})},qe=(e,t)=>i=>{var s;try{256&e.$flags$?null==(s=e.$lazyInstance$)||s[t](i):(e.$queuedListeners$=e.$queuedListeners$||[]).push([t,i])}catch(t){l(t,e.$hostElement$)}},Ke=(e,t,i)=>8&i?g:t,Ye=e=>m?{passive:!!(1&e),capture:!!(2&e)}:!!(2&e);var We=Ze;function Ze(){}Ze.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,i){this.callbacks=this.callbacks||{};var s=3===arguments.length,a=s?arguments[1]:void 0,r=s?arguments[2]:arguments[1];return r._groupName=a,(this.callbacks[e]=this.callbacks[e]||[]).push(r),this},t.once=function(e,t,i){var s=this,a=3===arguments.length,r=a?arguments[1]:void 0,n=a?arguments[2]:arguments[1];return this.on(e,r,function t(){s.off(e,t),n.apply(this,arguments)}),this},t.releaseGroup=function(e){var t,i,s,a;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(i=0,s=(a=this.callbacks[t]).length;i<s;i++)a[i]._groupName===e&&(a.splice(i,1),i--,s--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var i,s=this.callbacks[e];return s?1===arguments.length?(delete this.callbacks[e],this):(-1!==(i=s.indexOf(t))&&(s.splice(i,1),0===s.length&&delete this.callbacks[e]),this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,i,s,a=[].slice.call(arguments,1),r=this.callbacks[e],n=this.getWildcardCallbacks(e);if(r)for(t=0,i=(s=r.slice()).length;t<i&&s[t];++t)s[t].apply(this,a);if(n)for(i=n.length,t=0,i=(s=n.slice()).length;t<i&&s[t];++t)s[t].apply(this,[e].concat(a));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,i,s=[];for(t in this.callbacks)i=t.split("*"),("*"===t||2===i.length&&e.slice(0,i[0].length)===i[0])&&(s=s.concat(this.callbacks[t]));return s}},Ze.mixin(Ze);var Qe,Xe=We;"undefined"!=typeof window&&(Qe=window.AudioContext||window.webkitAudioContext);var Je=null,et=function(e,t){var i=new Xe;if(!Qe)return i;var s,a,r,n=(t=t||{}).smoothing||.1,o=t.interval||50,d=t.threshold,l=t.play,c=t.history||10,h=!0;Je=t.audioContext||Je||new Qe,(r=Je.createAnalyser()).fftSize=512,r.smoothingTimeConstant=n,a=new Float32Array(r.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(s=Je.createMediaElementSource(e),void 0===l&&(l=!0),d=d||-50):(s=Je.createMediaStreamSource(e),d=d||-50),s.connect(r),l&&r.connect(Je.destination),i.speaking=!1,i.suspend=function(){return Je.suspend()},i.resume=function(){return Je.resume()},Object.defineProperty(i,"state",{get:function(){return Je.state}}),Je.onstatechange=function(){i.emit("state_change",Je.state)},i.setThreshold=function(e){d=e},i.setInterval=function(e){o=e},i.stop=function(){h=!1,i.emit("volume_change",-100,d),i.speaking&&(i.speaking=!1,i.emit("stopped_speaking")),r.disconnect(),s.disconnect()},i.speakingHistory=[];for(var p=0;p<c;p++)i.speakingHistory.push(0);var u=function(){setTimeout(function(){if(h){var e=function(e,t){var i=-1/0;e.getFloatFrequencyData(t);for(var s=4,a=t.length;s<a;s++)t[s]>i&&t[s]<0&&(i=t[s]);return i}(r,a);i.emit("volume_change",e,d);var t=0;if(e>d&&!i.speaking){for(var s=i.speakingHistory.length-3;s<i.speakingHistory.length;s++)t+=i.speakingHistory[s];t>=2&&(i.speaking=!0,i.emit("speaking"))}else if(e<d&&i.speaking){for(s=0;s<i.speakingHistory.length;s++)t+=i.speakingHistory[s];0==t&&(i.speaking=!1,i.emit("stopped_speaking"))}i.speakingHistory.shift(),i.speakingHistory.push(0+(e>d)),u()}},o)};return u(),i};const tt=e=>!!st(e)&&("LIVESTREAM"===e.meta.viewType&&"ON_STAGE"!==e.stage.status),it=e=>{var t;return!!st(e)&&("LIVESTREAM"===e.meta.viewType&&(null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions.canLivestream))},st=e=>null==e?void 0:e.livestream;var at,rt;!function(e){e.BUFFERING="Buffering",e.ENDED="Ended",e.IDLE="Idle",e.PAUSED="Paused",e.PLAYING="Playing",e.READY="Ready"}(at||(at={})),function(e){e.INITIALIZED="PlayerInitialized",e.QUALITY_CHANGED="PlayerQualityChanged",e.DURATION_CHANGED="PlayerDurationChanged",e.VOLUME_CHANGED="PlayerVolumeChanged",e.MUTED_CHANGED="PlayerMutedChanged",e.PLAYBACK_RATE_CHANGED="PlayerPlaybackRateChanged",e.REBUFFERING="PlayerRebuffering",e.AUDIO_BLOCKED="PlayerAudioBlocked",e.PLAYBACK_BLOCKED="PlayerPlaybackBlocked",e.ERROR="PlayerError",e.RECOVERABLE_ERROR="PlayerRecoverableError",e.ANALYTICS_EVENT="PlayerAnalyticsEvent",e.TIME_UPDATE="PlayerTimeUpdate",e.BUFFER_UPDATE="PlayerBufferUpdate",e.SEEK_COMPLETED="PlayerSeekCompleted",e.SESSION_DATA="PlayerSessionData",e.STATE_CHANGED="PlayerStateChanged",e.WORKER_ERROR="PlayerWorkerError",e.METADATA="PlayerMetadata",e.TEXT_CUE="PlayerTextCue",e.TEXT_METADATA_CUE="PlayerTextMetadataCue",e.AD_CUE="PlayerAdCue",e.STREAM_SOURCE_CUE="PlayerStreamSourceCue",e.NETWORK_UNAVAILABLE="PlayerNetworkUnavailable",e.SEGMENT_DISCONTINUITY="PlayerSegmentDiscontinuity",e.SEGMENT_METADATA="PlayerSegmentMetadata",e.PLAYER_METADATA="PlayerMetadata"}(rt||(rt={}));const nt="play_participant_tile_video_on_pause",ot="disable_emoji_picker",dt="disable_kicking",lt="admin_cantremove_admin",ct="cantinvite_viewer",ht="pinned_msgs",pt=e=>{var t;return"CHAT"===(null==e?void 0:e.meta.viewType)||st(e)||(null===(t=null==e?void 0:e.__internals__)||void 0===t?void 0:t.features.hasFeature("feat_paginated_chat"))},ut=e=>{var t,i;return(null===(t=null==e?void 0:e.__internals__)||void 0===t?void 0:t.browserSpecs.isFirefox())&&(null===(i=null==e?void 0:e.__internals__)||void 0===i?void 0:i.features.hasFeature("disable_firefox_setting_sink_id"))};let gt=0;const ft="temp-";function mt(e){return e.includes(ft)}function vt(e){var t;return null!==(t=e.customParticipantId)&&void 0!==t?t:e.clientSpecificId}function yt(e){const t=new Map;return[e.self,...e.participants.joined.toArray()].map(e=>{t.set(vt(e),e.picture)}),[e.connectedMeetings.parentMeeting,...e.connectedMeetings.meetings].flatMap(e=>e.participants).map(e=>({id:e.id,customParticipantId:vt(e),displayName:e.displayName,displayPictureUrl:""!==e.displayPictureUrl?e.displayPictureUrl:t.get(vt(e))}))}const bt=e=>{if(!(e=>e.connectedMeetings.supportsConnectedMeetings)(e))return!1;const t=e.self.permissions.connectedMeetings;return!!t.canAlterConnectedMeetings||!(!t.canSwitchConnectedMeetings&&!t.canSwitchToParentMeeting)&&e.connectedMeetings.isActive};var wt,xt,kt,St,Et,Pt,Tt,Lt,Ct,_t,At,Rt,It,Dt,Mt,Ot=function(e,t,i,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===s?a.call(e,i):a?a.value=i:t.set(e,i),i},Ut=function(e,t,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!s:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?s:"a"===i?s.call(e):s?s.value:t.get(e)};class $t{constructor(){wt.add(this),xt.set(this,!1),kt.set(this,void 0),St.set(this,void 0),Et.set(this,void 0),Pt.set(this,void 0),Tt.set(this,void 0),Lt.set(this,void 0),Ct.set(this,void 0),_t.set(this,void 0)}get hasLocalChanges(){return Ut(this,xt,"f")}get currentState(){let e,t=[];return Array.from(Ut(this,Pt,"f").keys()).forEach(i=>{const s=Ut(this,Lt,"f").get(i);s.isParent?e=Object.assign(Object.assign({},s),{participants:Ut(this,wt,"m",Mt).call(this,i)}):t.push(Object.assign(Object.assign({},s),{participants:Ut(this,wt,"m",Mt).call(this,i)}))}),{parentMeeting:e,meetings:t}}get allConnectedMeetings(){return this.currentState.meetings.sort((e,t)=>e.title.localeCompare(t.title))}get allParticipants(){return Array.from(Ut(this,Tt,"f").values())}get unassignedParticipants(){return Ut(this,wt,"m",Mt).call(this,Ut(this,kt,"f").parentMeeting.id)}getParticipantsForMeeting(e){return Ut(this,wt,"m",Mt).call(this,e)}addNewMeeting(){Ot(this,xt,!0,"f");const e=function(e,t){var i={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.indexOf(s)<0&&(i[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(s=Object.getOwnPropertySymbols(e);a<s.length;a++)t.indexOf(s[a])<0&&Object.prototype.propertyIsEnumerable.call(e,s[a])&&(i[s[a]]=e[s[a]])}return i}({id:`${ft}${Math.random().toString(36)}`,title:"Room "+ ++gt,participants:[]},["participants"]);return Ut(this,wt,"m",Rt).call(this,Object.assign(Object.assign({},e),{isParent:!1})),e}addNewMeetings(e){return Array.from({length:e}).map(()=>this.addNewMeeting())}updateMeetingTitle(e,t){Ut(this,Lt,"f").get(e).title=t,mt(e)||Ut(this,Ct,"f").add(e)}deleteMeeting(e){Ot(this,xt,!0,"f");const t=Ut(this,Lt,"f").get(e),i=Ut(this,wt,"m",Mt).call(this,t.id).map(vt);this.assignParticipantsToMeeting(i,Ut(this,kt,"f").parentMeeting.id),Ut(this,Lt,"f").delete(t.id),Ut(this,Pt,"f").delete(t.id),mt(t.id)||Ut(this,_t,"f").add(t.id)}assignParticipantsToMeeting(e,t){return Ot(this,xt,!0,"f"),e.forEach(e=>{const i=Ut(this,St,"f").get(e);Ut(this,Pt,"f").get(i).delete(e),Ut(this,Pt,"f").get(t).add(e),Ut(this,St,"f").set(e,t)}),this.currentState}assignParticipantsRandomly(){const e=function(e,t){const i=e.length,s=Math.ceil(i/t),a=new Array(t);let r=0;for(let i=0;i<t;i++)a[i]=e.slice(r,r+s),r+=s;return a.filter(e=>e.length)}(this.unassignedParticipants,this.allConnectedMeetings.length);return this.allConnectedMeetings.forEach((t,i)=>{const s=e[i];s&&0!==s.length&&this.assignParticipantsToMeeting(s.map(e=>e.customParticipantId),t.id)}),this.currentState}unassignParticipants(e){const t=Ut(this,kt,"f").parentMeeting.id;return this.assignParticipantsToMeeting(e,t)}unassignAllParticipants(){const e=Ut(this,kt,"f").parentMeeting.id,t=this.allParticipants.map(vt);return this.assignParticipantsToMeeting(t,e)}updateCurrentState(e){Ut(this,xt,"f")||Ut(this,wt,"m",At).call(this,e),[e.parentMeeting,...e.meetings].forEach((e,t)=>{const i=Object.assign(Object.assign({},e),{isParent:0===t});Ut(this,wt,"m",Rt).call(this,i),e.participants.forEach(e=>{Ut(this,wt,"m",It).call(this,e,i)})})}get meetingsToCreate(){return this.allConnectedMeetings.filter(e=>mt(e.id)).map(({id:e,title:t})=>({id:e,title:t}))}get meetingsToUpdate(){return this.allConnectedMeetings.filter(e=>Ut(this,Ct,"f").has(e.id)).map(({id:e,title:t})=>({id:e,title:t}))}get meetingsToDelete(){return Array.from(Ut(this,_t,"f"))}get participantsToMove(){const e=new Map;return Array.from(Ut(this,St,"f").keys()).forEach(t=>{const i=Ut(this,Et,"f").get(t),s=Ut(this,St,"f").get(t);if(i===s)return;const a=`${i}__${s}`;e.has(a)||e.set(a,[]);const r=Ut(this,Tt,"f").get(t);e.get(a).push(r.id)}),Array.from(e.keys()).map(t=>{const[i,s]=t.split("__");return{sourceMeetingId:i,destinationMeetingId:s,participantIds:e.get(t)}})}async applyChanges(e){const t=0!==this.meetingsToCreate.length?e.connectedMeetings.createMeetings(this.meetingsToCreate):Promise.resolve([]),i=0!==this.meetingsToUpdate.length?e.connectedMeetings.updateMeetings(this.meetingsToUpdate):Promise.resolve(),[s]=await Promise.all([t,i]);s&&s.forEach(e=>{this.meetingsToCreate.forEach(t=>{t.title===e.title&&Ut(this,wt,"m",Dt).call(this,Ut(this,Lt,"f").get(t.id),e.id)})}),0!==this.participantsToMove.length&&this.participantsToMove.forEach(({sourceMeetingId:t,destinationMeetingId:i,participantIds:s})=>{e.connectedMeetings.moveParticipants(t,i,s)}),0!==this.meetingsToDelete.length&&e.connectedMeetings.deleteMeetings(this.meetingsToDelete)}discardChanges(){return Ot(this,xt,!1,"f"),this.updateCurrentState(Ut(this,kt,"f")),this.currentState}}xt=new WeakMap,kt=new WeakMap,St=new WeakMap,Et=new WeakMap,Pt=new WeakMap,Tt=new WeakMap,Lt=new WeakMap,Ct=new WeakMap,_t=new WeakMap,wt=new WeakSet,At=function(e){Ot(this,kt,e,"f"),Ot(this,Lt,new Map,"f"),Ot(this,Tt,new Map,"f"),Ot(this,Ct,new Set,"f"),Ot(this,_t,new Set,"f"),Ot(this,Pt,new Map,"f"),Ot(this,St,new Map,"f"),Ot(this,Et,new Map,"f"),Ot(this,Et,new Map,"f"),Ut(this,kt,"f").parentMeeting.participants.forEach(e=>{Ut(this,Et,"f").set(vt(e),Ut(this,kt,"f").parentMeeting.id)}),Ut(this,kt,"f").meetings.forEach(e=>{e.participants.forEach(t=>{Ut(this,Et,"f").set(vt(t),e.id)})})},Rt=function(e){Ut(this,Lt,"f").has(e.id)||(Ut(this,Lt,"f").set(e.id,e),Ut(this,Pt,"f").set(e.id,new Set))},It=function(e,t){Ut(this,Tt,"f").has(vt(e))||(Ut(this,Tt,"f").set(vt(e),e),Ut(this,St,"f").set(vt(e),t.id),Ut(this,Pt,"f").get(t.id).add(vt(e)))},Dt=function(e,t){const i=e.id;Ut(this,wt,"m",Rt).call(this,Object.assign(Object.assign({},e),{id:t})),Ut(this,Lt,"f").delete(i);const s=Ut(this,Pt,"f").get(i);Ut(this,Pt,"f").set(t,s),Ut(this,Pt,"f").delete(i),Array.from(Ut(this,St,"f").keys()).forEach(e=>{Ut(this,St,"f").get(e)===i&&Ut(this,St,"f").set(e,t)})},Mt=function(e){return Array.from(Ut(this,Pt,"f").get(e)).map(e=>Ut(this,Tt,"f").get(e))};const Ft={designTokens:{spacingBase:4,googleFont:"Inter"},styles:{"dyte-header":{display:"grid",height:"48px",gridTemplateColumns:"repeat(3, 1fr)",gridTemplateRows:"1fr",alignItems:"center"},"dyte-header.sm":{display:"grid",gridArea:"header",gridTemplateColumns:"repeat(2, 1fr)",gridTemplateRows:"1fr",alignItems:"center"},"div#header-left":{display:"flex",alignItems:"center",height:"48px",wordBreak:"break-all"},"dyte-logo":{height:"26px"},"div#header-center":{display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-all"},"div#header-right":{display:"flex",alignItems:"center",justifyContent:"flex-end"},"dyte-stage":{display:"flex",flex:"1"},"dyte-grid":{flex:"1",height:"auto"},"dyte-controlbar":{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gridTemplateRows:"1fr",alignItems:"center",padding:"8px"},"dyte-controlbar.sm":{display:"flex",position:"relative",backgroundColor:"rgb(var(--dyte-colors-background-1000, 0 0 0))"},"dyte-controlbar.md":{display:"flex",position:"relative",backgroundColor:"rgb(var(--dyte-colors-background-1000, 0 0 0))"},"div#controlbar-left":{display:"flex",alignItems:"center",gap:"var(--dyte-space-1, 4px)"},"div#controlbar-center":{display:"flex",alignItems:"center",gap:"var(--dyte-space-1, 4px)",position:"relative",overflow:"visible",justifyContent:"center"},"div#controlbar-mobile":{display:"flex",flex:"1",alignItems:"center",gap:"var(--dyte-space-1, 4px)",justifyContent:"center"},"div#controlbar-right":{display:"flex",alignItems:"center",gap:"var(--dyte-space-1, 4px)",justifyContent:"flex-end"},"dyte-settings":{width:"720px",height:"480px"},"dyte-debugger":{width:"720px",height:"480px"},"dyte-breakout-rooms-manager":{minHeight:"400px",minWidth:"500px",maxWidth:"80%",maxHeight:"480px"},"div#setupcontrols-media":{position:"absolute",bottom:"8px",right:"8px",display:"flex",gap:"4px"},"div#setupcontrols-settings":{position:"absolute",top:"8px",right:"8px",display:"flex",flexDirection:"column",gap:"6px"},"dyte-meeting-title.sm":{marginLeft:"0"},"dyte-clock":{marginRight:"0"}},root:{"dyte-meeting":{state:"meeting",states:["activeSidebar","activeAI"]},"dyte-meeting[meeting=waiting]":["dyte-waiting-screen"],"dyte-meeting[meeting=idle]":["dyte-idle-screen"],"dyte-meeting[meeting=setup]":["dyte-setup-screen","dyte-dialog-manager"],"dyte-meeting[meeting=joined]":["dyte-header","dyte-stage","dyte-controlbar","dyte-participants-audio","dyte-dialog-manager"],"dyte-meeting[meeting=joined].activeSidebar.sm":{add:[["dyte-sidebar",{view:"full-screen"}]]},"dyte-meeting[meeting=joined].activeSidebar.md":{add:[["dyte-sidebar",{view:"full-screen"}]]},"dyte-meeting[meeting=joined].activeAI.sm":{add:[["dyte-ai",{view:"full-screen"}]]},"dyte-meeting[meeting=joined].activeAI.md":{add:[["dyte-ai",{view:"full-screen"}]]},"dyte-meeting[meeting=ended]":["dyte-ended-screen"],"dyte-header":["div#header-left","div#header-center","div#header-right"],"dyte-header.sm":{remove:["div#header-center"]},"div#header-left":["dyte-logo","dyte-recording-indicator","dyte-livestream-indicator"],"div#header-center":["dyte-meeting-title"],"div#header-right":["dyte-grid-pagination","dyte-clock","dyte-participant-count","dyte-viewer-count"],"div#header-left.sm":["dyte-meeting-title","dyte-recording-indicator","dyte-livestream-indicator"],"dyte-stage":{states:["activeSidebar","activeAI"],children:["dyte-grid","dyte-notifications","dyte-transcripts"]},"dyte-stage.activeSidebar":{add:[["dyte-sidebar",{view:"sidebar"}]]},"dyte-stage.activeSidebar.sm":{remove:["dyte-sidebar"]},"dyte-stage.activeAI":{add:[["dyte-ai",{view:"sidebar"}]]},"dyte-stage.activeAI.sm":{remove:["dyte-ai"]},"dyte-grid":{states:["activeScreenShare","activePlugin","activeSpotlight"],children:["dyte-simple-grid"]},"dyte-grid.activeSpotlight":["dyte-spotlight-grid"],"dyte-grid.activeScreenShare":["dyte-mixed-grid"],"dyte-grid.activePlugin":["dyte-mixed-grid"],"dyte-grid.activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-grid.activePlugin.activeSpotlight":["dyte-mixed-grid"],"dyte-grid.activePlugin.activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-mixed-grid":{states:["activeSpotlight"],children:["dyte-simple-grid"]},"dyte-mixed-grid.activeSpotlight":["dyte-spotlight-grid"],"dyte-participant-tile":{state:"meeting",children:["dyte-name-tag","dyte-avatar","dyte-network-indicator"]},"dyte-participant-setup":["dyte-avatar","div#setupcontrols-media"],"dyte-participant-tile[meeting=setup]":["dyte-avatar","div#setupcontrols-settings","div#setupcontrols-media"],"div#setupcontrols-media":[["dyte-mic-toggle",{size:"sm"}],["dyte-camera-toggle",{size:"sm"}]],"div#setupcontrols-settings":[["dyte-settings-toggle",{size:"sm"}]],"dyte-screenshare-view":{children:["dyte-name-tag","dyte-network-indicator"]},"dyte-name-tag":[["dyte-audio-visualizer",{slot:"start"}]],"dyte-controlbar":{states:["activeMoreMenu"],props:{variant:"solid"},children:["div#controlbar-left","div#controlbar-center","div#controlbar-right"]},"dyte-more-toggle":{states:["activeMoreMenu"],children:[]},"dyte-controlbar.sm":["div#controlbar-mobile"],"dyte-controlbar.md":["div#controlbar-mobile"],"dyte-more-toggle.activeMoreMenu":[["dyte-fullscreen-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-pip-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-caption-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-mute-all-button",{variant:"horizontal",slot:"more-elements"}],["dyte-breakout-rooms-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-recording-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-debugger-toggle",{variant:"horizontal"}]],"dyte-more-toggle.activeMoreMenu.sm":[["dyte-chat-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-participants-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-polls-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-plugins-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-fullscreen-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-screen-share-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-pip-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-caption-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-mute-all-button",{variant:"horizontal",slot:"more-elements"}],["dyte-breakout-rooms-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-settings-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-ai-toggle",{variant:"horizontal"}],["dyte-debugger-toggle",{variant:"horizontal"}]],"dyte-more-toggle.activeMoreMenu.md":[["dyte-chat-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-participants-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-polls-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-plugins-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-fullscreen-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-screen-share-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-pip-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-caption-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-mute-all-button",{variant:"horizontal",slot:"more-elements"}],["dyte-breakout-rooms-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-settings-toggle",{variant:"horizontal",slot:"more-elements"}],["dyte-ai-toggle",{variant:"horizontal"}],["dyte-debugger-toggle",{variant:"horizontal"}]],"div#controlbar-mobile":["dyte-mic-toggle","dyte-camera-toggle","dyte-webinar-stage-toggle","dyte-stage-toggle","dyte-leave-button","dyte-more-toggle"],"div#controlbar-left":["dyte-settings-toggle","dyte-screen-share-toggle","dyte-livestream-toggle"],"div#controlbar-center":["dyte-mic-toggle","dyte-camera-toggle","dyte-webinar-stage-toggle","dyte-stage-toggle","dyte-more-toggle","dyte-leave-button"],"div#controlbar-right":["dyte-chat-toggle","dyte-polls-toggle","dyte-participants-toggle","dyte-plugins-toggle","dyte-ai-toggle"]},config:{notification_sounds:{participant_left:!1},participant_joined_sound_notification_limit:10,participant_chat_message_sound_notification_limit:10,videoFit:"cover"}},Nt=e=>!("isConnected"in e)||e.isConnected,jt=((e,t)=>{let i;return(...s)=>{i&&clearTimeout(i),i=setTimeout(()=>{i=0,e(...s)},t)}})(e=>{for(let t of e.keys())e.set(t,e.get(t).filter(Nt))},2e3),zt=e=>"function"==typeof e?e():e,Bt=(e,t)=>{const i=e.indexOf(t);i>=0&&(e[i]=e[e.length-1],e.length--)},Gt={about_call:"About Call",screen:"Screen",camera:"Camera",leave:"Leave",dismiss:"Dismiss",logo:"Logo",page:"Page",more:"More","page.prev":"Previous Page","page.next":"Next Page",layout:"Layout","layout.auto":"Auto Layout",settings:"Settings",file:"File",image:"Image",connection:"Connection",leave_confirmation:"Are you sure you want to leave the call?",cancel:"Cancel",yes:"Yes","(you)":"(you)",you:"You",everyone:"Everyone",to:"To",mute:"Mute",kick:"Kick",pin:"Pin",pinned:"Pinned",accept:"Accept",unpin:"Unpin",pip_on:"Show PiP",pip_off:"Hide PiP",viewers:"Viewers",join:"Join",joined:"Joined",create:"Create",close:"Close",ask:"Ask",type:"Type",activate:"Activate",requests:"Requests",mic_off:"Mic Off",disable_mic:"Disable Mic",mic_on:"Mic On",enable_mic:"Enable Mic",audio:"Audio",test:"Test",minimize:"Hide Tile",maximize:"Show Tile",mute_all:"Mute all","mute_all.description":"Everyone else in the meeting will be muted.","mute_all.header":"Are you sure?","mute_all.allow_unmute":"Allow others to unmute",video_off:"Video Off",disable_video:"Disable Video",video_on:"Video On",enable_video:"Enable Video",video:"Video",offline:"You're offline","offline.description":"Please ensure that you are connected to the internet.",disconnected:"You haven't joined the meeting.",failed:"You've been disconnected","failed.description":"We could not connect you back to the meeting room. Please try rejoining the meeting.","disconnected.description":"Please join the meeting in order to see and interact with other participants.",participants:"Participants","participants.errors.empty_results":"Couldn't find a participant with the specified name or ID.","participants.empty_list":"It looks like nobody is here.","participants.no_pending_requests":"There are no pending requests.","participants.turn_off_video":"Turn off video",polls:"Polls","polls.by":"Poll by","polls.question":"Poll Question","polls.question.placeholder":"What is your poll for?","polls.answers":"Answers","polls.option":"Add an option.","polls.option.placeholder":"Enter an option","polls.results.anon":"Anonymous","polls.results.hide":"Hide results before voting","polls.create":"Create Poll","polls.cancel":"Cancel Poll Creation","polls.empty":"No polls available","polls.errors.question_required":"Question is required.","polls.errors.empty_option":"Empty options not allowed.",screenshare:"Screen Share","screenshare.min_preview":"Minimize Preview","screenshare.max_preview":"Expand Preview","screenshare.shared":"Your screen is being shared.","screenshare.start":"Share Screen","screenshare.stop":"Stop Sharing","screenshare.error.unknown":"An error occured while starting screenshare.","screenshare.error.max_count":"Maximum screen share limit reached.",plugins:"Plugins",perm_denied:"Permission denied by browser.","perm_denied.audio":"Mic Permission denied by browser","perm_denied.video":"Camera Permission denied by browser","perm_denied.screenshare":"Screenshare Permission denied by browser","perm_denied.audio.chrome.message":"In the top navigation bar, click on the icon left to the URL and ensure  'Microphone' permission is checked","perm_denied.video.chrome.message":"In the top navigation bar, click on the icon left to the URL and ensure  'Camera' permission is checked","perm_denied.screenshare.chrome.message":"Under Chrome settings, navigate to 'Privacy and Security > Site Settings > Permissions'. Select 'Screenshare', provide permission and reload this application.","perm_denied.audio.safari.message":"Under Safari settings, navigate to 'Websites > Microphone', provide permission and reload this application.","perm_denied.video.safari.message":"Under Safari settings, navigate to 'Websites > Camera', provide permission and reload this application.","perm_denied.screenshare.safari.message":"Under Safari settings, navigate to 'Websites > Screenshare', provide permission and reload this application.","perm_denied.audio.edge.message":"Under Edge settings, navigate to 'Site Permissions > Microphone', provide permission and reload this application.","perm_denied.video.edge.message":"Under Edge settings, navigate to 'Site Permissions > Camera', provide permission and reload this application.","perm_denied.screenshare.edge.message":"Under Edge settings, navigate to 'Site Permissions > Screenshare', provide permission and reload this application.","perm_denied.audio.microsoft edge.message":"Under Edge settings, navigate to 'Site Permissions > Microphone', provide permission and reload this application.","perm_denied.video.microsoft edge.message":"Under Edge settings, navigate to 'Site Permissions > Camera', provide permission and reload this application.","perm_denied.screenshare.microsoft edge.message":"Under Edge settings, navigate to 'Site Permissions > Screenshare', provide permission and reload this application.","perm_denied.audio.firefox.message":"Under Firefox settings, navigate to 'Privacy and Security > Permissions > Microphone', provide permission and reload this application.","perm_denied.video.firefox.message":"Under Firefox settings, navigate to 'Privacy and Security > Permissions > Camera', provide permission and reload this application.","perm_denied.screenshare.firefox.message":"Under Firefox settings, navigate to 'Privacy and Security > Permissions > Screenshare', provide permission and reload this application.","perm_denied.audio.others.message":"From your browser settings, enable 'Microphone' permissions and reload this application.","perm_denied.video.others.message":"From your browser settings, enable 'Camera' permissions and reload this application.","perm_denied.screenshare.others.message":"From your browser settings, enable 'Screenshare' permissions and reload this application.",perm_sys_denied:"Permission denied by system","perm_sys_denied.audio":"Mic permission denied by system","perm_sys_denied.video":"Camera permission denied by system","perm_sys_denied.screenshare":"Screenshare permission denied by system","perm_sys_denied.audio.macos.message":"Open Apple Menu, Navigate to 'System Settings > Privacy & Security > Microphone'. Allow access to your browser and reload this application.","perm_sys_denied.video.macos.message":"Open Apple Menu, Navigate to 'System Settings > Privacy & Security > Camera'. Allow access to your browser and reload this application.","perm_sys_denied.screenshare.macos.message":"Open Apple Menu, Navigate to 'System Settings > Privacy & Security > Screenshare'. Allow access to your browser and reload this application.","perm_sys_denied.audio.ios.message":"On your iPhone, navigate to 'Settings > Privacy > Microphone', allow access to your browser and reload this application.","perm_sys_denied.video.ios.message":"On your iPhone, navigate to 'Settings > Privacy > Camera', allow access to your browser and reload this application.","perm_sys_denied.screenshare.ios.message":"On your iPhone, navigate to 'Settings > Privacy > Screenshare', allow access to your browser and reload this application.","perm_sys_denied.audio.windows.message":"Go to windows settings, select 'Settings > Privacy > Microphone'. Allow permissions to your browser and reload this application.","perm_sys_denied.video.windows.message":"Go to windows settings, select 'Settings > Privacy > Camera'. Allow permissions to your browser and reload this application.","perm_sys_denied.screenshare.windows.message":"Go to windows settings, select 'Settings > Privacy > Screenshare'. Allow permissions to your browser and reload this application.","perm_sys_denied.audio.android.message":"On you device, navigate to 'Settings > Apps'. Select your browser, allow Microphone permissions and reload this application.","perm_sys_denied.video.android.message":"On you device, navigate to 'Settings > Apps'. Select your browser, allow Camera permissions and reload this application.","perm_sys_denied.screenshare.android.message":"On you device, navigate to 'Settings > Apps'. Select your browser, allow Screenshare permissions and reload this application.","perm_sys_denied.audio.others.message":"Navigate to your system settings. Allow 'Microphone' permissions for your browser and reload this application.","perm_sys_denied.video.others.message":"Navigate to your system settings. Allow 'Camera' permissions for your browser and reload this application.","perm_sys_denied.screenshare.others.message":"Navigate to your system settings. Allow 'Screenshare' permissions for your browser and reload this application.",perm_could_not_start:"Could not capture device.","perm_could_not_start.audio":"Unable to start your Microphone","perm_could_not_start.video":"Unable to start your Camera","perm_could_not_start.screenshare":"Unable to start your Screenshare","perm_could_not_start.audio.message":"Looks like the system could not capture your microphone. Please restart your device or upgrade your browser to fix this.","perm_could_not_start.video.message":"Looks like the system could not capture your camera. Please restart your device or upgrade your browser to fix this.","perm_could_not_start.screenshare.message":"Looks like the system could not capture your screenshare. Please restart your device or upgrade your browser to fix this.",full_screen:"Full Screen","full_screen.exit":"Exit Full Screen","waitlist.header_title":"Waiting","waitlist.body_text":"You are in the waiting room, the host will let you in soon.","waitlist.deny_request":"Deny request","waitlist.accept_request":"Accept request","waitlist.accept_all":"Accept all","stage_request.header_title":"Join Stage Requests","stage_request.deny_request":"Deny request","stage_request.accept_request":"Accept request","stage_request.accept_all":"Accept all","stage_request.deny_all":"Deny all","stage_request.approval_pending":"Pending","stage_request.denied":"Denied","stage_request.request":"Join stage","stage_request.requested":"Requested","stage_request.cancel_request":"Cancel request","stage_request.leave_stage":"Leave stage","stage_request.request_tip":"Request to join the discussion","stage_request.leave_tip":"Leave the stage","stage_request.pending_tip":"Request pending","stage_request.denied_tip":"Rejected request","stage.empty_host":"The stage is empty","stage.empty_host_summary":"You are off stage. You can manage stage request from the participants tab.","stage.empty_viewer":"There is no one on stage","stage.remove_from_stage":"Remove from stage","stage.invited_notification":"has been invited to join stage.","stage.add_to_stage":"Invite to stage","stage.join_title":"Join Stage","stage.join_summary":"You are about to join the stage, your video & audio as shown above will be visible to all participants.","stage.join_cancel":"Cancel","stage.join_confirm":"Join","setup_screen.join_in_as":"Join in as","setup_screen.joining_as":"Joining as","setup_screen.your_name":"Your name","stage.reconnecting":"Reconnecting...","recording.label":"REC","recording.indicator":"This meeting is being recorded.","recording.started":"This meeting is being recorded.","recording.stopped":"Recording for this meeting has been stopped.","recording.paused":"Recording for this meeting has been paused.","recording.error.start":"Error while starting recording.","recording.error.stop":"Error while stopping recording","recording.error.resume":"Error while resuming recording","recording.start":"Start Recording","recording.stop":"Stop Recording","recording.resume":"Resume Recording","recording.starting":"Starting","recording.stopping":"Stopping","recording.loading":"Loading","recording.idle":"Record",audio_playback:"Play Audio","audio_playback.title":"Allow Audio Playback","audio_playback.description":"In order to play audio properly on your device, click the button below.",breakout_rooms:"Breakout Rooms","breakout_rooms.room_config_header":"Create Breakout","breakout_rooms.join_breakout_header":"Join Breakout","breakout_rooms.empty":"Nobody here yet.","breakout_rooms.delete":"Delete Room","breakout_rooms.switch":"Switch","breakout_rooms.main_room":"Main Room","breakout_rooms.shuffle_participants":"Shuffle Participants","breakout_rooms.deselect":"Deselect","breakout_rooms.selected":"selected","breakout_rooms.num_of_rooms":"No. of Rooms","breakout_rooms.approx":"Approx.","breakout_rooms.participants_per_room":"participants/room","breakout_rooms.division_text":"when equally divided.","breakout_rooms.start_breakout":"Start Breakout","breakout_rooms.close_breakout":"Close Breakout","breakout_rooms.update_breakout":"Update Breakout","breakout_rooms.discard_changes":"Discard Changes","breakout_rooms.room":"Room","breakout_rooms.rooms":"Rooms","breakout_rooms.room_name":"Room Name","breakout_rooms.edit_room_name":"Edit Room Name","breakout_rooms.save_room_name":"Save Room Name","breakout_rooms.add_room":"Add","breakout_rooms.add_room_brief":"Add Room","breakout_rooms.select_all":"Select all","breakout_rooms.unassign_all":"Unassign all","breakout_rooms.assign":"Assign","breakout_rooms.assign_participants":"Assign Participants","breakout_rooms.none_assigned":"No participants assigned yet","breakout_rooms.drag_drop_participants":"Drag and drop participants","breakout_rooms.click_drop_participants":"Click here to assign","breakout_rooms.status.assign_multiple":"Assign multiple participants at once by clicking and selecting them","breakout_rooms.status.select_room":"Select a room to assign","breakout_rooms.ephemeral_status.participants_assigned":"Participants assigned","breakout_rooms.ephemeral_status.participants_assigned_randomly":"Participants assigned randomly","breakout_rooms.ephemeral_status.changes_discarded":"Changes discarded","breakout_rooms.confirm_modal.start_breakout.header":"Start breakout rooms?","breakout_rooms.confirm_modal.start_breakout.content":"Once started, all participants will be moved to their assigned rooms.","breakout_rooms.confirm_modal.start_breakout.cancelText":"No, go back","breakout_rooms.confirm_modal.start_breakout.ctaText":"Yes, start","breakout_rooms.confirm_modal.close_breakout.header":"Close breakout rooms?","breakout_rooms.confirm_modal.close_breakout.content":"All breakout rooms will be closed & participants will be moved back to the main room.","breakout_rooms.confirm_modal.close_breakout.ctaText":"Yes, close breakout","breakout_rooms.move_reason.started_msg":"Starting breakout rooms...","breakout_rooms.move_reason.started_desc":"You are being moved to your assigned room","breakout_rooms.move_reason.closed_msg":"Closing Breakout rooms...","breakout_rooms.move_reason.closed_desc":"You are being moved back to the main room","breakout_rooms.move_reason.switch_room":"Joining Breakout Room...","breakout_rooms.move_reason.switch_main_room":"Joining Main Room...","breakout_rooms.all_assigned":"All participants have been assigned","breakout_rooms.empty_main_room":"No more participants in the main room.","breakout_rooms.leave_confirmation":"Are you sure you want to leave the call? You are in a breakout room, you can join the main room too.","breakout_rooms.leave_confirmation.main_room_btn":"Go back to main room",ai:"AI","ai.meeting_ai":"MeetingAI","ai.home":"Home","ai.transcriptions":"Transcriptions","ai.personal":"Personal","ai.caption_view":"Caption View","ai.chat.tooltip":"This conversation will just be visible to you and not to others in the call.","ai.chat.summerise":"Hey AI, summarise this call","ai.chat.agenda":"Hey AI, what is today's agenda?",search:"Search","search.could_not_find":"Couldn't find a participant with the specified name or ID.","search.empty":"It looks like nobody is here.",end:"End Meeting","end.all":"End meeting for all",ended:"The meeting ended.","ended.rejected":"Your request to join the meeting was denied.","ended.left":"You left the meeting.","ended.kicked":"You were removed from the meeting.","ended.disconnected":"The call ended because the connection was lost.","ended.network":"Please check your internet connection and try again.","ended.unauthorized":"You are not authorized to join this meeting.",network:"Network","network.reconnecting":"Connection lost. Trying to reconnect.","network.delay_extended":"Taking too long to reconnect. Please check your network connection.","network.disconnected":"Could not reconnect. Please leave the meeting and try refreshing the window.","network.leaving":"Automatically leaving the meeting in 10 seconds.","network.restored":"Connection restored","network.delay":"Taking too long to reconnect.","network.lost":"Connection lost","network.lost_extended":"Connection lost. Please check your network connection.",livestream:"Livestream","livestream.indicator":"This meeting is being livestreamed.","livestream.skip":"Skip to Live","livestream.idle":"Waiting to go live.","livestream.starting":"Livestream is starting...","livestream.stopping":"Livestream is stopping...","livestream.waiting_on_manual_ingestion":"Please ingest livestream media.","livestream.error.not_supported":"Player not supported.","livestream.error.not_found":"Playback URL not found.","livestream.error.unknown":"An unknown error occured.","livestream.error.sync":"Could not sync livestream please try again later.","livestream.error.start":"Error while starting livestream.","livestream.error.stop":"Error while stopping livestream.","livestream.go_live":"Go Live","livestream.end_live":"End Live","livestream.error":"Error","cta.help":"Need help on how to do this?","cta.continue":"Ignore","cta.reload":"Reload","cta.confirmation":"Are you sure?","cta.system_settings":"Open Settings","remote_access.empty":"There are no remote requests, yet.","remote_access.requests":"The following people have requested remote control to your screen share.","remote_access.allow":"Please select whom you want to give access to.","remote_access.grant":"Grant acess","remote_access.indicator":"Any plugin or screenshare you switch to will sync the change across the meeting",chat:"Chat","chat.new":"New","chat.max_limit_warning":"Max Character Limit","chat.rate_limit_error":"Please wait before you can send another message","chat.new_channel":"Create new channel","chat.channel_name":"Enter channel name","chat.member_name":"Enter member name","chat.add_members":"Add members","chat.delete_msg":"Delete","chat.edit_msg":"Edit","chat.send_msg":"Send message","chat.send_attachment":"Drop files/images to send","chat.send_img":"Send an image","chat.send_file":"Send a file","chat.send_emoji":"Send an emoji","chat.update_msg":"Update message","chat.channel_members":"Channel Members","chat.img.loading":"Loading image","chat.error.img_not_found":"Image not found","chat.error.empty_results":"Couldn't find a member with the specified name.","chat.img.shared_by":"Shared by","chat.reply":"Reply","chat.message_placeholder":"Message..","chat.click_to_send":"Click to send as message","chat.search_msgs":"Search messages","chat.search_conversations":"Search conversations","chat.start_conversation":"Start a conversation..","chat.empty_search":"No messages found","chat.empty_channel":"Send a message to get started","chat.cancel_upload":"Cancel upload","chat.view_chats":"View chats","chat.everyone":"everyone","chat.pinned_msgs":"Pinned messages","chat.toggle_pinned_msgs":"Toggle pinned messages","date.today":"Today","date.yesteday":"Yesterday","date.sunday":"Sunday","date.monday":"Monday","date.tuesday":"Tuesday","date.wednesday":"Wednesday","date.thursday":"Thursday","date.friday":"Friday","date.saturday":"Saturday","list.empty":"No items found","grid.listening":"Listening","transcript.off":"Turn off Transcripts","transcript.on":"Turn on Transcripts","settings.notification_sound":"Notification sound","settings.microphone_input":"Microphone","settings.speaker_output":"Speaker","settings.mirror_video":"Mirror my Video","settings.camera_off":"Camera is off","dialog.close":"Close dialog","notifications.joined":"just joined","notifications.left":"left","notifications.requesting_to_join_meeting":"is requesting to join the meeting","notifications.requested_to_join_stage":"has requested to join stage","notifications.joined_stage":"has joined stage","notifications.request_to_join_accepted":"Request to join accepted","notifications.request_to_join_rejected":"Request to join rejected","notifications.accept":"Accept","notifications.new_poll_created_by":"New poll created by","notifications.connected_to":"Connected to","notifications.plugin_switched_to":"Plugin switched to","notifications.remote_control_requested":"has requested for remote control","notifications.remote_control_request_sent":"Sent remote control request to","notifications.remote_control_request_accepted":"has granted remote control","notifications.remote_control_granted":"Granted remote control to","notifications.remote_control_terminated":"Existing remote control has been terminated","debugger.troubleshooting.label":"Troubleshooting","debugger.quality.good":"Good","debugger.quality.average":"Average","debugger.quality.poor":"Poor","debugger.stats.bitrate.label":"Bitrate","debugger.stats.bitrate.description":"Data transmitted per second, affects quality and file size.","debugger.stats.packet_loss.label":"Packet Loss","debugger.stats.packet_loss.description":"Amount of data lost during transfer","debugger.stats.jitter.label":"Jitter","debugger.stats.jitter.description":"Variance or fluctuation in latency","debugger.stats.cpu_limitations.label":"CPU Limitations","debugger.stats.cpu_limitations.description":"CPU limitations can impact WebRTC call quality and performance.","debugger.stats.bandwidth_limitations.label":"Bandwidth Limitations","debugger.stats.bandwidth_limitations.description":"Slow internet speeds can degrade video quality.","debugger.audio.label":"Audio","debugger.audio.troubleshooting.label":"Audio Troubleshooting","debugger.audio.messages.generating_report":"Generating report. Please wait for a few seconds.","debugger.audio.messages.enable_media":"Please enable mic to see the report.","debugger.audio.sections.network_media":"Network & Media","debugger.video.label":"Video","debugger.video.troubleshooting.label":"Video Troubleshooting","debugger.video.messages.generating_report":"Generating report. Please wait for a few seconds.","debugger.video.messages.enable_media":"Please enable camera to see the report.","debugger.video.sections.network_media":"Network & Media","debugger.screenshare.label":"Screenshare","debugger.screenshare.troubleshooting.label":"Screenshare Troubleshooting","debugger.screenshare.sections.network_media":"Network & Media","debugger.screenshare.messages.generating_report":"Generating report. Please wait for a few seconds.","debugger.screenshare.messages.enable_media":"Please share screen to see the report.","debugger.system.label":"System","debugger.system.troubleshooting.label":"System Troubleshooting","debugger.system.sections.battery":"Battery","debugger.system.battery.level.label":"Battery Level","debugger.system.battery.level.description":"A low battery charge may result in reduced performance.","debugger.system.battery.charging.label":"Battery Charging Status","debugger.system.battery.charging.description":"A device running on power performs optimally.","debugger.system.battery.charging.is_charging":"Charging","debugger.system.battery.charging.is_not_charging":"Not charging"},Ht=(e=Gt)=>{let t=Gt;return(e!==Gt||Object.keys(e).length>0)&&(t=Object.assign({},Gt,e)),e=>{var i;return null!==(i=t[e])&&void 0!==i?i:e}},Vt={people:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 13.999 13 14a2 2 0 0 1 1.995 1.85L15 16v1.5C14.999 21 11.284 22 8.5 22c-2.722 0-6.335-.956-6.495-4.27L2 17.5v-1.501c0-1.054.816-1.918 1.85-1.995L4 14ZM15.22 14H20c1.054 0 1.918.816 1.994 1.85L22 16v1c-.001 3.062-2.858 4-5 4a7.16 7.16 0 0 1-2.14-.322c.336-.386.607-.827.802-1.327A6.19 6.19 0 0 0 17 19.5l.267-.006c.985-.043 3.086-.363 3.226-2.289L20.5 17v-1a.501.501 0 0 0-.41-.492L20 15.5h-4.051a2.957 2.957 0 0 0-.595-1.34L15.22 14H20h-4.78ZM4 15.499l-.1.01a.51.51 0 0 0-.254.136.506.506 0 0 0-.136.253l-.01.101V17.5c0 1.009.45 1.722 1.417 2.242.826.445 2.003.714 3.266.753l.317.005.317-.005c1.263-.039 2.439-.308 3.266-.753.906-.488 1.359-1.145 1.412-2.057l.005-.186V16a.501.501 0 0 0-.41-.492L13 15.5l-9-.001ZM8.5 3a4.5 4.5 0 1 1 0 9 4.5 4.5 0 0 1 0-9Zm9 2a3.5 3.5 0 1 1 0 7 3.5 3.5 0 0 1 0-7Zm-9-.5c-1.654 0-3 1.346-3 3s1.346 3 3 3 3-1.346 3-3-1.346-3-3-3Zm9 2c-1.103 0-2 .897-2 2s.897 2 2 2 2-.897 2-2-.897-2-2-2Z" fill="currentColor"/></svg>',people_checked:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 29 29"><path fill="currentColor" d="M14.58 15.333H2.833a2.667 2.667 0 0 0-2.666 2.666v2l.006.307c.214 4.419 5.031 5.693 8.66 5.693 1.374 0 2.92-.182 4.32-.649a8.53 8.53 0 0 1-.717-1.87c-.93.298-2.027.478-3.18.513l-.423.006-.422-.006c-1.684-.052-3.254-.411-4.355-1.004-1.29-.694-1.89-1.644-1.89-2.99v-2.001l.014-.135a.675.675 0 0 1 .181-.337.68.68 0 0 1 .338-.181l.134-.014h10.31a8.71 8.71 0 0 1 1.436-1.998h.001Zm.253-8.667a6 6 0 1 0-12 0 6 6 0 0 0 12 0Zm-10 0c0-2.205 1.795-4 4-4 2.206 0 4 1.795 4 4s-1.794 4-4 4c-2.205 0-4-1.795-4-4ZM25.5 7.999a4.667 4.667 0 1 0-9.333 0A4.667 4.667 0 0 0 25.5 8Zm-7.333 0a2.67 2.67 0 0 1 2.666-2.666A2.67 2.67 0 0 1 23.5 7.999a2.67 2.67 0 0 1-2.667 2.667 2.67 2.67 0 0 1-2.666-2.667Zm10 13.334a7.333 7.333 0 1 1-14.667 0 7.333 7.333 0 0 1 14.667 0Zm-2.862-3.139a.666.666 0 0 0-.944 0l-4.86 4.863-2.196-2.196a.667.667 0 1 0-.944.944l2.667 2.666a.666.666 0 0 0 .944 0l5.333-5.333a.666.666 0 0 0 0-.944Z"/></svg>',chat:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10a9.96 9.96 0 0 1-4.587-1.112l-3.826 1.067a1.25 1.25 0 0 1-1.54-1.54l1.068-3.823A9.96 9.96 0 0 1 2 12C2 6.477 6.477 2 12 2Zm0 1.5A8.5 8.5 0 0 0 3.5 12c0 1.47.373 2.883 1.073 4.137l.15.27-1.112 3.984 3.987-1.112.27.15A8.5 8.5 0 1 0 12 3.5ZM8.75 13h4.498a.75.75 0 0 1 .102 1.493l-.102.007H8.75a.75.75 0 0 1-.102-1.493L8.75 13h4.498H8.75Zm0-3.5h6.505a.75.75 0 0 1 .101 1.493l-.101.007H8.75a.75.75 0 0 1-.102-1.493L8.75 9.5h6.505H8.75Z" fill="currentColor"/></svg>',poll:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.752 2a2.752 2.752 0 0 1 2.752 2.751V19.25a2.752 2.752 0 1 1-5.504 0V4.75A2.752 2.752 0 0 1 11.752 2Zm7 5a2.752 2.752 0 0 1 2.752 2.751v9.499a2.752 2.752 0 1 1-5.504 0V9.75A2.752 2.752 0 0 1 18.752 7Zm-14 5a2.752 2.752 0 0 1 2.752 2.751v4.499a2.752 2.752 0 0 1-5.504 0V14.75A2.752 2.752 0 0 1 4.752 12Zm7-8.5c-.692 0-1.252.56-1.252 1.251V19.25a1.252 1.252 0 0 0 2.504 0V4.75c0-.691-.56-1.251-1.252-1.251Zm7 5c-.691 0-1.252.56-1.252 1.251v9.499a1.252 1.252 0 0 0 2.504 0V9.75c0-.691-.56-1.251-1.252-1.251Zm-14 5c-.692 0-1.252.56-1.252 1.251v4.499a1.252 1.252 0 1 0 2.504 0V14.75c0-.691-.56-1.252-1.252-1.252Z" fill="currentColor"/></svg>',participants:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.754 10c.966 0 1.75.784 1.75 1.75v4.749a4.501 4.501 0 0 1-9.002 0V11.75c0-.966.783-1.75 1.75-1.75h5.502Zm0 1.5H9.252a.25.25 0 0 0-.25.25v4.749a3.001 3.001 0 0 0 6.002 0V11.75a.25.25 0 0 0-.25-.25ZM3.75 10h3.381a2.738 2.738 0 0 0-.618 1.5H3.75a.25.25 0 0 0-.25.25v3.249a2.501 2.501 0 0 0 3.082 2.433c.085.504.24.985.453 1.432A4.001 4.001 0 0 1 2 14.999V11.75c0-.966.784-1.75 1.75-1.75Zm13.125 0h3.375c.966 0 1.75.784 1.75 1.75V15a4 4 0 0 1-5.03 3.866c.214-.448.369-.929.455-1.433A2.5 2.5 0 0 0 20.5 15v-3.25a.25.25 0 0 0-.25-.25h-2.757a2.738 2.738 0 0 0-.618-1.5ZM12 3a3 3 0 1 1 0 6 3 3 0 0 1 0-6Zm6.5 1a2.5 2.5 0 1 1 0 5 2.5 2.5 0 0 1 0-5Zm-13 0a2.5 2.5 0 1 1 0 5 2.5 2.5 0 0 1 0-5Zm6.5.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3Zm6.5 1a1 1 0 1 0 0 2 1 1 0 0 0 0-2Zm-13 0a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z" fill="currentColor"/></svg>',rocket:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48"><path d="M9.35 20.45 14.65 22.7Q15.55 20.9 16.575 19.15Q17.6 17.4 18.75 15.8L14.8 15Q14.8 15 14.8 15Q14.8 15 14.8 15ZM17.05 24.5 23.7 31.15Q26.55 29.85 29.05 28.2Q31.55 26.55 33.1 25Q37.15 20.95 39.05 16.7Q40.95 12.45 41.1 7.1Q35.75 7.25 31.5 9.15Q27.25 11.05 23.2 15.1Q21.65 16.65 20 19.15Q18.35 21.65 17.05 24.5ZM28.5 19.7Q27.5 18.7 27.5 17.225Q27.5 15.75 28.5 14.75Q29.5 13.75 30.975 13.75Q32.45 13.75 33.45 14.75Q34.45 15.75 34.45 17.225Q34.45 18.7 33.45 19.7Q32.45 20.7 30.975 20.7Q29.5 20.7 28.5 19.7ZM27.75 38.85 33.2 33.4Q33.2 33.4 33.2 33.4Q33.2 33.4 33.2 33.4L32.4 29.45Q30.8 30.6 29.05 31.625Q27.3 32.65 25.5 33.55ZM44.05 4.15Q44.5 10.95 42.35 16.55Q40.2 22.15 35.25 27.1Q35.2 27.15 35.15 27.2Q35.1 27.25 35.05 27.3L36.15 32.8Q36.3 33.55 36.075 34.25Q35.85 34.95 35.3 35.5L26.75 44.1L22.5 34.2L14 25.7L4.1 21.45L12.7 12.9Q13.25 12.35 13.95 12.125Q14.65 11.9 15.4 12.05L20.9 13.15Q20.95 13.1 21 13.075Q21.05 13.05 21.1 13Q26.05 8.05 31.65 5.875Q37.25 3.7 44.05 4.15ZM7.45 31.75Q9.2 30 11.725 29.975Q14.25 29.95 16 31.7Q17.75 33.45 17.725 35.975Q17.7 38.5 15.95 40.25Q14.65 41.55 11.925 42.4Q9.2 43.25 3.75 44Q4.5 38.55 5.325 35.8Q6.15 33.05 7.45 31.75ZM9.55 33.9Q8.85 34.65 8.3 36.25Q7.75 37.85 7.35 40.35Q9.85 39.95 11.45 39.4Q13.05 38.85 13.8 38.15Q14.75 37.3 14.775 36.025Q14.8 34.75 13.9 33.8Q12.95 32.9 11.675 32.925Q10.4 32.95 9.55 33.9Z" fill="currentColor" /></svg>',call_end:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m21.903 13.202-.191.816a2.75 2.75 0 0 1-2.955 2.107l-1.755-.178A2.75 2.75 0 0 1 14.6 13.83l-.389-1.686a.25.25 0 0 0-.113-.157c-.321-.197-1.034-.32-2.098-.32-.786 0-1.386.067-1.786.189-.14.043-.238.085-.301.116l-.09.048-.015.04-.409 1.77A2.75 2.75 0 0 1 7 15.948l-1.746.177A2.75 2.75 0 0 1 2.3 14.03l-.196-.817a3.75 3.75 0 0 1 1.13-3.651C5.134 7.839 8.064 7 12 7c3.943 0 6.875.842 8.776 2.57a3.75 3.75 0 0 1 1.172 3.41l-.045.222Zm-1.426-.514a2.25 2.25 0 0 0-.71-2.009C18.184 9.241 15.602 8.5 12 8.5c-3.598 0-6.177.739-7.76 2.172a2.25 2.25 0 0 0-.677 2.19l.196.818a1.25 1.25 0 0 0 1.342.953l1.746-.178a1.25 1.25 0 0 0 1.09-.962l.423-1.82.043-.136c.376-.998 1.591-1.37 3.597-1.37 1.318 0 2.265.164 2.88.54.401.245.687.642.793 1.1l.389 1.685c.12.522.56.909 1.092.963l1.754.178a1.25 1.25 0 0 0 1.343-.958l.192-.816.034-.171Z" fill="currentColor"/></svg>',share:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 2.498a3.502 3.502 0 1 1-2.597 5.851l-4.558 2.604a3.5 3.5 0 0 1 0 2.093l4.557 2.606a3.502 3.502 0 1 1-.745 1.302L9.1 14.347a3.502 3.502 0 1 1 0-4.698l4.557-2.604A3.502 3.502 0 0 1 17 2.498Zm0 13.5a2.002 2.002 0 1 0 0 4.004 2.002 2.002 0 0 0 0-4.004Zm-10.498-6a2.002 2.002 0 1 0 0 4.004 2.002 2.002 0 0 0 0-4.004Zm10.498-6a2.002 2.002 0 1 0 0 4.004 2.002 2.002 0 0 0 0-4.004Z" fill="currentColor"/></svg>',mic_on:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.25 11a.75.75 0 0 1 .743.648l.007.102v.5a6.75 6.75 0 0 1-6.249 6.732l-.001 2.268a.75.75 0 0 1-1.493.102l-.007-.102v-2.268a6.75 6.75 0 0 1-6.246-6.496L5 12.25v-.5a.75.75 0 0 1 1.493-.102l.007.102v.5a5.25 5.25 0 0 0 5.034 5.246l.216.004h.5a5.25 5.25 0 0 0 5.246-5.034l.004-.216v-.5a.75.75 0 0 1 .75-.75ZM12 2a4 4 0 0 1 4 4v6a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4Zm0 1.5A2.5 2.5 0 0 0 9.5 6v6a2.5 2.5 0 0 0 5 0V6A2.5 2.5 0 0 0 12 3.5Z" fill="currentColor"/></svg>',mic_off:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.28 2.22a.75.75 0 1 0-1.06 1.06L8 9.06V12a4 4 0 0 0 6.248 3.309l1.146 1.146A5.227 5.227 0 0 1 12.25 17.5h-.5l-.216-.004A5.25 5.25 0 0 1 6.5 12.25v-.5l-.007-.102A.75.75 0 0 0 5 11.75v.5l.004.236a6.75 6.75 0 0 0 6.246 6.496v2.268l.007.102a.75.75 0 0 0 1.493-.102l.001-2.268a6.718 6.718 0 0 0 3.712-1.458l4.256 4.256a.75.75 0 0 0 1.061-1.06L3.28 2.22Zm9.876 11.997A2.5 2.5 0 0 1 9.5 12v-1.44l3.656 3.657ZM14.5 6v5.318l1.43 1.43c.046-.242.07-.492.07-.748V6a4 4 0 0 0-7.862-1.044L9.5 6.318V6a2.5 2.5 0 0 1 5 0ZM17.196 14.014l1.146 1.146A6.725 6.725 0 0 0 19 12.25v-.5l-.007-.102a.75.75 0 0 0-1.493.102v.5l-.004.216a5.233 5.233 0 0 1-.3 1.548Z" fill="currentColor"/></svg>',video_on:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13.75 4.5A3.25 3.25 0 0 1 17 7.75v.173l3.864-2.318A.75.75 0 0 1 22 6.248V17.75a.75.75 0 0 1-1.136.643L17 16.075v.175a3.25 3.25 0 0 1-3.25 3.25h-8.5A3.25 3.25 0 0 1 2 16.25v-8.5A3.25 3.25 0 0 1 5.25 4.5h8.5Zm0 1.5h-8.5A1.75 1.75 0 0 0 3.5 7.75v8.5c0 .966.784 1.75 1.75 1.75h8.5a1.75 1.75 0 0 0 1.75-1.75v-8.5A1.75 1.75 0 0 0 13.75 6Zm6.75 1.573L17 9.674v4.651l3.5 2.1V7.573Z" fill="currentColor"/></svg>',video_off:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.28 2.22a.75.75 0 1 0-1.06 1.06l1.567 1.567A3.25 3.25 0 0 0 2 7.75v8.5a3.25 3.25 0 0 0 3.25 3.25h8.5a3.25 3.25 0 0 0 2.903-1.786l4.066 4.067a.75.75 0 0 0 1.061-1.061L3.28 2.22Zm12.196 14.317A1.75 1.75 0 0 1 13.75 18h-8.5a1.75 1.75 0 0 1-1.75-1.75v-8.5c0-.869.633-1.59 1.463-1.727l10.514 10.514ZM15.5 12.318V7.75A1.75 1.75 0 0 0 13.75 6H9.182l-1.5-1.5h6.068A3.25 3.25 0 0 1 17 7.75v.173l3.864-2.318A.75.75 0 0 1 22 6.248V17.75c0 .301-.17.543-.403.665L20.5 17.318V7.573L17 9.674v4.144l-1.5-1.5Z" fill="currentColor"/></svg>',share_screen_start:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M2 6.25A2.25 2.25 0 0 1 4.25 4h15.5A2.25 2.25 0 0 1 22 6.25v11.5A2.25 2.25 0 0 1 19.75 20H4.25A2.25 2.25 0 0 1 2 17.75V6.25Zm2.25-.75a.75.75 0 0 0-.75.75v11.5c0 .414.336.75.75.75h15.5a.75.75 0 0 0 .75-.75V6.25a.75.75 0 0 0-.75-.75H4.25Z"/><path d="M12 7.245a.75.75 0 0 1 .53.22l3.255 3.255a.75.75 0 1 1-1.06 1.06L12.75 9.806v6.447a.75.75 0 0 1-1.5 0V9.808L9.28 11.78a.75.75 0 1 1-1.06-1.06l3.25-3.254a.75.75 0 0 1 .53-.22Z"/></svg>',share_screen_stop:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M2 6.25A2.25 2.25 0 0 1 4.25 4h15.5A2.25 2.25 0 0 1 22 6.25v11.5A2.25 2.25 0 0 1 19.75 20H4.25A2.25 2.25 0 0 1 2 17.75V6.25Zm2.25-.75a.75.75 0 0 0-.75.75v11.5c0 .414.336.75.75.75h15.5a.75.75 0 0 0 .75-.75V6.25a.75.75 0 0 0-.75-.75H4.25Z"/><path d="M8.22 8.215a.75.75 0 0 1 1.06 0l2.72 2.72 2.725-2.716a.75.75 0 0 1 1.06 1.062l-2.724 2.715 2.724 2.724a.75.75 0 1 1-1.06 1.06L12 13.057 9.28 15.78a.75.75 0 0 1-1.06-1.06l2.72-2.724-2.72-2.72a.75.75 0 0 1 0-1.06Z"/></svg>',share_screen_person:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M2 7.25A3.25 3.25 0 0 1 5.25 4h13.5A3.25 3.25 0 0 1 22 7.25V13h-.258a3.74 3.74 0 0 0-1.242-2.545V7.25a1.75 1.75 0 0 0-1.75-1.75H5.25A1.75 1.75 0 0 0 3.5 7.25v9.5c0 .966.784 1.75 1.75 1.75H12v.5c0 .34.04.674.118 1H5.25A3.25 3.25 0 0 1 2 16.75v-9.5ZM21.5 17a1.5 1.5 0 0 1 1.5 1.5v.5c0 1.971-1.86 4-5 4-3.14 0-5-2.029-5-4v-.5a1.5 1.5 0 0 1 1.5-1.5h7ZM18 10.5a2.75 2.75 0 1 1 0 5.5 2.75 2.75 0 0 1 0-5.5Z" fill="currentColor"/></svg>',clock:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333ZM11.25 6a.75.75 0 0 1 .743.648L12 6.75V12h3.25a.75.75 0 0 1 .102 1.493l-.102.007h-4a.75.75 0 0 1-.743-.648l-.007-.102v-6a.75.75 0 0 1 .75-.75Z" fill="currentColor"/></svg>',dismiss:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m4.397 4.554.073-.084a.75.75 0 0 1 .976-.073l.084.073L12 10.939l6.47-6.47a.75.75 0 1 1 1.06 1.061L13.061 12l6.47 6.47a.75.75 0 0 1 .072.976l-.073.084a.75.75 0 0 1-.976.073l-.084-.073L12 13.061l-6.47 6.47a.75.75 0 0 1-1.06-1.061L10.939 12l-6.47-6.47a.75.75 0 0 1-.072-.976l.073-.084-.073.084Z" fill="currentColor"/></svg>',send:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.694 12 2.299 3.272c-.236-.607.356-1.188.942-.982l.093.04 18 9a.75.75 0 0 1 .097 1.283l-.097.058-18 9a.75.75 0 0 1-1.065-.847l.03-.096L5.694 12 2.299 3.272 5.694 12ZM4.402 4.54l2.61 6.71h6.627a.75.75 0 0 1 .743.648l.007.102a.75.75 0 0 1-.649.743l-.101.007H7.01l-2.609 6.71L19.322 12 4.401 4.54Z" fill="currentColor"/></svg>',search:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 2.75a7.25 7.25 0 0 1 5.63 11.819l4.9 4.9a.75.75 0 0 1-.976 1.134l-.084-.073-4.901-4.9A7.25 7.25 0 1 1 10 2.75Zm0 1.5a5.75 5.75 0 1 0 0 11.5 5.75 5.75 0 0 0 0-11.5Z" fill="currentColor"/</svg>',more_vertical:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7.75a1.75 1.75 0 1 1 0-3.5 1.75 1.75 0 0 1 0 3.5ZM12 13.75a1.75 1.75 0 1 1 0-3.5 1.75 1.75 0 0 1 0 3.5ZM10.25 18a1.75 1.75 0 1 0 3.5 0 1.75 1.75 0 0 0-3.5 0Z" fill="currentColor"/></svg>',chevron_down:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.22 8.47a.75.75 0 0 1 1.06 0L12 15.19l6.72-6.72a.75.75 0 1 1 1.06 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L4.22 9.53a.75.75 0 0 1 0-1.06Z" fill="currentColor"/></svg>',chevron_up:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.22 15.53a.75.75 0 0 0 1.06 0L12 8.81l6.72 6.72a.75.75 0 1 0 1.06-1.06l-7.25-7.25a.75.75 0 0 0-1.06 0l-7.25 7.25a.75.75 0 0 0 0 1.06Z" fill="currentColor"/></svg>',chevron_left:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M15.53 4.22a.75.75 0 0 1 0 1.06L8.81 12l6.72 6.72a.75.75 0 1 1-1.06 1.06l-7.25-7.25a.75.75 0 0 1 0-1.06l7.25-7.25a.75.75 0 0 1 1.06 0Z" fill="currentColor"/></svg>',chevron_right:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.47 4.22a.75.75 0 0 0 0 1.06L15.19 12l-6.72 6.72a.75.75 0 1 0 1.06 1.06l7.25-7.25a.75.75 0 0 0 0-1.06L9.53 4.22a.75.75 0 0 0-1.06 0Z" fill="currentColor"/></svg>',settings:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="currentColor"/></svg>',wifi:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.745 10.75a8.291 8.291 0 0 1 1.492 2.07.75.75 0 1 1-1.335.683 6.798 6.798 0 0 0-1.218-1.692 6.562 6.562 0 0 0-10.493 1.673.75.75 0 1 1-1.339-.677 8.062 8.062 0 0 1 12.893-2.057Zm-2.102 3.07c.448.447.816.997 1.072 1.582a.75.75 0 1 1-1.373.602 3.72 3.72 0 0 0-.76-1.124 3.592 3.592 0 0 0-5.08 0c-.31.31-.562.689-.746 1.11a.75.75 0 1 1-1.375-.6 5.11 5.11 0 0 1 1.061-1.57 5.092 5.092 0 0 1 7.201 0Zm4.805-5.541c.51.509.99 1.09 1.409 1.697a.75.75 0 0 1-1.235.852 10.822 10.822 0 0 0-1.234-1.489c-4.08-4.08-10.695-4.08-14.776 0-.421.422-.84.934-1.222 1.484a.75.75 0 0 1-1.232-.855c.43-.62.905-1.2 1.394-1.69 4.666-4.665 12.23-4.665 16.896 0Zm-7.387 8.16a1.5 1.5 0 1 1-2.122 2.122 1.5 1.5 0 0 1 2.122-2.122Z" fill="currentColor"/></svg>',speaker:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M15 4.25c0-1.079-1.274-1.65-2.08-.934L8.427 7.309a.75.75 0 0 1-.498.19H4.25A2.25 2.25 0 0 0 2 9.749v4.497a2.25 2.25 0 0 0 2.25 2.25h3.68a.75.75 0 0 1 .498.19l4.491 3.994c.806.716 2.081.144 2.081-.934V4.25ZM9.425 8.43 13.5 4.807v14.382l-4.075-3.624a2.25 2.25 0 0 0-1.495-.569H4.25a.75.75 0 0 1-.75-.75V9.75a.75.75 0 0 1 .75-.75h3.68a2.25 2.25 0 0 0 1.495-.569ZM18.992 5.897a.75.75 0 0 1 1.049.157A9.959 9.959 0 0 1 22 12a9.96 9.96 0 0 1-1.96 5.946.75.75 0 0 1-1.205-.892A8.459 8.459 0 0 0 20.5 12a8.459 8.459 0 0 0-1.665-5.054.75.75 0 0 1 .157-1.049Z" /><path d="M17.143 8.37a.75.75 0 0 1 1.017.302c.536.99.84 2.125.84 3.328a6.973 6.973 0 0 1-.84 3.328.75.75 0 0 1-1.32-.714c.42-.777.66-1.666.66-2.614s-.24-1.837-.66-2.614a.75.75 0 0 1 .303-1.017Z"/></svg>',speaker_off:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M3.28 2.22a.75.75 0 1 0-1.06 1.06L6.438 7.5H4.25A2.25 2.25 0 0 0 2 9.749v4.497a2.25 2.25 0 0 0 2.25 2.25h3.68a.75.75 0 0 1 .498.19l4.491 3.994c.806.716 2.081.144 2.081-.934V16.06l5.72 5.72a.75.75 0 0 0 1.06-1.061L3.28 2.22ZM13.5 14.56v4.629l-4.075-3.624a2.25 2.25 0 0 0-1.495-.569H4.25a.75.75 0 0 1-.75-.75V9.75a.75.75 0 0 1 .75-.75h3.688L13.5 14.56ZM13.5 4.807v5.511l1.5 1.5V4.25c0-1.079-1.274-1.65-2.08-.934l-3.4 3.022 1.063 1.063L13.5 4.807ZM17.141 13.96l1.138 1.137A6.974 6.974 0 0 0 19 12a6.973 6.973 0 0 0-.84-3.328.75.75 0 0 0-1.32.714c.42.777.66 1.666.66 2.614 0 .691-.127 1.351-.359 1.96ZM19.388 16.206l1.093 1.094A9.955 9.955 0 0 0 22 12a9.959 9.959 0 0 0-1.96-5.946.75.75 0 0 0-1.205.892A8.46 8.46 0 0 1 20.5 12a8.458 8.458 0 0 1-1.112 4.206Z"/></svg>',download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18.25 20.5a.75.75 0 1 1 0 1.5l-13 .004a.75.75 0 1 1 0-1.5l13-.004ZM11.648 2.012l.102-.007a.75.75 0 0 1 .743.648l.007.102-.001 13.685 3.722-3.72a.75.75 0 0 1 .976-.073l.085.073a.75.75 0 0 1 .072.976l-.073.084-4.997 4.997a.75.75 0 0 1-.976.073l-.085-.073-5.003-4.996a.75.75 0 0 1 .976-1.134l.084.072 3.719 3.714L11 2.755a.75.75 0 0 1 .648-.743l.102-.007-.102.007Z" fill="currentColor"/></svg>',full_screen_maximize:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4.5 5.75c0-.69.56-1.25 1.25-1.25h2a.75.75 0 0 0 0-1.5h-2A2.75 2.75 0 0 0 3 5.75v2a.75.75 0 0 0 1.5 0v-2ZM4.5 18.25c0 .69.56 1.25 1.25 1.25h2a.75.75 0 0 1 0 1.5h-2A2.75 2.75 0 0 1 3 18.25v-2a.75.75 0 0 1 1.5 0v2ZM18.25 4.5c.69 0 1.25.56 1.25 1.25v2a.75.75 0 0 0 1.5 0v-2A2.75 2.75 0 0 0 18.25 3h-2a.75.75 0 0 0 0 1.5h2ZM19.5 18.25c0 .69-.56 1.25-1.25 1.25h-2a.75.75 0 0 0 0 1.5h2A2.75 2.75 0 0 0 21 18.25v-2a.75.75 0 0 0-1.5 0v2Z" fill="currentColor"/></svg>',full_screen_minimize:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.5 3.75a.75.75 0 0 0-1.5 0v2.5a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 0 0 1.5h2.5A2.25 2.25 0 0 0 8.5 6.25v-2.5ZM8.5 20.25a.75.75 0 0 1-1.5 0v-2.5a.75.75 0 0 0-.75-.75h-2.5a.75.75 0 0 1 0-1.5h2.5a2.25 2.25 0 0 1 2.25 2.25v2.5ZM16.25 3a.75.75 0 0 0-.75.75v2.5a2.25 2.25 0 0 0 2.25 2.25h2.5a.75.75 0 0 0 0-1.5h-2.5a.75.75 0 0 1-.75-.75v-2.5a.75.75 0 0 0-.75-.75ZM15.5 20.25a.75.75 0 0 0 1.5 0v-2.5a.75.75 0 0 1 .75-.75h2.5a.75.75 0 0 0 0-1.5h-2.5a2.25 2.25 0 0 0-2.25 2.25v2.5Z" fill="currentColor"/></svg>',copy:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5.503 4.627 5.5 6.75v10.504a3.25 3.25 0 0 0 3.25 3.25h8.616a2.251 2.251 0 0 1-2.122 1.5H8.75A4.75 4.75 0 0 1 4 17.254V6.75c0-.98.627-1.815 1.503-2.123ZM17.75 2A2.25 2.25 0 0 1 20 4.25v13a2.25 2.25 0 0 1-2.25 2.25h-9a2.25 2.25 0 0 1-2.25-2.25v-13A2.25 2.25 0 0 1 8.75 2h9Zm0 1.5h-9a.75.75 0 0 0-.75.75v13c0 .414.336.75.75.75h9a.75.75 0 0 0 .75-.75v-13a.75.75 0 0 0-.75-.75Z" fill="currentColor"/></svg>',attach:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M11.772 3.743a6 6 0 0 1 8.66 8.302l-.19.197-8.8 8.798-.036.03a3.723 3.723 0 0 1-5.489-4.973.764.764 0 0 1 .085-.13l.054-.06.086-.088.142-.148.002.003 7.436-7.454a.75.75 0 0 1 .977-.074l.084.073a.75.75 0 0 1 .074.976l-.073.084-7.594 7.613a2.23 2.23 0 0 0 3.174 3.106l8.832-8.83A4.502 4.502 0 0 0 13 4.644l-.168.16-.013.014-9.536 9.536a.75.75 0 0 1-1.133-.977l.072-.084 9.549-9.55h.002Z" fill="currentColor"/></svg>',image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17.75 3A3.25 3.25 0 0 1 21 6.25v11.5A3.25 3.25 0 0 1 17.75 21H6.25A3.25 3.25 0 0 1 3 17.75V6.25A3.25 3.25 0 0 1 6.25 3h11.5Zm.58 16.401-5.805-5.686a.75.75 0 0 0-.966-.071l-.084.07-5.807 5.687c.182.064.378.099.582.099h11.5c.203 0 .399-.035.58-.099l-5.805-5.686L18.33 19.4ZM17.75 4.5H6.25A1.75 1.75 0 0 0 4.5 6.25v11.5c0 .208.036.408.103.594l5.823-5.701a2.25 2.25 0 0 1 3.02-.116l.128.116 5.822 5.702c.067-.186.104-.386.104-.595V6.25a1.75 1.75 0 0 0-1.75-1.75Zm-2.498 2a2.252 2.252 0 1 1 0 4.504 2.252 2.252 0 0 1 0-4.504Zm0 1.5a.752.752 0 1 0 0 1.504.752.752 0 0 0 0-1.504Z" fill="currentColor"/></svg>',emoji_multiple:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.5 2a6.503 6.503 0 0 1 6.312 4.943c-.515.01-1.02.068-1.506.171a5 5 0 1 0-6.191 6.191 8.053 8.053 0 0 0-.172 1.507A6.5 6.5 0 0 1 8.5 2Zm.16 8.006c.355-.451.759-.864 1.202-1.23a3.5 3.5 0 0 0-4.022.95.75.75 0 1 0 1.14.974 2 2 0 0 1 1.68-.694ZM7.5 6.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm1 8a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm5.458 2.042a.75.75 0 0 1 .082 1.058 4 4 0 0 1-6.075.005.75.75 0 0 1 1.138-.977 2.499 2.499 0 0 0 3.797-.003.75.75 0 0 1 1.058-.083ZM17.5 14.5a1 1 0 1 0 0-2 1 1 0 0 0 0 2ZM15 22a7 7 0 1 0 0-14 7 7 0 0 0 0 14Zm0-1.5a5.5 5.5 0 1 1 0-11 5.5 5.5 0 0 1 0 11Z" fill="currentColor"/></svg>',image_off:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.28 2.22a.75.75 0 1 0-1.06 1.06l1.263 1.264A3.235 3.235 0 0 0 3 6.25v11.5A3.25 3.25 0 0 0 6.25 21h11.5c.626 0 1.21-.177 1.706-.483l1.263 1.264a.75.75 0 0 0 1.061-1.061L3.28 2.22Zm8.788 10.909 6.206 6.206.056.066a1.746 1.746 0 0 1-.58.099H6.25c-.204 0-.4-.035-.582-.099l5.807-5.686.593-.586Zm-.95-.95a2.245 2.245 0 0 0-.692.464l-5.823 5.7a1.747 1.747 0 0 1-.103-.593V6.25c0-.206.036-.404.101-.588l6.518 6.518ZM19.5 16.318V6.25a1.75 1.75 0 0 0-1.75-1.75H7.682L6.182 3H17.75A3.25 3.25 0 0 1 21 6.25v11.568l-1.5-1.5Z" fill="currentColor"/><path d="M15.252 6.5a2.252 2.252 0 1 1 0 4.504 2.252 2.252 0 0 1 0-4.504Zm0 1.5a.752.752 0 1 0 0 1.504.752.752 0 0 0 0-1.504Z" fill="currentColor"/></svg>',disconnected:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.28 2.22a.75.75 0 0 0-1.06 1.06l3.364 3.365a11.99 11.99 0 0 0-2.033 1.634c-.49.489-.964 1.069-1.394 1.689a.75.75 0 1 0 1.233.855c.381-.55.8-1.062 1.222-1.484a10.468 10.468 0 0 1 2.063-1.604l1.591 1.592a8.062 8.062 0 0 0-1.923 1.424c-.61.61-1.109 1.3-1.491 2.056a.75.75 0 1 0 1.338.677 6.51 6.51 0 0 1 1.214-1.673 6.546 6.546 0 0 1 1.984-1.362l1.93 1.93a5.07 5.07 0 0 0-2.876 1.44 5.11 5.11 0 0 0-1.061 1.57.75.75 0 0 0 1.374.602c.185-.422.437-.8.747-1.111a3.59 3.59 0 0 1 3.36-.958l7.858 7.858a.75.75 0 0 0 1.06-1.06L3.28 2.22Zm8.304 6.182 1.584 1.584a6.532 6.532 0 0 1 3.516 1.825 6.798 6.798 0 0 1 1.217 1.692.75.75 0 1 0 1.336-.683 8.292 8.292 0 0 0-1.492-2.07 8.042 8.042 0 0 0-6.16-2.348ZM8.487 5.305 9.713 6.53a10.44 10.44 0 0 1 10.908 4.297.75.75 0 1 0 1.235-.852 11.946 11.946 0 0 0-13.369-4.67Zm4.573 11.134a1.5 1.5 0 1 1-2.121 2.122 1.5 1.5 0 0 1 2.121-2.122Z" fill="currentColor"/></svg>',wand:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m13.314 7.565-.136.126-10.48 10.488a2.27 2.27 0 0 0 3.211 3.208L16.388 10.9a2.251 2.251 0 0 0-.001-3.182l-.157-.146a2.25 2.25 0 0 0-2.916-.007Zm-.848 2.961 1.088 1.088-8.706 8.713a.77.77 0 1 1-1.089-1.088l8.707-8.713Zm4.386 4.48L16.75 15a.75.75 0 0 0-.743.648L16 15.75v.75h-.75a.75.75 0 0 0-.743.648l-.007.102c0 .38.282.694.648.743l.102.007H16v.75c0 .38.282.694.648.743l.102.007a.75.75 0 0 0 .743-.648l.007-.102V18h.75a.75.75 0 0 0 .743-.648L19 17.25a.75.75 0 0 0-.648-.743l-.102-.007h-.75v-.75a.75.75 0 0 0-.648-.743L16.75 15l.102.007Zm-1.553-6.254.027.027a.751.751 0 0 1 0 1.061l-.711.713-1.089-1.089.73-.73a.75.75 0 0 1 1.043.018ZM6.852 5.007 6.75 5a.75.75 0 0 0-.743.648L6 5.75v.75h-.75a.75.75 0 0 0-.743.648L4.5 7.25c0 .38.282.693.648.743L5.25 8H6v.75c0 .38.282.693.648.743l.102.007a.75.75 0 0 0 .743-.648L7.5 8.75V8h.75a.75.75 0 0 0 .743-.648L9 7.25a.75.75 0 0 0-.648-.743L8.25 6.5H7.5v-.75a.75.75 0 0 0-.648-.743L6.75 5l.102.007Zm12-2L18.75 3a.75.75 0 0 0-.743.648L18 3.75v.75h-.75a.75.75 0 0 0-.743.648l-.007.102c0 .38.282.693.648.743L17.25 6H18v.75c0 .38.282.693.648.743l.102.007a.75.75 0 0 0 .743-.648l.007-.102V6h.75a.75.75 0 0 0 .743-.648L21 5.25a.75.75 0 0 0-.648-.743L20.25 4.5h-.75v-.75a.75.75 0 0 0-.648-.743L18.75 3l.102.007Z" fill="currentColor"/></svg>',recording:'<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"><path d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12Z"/><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2ZM3.5 12a8.5 8.5 0 1 1 17 0 8.5 8.5 0 0 1-17 0Z"/></svg>',subtract:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.755 12.5h16.492a.75.75 0 0 0 0-1.5H3.755a.75.75 0 0 0 0 1.5Z" fill="currentColor"/></svg>',stop_recording:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3.5C9.74566 3.5 7.58365 4.39553 5.98959 5.98959C4.39553 7.58365 3.5 9.74566 3.5 12C3.5 14.2543 4.39553 16.4163 5.98959 18.0104C7.58365 19.6045 9.74566 20.5 12 20.5C14.2543 20.5 16.4163 19.6045 18.0104 18.0104C19.6045 16.4163 20.5 14.2543 20.5 12C20.5 9.74566 19.6045 7.58365 18.0104 5.98959C16.4163 4.39553 14.2543 3.5 12 3.5ZM2 12C2 6.477 6.477 2 12 2C17.523 2 22 6.477 22 12C22 17.523 17.523 22 12 22C6.477 22 2 17.523 2 12ZM8 9.5C8 9.10218 8.15804 8.72064 8.43934 8.43934C8.72064 8.15804 9.10218 8 9.5 8H14.5C14.8978 8 15.2794 8.15804 15.5607 8.43934C15.842 8.72064 16 9.10218 16 9.5V14.5C16 14.8978 15.842 15.2794 15.5607 15.5607C15.2794 15.842 14.8978 16 14.5 16H9.5C9.10218 16 8.72064 15.842 8.43934 15.5607C8.15804 15.2794 8 14.8978 8 14.5V9.5Z" fill="currentColor"/></svg>',warning:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.91 2.782a2.25 2.25 0 0 1 2.975.74l.083.138 7.759 14.009a2.25 2.25 0 0 1-1.814 3.334l-.154.006H4.243a2.25 2.25 0 0 1-2.041-3.197l.072-.143L10.031 3.66a2.25 2.25 0 0 1 .878-.878Zm9.505 15.613-7.76-14.008a.75.75 0 0 0-1.254-.088l-.057.088-7.757 14.008a.75.75 0 0 0 .561 1.108l.095.006h15.516a.75.75 0 0 0 .696-1.028l-.04-.086-7.76-14.008 7.76 14.008ZM12 16.002a.999.999 0 1 1 0 1.997.999.999 0 0 1 0-1.997ZM11.995 8.5a.75.75 0 0 1 .744.647l.007.102.004 4.502a.75.75 0 0 1-1.494.103l-.006-.102-.004-4.502a.75.75 0 0 1 .75-.75Z" fill="currentColor"/></svg>',pin:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m16.242 2.932 4.826 4.826a2.75 2.75 0 0 1-.715 4.404l-4.87 2.435a.75.75 0 0 0-.374.426l-1.44 4.166a1.25 1.25 0 0 1-2.065.476L8.5 16.561 4.06 21H3v-1.06l4.44-4.44-3.105-3.104a1.25 1.25 0 0 1 .476-2.066l4.166-1.44a.75.75 0 0 0 .426-.373l2.435-4.87a2.75 2.75 0 0 1 4.405-.715Zm3.766 5.886-4.826-4.826a1.25 1.25 0 0 0-2.002.325l-2.435 4.871a2.25 2.25 0 0 1-1.278 1.12l-3.789 1.31 6.705 6.704 1.308-3.789a2.25 2.25 0 0 1 1.12-1.277l4.872-2.436a1.25 1.25 0 0 0 .325-2.002Z" fill="currentColor"/></svg>',pin_off:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.28 2.22a.75.75 0 0 0-1.06 1.06l5.905 5.905L4.81 10.33a1.25 1.25 0 0 0-.476 2.065L7.439 15.5 3 19.94V21h1.06l4.44-4.44 3.105 3.105a1.25 1.25 0 0 0 2.065-.476l1.145-3.313 5.905 5.904a.75.75 0 0 0 1.06-1.06L3.28 2.22Zm10.355 12.476-1.252 3.626-6.705-6.705 3.626-1.252 4.331 4.331Zm6.048-3.876-3.787 1.894 1.118 1.118 3.34-1.67a2.75 2.75 0 0 0 .714-4.404l-4.825-4.826a2.75 2.75 0 0 0-4.405.715l-1.67 3.34 1.118 1.117 1.894-3.787a1.25 1.25 0 0 1 2.002-.325l4.826 4.826a1.25 1.25 0 0 1-.325 2.002Z" fill="currentColor"/></svg>',spinner:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><circle cx="12" cy="12" r="10" stroke-width="2" stroke="currentColor" stroke-opacity="0.2" vector-effect="non-scaling-stroke"/><path d="M22 12C22 10.6868 21.7413 9.38642 21.2388 8.17317C20.7362 6.95991 19.9997 5.85752 19.0711 4.92893C18.1425 4.00035 17.0401 3.26375 15.8268 2.7612C14.6136 2.25866 13.3132 2 12 2" stroke="currentColor" stroke-width="2" stroke-linecap="round" vector-effect="non-scaling-stroke"/></svg>',breakout_rooms:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10.5 3a2.25 2.25 0 0 1 2.25 2.25v6h6A2.25 2.25 0 0 1 21 13.5v5.25A2.25 2.25 0 0 1 18.75 21H5.25A2.25 2.25 0 0 1 3 18.75V5.25A2.25 2.25 0 0 1 5.25 3h5.25Zm.75 9.75H4.5v6c0 .414.336.75.75.75h5.999l.001-6.75Zm7.5 0h-6.001v6.75h6.001a.75.75 0 0 0 .75-.75V13.5a.75.75 0 0 0-.75-.75ZM10.5 4.5H5.25a.75.75 0 0 0-.75.75v6h6.75v-6a.75.75 0 0 0-.75-.75Zm7.398-2.493L18 2a.75.75 0 0 1 .743.648l.007.102v2.5h2.5a.75.75 0 0 1 .743.648L22 6a.75.75 0 0 1-.648.743l-.102.007h-2.5v2.5a.75.75 0 0 1-.648.743L18 10a.75.75 0 0 1-.743-.648l-.007-.102v-2.5h-2.5a.75.75 0 0 1-.743-.648L14 6a.75.75 0 0 1 .648-.743l.102-.007h2.5v-2.5a.75.75 0 0 1 .648-.743Z" fill="currentColor"/></svg>',add:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M11.75 3a.75.75 0 0 1 .743.648l.007.102.001 7.25h7.253a.75.75 0 0 1 .102 1.493l-.102.007h-7.253l.002 7.25a.75.75 0 0 1-1.493.101l-.007-.102-.002-7.249H3.752a.75.75 0 0 1-.102-1.493L3.752 11h7.25L11 3.75a.75.75 0 0 1 .75-.75Z" fill="currentColor"/></svg>',shuffle:'<svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M14.0058 8.11111H18.7947L16.9613 9.94444C16.9095 9.99587 16.8684 10.057 16.8402 10.1243C16.812 10.1917 16.7974 10.2639 16.7971 10.3369C16.7966 10.4843 16.8547 10.6259 16.9586 10.7306C17.01 10.7823 17.0711 10.8235 17.1385 10.8517C17.2058 10.8799 17.278 10.8945 17.351 10.8947C17.4985 10.8953 17.64 10.8372 17.7447 10.7333L20.8891 7.59999L20.4947 7.20555L17.7447 4.46111C17.64 4.35723 17.4985 4.29917 17.351 4.29969C17.2036 4.30021 17.0624 4.35927 16.9586 4.46388C16.8547 4.5685 16.7966 4.71009 16.7971 4.85751C16.7977 5.00494 16.8567 5.14612 16.9613 5.24999L18.728 6.99999H13.6669C13.5699 7.00058 13.4748 7.02653 13.391 7.07526C13.3072 7.12399 13.2376 7.19381 13.1891 7.27777L11.7224 9.82777L12.3669 10.9389L14.0058 8.11111Z" fill="currentColor"/><path d="M8.15022 15.9278H3.66688C3.51954 15.9278 3.37823 15.9863 3.27405 16.0905C3.16986 16.1947 3.11133 16.336 3.11133 16.4833C3.11133 16.6307 3.16986 16.772 3.27405 16.8762C3.37823 16.9804 3.51954 17.0389 3.66688 17.0389H8.47244C8.56939 17.0383 8.6645 17.0124 8.74832 16.9636C8.83214 16.9149 8.90174 16.8451 8.95022 16.7611L10.4335 14.2222L9.77799 13.1111L8.15022 15.9278Z"/><path d="M17.7447 13.2056C17.64 13.1017 17.4985 13.0436 17.351 13.0441C17.2036 13.0447 17.0624 13.1037 16.9586 13.2083C16.8547 13.3129 16.7966 13.4545 16.7971 13.602C16.7977 13.7494 16.8567 13.8906 16.9613 13.9944L18.9058 15.9389H14.0058L8.95022 7.29444C8.90174 7.21047 8.83214 7.14066 8.74832 7.09193C8.6645 7.04319 8.56939 7.01725 8.47244 7.01666H3.66688C3.51954 7.01666 3.37823 7.07519 3.27405 7.17938C3.16986 7.28357 3.11133 7.42487 3.11133 7.57222C3.11133 7.71956 3.16986 7.86087 3.27405 7.96505C3.37823 8.06924 3.51954 8.12777 3.66688 8.12777H8.15022L13.2058 16.7667C13.2542 16.8506 13.3239 16.9204 13.4077 16.9692C13.4915 17.0179 13.5866 17.0439 13.6836 17.0444H18.6113L16.9447 18.7111C16.8929 18.7625 16.8517 18.8237 16.8235 18.891C16.7954 18.9584 16.7807 19.0306 16.7805 19.1036C16.7802 19.1766 16.7943 19.2489 16.822 19.3165C16.8497 19.384 16.8905 19.4454 16.9419 19.4972C16.9933 19.549 17.0545 19.5902 17.1218 19.6184C17.1891 19.6465 17.2614 19.6612 17.3344 19.6614C17.4074 19.6617 17.4797 19.6476 17.5472 19.6199C17.6148 19.5922 17.6762 19.5514 17.728 19.5L20.478 16.7556L20.8724 16.3611L17.7447 13.2056Z"/></svg>',edit:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.03 2.97a3.578 3.578 0 0 1 0 5.06L9.062 20a2.25 2.25 0 0 1-.999.58l-5.116 1.395a.75.75 0 0 1-.92-.921l1.395-5.116a2.25 2.25 0 0 1 .58-.999L15.97 2.97a3.578 3.578 0 0 1 5.06 0ZM15 6.06 5.062 16a.75.75 0 0 0-.193.333l-1.05 3.85 3.85-1.05A.75.75 0 0 0 8 18.938L17.94 9 15 6.06Zm2.03-2.03-.97.97L19 7.94l.97-.97a2.079 2.079 0 0 0-2.94-2.94Z" fill="currentColor"/></svg>',delete:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 1.75a3.25 3.25 0 0 1 3.245 3.066L15.25 5h5.25a.75.75 0 0 1 .102 1.493L20.5 6.5h-.796l-1.28 13.02a2.75 2.75 0 0 1-2.561 2.474l-.176.006H8.313a2.75 2.75 0 0 1-2.714-2.307l-.023-.174L4.295 6.5H3.5a.75.75 0 0 1-.743-.648L2.75 5.75a.75.75 0 0 1 .648-.743L3.5 5h5.25A3.25 3.25 0 0 1 12 1.75Zm6.197 4.75H5.802l1.267 12.872a1.25 1.25 0 0 0 1.117 1.122l.127.006h7.374c.6 0 1.109-.425 1.225-1.002l.02-.126L18.196 6.5ZM13.75 9.25a.75.75 0 0 1 .743.648L14.5 10v7a.75.75 0 0 1-1.493.102L13 17v-7a.75.75 0 0 1 .75-.75Zm-3.5 0a.75.75 0 0 1 .743.648L11 10v7a.75.75 0 0 1-1.493.102L9.5 17v-7a.75.75 0 0 1 .75-.75Zm1.75-6a1.75 1.75 0 0 0-1.744 1.606L10.25 5h3.5A1.75 1.75 0 0 0 12 3.25Z" fill="currentColor"/></svg>',back:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4.75 2a.75.75 0 0 1 .743.648l.007.102v5.69l4.574-4.56a6.41 6.41 0 0 1 8.879-.179l.186.18a6.41 6.41 0 0 1 0 9.063l-8.846 8.84a.75.75 0 0 1-1.06-1.062l8.845-8.838a4.91 4.91 0 0 0-6.766-7.112l-.178.17L6.562 9.5h5.688a.75.75 0 0 1 .743.648l.007.102a.75.75 0 0 1-.648.743L12.25 11h-7.5a.75.75 0 0 1-.743-.648L4 10.25v-7.5A.75.75 0 0 1 4.75 2Z" fill="currentColor"/></svg>',save:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 5.75A2.75 2.75 0 0 1 5.75 3h9.964a3.25 3.25 0 0 1 2.299.952l2.035 2.035c.61.61.952 1.437.952 2.299v9.964A2.75 2.75 0 0 1 18.25 21H5.75A2.75 2.75 0 0 1 3 18.25V5.75ZM5.75 4.5c-.69 0-1.25.56-1.25 1.25v12.5c0 .69.56 1.25 1.25 1.25H6v-5.25A2.25 2.25 0 0 1 8.25 12h7.5A2.25 2.25 0 0 1 18 14.25v5.25h.25c.69 0 1.25-.56 1.25-1.25V8.286c0-.465-.184-.91-.513-1.238l-2.035-2.035a1.75 1.75 0 0 0-.952-.49V7.25a2.25 2.25 0 0 1-2.25 2.25h-4.5A2.25 2.25 0 0 1 7 7.25V4.5H5.75Zm10.75 15v-5.25a.75.75 0 0 0-.75-.75h-7.5a.75.75 0 0 0-.75.75v5.25h9Zm-8-15v2.75c0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75V4.5h-6Z" fill="currentColor"/></svg>',web:'<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 1.999c5.524 0 10.002 4.478 10.002 10.002 0 5.523-4.478 10.001-10.002 10.001-5.524 0-10.002-4.478-10.002-10.001C1.998 6.477 6.476 1.999 12 1.999ZM14.939 16.5H9.06c.652 2.414 1.786 4.002 2.939 4.002s2.287-1.588 2.939-4.002Zm-7.43 0H4.785a8.532 8.532 0 0 0 4.094 3.411c-.522-.82-.953-1.846-1.27-3.015l-.102-.395Zm11.705 0h-2.722c-.324 1.335-.792 2.5-1.373 3.411a8.528 8.528 0 0 0 3.91-3.127l.185-.283ZM7.094 10H3.735l-.005.017a8.525 8.525 0 0 0-.233 1.984c0 1.056.193 2.067.545 3h3.173a20.847 20.847 0 0 1-.123-5Zm8.303 0H8.603a18.966 18.966 0 0 0 .135 5h6.524a18.974 18.974 0 0 0 .135-5Zm4.868 0h-3.358c.062.647.095 1.317.095 2a20.3 20.3 0 0 1-.218 3h3.173a8.482 8.482 0 0 0 .544-3c0-.689-.082-1.36-.236-2ZM8.88 4.09l-.023.008A8.531 8.531 0 0 0 4.25 8.5h3.048c.314-1.752.86-3.278 1.583-4.41ZM12 3.499l-.116.005C10.62 3.62 9.396 5.622 8.83 8.5h6.342c-.566-2.87-1.783-4.869-3.045-4.995L12 3.5Zm3.12.59.107.175c.669 1.112 1.177 2.572 1.475 4.237h3.048a8.533 8.533 0 0 0-4.339-4.29l-.291-.121Z" fill="currentColor"/></svg>',checkmark:'<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"><path fill="none" d="M0 0h24v24H0V0z"/><path d="m18 6.7-8.48 8.48-3.54-3.54a.996.996 0 1 0-1.41 1.41l4.24 4.24c.39.39 1.02.39 1.41 0l9.18-9.18a.999.999 0 0 0-.01-1.42c-.37-.38-1-.38-1.39.01z"/></svg>',spotlight:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M19.745 4C20.3417 4 20.914 4.23705 21.336 4.65901C21.7579 5.08097 21.995 5.65326 21.995 6.25V12.805C21.5485 12.3774 21.0434 12.0154 20.495 11.73V6.25C20.495 6.05109 20.416 5.86032 20.2753 5.71967C20.1347 5.57902 19.9439 5.5 19.745 5.5H4.25C4.05109 5.5 3.86032 5.57902 3.71967 5.71967C3.57902 5.86032 3.5 6.05109 3.5 6.25V17.755C3.5 18.169 3.836 18.505 4.25 18.505L6.999 18.504L7 15.75C7.00002 15.3108 7.16517 14.8877 7.46268 14.5646C7.76019 14.2415 8.1683 14.0421 8.606 14.006L8.75 14H12.022C11.7223 14.4675 11.484 14.9716 11.313 15.5H8.75C8.69368 15.5001 8.63904 15.5192 8.59493 15.5542C8.55083 15.5893 8.51984 15.6382 8.507 15.693L8.5 15.75L8.499 18.504H11.077C11.1569 19.0193 11.2989 19.5229 11.5 20.004H4.25C3.65344 20.004 3.08129 19.7671 2.65936 19.3453C2.23744 18.9236 2.00027 18.3516 2 17.755V6.25C2 5.65326 2.23705 5.08097 2.65901 4.65901C3.08097 4.23705 3.65326 4 4.25 4H19.745Z"/><path d="M12 7C12.7956 7 13.5587 7.31607 14.1213 7.87868C14.6839 8.44129 15 9.20435 15 10C15 10.7956 14.6839 11.5587 14.1213 12.1213C13.5587 12.6839 12.7956 13 12 13C11.2044 13 10.4413 12.6839 9.87868 12.1213C9.31607 11.5587 9 10.7956 9 10C9 9.20435 9.31607 8.44129 9.87868 7.87868C10.4413 7.31607 11.2044 7 12 7ZM12 8.5C11.6022 8.5 11.2206 8.65804 10.9393 8.93934C10.658 9.22064 10.5 9.60218 10.5 10C10.5 10.3978 10.658 10.7794 10.9393 11.0607C11.2206 11.342 11.6022 11.5 12 11.5C12.3978 11.5 12.7794 11.342 13.0607 11.0607C13.342 10.7794 13.5 10.3978 13.5 10C13.5 9.60218 13.342 9.22064 13.0607 8.93934C12.7794 8.65804 12.3978 8.5 12 8.5Z"/><path d="M23 17.5C23 18.9587 22.4205 20.3576 21.3891 21.3891C20.3576 22.4205 18.9587 23 17.5 23C16.0413 23 14.6424 22.4205 13.6109 21.3891C12.5795 20.3576 12 18.9587 12 17.5C12 16.0413 12.5795 14.6424 13.6109 13.6109C14.6424 12.5795 16.0413 12 17.5 12C18.9587 12 20.3576 12.5795 21.3891 13.6109C22.4205 14.6424 23 16.0413 23 17.5ZM18.055 14.42C18.0207 14.2993 17.9479 14.193 17.8478 14.1174C17.7476 14.0417 17.6255 14.0008 17.5 14.0008C17.3745 14.0008 17.2524 14.0417 17.1522 14.1174C17.0521 14.193 16.9793 14.2993 16.945 14.42L16.388 16.208H14.585C14.019 16.208 13.785 16.962 14.242 17.308L15.7 18.413L15.143 20.2C14.968 20.761 15.584 21.228 16.042 20.881L17.5 19.777L18.958 20.881C19.416 21.228 20.032 20.761 19.857 20.201L19.3 18.413L20.758 17.309C21.216 16.962 20.981 16.208 20.415 16.208H18.612L18.055 14.421V14.42Z"/></svg>',join_stage:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M17.5 22C14.4618 22 12 19.5376 12 16.5C12 13.4623 14.4618 11 17.5 11C20.5371 11 23 13.4624 23 16.5C23 19.5376 20.5371 22 17.5 22ZM17.0704 18.992L17.1167 19.0322C17.1868 19.0841 17.2716 19.1125 17.3588 19.1132C17.4461 19.1139 17.5314 19.0869 17.6023 19.036L17.654 18.992L17.6936 18.9458C17.7455 18.8757 17.7739 18.7909 17.7746 18.7037C17.7753 18.6164 17.7483 18.5311 17.6975 18.4602L17.6535 18.4085L16.158 16.9125H19.8375L19.8936 16.9092C19.9829 16.8969 20.0657 16.8558 20.1293 16.792C20.193 16.7282 20.234 16.6454 20.2462 16.5561L20.25 16.5005L20.2462 16.4444C20.2339 16.3553 20.1928 16.2725 20.1292 16.2089C20.0655 16.1452 19.9828 16.1041 19.8936 16.0919L19.8375 16.088H16.158L17.654 14.592L17.6941 14.5453C17.7537 14.4659 17.7827 14.3676 17.7756 14.2686C17.7686 14.1695 17.726 14.0763 17.6558 14.0061C17.5856 13.9359 17.4924 13.8934 17.3934 13.8863C17.2943 13.8793 17.1961 13.9082 17.1167 13.9678L17.071 14.0079L14.8699 16.2079L14.8303 16.2547C14.7784 16.3247 14.75 16.4094 14.7493 16.4965C14.7485 16.5837 14.7753 16.6688 14.8259 16.7398L14.8699 16.7915L17.0704 18.992Z"/><path d="M2.80546 3.80546C2.28973 4.32118 2 5.02065 2 5.75V16.25C2 16.6111 2.07113 16.9687 2.20933 17.3024C2.34753 17.636 2.5501 17.9392 2.80546 18.1945C3.06082 18.4499 3.36398 18.6525 3.69762 18.7907C4.03127 18.9289 4.38886 19 4.75 19H11.498C11.3 18.526 11.157 18.023 11.076 17.5H9.002V14.75C9.002 14.6837 9.02834 14.6201 9.07522 14.5732C9.12211 14.5263 9.1857 14.5 9.252 14.5H11.3135C11.4858 13.9665 11.7253 13.4632 12.0218 13H9.252C8.285 13 7.502 13.784 7.502 14.75V16H7.5V17.5H4.75C4.06 17.5 3.5 16.94 3.5 16.25V5.75C3.5 5.06 4.06 4.5 4.75 4.5H19.25C19.94 4.5 20.5 5.06 20.5 5.75V10.732C20.6457 10.808 20.7884 10.8895 20.9277 10.9762C20.9687 11.0017 21.0093 11.0276 21.0497 11.054C21.3899 11.2762 21.708 11.5294 22 11.8096V5.75C22 5.02065 21.7103 4.32118 21.1945 3.80546C20.6788 3.28973 19.9793 3 19.25 3H4.75C4.02065 3 3.32118 3.28973 2.80546 3.80546Z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14.4181 10.7757C14.7938 10.264 15 9.64262 15 9C15 8.20435 14.6839 7.44129 14.1213 6.87868C13.5587 6.31607 12.7956 6 12 6C11.2044 6 10.4413 6.31607 9.87868 6.87868C9.31607 7.44129 9 8.20435 9 9C9 9.79565 9.31607 10.5587 9.87868 11.1213C10.4413 11.6839 11.2044 12 12 12C12.333 12 12.6602 11.9446 12.9695 11.839C13.3992 11.4213 13.8864 11.0625 14.4181 10.7757ZM10.9393 7.93934C11.2206 7.65804 11.6022 7.5 12 7.5C12.3978 7.5 12.7794 7.65804 13.0607 7.93934C13.342 8.22064 13.5 8.60218 13.5 9C13.5 9.39782 13.342 9.77936 13.0607 10.0607C12.7794 10.342 12.3978 10.5 12 10.5C11.6022 10.5 11.2206 10.342 10.9393 10.0607C10.658 9.77936 10.5 9.39782 10.5 9C10.5 8.60218 10.658 8.22064 10.9393 7.93934Z"></svg>',leave_stage:'<svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M2.80546 3.80546C2.28973 4.32118 2 5.02065 2 5.75V16.25C2 16.6111 2.07113 16.9687 2.20933 17.3024C2.34753 17.636 2.5501 17.9392 2.80546 18.1945C3.06082 18.4499 3.36398 18.6525 3.69762 18.7907C4.03127 18.9289 4.38886 19 4.75 19H11.498C11.3 18.526 11.157 18.023 11.076 17.5H9.002V14.75C9.002 14.6837 9.02834 14.6201 9.07522 14.5732C9.12211 14.5263 9.1857 14.5 9.252 14.5H11.3135C11.4858 13.9665 11.7253 13.4632 12.0218 13H9.252C8.285 13 7.502 13.784 7.502 14.75V16H7.5V17.5H4.75C4.06 17.5 3.5 16.94 3.5 16.25V5.75C3.5 5.06 4.06 4.5 4.75 4.5H19.25C19.94 4.5 20.5 5.06 20.5 5.75V10.732C20.6457 10.808 20.7884 10.8895 20.9277 10.9762C20.9687 11.0017 21.0093 11.0276 21.0497 11.054C21.3899 11.2762 21.708 11.5294 22 11.8096V5.75C22 5.02065 21.7103 4.32118 21.1945 3.80546C20.6788 3.28973 19.9793 3 19.25 3H4.75C4.02065 3 3.32118 3.28973 2.80546 3.80546Z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M14.4181 10.7757C14.7938 10.264 15 9.64262 15 9C15 8.20435 14.6839 7.44129 14.1213 6.87868C13.5587 6.31607 12.7956 6 12 6C11.2044 6 10.4413 6.31607 9.87868 6.87868C9.31607 7.44129 9 8.20435 9 9C9 9.79565 9.31607 10.5587 9.87868 11.1213C10.4413 11.6839 11.2044 12 12 12C12.333 12 12.6602 11.9446 12.9695 11.839C13.3992 11.4213 13.8864 11.0625 14.4181 10.7757ZM10.9393 7.93934C11.2206 7.65804 11.6022 7.5 12 7.5C12.3978 7.5 12.7794 7.65804 13.0607 7.93934C13.342 8.22064 13.5 8.60218 13.5 9C13.5 9.39782 13.342 9.77936 13.0607 10.0607C12.7794 10.342 12.3978 10.5 12 10.5C11.6022 10.5 11.2206 10.342 10.9393 10.0607C10.658 9.77936 10.5 9.39782 10.5 9C10.5 8.60218 10.658 8.22064 10.9393 7.93934Z"/><path d="M17.5 11C20.5382 11 23 13.4624 23 16.5C23 19.5377 20.5382 22 17.5 22C14.4629 22 12 19.5377 12 16.5C12 13.4624 14.4629 11 17.5 11V11ZM17.9296 14.0079L17.8833 13.9678C17.8132 13.9159 17.7284 13.8875 17.6412 13.8868C17.5539 13.8861 17.4686 13.9131 17.3977 13.964L17.346 14.0079L17.3064 14.0542C17.2545 14.1243 17.2261 14.2091 17.2254 14.2963C17.2247 14.3836 17.2517 14.4689 17.3026 14.5398L17.3465 14.5915L18.842 16.0875H15.1625L15.1064 16.0908C15.0171 16.1031 14.9343 16.1442 14.8707 16.208C14.807 16.2718 14.766 16.3546 14.7539 16.4439L14.75 16.4995L14.7539 16.5556C14.7661 16.6447 14.8072 16.7275 14.8708 16.7911C14.9345 16.8548 15.0172 16.8959 15.1064 16.9081L15.1625 16.912H18.842L17.346 18.408L17.3059 18.4547C17.2463 18.5341 17.2173 18.6324 17.2244 18.7314C17.2314 18.8305 17.274 18.9237 17.3442 18.9939C17.4144 19.0641 17.5076 19.1066 17.6066 19.1137C17.7057 19.1207 17.8039 19.0918 17.8833 19.0322L17.929 18.9921L20.1301 16.7921L20.1697 16.7453C20.2216 16.6753 20.25 16.5906 20.2507 16.5035C20.2515 16.4163 20.2247 16.3312 20.1741 16.2602L20.1301 16.2085L17.9301 14.0079L17.8833 13.9678L17.9296 14.0079V14.0079Z"/></svg>',pip_off:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path fill-rule="evenodd" clip-rule="evenodd" d="M10.8666 12.3058C11.0731 12.3058 11.2404 12.1385 11.2404 11.932V8.56753C11.2404 8.36107 11.0731 8.1937 10.8666 8.1937C10.6601 8.1937 10.4928 8.36107 10.4928 8.56753V11.0295L6.45393 6.99066C6.30794 6.84467 6.07124 6.84467 5.92525 6.99066C5.77926 7.13665 5.77926 7.37335 5.92525 7.51934L9.9641 11.5582L7.50212 11.5582C7.29566 11.5582 7.12829 11.7256 7.12829 11.932C7.12829 12.1385 7.29566 12.3058 7.50212 12.3058L10.8666 12.3058ZM5.73832 19.8879C3.6737 19.8879 2 18.2141 2 16.1495V7.73832C2 5.6737 3.6737 4 5.73832 4H18.2617C20.3263 4 22 5.6737 22 7.73832L22 13.0269C22 12.2687 21.6002 11.6038 21 11.2316C20.8468 11.1366 20.6806 11.0607 20.5047 11.0071V7.73832C20.5047 6.49955 19.5005 5.49533 18.2617 5.49533H5.73832C4.49955 5.49533 3.49533 6.49955 3.49533 7.73832V16.1495C3.49533 17.3883 4.49955 18.3925 5.73832 18.3925H10.7971C10.8506 18.5685 10.9266 18.7347 11.0216 18.8879C11.3938 19.4881 12.0587 19.8879 12.8169 19.8879H5.73832Z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M19.7265 12.5H13.3911C12.899 12.5 12.5 12.899 12.5 13.3911V17.6462C12.5 18.1384 12.899 18.5374 13.3911 18.5374H19.7265C20.2187 18.5374 20.6176 18.1384 20.6176 17.6462V13.3911C20.6176 12.899 20.2187 12.5 19.7265 12.5ZM13.3911 11.5C12.3467 11.5 11.5 12.3467 11.5 13.3911V17.6462C11.5 18.6907 12.3467 19.5374 13.3911 19.5374H19.7265C20.771 19.5374 21.6176 18.6907 21.6176 17.6462V13.3911C21.6176 12.3467 20.771 11.5 19.7265 11.5H13.3911Z"/></svg>',pip_on:'<svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M5.73832 19.8879C3.6737 19.8879 2 18.2141 2 16.1495V7.73832C2 5.6737 3.6737 4 5.73832 4H18.2617C20.3263 4 22 5.6737 22 7.73832L22 13.0269C22 12.2687 21.6002 11.6038 21 11.2316C20.8468 11.1366 20.6806 11.0607 20.5047 11.0071V7.73832C20.5047 6.49955 19.5005 5.49533 18.2617 5.49533H5.73832C4.49955 5.49533 3.49533 6.49955 3.49533 7.73832V16.1495C3.49533 17.3883 4.49955 18.3925 5.73832 18.3925H10.7971C10.8506 18.5685 10.9266 18.7347 11.0216 18.8879C11.3938 19.4881 12.0587 19.8879 12.8169 19.8879H5.73832Z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M19.7265 12.5H13.3911C12.899 12.5 12.5 12.899 12.5 13.3911V17.6462C12.5 18.1384 12.899 18.5374 13.3911 18.5374H19.7265C20.2187 18.5374 20.6176 18.1384 20.6176 17.6462V13.3911C20.6176 12.899 20.2187 12.5 19.7265 12.5ZM13.3911 11.5C12.3467 11.5 11.5 12.3467 11.5 13.3911V17.6462C11.5 18.6907 12.3467 19.5374 13.3911 19.5374H19.7265C20.771 19.5374 21.6176 18.6907 21.6176 17.6462V13.3911C21.6176 12.3467 20.771 11.5 19.7265 11.5H13.3911Z"/><path d="M6.18951 6.88123C5.98304 6.88123 5.81567 7.0486 5.81567 7.25506V10.6195C5.81567 10.826 5.98304 10.9934 6.18951 10.9934C6.39597 10.9934 6.56334 10.826 6.56334 10.6195V8.15757L10.6022 12.1964C10.7482 12.3424 10.9849 12.3424 11.1309 12.1964C11.2769 12.0504 11.2769 11.8137 11.1309 11.6677L7.09202 7.62889L9.55399 7.62889C9.76045 7.62889 9.92782 7.46152 9.92782 7.25506C9.92782 7.0486 9.76045 6.88123 9.55399 6.88123L6.18951 6.88123Z"/></svg>',signal_1:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 16h2v5H3z"></path></svg>',signal_2:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 16h2v5H3zm4-3h2v8H7z"></path></svg>',signal_3:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 16h2v5H3zm4-3h2v8H7zm4-3h2v11h-2z"></path></svg>',signal_4:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 16h2v5H3zm4-3h2v8H7zm4-3h2v11h-2zm4-3h2v14h-2z"></path></svg>',signal_5:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M3 16h2v5H3zm4-3h2v8H7zm4-3h2v11h-2zm4-3h2v14h-2zm4-3h2v17h-2z"></path></svg>',start_livestream:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M6.343 4.938a1 1 0 0 1 0 1.415a8.003 8.003 0 0 0 0 11.317a1 1 0 1 1-1.415 1.414c-3.906-3.906-3.906-10.24 0-14.146a1 1 0 0 1 1.415 0Zm12.731 0c3.906 3.907 3.906 10.24 0 14.146a1 1 0 0 1-1.414-1.414a8.003 8.003 0 0 0 0-11.317a1 1 0 0 1 1.414-1.415ZM9.31 7.812a1 1 0 0 1 0 1.414a3.92 3.92 0 0 0 0 5.544a1 1 0 1 1-1.414 1.414a5.92 5.92 0 0 1 0-8.372a1 1 0 0 1 1.414 0Zm6.959 0a5.92 5.92 0 0 1 0 8.372a1 1 0 0 1-1.415-1.414a3.92 3.92 0 0 0 0-5.544a1 1 0 0 1 1.415-1.414Zm-4.187 2.77a1.5 1.5 0 1 1 0 3a1.5 1.5 0 0 1 0-3Z"/></svg>',stop_livestream:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M2.854 2.146a.5.5 0 1 0-.708.708l1.811 1.81A8.218 8.218 0 0 0 2 10a8.228 8.228 0 0 0 2.604 6.015a.725.725 0 0 0 1.01-.025c.316-.316.277-.819-.027-1.11A6.73 6.73 0 0 1 3.5 10c0-1.62.57-3.107 1.522-4.27l.712.71A5.726 5.726 0 0 0 4.5 10c0 1.691.73 3.213 1.893 4.264a.713.713 0 0 0 .983-.037c.328-.328.267-.844-.041-1.134A4.238 4.238 0 0 1 6 10c0-.93.298-1.789.804-2.489l1.842 1.842a1.5 1.5 0 0 0 2 2l6.5 6.5a.5.5 0 0 0 .708-.707l-1.811-1.81l-1.065-1.066l-.712-.71l-1.07-1.072l-1.842-1.841l-2-2L7.4 6.693l-.942-.942l-.82-.82l-.944-.944l-1.841-1.842Zm13.794 12.38A8.212 8.212 0 0 0 18 10c0-2.283-.928-4.35-2.426-5.843a.726.726 0 0 0-1.027.01c-.31.31-.28.8.01 1.095A6.727 6.727 0 0 1 16.5 10a6.718 6.718 0 0 1-.94 3.438l1.088 1.089Zm-1.822-1.822A5.73 5.73 0 0 0 15.5 10a5.733 5.733 0 0 0-1.706-4.087a.714.714 0 0 0-1.008.016c-.319.318-.272.816.014 1.111A4.235 4.235 0 0 1 14 10c0 .557-.107 1.09-.302 1.577l1.128 1.127Z"/></svg>',viewers:'<svg fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 9.005a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm0 1.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5ZM12 5.5c4.613 0 8.596 3.15 9.701 7.564a.75.75 0 1 1-1.455.365 8.503 8.503 0 0 0-16.493.004.75.75 0 0 1-1.455-.363A10.003 10.003 0 0 1 12 5.5Z" fill="currentColor"/></svg>',debug:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m10.05 15.42 6.256-8.476a.694.694 0 0 1 1.235.57l-.03.098-3.87 9.8a2.07 2.07 0 1 1-3.737-1.766l.069-.115.076-.11 6.257-8.477-6.257 8.476Zm2.05-4.549-1.226 1.66a3.32 3.32 0 0 0-2.29 3.024.75.75 0 0 1-1.5-.063A4.819 4.819 0 0 1 9.14 11.74c.9-.631 1.942-.911 2.961-.87Zm4.167 2.752c.28.586.436 1.22.463 1.866a.75.75 0 0 1-1.376.444l.913-2.31Zm-2.233-5.37-.969 1.311a6.22 6.22 0 0 0-4.736 1.02 6.208 6.208 0 0 0-2.419 3.39.75.75 0 0 1-1.442-.412 7.708 7.708 0 0 1 3-4.207 7.724 7.724 0 0 1 6.566-1.102Zm3.51 2.138c.25.267.486.556.702.865a7.727 7.727 0 0 1 1.097 2.288.75.75 0 0 1-1.44.417 6.23 6.23 0 0 0-.885-1.845l-.102-.138.627-1.587ZM15.98 5.852l-.088.054c-.123.082-.236.18-.337.295l-.096.12-.54.732a9.138 9.138 0 0 0-8.261 1.146A9.103 9.103 0 0 0 3.38 12.37a.75.75 0 1 1-1.398-.543A10.603 10.603 0 0 1 5.799 6.97 10.642 10.642 0 0 1 15.98 5.852Zm2.629 1.562a10.646 10.646 0 0 1 2.022 2.171c.49.702.892 1.451 1.199 2.235a.75.75 0 1 1-1.397.547 9.188 9.188 0 0 0-2.327-3.405l.381-.964c.076-.19.115-.388.122-.584Z" fill="currentColor"/></svg>',info:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 1.999c5.524 0 10.002 4.478 10.002 10.002 0 5.523-4.478 10.001-10.002 10.001-5.524 0-10.002-4.478-10.002-10.001C1.998 6.477 6.476 1.999 12 1.999Zm0 1.5a8.502 8.502 0 1 0 0 17.003A8.502 8.502 0 0 0 12 3.5Zm-.004 7a.75.75 0 0 1 .744.648l.007.102.003 5.502a.75.75 0 0 1-1.493.102l-.007-.101-.003-5.502a.75.75 0 0 1 .75-.75ZM12 7.003a.999.999 0 1 1 0 1.997.999.999 0 0 1 0-1.997Z" fill="currentColor"/></svg>',devices:'<svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm5.5-8.5V9a5.5 5.5 0 1 0-11 0v1H9a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H6.5v.25a2.25 2.25 0 0 0 2.096 2.245l.154.005h1.128a2.251 2.251 0 1 1 0 1.5H8.75a3.75 3.75 0 0 1-3.745-3.55L5 16.25V9a7 7 0 0 1 14 0v5a2 2 0 0 1-1.85 1.995L17 16h-2a1 1 0 0 1-.993-.883L14 15v-4a1 1 0 0 1 .883-.993L15 10h2.5Zm-9 1.5h-2v3h2v-3Zm9 0h-2v3H17a.5.5 0 0 0 .492-.41L17.5 14v-2.5Z" fill="currentColor"/></svg>',horizontal_dots:'<svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8 12a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM14 12a2 2 0 1 1-4 0 2 2 0 0 1 4 0ZM18 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" fill="currentColor"/></svg>',ai_sparkle:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 49 48" fill="none"><path fill="#F13E1B" d="m30.023 15.96.07.016a1.362 1.362 0 0 1 .657 2.068c-.163.23-.392.403-.658.497l-3.444 1.118a7.095 7.095 0 0 0-4.495 4.492l-1.12 3.442a1.357 1.357 0 0 1-1.267.907h-.016a1.361 1.361 0 0 1-1.283-.907l-1.12-3.442a7.091 7.091 0 0 0-4.495-4.509l-3.444-1.119a1.36 1.36 0 0 1 0-2.564l3.444-1.118a7.097 7.097 0 0 0 4.427-4.492l1.119-3.442a1.36 1.36 0 0 1 2.566 0l1.12 3.442a7.09 7.09 0 0 0 4.495 4.492l3.444 1.118Zm9.195 16.007-2.755-.894a5.678 5.678 0 0 1-3.596-3.594l-.896-2.753a1.087 1.087 0 0 0-2.053 0l-.895 2.753a5.672 5.672 0 0 1-3.541 3.594l-2.756.894a1.088 1.088 0 0 0 0 2.052l2.756.895a5.675 5.675 0 0 1 3.596 3.607l.896 2.753a1.088 1.088 0 0 0 2.052 0l.896-2.753a5.672 5.672 0 0 1 3.596-3.594l2.756-.894a1.088 1.088 0 0 0 0-2.052l-.056-.014Z"/><path fill="#2160FD" d="m39.218 31.967-2.755-.894a5.677 5.677 0 0 1-3.596-3.594l-.896-2.753a1.087 1.087 0 0 0-2.053 0l-.895 2.753a5.672 5.672 0 0 1-3.541 3.594l-2.756.894a1.088 1.088 0 0 0 0 2.052l2.756.895a5.675 5.675 0 0 1 3.596 3.607l.896 2.753a1.088 1.088 0 0 0 2.052 0l.896-2.753a5.672 5.672 0 0 1 3.596-3.594l2.756-.894a1.088 1.088 0 0 0 0-2.052l-.056-.014Z"/></svg>',meeting_ai:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" fill="none"><path fill="#F13E1B" d="M9.111 12.888a4.98 4.98 0 0 0-1.075-.8l-.04.048a4.651 4.651 0 0 0-.903-.424l-2.446-.8a.963.963 0 0 1-.467-.356.953.953 0 0 1 0-1.116.955.955 0 0 1 .467-.352l2.446-.8A5.088 5.088 0 0 0 9.04 7.06a5.048 5.048 0 0 0 1.2-1.904l.02-.064.799-2.444A.97.97 0 0 1 11.969 2a.97.97 0 0 1 .91.648l.8 2.444a5.147 5.147 0 0 0 1.219 1.976 5.042 5.042 0 0 0 1.974 1.2l2.45.8h.048c.188.067.351.19.468.352.115.164.176.36.175.56.001.2-.06.396-.175.56a1 1 0 0 1-.468.352l-2.446.8a5.067 5.067 0 0 0-1.978 1.2 5.096 5.096 0 0 0-1.199 1.976l-.8 2.448-.023.06a1.02 1.02 0 0 1-.184.284.967.967 0 0 1-.703.3 1 1 0 0 1-.927-.644l-.8-2.448a5.11 5.11 0 0 0-.799-1.508 5.16 5.16 0 0 0-.4-.472Zm10.434 5.396a.492.492 0 0 1 .176-.236.473.473 0 0 1 .1-.048.466.466 0 0 1 .168-.04c.1 0 .197.031.28.088l.091.072a.456.456 0 0 1 .096.164l.4 1.224c.124.372.332.71.607.988.278.276.616.484.987.608l1.223.4h.028l.084.04a.536.536 0 0 1 .148.136c.056.082.087.18.088.28a.484.484 0 0 1-.32.456l-1.227.4a2.528 2.528 0 0 0-1.595 1.6l-.399 1.224a.46.46 0 0 1-.176.232.464.464 0 0 1-.28.088.475.475 0 0 1-.455-.32l-.4-1.224a2.507 2.507 0 0 0-.611-.992 2.487 2.487 0 0 0-.987-.612l-1.223-.4a.48.48 0 0 1 0-.908l1.223-.4c.367-.128.7-.337.975-.612.137-.142.257-.3.36-.468.1-.162.18-.335.24-.516l.399-1.224Z"/><path fill="currentColor" d="M19.545 18.284a.492.492 0 0 1 .176-.236.469.469 0 0 1 .1-.048.466.466 0 0 1 .168-.04c.1 0 .197.031.28.088l.091.072a.456.456 0 0 1 .096.164l.4 1.224c.124.372.332.71.607.988.279.276.616.484.988.608l1.222.4h.028l.084.04a.534.534 0 0 1 .148.136c.057.082.087.18.088.28a.484.484 0 0 1-.32.456l-1.227.4a2.528 2.528 0 0 0-1.595 1.6l-.399 1.224a.46.46 0 0 1-.175.232.464.464 0 0 1-.28.088.475.475 0 0 1-.456-.32l-.4-1.224a2.509 2.509 0 0 0-.61-.992 2.487 2.487 0 0 0-.988-.612l-1.223-.4a.48.48 0 0 1 0-.908l1.223-.4c.367-.128.7-.337.975-.612a2.7 2.7 0 0 0 .36-.468c.1-.162.18-.335.24-.516l.4-1.224Z"/></svg>',create_channel:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none"><path fill="currentColor" d="M2 14.75A3.25 3.25 0 0 0 5.25 18H6v2.75a1.25 1.25 0 0 0 1.999 1l2.125-1.59.396-1.583c.071-.286.177-.56.312-.82L7.5 20.252 7.499 16.5H5.25a1.75 1.75 0 0 1-1.75-1.75v-8.5c0-.966.784-1.75 1.75-1.75h13.5c.966 0 1.75.784 1.75 1.75v3.845a3.27 3.27 0 0 1 1.5.83V6.25A3.25 3.25 0 0 0 18.75 3H5.25A3.25 3.25 0 0 0 2 6.25v8.5Z"/><path fill="currentColor" d="m18.098 11.67-5.902 5.902a2.684 2.684 0 0 0-.707 1.247l-.458 1.831a1.087 1.087 0 0 0 1.319 1.318l1.83-.457a2.685 2.685 0 0 0 1.248-.707l5.902-5.902a2.285 2.285 0 1 0-3.232-3.232Z"/></svg>',create_channel_illustration:'<svg width="503" height="362" viewBox="0 0 503 362" fill="none" xmlns="http://www.w3.org/2000/svg"> <path d="M93.3477 192.893C93.3477 190.684 95.1385 188.893 97.3477 188.893H476C478.209 188.893 480 190.684 480 192.893V311.824C480 314.033 478.209 315.824 476 315.824H469.354C467.145 315.824 465.354 317.615 465.354 319.824V339.364C465.354 342.928 461.045 344.712 458.525 342.193L433.328 316.996C432.578 316.245 431.561 315.824 430.5 315.824H97.3477C95.1385 315.824 93.3477 314.033 93.3477 311.824V192.893Z" fill="#282828"/> <path d="M306.606 230.9H136.121C134.648 230.9 133.453 232.095 133.453 233.568C133.453 235.041 134.648 236.236 136.121 236.236H306.606C308.079 236.236 309.274 235.041 309.274 233.568C309.274 232.095 308.079 230.9 306.606 230.9Z" fill="#2160FD"/> <path d="M437.226 249.358H136.121C134.648 249.358 133.453 250.553 133.453 252.026C133.453 253.499 134.648 254.694 136.121 254.694H437.226C438.7 254.694 439.894 253.499 439.894 252.026C439.894 250.553 438.7 249.358 437.226 249.358Z" fill="#5C5C5C"/> <path d="M436.926 267.816H136.121C134.648 267.816 133.453 269.011 133.453 270.484C133.453 271.957 134.648 273.152 136.121 273.152H436.926C438.4 273.152 439.594 271.957 439.594 270.484C439.594 269.011 438.399 267.816 436.926 267.816Z" fill="#5C5C5C"/> <path d="M411.652 23C411.652 20.7909 409.861 19 407.652 19H29C26.7909 19 25 20.7909 25 23V141.931C25 144.14 26.7909 145.931 29 145.931H35.646C37.8551 145.931 39.646 147.722 39.646 149.931V169.472C39.646 173.036 43.9546 174.82 46.4745 172.3L71.6714 147.103C72.4216 146.352 73.439 145.931 74.4999 145.931H407.652C409.861 145.931 411.652 144.14 411.652 141.931V23Z" fill="#282828"/> <path d="M241.188 61.9839H70.703C69.2296 61.9839 68.0352 63.1783 68.0352 64.6517C68.0352 66.1252 69.2296 67.3196 70.703 67.3196H241.188C242.662 67.3196 243.856 66.1252 243.856 64.6517C243.856 63.1783 242.662 61.9839 241.188 61.9839Z" fill="#2160FD"/> <path d="M371.808 80.4419H70.703C69.2296 80.4419 68.0352 81.6363 68.0352 83.1098C68.0352 84.5832 69.2296 85.7776 70.703 85.7776H371.808C373.282 85.7776 374.476 84.5832 374.476 83.1098C374.476 81.6363 373.282 80.4419 371.808 80.4419Z" fill="#5C5C5C"/> <path d="M371.508 98.8999H70.703C69.2296 98.8999 68.0352 100.094 68.0352 101.568C68.0352 103.041 69.2296 104.236 70.703 104.236H371.508C372.982 104.236 374.176 103.041 374.176 101.568C374.176 100.094 372.982 98.8999 371.508 98.8999Z" fill="#5C5C5C"/> </svg>',captionsOn:'<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18.75 4A3.25 3.25 0 0 1 22 7.25v9.505a3.25 3.25 0 0 1-3.25 3.25H5.25A3.25 3.25 0 0 1 2 16.755V7.25a3.25 3.25 0 0 1 3.066-3.245L5.25 4h13.5Zm0 1.5H5.25l-.144.006A1.75 1.75 0 0 0 3.5 7.25v9.505c0 .966.784 1.75 1.75 1.75h13.5a1.75 1.75 0 0 0 1.75-1.75V7.25a1.75 1.75 0 0 0-1.75-1.75ZM5.5 12c0-3.146 2.713-4.775 5.122-3.401A.75.75 0 0 1 9.878 9.9C8.481 9.104 7 9.994 7 12c0 2.005 1.484 2.896 2.88 2.103a.75.75 0 0 1 .74 1.304C8.216 16.775 5.5 15.143 5.5 12Zm7.5 0c0-3.146 2.713-4.775 5.122-3.401a.75.75 0 0 1-.744 1.302C15.981 9.104 14.5 9.994 14.5 12c0 2.005 1.484 2.896 2.88 2.103a.75.75 0 0 1 .74 1.304C15.716 16.775 13 15.143 13 12Z" fill="currentColor"/></svg>',captionsOff:'<svg width="24" height="24" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3.28 2.22a.75.75 0 0 0-1.06 1.06l1.25 1.25A3.247 3.247 0 0 0 2 7.25v9.505a3.25 3.25 0 0 0 3.25 3.25h13.5c.063 0 .126-.002.188-.006l1.781 1.781a.75.75 0 0 0 1.061-1.06L3.28 2.22Zm14.164 16.284H5.25a1.75 1.75 0 0 1-1.75-1.75V7.25c0-.727.443-1.35 1.074-1.615l2.828 2.828C6.292 9.043 5.5 10.3 5.5 12c0 3.143 2.715 4.775 5.12 3.406a.75.75 0 0 0-.74-1.303C8.483 14.896 7 14.005 7 12c0-1.37.69-2.22 1.573-2.366l8.87 8.87Zm2.986-1.256c.045-.157.07-.322.07-.494V7.25a1.75 1.75 0 0 0-1.75-1.75H8.682L7.182 4H18.75A3.25 3.25 0 0 1 22 7.25v9.505c0 .593-.159 1.148-.436 1.627l-1.134-1.134Zm-5.877-5.877-1.197-1.197c.813-1.888 2.882-2.65 4.766-1.575a.75.75 0 0 1-.744 1.302c-1.241-.708-2.549-.085-2.825 1.47Z" fill="currentColor"/></svg>',play:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M8 5v14l11-7z" /></svg>',pause:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill="currentColor"><path d="M6 4 H9 V20 H6 Z" /><path d="M15 4 H18 V20 H15 Z" /></svg>',fastForward:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 24" fill="currentColor"><path d="M4 5v14l11-7-11-7zm13 0v14l11-7-11-7z"/></svg>',minimize:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21.778 2.223a.75.75 0 0 1 .072.976l-.072.084-6.223 6.224h5.693a.75.75 0 0 1 .743.65l.007.1a.75.75 0 0 1-.649.744l-.101.007-7.55-.002-.016-.002a.727.727 0 0 1-.195-.042l-.098-.046a.747.747 0 0 1-.386-.553l-.007-.105V2.754a.75.75 0 0 1 1.493-.102l.007.102v5.69l6.222-6.221a.749.749 0 0 1 1.06 0ZM11.003 13.755v7.504a.75.75 0 0 1-1.494.102l-.007-.102v-5.695L3.28 21.78a.75.75 0 0 1-1.133-.977l.073-.084 6.22-6.214H2.751a.75.75 0 0 1-.743-.648L2 13.755a.75.75 0 0 1 .75-.75l7.554.002.074.009.097.023.053.019.086.04.089.058a.761.761 0 0 1 .148.148l.066.106.041.094.022.07.01.055.007.058v-.008l.005.076Z" fill="currentColor"/></svg>',maximize:'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.748 3.001h7.554l.1.014.099.028.061.026a.72.72 0 0 1 .218.15l.04.044.061.082.037.065.039.09.02.064.013.064.009.093v7.534a.75.75 0 0 1-1.493.102l-.006-.102-.001-5.696-13.94 13.945h5.69a.75.75 0 0 1 .744.65l.007.1a.75.75 0 0 1-.649.744l-.101.007H3.714L3.684 21a.705.705 0 0 1-.187-.04l-.09-.038-.018-.01a.746.746 0 0 1-.384-.553l-.007-.105V12.75a.75.75 0 0 1 1.493-.102l.007.102v5.692L18.438 4.5l-5.69.001a.75.75 0 0 1-.743-.648l-.007-.102a.75.75 0 0 1 .648-.743L12.748 3Z" fill="currentColor"/></svg>'},qt={get:(e,t,i)=>(...s)=>{try{return Reflect.get(e,t,i).apply(e,s)}catch(e){return null}}};let Kt;try{Kt=new Proxy(localStorage,qt)}catch(e){Kt=new Proxy({},qt)}const Yt=Kt,Wt="dyte-prefs",Zt=(e,t)=>{const i=JSON.parse(Yt.getItem(Wt)||"{}");i[e]=JSON.stringify(t),Yt.setItem("dyte-prefs",JSON.stringify(i))},Qt=e=>JSON.parse(Yt.getItem(Wt)||"{}")[e],Xt=()=>{const e=JSON.parse(Yt.getItem(Wt)||"{}");return{mirrorVideo:!e["mirror-video"]||"true"===e["mirror-video"],muteNotificationSounds:!!e["mute-notification-sounds"]&&"true"===e["mute-notification-sounds"]}},Jt={},ei=((e,t)=>{const i=((e,t=(e,t)=>e!==t)=>{const i=zt(e);let s=new Map(Object.entries(i??{}));const a={dispose:[],get:[],set:[],reset:[]},r=()=>{s=new Map(Object.entries(zt(e)??{})),a.reset.forEach(e=>e())},n=e=>(a.get.forEach(t=>t(e)),s.get(e)),o=(e,i)=>{const r=s.get(e);t(i,r,e)&&(s.set(e,i),a.set.forEach(t=>t(e,i,r)))},d="undefined"==typeof Proxy?{}:new Proxy(i,{get:(e,t)=>n(t),ownKeys:e=>Array.from(s.keys()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),has:(e,t)=>s.has(t),set:(e,t,i)=>(o(t,i),!0)}),l=(e,t)=>(a[e].push(t),()=>{Bt(a[e],t)});return{state:d,get:n,set:o,on:l,onChange:(t,i)=>{const s=l("set",(e,s)=>{e===t&&i(s)}),a=l("reset",()=>i(zt(e)[t]));return()=>{s(),a()}},use:(...e)=>{const t=e.reduce((e,t)=>(t.set&&e.push(l("set",t.set)),t.get&&e.push(l("get",t.get)),t.reset&&e.push(l("reset",t.reset)),t.dispose&&e.push(l("dispose",t.dispose)),e),[]);return()=>t.forEach(e=>e())},dispose:()=>{a.dispose.forEach(e=>e()),r()},reset:r,forceUpdate:e=>{const t=s.get(e);a.set.forEach(i=>i(e,t,t))}}})(e,t);return i.use((()=>{const e=new Map;return{dispose:()=>e.clear(),get:t=>{const i=Re();i&&((e,t,i)=>{const s=e.get(t);s?s.includes(i)||s.push(i):e.set(t,[i])})(e,t,i)},set:t=>{const i=e.get(t);i&&e.set(t,i.filter(De)),jt(e)},reset:()=>{e.forEach(e=>e.forEach(De)),jt(e)}}})()),i})({meeting:void 0,t:Ht(),iconPack:Vt,states:{meeting:"idle",prefs:Xt()},config:Ft,size:void 0}),ti=new Map;ei.use({set:(e,t,i)=>{const s=ti.get(e);s&&ti.set(e,s.filter(s=>s[e]===i&&(s[e]=t,!0)))}});const ii=ei.state;function si(){return function(e,t){const{connectedCallback:i,disconnectedCallback:s}=e;e.connectedCallback=function(){const e=Y(this);if(!e[t]){const i=ei.state[t];e[t]=i,function(e,t){const i=ti.get(e);i?i.push(t):ti.set(e,[t])}(t,e)}return null==i?void 0:i.call(this)},e.disconnectedCallback=function(){return function(e,t){const i=ti.get(e);if(i&&i.length>0){const s=i.indexOf(t);-1!==s&&(i.splice(s,1),ti.set(e,i))}}(t,Y(this)),null==s?void 0:s.call(this)}}}const ai=(e,t=20)=>null==e?"":e.length>t?`${e.substring(0,t)}...`:e,ri=e=>/^\p{Emoji}+$/u.test(e)&&!/^\d+$/.test(e),ni=e=>(null==e?void 0:e.trim().toLowerCase().startsWith("javascript:"))?"https://dyte.io":e,oi=e=>""===(e=null==e?void 0:e.trim())?"Participant":e,di=new RegExp(/[^\u00BF-\u1FFF\u2C00-\uD7FF\w\s]/,"g"),li=new RegExp(/\s+/);function ci(e,t=2){return e.replace(di,"").trim().split(li).slice(0,t).map(e=>e.charAt(0)).join("").toUpperCase()}const hi="object"==typeof global&&global&&global.Object===Object&&global;var pi="object"==typeof self&&self&&self.Object===Object&&self;const ui=hi||pi||Function("return this")();const gi=ui.Symbol;var fi=Object.prototype,mi=fi.hasOwnProperty,vi=fi.toString,yi=gi?gi.toStringTag:void 0;var bi=Object.prototype.toString;var wi=gi?gi.toStringTag:void 0;function xi(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":wi&&wi in Object(e)?function(e){var t=mi.call(e,yi),i=e[yi];try{e[yi]=void 0;var s=!0}catch(e){}var a=vi.call(e);return s&&(t?e[yi]=i:delete e[yi]),a}(e):function(e){return bi.call(e)}(e)}function ki(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Si(e){return null!=e&&"object"==typeof e}var Ei=/\s/;var Pi=/^\s+/;function Ti(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&Ei.test(e.charAt(t)););return t}(e)+1).replace(Pi,""):e}var Li=/^[-+]0x[0-9a-f]+$/i,Ci=/^0b[01]+$/i,_i=/^0o[0-7]+$/i,Ai=parseInt;function Ri(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||Si(e)&&"[object Symbol]"==xi(e)}(e))return NaN;if(ki(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ki(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Ti(e);var i=Ci.test(e);return i||_i.test(e)?Ai(e.slice(2),i?2:8):Li.test(e)?NaN:+e}const Ii=function(){return ui.Date.now()};var Di=Math.max,Mi=Math.min;function Oi(e,t,i){var s,a,r,n,o,d,l=0,c=!1,h=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function u(t){var i=s,r=a;return s=a=void 0,l=t,n=e.apply(r,i)}function g(e){var i=e-d;return void 0===d||i>=t||i<0||h&&e-l>=r}function f(){var e=Ii();if(g(e))return m(e);o=setTimeout(f,function(e){var i=t-(e-d);return h?Mi(i,r-(e-l)):i}(e))}function m(e){return o=void 0,p&&s?u(e):(s=a=void 0,n)}function v(){var e=Ii(),i=g(e);if(s=arguments,a=this,d=e,i){if(void 0===o)return function(e){return l=e,o=setTimeout(f,t),c?u(e):n}(d);if(h)return clearTimeout(o),o=setTimeout(f,t),u(d)}return void 0===o&&(o=setTimeout(f,t)),n}return t=Ri(t)||0,ki(i)&&(c=!!i.leading,r=(h="maxWait"in i)?Di(Ri(i.maxWait)||0,t):r,p="trailing"in i?!!i.trailing:p),v.cancel=function(){void 0!==o&&clearTimeout(o),l=0,s=d=a=o=void 0},v.flush=function(){return void 0===o?n:m(Ii())},v}const Ui=e=>{let t=null;try{const i=JSON.parse(e.message),{target:s,message:a}=i;t=void 0===s||void 0===a?e:Object.assign(Object.assign({},e),{targetUserIds:s,message:a})}catch(i){t=e}return t};function $i(e,t){return e.localeCompare(t)}function Fi(e){return e.sort((e,t)=>e.localeCompare(t)).join("_")}function Ni(e,t){if(null==e)return!0;for(const i of e)if("file"===i.kind){const e=i.getAsFile();i.type.startsWith("image/")?t("image",e):t("file",e)}}const ji="dm__";function zi(e){return e.isDirectMessage}function Bi(e){return[...new Set(e)].sort($i).join("<>")}function Gi(e){return e.split("").reverse().join("")}const Hi=/^\*([^*\s]+)\*/,Vi=/^_([^_\s]+)_/,qi=/^~([^~\s]+)~/,Ki=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\+.,~#?&//=]*)/,Yi=/<blockquote>[.\s\S]*<\/blockquote>\n\n/m;function Wi(e,t=!1){if(!Yi.test(e))return"";let i=0,s=13;return t&&(i=12,s=0),e.substring(e.indexOf("<blockquote>")+i,e.indexOf("</blockquote>")+s)}function Zi(e){return e.replace(Yi,"")}const Qi=2e3,Xi=["<a>","<b>","<i>","<q>","<s>"];function Ji(e){e=(e=e.split(" ").map(e=>{if(Ki.test(e)){const t=Ki.exec(e);e=e.replace(t[0],`<a>${t[0]}</a>`)}else{if(Hi.test(e)){const t=Hi.exec(e);e=e.replace(t[0],`<b>${t[1]}</b>`)}if(Vi.test(e)){const t=Vi.exec(e);e=e.replace(t[0],`<i>${t[1]}</i>`)}if(qi.test(e)){const t=qi.exec(e);e=e.replace(t[0],`<s>${t[1]}</s>`)}}return e}).join(" ")).split(" ").map((e,t)=>">"!==e||0!==t&&">"!==e[t-1]?e:"<q></q>").join(" ");const[t]=es(e);return t}function es(e,t=""){const i=[];if(0===e.length)return[i,0];let s=0;for(;s<e.length;){if(t.length&&t===e.substring(s,s+t.length))return[i,s+t.length];if(Xi.includes(e.substring(s,s+3))){const[t,a]=es(e.substring(s+3),`</${e[s+1]}>`);i.push({type:e[s+1],content:1===t.length&&"plain_text"===t[0].type?t[0].content:t}),s+=a+3}else{let t=i[i.length-1];t&&"plain_text"===t.type||(i.push({type:"plain_text",content:""}),t=i[i.length-1]),t.content+=e[s],s++}}return[i,s]}const ts=(e,t)=>{const i=t.getTime()-e.getTime();return Math.round(Math.abs(i/1e3/60))},is=(e,t)=>{const i=ts(e,t);if(i<2)return"just now";if(i<60)return`${i}m ago`;const s=Math.round(i/60);if(i<90)return`about ${s}h ago`;if(s<24)return`${s}h ago`;const a=Math.round(s/24);if(a<7)return`${a}d ago`;return`${Math.round(a/7)}w ago`},ss=e=>e.toDateString()+" "+e.toLocaleTimeString(),as=({name:e,time:t,now:i})=>z("div",{class:"head"},z("div",{class:"name"},ai(oi(e),20)),z("div",{class:"time",title:ss(t)},is(t,i))),rs=(e,t=!0)=>{null!=e&&e.scrollTo({top:e.scrollHeight,behavior:t?"smooth":"auto"})},ns=({element:e,size:t,states:i={},config:s={}})=>{let a=[];const r=null==s?void 0:s.root[e],n=e=>{a.push(e),"string"==typeof t&&a.push(`${e}.${t}`)};if(n(e),"object"==typeof r&&!Array.isArray(r)&&null!==r){const{state:t,states:s}=r;let a=e,o=[];if(Array.isArray(s)){o=s.filter(e=>i[e]),o.sort();for(const e of o)n(`${a}.${e}`);if(o.length>1){n([a,...o].join("."))}}if("string"==typeof t){const s=`${e}[${t}=${i[t]}]`;n(s);for(const e of o)n(`${s}.${e}`);if(o.length>1){n([s,...o].join("."))}}}return a},os=({selectors:e,root:t})=>{if(!t||!Array.isArray(e))return[];let i=[];for(const s of e){const e=t[s];if(Array.isArray(e))i=[...e];else if(e){if(e.children&&(i=[...e.children]),Array.isArray(e.remove))for(const t of e.remove)i=i.filter(e=>"string"==typeof e?e!==t:!Array.isArray(e)||e[0]!==t);if(e.addBefore)for(const[t,s]of Object.entries(e.addBefore)){const e=i.findIndex(e=>"string"==typeof e?e===t:!!Array.isArray(e)&&e[0]===t);e>=0&&i.splice(e,0,...s)}Array.isArray(e.add)&&(i=i.concat(e.add)),Array.isArray(e.prepend)&&(i=e.prepend.concat(i))}}return i},ds=({elements:e,defaults:t,props:i={},deepProps:s=!1,elementProps:a={}})=>Array.isArray(e)&&0!==e.length?e.map(e=>z(ls,{element:e,defaults:t,props:i,childProps:s&&i,elementProps:a})):null,ls=({element:e,defaults:t,childProps:i={},props:s={},onlyChildren:a=!1,asHost:r=!1,deepProps:n=!1,elementProps:o={}},d)=>{var l;const{config:c,size:h,states:p}=t;let u,g={},f=[];Array.isArray(e)?[u,g,...f]=e:u=e;const m=null===(l=null==c?void 0:c.root)||void 0===l?void 0:l[u];null!=m&&"props"in m&&(s=Object.assign(Object.assign({},m.props),s)),s=Object.assign(Object.assign({},s),g),u in o&&(s=Object.assign(Object.assign({},s),o[u]));const v=ns({element:u,size:h,states:p,config:c}),y=os({selectors:v,root:c.root});if(a)return z(ds,{elements:y,defaults:t,props:i,deepProps:n,elementProps:o});const b=(({selectors:e,styles:t})=>{if(!Array.isArray(e)||null==t)return{};const i={};for(const s of e){const e=t[s];null!=e&&Object.assign(i,e)}return i})({selectors:v,styles:c.styles});if(r)return z(G,Object.assign({},t,{style:b},s),z(ds,{elements:y,defaults:t,props:i,deepProps:n,elementProps:o}),d,f.map(e=>{if(Array.isArray(e)){const[i,s]=e;return z(i,Object.assign({},t,s))}return e}));if(["dyte-header","dyte-controlbar"].includes(u)&&(s.disableRender=!0),u.startsWith("dyte-"))return z(u,Object.assign({},t,{style:b},s),z(ds,{elements:y,defaults:t,props:i,deepProps:n,elementProps:o}),d,f.map(e=>{if(Array.isArray(e)){const[i,s]=e;return z(i,Object.assign({},t,s))}return e}));{const[e,a]=u.split("#");return z(e,Object.assign({id:a,style:b},s),z(ds,{elements:y,defaults:t,props:i,deepProps:n,elementProps:o}),d,f.map(e=>{if(Array.isArray(e)){const[i,s]=e;return z(i,Object.assign({},t,s))}return e}))}};function cs(e,t){return e===t||e!=e&&t!=t}function hs(e,t){for(var i=e.length;i--;)if(cs(e[i][0],t))return i;return-1}var ps=Array.prototype.splice;function us(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}us.prototype.clear=function(){this.__data__=[],this.size=0},us.prototype.delete=function(e){var t=this.__data__,i=hs(t,e);return!(i<0)&&(i==t.length-1?t.pop():ps.call(t,i,1),--this.size,!0)},us.prototype.get=function(e){var t=this.__data__,i=hs(t,e);return i<0?void 0:t[i][1]},us.prototype.has=function(e){return hs(this.__data__,e)>-1},us.prototype.set=function(e,t){var i=this.__data__,s=hs(i,e);return s<0?(++this.size,i.push([e,t])):i[s][1]=t,this};function gs(e){if(!ki(e))return!1;var t=xi(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}const fs=ui["__core-js_shared__"];var ms,vs=(ms=/[^.]+$/.exec(fs&&fs.keys&&fs.keys.IE_PROTO||""))?"Symbol(src)_1."+ms:"";var ys=Function.prototype.toString;function bs(e){if(null!=e){try{return ys.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var ws=/^\[object .+?Constructor\]$/,xs=Function.prototype,ks=Object.prototype,Ss=xs.toString,Es=ks.hasOwnProperty,Ps=RegExp("^"+Ss.call(Es).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ts(e){return!(!ki(e)||(t=e,vs&&vs in t))&&(gs(e)?Ps:ws).test(bs(e));var t}function Ls(e,t){var i=function(e,t){return null==e?void 0:e[t]}(e,t);return Ts(i)?i:void 0}const Cs=Ls(ui,"Map");const _s=Ls(Object,"create");var As=Object.prototype.hasOwnProperty;var Rs=Object.prototype.hasOwnProperty;function Is(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}function Ds(e,t){var i,s,a=e.__data__;return("string"==(s=typeof(i=t))||"number"==s||"symbol"==s||"boolean"==s?"__proto__"!==i:null===i)?a["string"==typeof t?"string":"hash"]:a.map}function Ms(e){var t=-1,i=null==e?0:e.length;for(this.clear();++t<i;){var s=e[t];this.set(s[0],s[1])}}Is.prototype.clear=function(){this.__data__=_s?_s(null):{},this.size=0},Is.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Is.prototype.get=function(e){var t=this.__data__;if(_s){var i=t[e];return"__lodash_hash_undefined__"===i?void 0:i}return As.call(t,e)?t[e]:void 0},Is.prototype.has=function(e){var t=this.__data__;return _s?void 0!==t[e]:Rs.call(t,e)},Is.prototype.set=function(e,t){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=_s&&void 0===t?"__lodash_hash_undefined__":t,this},Ms.prototype.clear=function(){this.size=0,this.__data__={hash:new Is,map:new(Cs||us),string:new Is}},Ms.prototype.delete=function(e){var t=Ds(this,e).delete(e);return this.size-=t?1:0,t},Ms.prototype.get=function(e){return Ds(this,e).get(e)},Ms.prototype.has=function(e){return Ds(this,e).has(e)},Ms.prototype.set=function(e,t){var i=Ds(this,e),s=i.size;return i.set(e,t),this.size+=i.size==s?0:1,this};function Os(e){var t=this.__data__=new us(e);this.size=t.size}Os.prototype.clear=function(){this.__data__=new us,this.size=0},Os.prototype.delete=function(e){var t=this.__data__,i=t.delete(e);return this.size=t.size,i},Os.prototype.get=function(e){return this.__data__.get(e)},Os.prototype.has=function(e){return this.__data__.has(e)},Os.prototype.set=function(e,t){var i=this.__data__;if(i instanceof us){var s=i.__data__;if(!Cs||s.length<199)return s.push([e,t]),this.size=++i.size,this;i=this.__data__=new Ms(s)}return i.set(e,t),this.size=i.size,this};var Us=function(){try{var e=Ls(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();const $s=Us;function Fs(e,t,i){"__proto__"==t&&$s?$s(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}var Ns="object"==typeof e&&e&&!e.nodeType&&e,js=Ns&&"object"==typeof module&&module&&!module.nodeType&&module,zs=js&&js.exports===Ns?ui.Buffer:void 0,Bs=zs?zs.allocUnsafe:void 0;function Gs(e,t){if(t)return e.slice();var i=e.length,s=Bs?Bs(i):new e.constructor(i);return e.copy(s),s}const Hs=ui.Uint8Array;function Vs(e){var t=new e.constructor(e.byteLength);return new Hs(t).set(new Hs(e)),t}function qs(e,t){var i=t?Vs(e.buffer):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}var Ks=Object.create;const Ys=function(){function e(){}return function(t){if(!ki(t))return{};if(Ks)return Ks(t);e.prototype=t;var i=new e;return e.prototype=void 0,i}}();function Ws(e,t){return function(i){return e(t(i))}}const Zs=Ws(Object.getPrototypeOf,Object);var Qs=Object.prototype;function Xs(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Qs)}function Js(e){return"function"!=typeof e.constructor||Xs(e)?{}:Ys(Zs(e))}function ea(e){return Si(e)&&"[object Arguments]"==xi(e)}var ta=Object.prototype,ia=ta.hasOwnProperty,sa=ta.propertyIsEnumerable,aa=ea(function(){return arguments}())?ea:function(e){return Si(e)&&ia.call(e,"callee")&&!sa.call(e,"callee")};const ra=aa;const na=Array.isArray;function oa(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function da(e){return null!=e&&oa(e.length)&&!gs(e)}var la="object"==typeof e&&e&&!e.nodeType&&e,ca=la&&"object"==typeof module&&module&&!module.nodeType&&module,ha=ca&&ca.exports===la?ui.Buffer:void 0;const pa=(ha?ha.isBuffer:void 0)||function(){return!1};var ua={};function ga(e){return function(t){return e(t)}}ua["[object Float32Array]"]=ua["[object Float64Array]"]=ua["[object Int8Array]"]=ua["[object Int16Array]"]=ua["[object Int32Array]"]=ua["[object Uint8Array]"]=ua["[object Uint8ClampedArray]"]=ua["[object Uint16Array]"]=ua["[object Uint32Array]"]=!0,ua["[object Arguments]"]=ua["[object Array]"]=ua["[object ArrayBuffer]"]=ua["[object Boolean]"]=ua["[object DataView]"]=ua["[object Date]"]=ua["[object Error]"]=ua["[object Function]"]=ua["[object Map]"]=ua["[object Number]"]=ua["[object Object]"]=ua["[object RegExp]"]=ua["[object Set]"]=ua["[object String]"]=ua["[object WeakMap]"]=!1;var fa="object"==typeof e&&e&&!e.nodeType&&e,ma=fa&&"object"==typeof module&&module&&!module.nodeType&&module,va=ma&&ma.exports===fa&&hi.process;const ya=function(){try{var e=ma&&ma.require&&ma.require("util").types;return e||va&&va.binding&&va.binding("util")}catch(e){}}();var ba=ya&&ya.isTypedArray;const wa=ba?ga(ba):function(e){return Si(e)&&oa(e.length)&&!!ua[xi(e)]};var xa=Object.prototype.hasOwnProperty;function ka(e,t,i){var s=e[t];xa.call(e,t)&&cs(s,i)&&(void 0!==i||t in e)||Fs(e,t,i)}var Sa=/^(?:0|[1-9]\d*)$/;function Ea(e,t){var i=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==i||"symbol"!=i&&Sa.test(e))&&e>-1&&e%1==0&&e<t}var Pa=Object.prototype.hasOwnProperty;function Ta(e,t){var i=na(e),s=!i&&ra(e),a=!i&&!s&&pa(e),r=!i&&!s&&!a&&wa(e),n=i||s||a||r,o=n?function(e,t){for(var i=-1,s=Array(e);++i<e;)s[i]=t(i);return s}(e.length,String):[],d=o.length;for(var l in e)!t&&!Pa.call(e,l)||n&&("length"==l||a&&("offset"==l||"parent"==l)||r&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Ea(l,d))||o.push(l);return o}var La=Object.prototype.hasOwnProperty;function Ca(e){if(!ki(e))return function(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t}(e);var t=Xs(e),i=[];for(var s in e)("constructor"!=s||!t&&La.call(e,s))&&i.push(s);return i}function _a(e){return da(e)?Ta(e,!0):Ca(e)}const Aa=[0,.5,1,1.5,2,3,4,5,6,7,8,9,10,12,14,16,20,24,28,32,36,40,44,48,52,56,60,64,72,80,96],Ra={darkest:{background:{1e3:"#080808",900:"#1A1A1A",800:"#1E1E1E",700:"#2C2C2C",600:"#393939"},text:"#FFFFFF"},dark:{background:{1e3:"#252525",900:"#2F2F2F",800:"#323232",700:"#3E3E3E",600:"#4A4A4A"},text:"#F5F5F5","video-bg":"#1C1C1C"},light:{background:{1e3:"#FFFFFF",900:"#F5F5F5",800:"#EBEBEB",700:"#E0E0E0",600:"#D6D6D6"},text:"#111111","text-on-brand":"#ffffff","video-bg":"#DADADA"}},Ia={none:{none:0,sm:0,md:0,lg:0},thin:{none:0,sm:1,md:2,lg:4},fat:{none:0,sm:2,md:4,lg:8}},Da={sharp:{none:0,sm:0,md:0,lg:0},rounded:{none:0,sm:4,md:8,lg:12},"extra-rounded":{none:0,sm:8,md:16,lg:24},circular:{none:9999,sm:9999,md:9999,lg:9999}};function Ma(e){let t="0",i="0",s="0";return 4==(e=e.trim()).length?(t="0x"+e[1]+e[1],i="0x"+e[2]+e[2],s="0x"+e[3]+e[3]):e.length>6&&(t="0x"+e[1]+e[2],i="0x"+e[3]+e[4],s="0x"+e[5]+e[6]),[+t,+i,+s]}const Oa=e=>"string"==typeof e&&7===e.length&&e.startsWith("#"),Ua="--dyte-";function $a(e,t=Ua){return t+e}const Fa=(e,t,i=Ua)=>{Object.keys(t).forEach(s=>{const a=t[s];if("string"==typeof a)if("text"===s||"text-on-brand"===s){const t=Ma(a).join(" ");e.style.setProperty($a(`colors-${s}-1000`,i),`${t}`),e.style.setProperty($a(`colors-${s}-900`,i),`${t} / 0.88`),e.style.setProperty($a(`colors-${s}-800`,i),`${t} / 0.76`),e.style.setProperty($a(`colors-${s}-700`,i),`${t} / 0.64`),e.style.setProperty($a(`colors-${s}-600`,i),`${t} / 0.52`)}else{const t=Ma(a).join(" ");e.style.setProperty($a(`colors-${s}`,i),t)}else"object"==typeof a&&Object.keys(a).forEach(t=>{const r=Ma(a[t]).join(" ");e.style.setProperty($a(`colors-${s}-${t}`,i),r)})})},Na=(e,{spacingBase:t,borderRadius:i,borderWidth:s,colors:a,fontFamily:r,googleFont:n,theme:o,tokenPrefix:d=Ua})=>{if("object"!=typeof e)throw new Error("[dyte-ui-kit] (provideDyteDesignSystem): Passed element is not a valid HTML Element");if("string"==typeof n&&((e=>{const t=[];if(null==document.querySelector("link[data-dyte-font]")){const e=document.createElement("link");e.rel="preconnect",e.setAttribute("data-dyte-font","true"),e.href="https://fonts.googleapis.com";const i=e.cloneNode(!0);i.href="https://fonts.gstatic.com",i.crossOrigin="",t.push(e,i)}const i=document.createElement("link");i.rel="stylesheet",i.setAttribute("data-dyte-font",e),i.href=encodeURI(`https://fonts.googleapis.com/css2?family=${e}:wght@${[400,500,700].join(";")}&display=swap`),t.push(i),document.head.append(...t)})(n),e.style.setProperty($a("font-family",d),n)),"string"==typeof r&&e.style.setProperty($a("font-family",d),r),"number"==typeof t&&((e,t,i=Ua)=>{Aa.forEach(s=>{e.style.setProperty($a(`space-${s}`,i),s*t+"px")})})(e,t,d),"string"==typeof s&&((e,t,i=Ua)=>{if(t in Ia){const s=Ia[t];Object.keys(s).forEach(t=>{e.style.setProperty($a(`border-width-${t}`,i),`${s[t]}px`)})}})(e,s,d),"string"==typeof i&&((e,t,i=Ua)=>{if(t in Da){const s=Da[t];Object.keys(s).forEach(t=>{e.style.setProperty($a(`border-radius-${t}`,i),`${s[t]}px`)})}})(e,i,d),"string"==typeof o){const t=Ra[o];null!=t&&Fa(e,t,d)}"object"==typeof a&&Fa(e,a,d)};function ja(e,t,i){(void 0!==i&&!cs(e[t],i)||void 0===i&&!(t in e))&&Fs(e,t,i)}var za=function(e,t,i){for(var s=-1,a=Object(e),r=i(e),n=r.length;n--;){var o=r[++s];if(!1===t(a[o],o,a))break}return e};const Ba=za;var Ga=Function.prototype,Ha=Object.prototype,Va=Ga.toString,qa=Ha.hasOwnProperty,Ka=Va.call(Object);function Ya(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Wa(e){return function(e,t,i){var s=!i;i||(i={});for(var a=-1,r=t.length;++a<r;){var n=t[a],o=void 0;void 0===o&&(o=e[n]),s?Fs(i,n,o):ka(i,n,o)}return i}(e,_a(e))}function Za(e,t,i,s,a,r,n){var o=Ya(e,i),d=Ya(t,i),l=n.get(d);if(l)ja(e,i,l);else{var c,h=r?r(o,d,i+"",e,t,n):void 0,p=void 0===h;if(p){var u=na(d),g=!u&&pa(d),f=!u&&!g&&wa(d);h=d,u||g||f?na(o)?h=o:Si(c=o)&&da(c)?h=function(e,t){var i=-1,s=e.length;for(t||(t=Array(s));++i<s;)t[i]=e[i];return t}(o):g?(p=!1,h=Gs(d,!0)):f?(p=!1,h=qs(d,!0)):h=[]:function(e){if(!Si(e)||"[object Object]"!=xi(e))return!1;var t=Zs(e);if(null===t)return!0;var i=qa.call(t,"constructor")&&t.constructor;return"function"==typeof i&&i instanceof i&&Va.call(i)==Ka}(d)||ra(d)?(h=o,ra(o)?h=Wa(o):ki(o)&&!gs(o)||(h=Js(d))):p=!1}p&&(n.set(d,h),a(h,d,s,r,n),n.delete(d)),ja(e,i,h)}}function Qa(e,t,i,s,a){e!==t&&Ba(t,function(r,n){if(a||(a=new Os),ki(r))Za(e,t,n,i,Qa,s,a);else{var o=s?s(Ya(e,n),r,n+"",e,t,a):void 0;void 0===o&&(o=r),ja(e,n,o)}},_a)}function Xa(e){return e}var Ja=Math.max;var er=$s?function(e,t){return $s(e,"toString",{configurable:!0,enumerable:!1,value:(i=t,function(){return i}),writable:!0});var i}:Xa;const tr=er;var ir=Date.now;var sr,ar,rr,nr=(sr=tr,ar=0,rr=0,function(){var e=ir(),t=16-(e-rr);if(rr=e,t>0){if(++ar>=800)return arguments[0]}else ar=0;return sr.apply(void 0,arguments)});const or=nr;function dr(e,t){return or(function(e,t,i){return t=Ja(void 0===t?e.length-1:t,0),function(){for(var s=arguments,a=-1,r=Ja(s.length-t,0),n=Array(r);++a<r;)n[a]=s[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=s[a];return o[t]=i(n),function(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}(e,this,o)}}(e,t,Xa),e+"")}var lr,cr=(lr=function(e,t,i){Qa(e,t,i)},dr(function(e,t){var i=-1,s=t.length,a=s>1?t[s-1]:void 0,r=s>2?t[2]:void 0;for(a=lr.length>3&&"function"==typeof a?(s--,a):void 0,r&&function(e,t,i){if(!ki(i))return!1;var s=typeof t;return!!("number"==s?da(i)&&Ea(t,i.length):"string"==s&&t in i)&&cs(i[t],e)}(t[0],t[1],r)&&(a=s<3?void 0:a,s=1),e=Object(e);++i<s;){var n=t[i];n&&lr(e,n,i,a)}return e}));const hr=cr,pr=(e,t,i={},s={grid_pagination:!0,settings_toggle:!0})=>{var a,r,n,o,d,l,c,h,p,u,g,f,m,v,y,b,w,x;const k={showSetupScreen:!0};let S,E=["dyte-stage"],P={},T={};const L=!1!==(null==s?void 0:s.settings_toggle),C=!1!==(null==s?void 0:s.grid_pagination);if(null===(a=e.controlBar)||void 0===a?void 0:a.isEnabled){E.push("dyte-controlbar");const{elements:i}=e.controlBar,s=[...i.fullscreen?["dyte-fullscreen-toggle"]:[],...L?["dyte-settings-toggle"]:[]],a=[],h=[];(null===(r=t.participants.pip)||void 0===r?void 0:r.isSupported())&&(null===(o=null===(n=t.self)||void 0===n?void 0:n.config)||void 0===o?void 0:o.pipMode)&&"LIVESTREAM"!==(null===(d=t.self.config)||void 0===d?void 0:d.viewType)&&h.push("dyte-pip-toggle"),(null==t?void 0:t.self.permissions.canDisableParticipantAudio)&&h.push("dyte-mute-all-button"),h.push("dyte-breakout-rooms-toggle"),(null===(l=t.self)||void 0===l?void 0:l.permissions.canRecord)&&h.push("dyte-recording-toggle"),null!==(c=t.self.permissions.transcriptionEnabled)&&void 0!==c&&c&&h.push("dyte-caption-toggle"),"ReactNative"!==navigator.product&&h.push("dyte-debugger-toggle"),it(t)&&s.push("dyte-livestream-toggle"),i.screenshare&&s.push("dyte-screen-share-toggle"),i.chat&&a.push("dyte-chat-toggle"),i.polls&&a.push("dyte-polls-toggle"),i.participants&&a.push("dyte-participants-toggle"),i.plugins&&a.push("dyte-plugins-toggle"),a.push("dyte-ai-toggle");const p=["dyte-mic-toggle","dyte-camera-toggle","dyte-stage-toggle","dyte-leave-button"];h.length>0&&p.push("dyte-more-toggle");const u=s.concat(a).concat(h);let g=!1;u.length>0&&(g=!0),T={"dyte-controlbar":{states:["activeMoreMenu"],children:["div#controlbar-left","div#controlbar-center","div#controlbar-right"]},"div#controlbar-left":s,"div#controlbar-center":p,"div#controlbar-right":a,"dyte-more-toggle":{states:["activeMoreMenu"],children:[]},"dyte-more-toggle.activeMoreMenu":h.map(e=>[e,{variant:"horizontal",slot:"more-elements"}]),"dyte-controlbar.sm":["div#controlbar-mobile"],"dyte-controlbar.md":["div#controlbar-mobile"],"dyte-more-toggle.activeMoreMenu.md":u.map(e=>[e,{variant:"horizontal",slot:"more-elements"}]),"dyte-more-toggle.activeMoreMenu.sm":u.map(e=>[e,{variant:"horizontal",slot:"more-elements"}]),"div#controlbar-mobile":["dyte-mic-toggle","dyte-camera-toggle","dyte-stage-toggle",g&&"dyte-more-toggle","dyte-leave-button"]}}if(null===(h=e.header)||void 0===h?void 0:h.isEnabled){E.unshift("dyte-header");const{elements:t}=e.header;let i=["dyte-recording-indicator","dyte-livestream-indicator"],s=[],a=[];C&&a.push("dyte-grid-pagination"),t.title&&s.push("dyte-meeting-title"),"string"==typeof t.logo&&t.logo.length>0&&(S=t.logo,i.unshift("dyte-logo")),t.participantCount&&a.push("dyte-participant-count","dyte-viewer-count"),t.timer&&a.push("dyte-clock"),P={"dyte-header":["div#header-left","div#header-center","div#header-right"],"dyte-header.sm":{remove:["div#header-center"]},"div#header-left":i,"div#header-center":s,"div#header-right":a,"div#header-left.sm":{remove:["dyte-logo"],prepend:["dyte-meeting-title"]}}}E.push("dyte-participants-audio","dyte-dialog-manager");let _={logo:S};_=e.designTokens,Oa(null===(u=null===(p=null==e?void 0:e.designTokens)||void 0===p?void 0:p.colors)||void 0===u?void 0:u.textOnBrand)&&(_.colors["text-on-brand"]=null===(f=null===(g=null==e?void 0:e.designTokens)||void 0===g?void 0:g.colors)||void 0===f?void 0:f.textOnBrand),Oa(null===(v=null===(m=null==e?void 0:e.designTokens)||void 0===m?void 0:m.colors)||void 0===v?void 0:v.videoBg)&&(_.colors["video-bg"]=null===(b=null===(y=null==e?void 0:e.designTokens)||void 0===y?void 0:y.colors)||void 0===b?void 0:b.videoBg);let A={designTokens:_,styles:{"dyte-header":{display:"grid",height:"48px",gridTemplateColumns:"repeat(3, 1fr)",gridTemplateRows:"1fr",alignItems:"center"},"dyte-header.sm":{display:"grid",gridArea:"header",gridTemplateColumns:"repeat(2, 1fr)",gridTemplateRows:"1fr",alignItems:"center"},"div#header-left":{display:"flex",alignItems:"center",height:"48px",wordBreak:"break-all"},"dyte-logo":{height:"26px"},"div#header-center":{display:"flex",alignItems:"center",justifyContent:"center",wordBreak:"break-all"},"div#header-right":{display:"flex",alignItems:"center",justifyContent:"flex-end"},"dyte-stage":{display:"flex",flex:"1"},"dyte-grid":{flex:"1",height:"auto"},"dyte-controlbar":{display:"grid",gridTemplateColumns:"repeat(3,1fr)",gridTemplateRows:"1fr",alignItems:"center",padding:"8px"},"dyte-controlbar.sm":{display:"flex",position:"relative",backgroundColor:"var(--dyte-colors-background-1000, #000)"},"dyte-controlbar.md":{display:"flex",position:"relative",backgroundColor:"var(--dyte-colors-background-1000, #000)"},"div#controlbar-left":{display:"flex",alignItems:"center",gap:"var(--dyte-space-1, 4px)"},"div#controlbar-center":{display:"flex",alignItems:"center",position:"relative",overflow:"visible",justifyContent:"center",gap:"var(--dyte-space-1, 4px)"},"div#controlbar-mobile":{display:"flex",flex:"1",alignItems:"center",justifyContent:"center",zIndex:"10000",gap:"var(--dyte-space-1, 4px)"},"div#controlbar-right":{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:"var(--dyte-space-1, 4px)"},"dyte-settings":{width:"720px",height:"480px"},"dyte-debugger":{width:"720px",height:"480px"},"div#setupcontrols-indicator":{position:"absolute",bottom:"12px",left:"12px",display:"flex",gap:"6px",background:"rgb(var(--dyte-colors-background-800, 0 0 0))",borderRadius:"100%"},"div#setupcontrols-media":{position:"absolute",bottom:"8px",right:"8px",display:"flex",gap:"6px"},"div#setupcontrols-settings":{position:"absolute",top:"8px",right:"8px",display:"flex",flexDirection:"column",gap:"6px"},"dyte-meeting-title.sm":{marginLeft:"0"},"dyte-clock":{marginRight:"0"}},root:Object.assign(Object.assign(Object.assign({"dyte-meeting":{state:"meeting",states:["activeSidebar","activeAI"]},"dyte-meeting[meeting=idle]":["dyte-idle-screen"],"dyte-meeting[meeting=waiting]":["dyte-waiting-screen"],"dyte-meeting[meeting=setup]":["dyte-setup-screen","dyte-dialog-manager"],"dyte-meeting[meeting=joined]":E,"dyte-meeting[meeting=joined].activeSidebar.sm":{add:[["dyte-sidebar",{view:"full-screen"}]]},"dyte-meeting[meeting=joined].activeSidebar.md":{add:[["dyte-sidebar",{view:"full-screen"}]]},"dyte-meeting[meeting=joined].activeAI.sm":{add:[["dyte-ai",{view:"full-screen"}]]},"dyte-meeting[meeting=joined].activeAI.md":{add:[["dyte-ai",{view:"full-screen"}]]},"dyte-meeting[meeting=ended]":["dyte-ended-screen"]},P),T),{"dyte-stage":{states:["activeSidebar","activeAI"],children:["dyte-grid","dyte-notifications","dyte-transcripts"]},"dyte-stage.activeSidebar":{add:[["dyte-sidebar",{view:"sidebar"}]]},"dyte-stage.activeSidebar.sm":{remove:["dyte-sidebar"]},"dyte-stage.activeAI":{add:[["dyte-ai",{view:"sidebar"}]]},"dyte-stage.activeAI.sm":{remove:["dyte-ai"]},"dyte-grid":{states:["activeScreenShare","activePlugin","activeSpotlight"],state:"viewType",children:["dyte-simple-grid"]},"dyte-grid[viewType=AUDIO_ROOM]":["dyte-audio-grid"],"dyte-grid[viewType=AUDIO_ROOM].activePlugin":["dyte-mixed-grid"],"dyte-grid[viewType=AUDIO_ROOM].activeScreenshare":["dyte-mixed-grid"],"dyte-grid[viewType=AUDIO_ROOM].activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-grid[viewType=AUDIO_ROOM].activePlugin.activeSpotlight":["dyte-mixed-grid"],"dyte-grid[viewType=AUDIO_ROOM].activePlugin.activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-grid.activeSpotlight":["dyte-spotlight-grid"],"dyte-grid.activeScreenShare":["dyte-mixed-grid"],"dyte-grid.activePlugin":["dyte-mixed-grid"],"dyte-grid.activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-grid.activePlugin.activeSpotlight":["dyte-mixed-grid"],"dyte-grid.activePlugin.activeScreenShare.activeSpotlight":["dyte-mixed-grid"],"dyte-mixed-grid":{states:["activeSpotlight"],state:"viewType",children:["dyte-simple-grid"]},"dyte-mixed-grid[viewType=AUDIO_ROOM]":["dyte-audio-grid"],"dyte-mixed-grid.activeSpotlight":["dyte-spotlight-grid"],"dyte-participant-tile":{state:"meeting",children:["dyte-name-tag","dyte-avatar","dyte-network-indicator"]},"dyte-participant-setup":["dyte-avatar","div#setupcontrols-media"],"dyte-participant-tile[meeting=setup]":["dyte-avatar","div#setupcontrols-indicator","div#setupcontrols-media",...L?["div#setupcontrols-settings"]:[]],"div#setupcontrols-indicator":[["dyte-audio-visualizer",{slot:"start",hideMuted:!0}]],"div#setupcontrols-media":[["dyte-mic-toggle",{size:"sm"}],["dyte-camera-toggle",{size:"sm"}]],"div#setupcontrols-settings":[["dyte-settings-toggle",{size:"sm"}]],"dyte-screenshare-view":["dyte-name-tag","dyte-network-indicator"],"dyte-name-tag":[["dyte-audio-visualizer",{slot:"start"}]]}),config:{notification_sounds:{participant_left:!1},participant_joined_sound_notification_limit:3,participant_chat_message_sound_notification_limit:10,videoFit:"cover"}};return A=((e,t=Ft)=>{let i=Object.assign({},t);return hr(i,e),i})(i,A),k.showSetupScreen=null===(x=null===(w=e.setupScreen)||void 0===w?void 0:w.isEnabled)||void 0===x||x,{config:A,data:k}},ur=768,gr=1080,fr=e=>e>=gr?"lg":e>=ur?"md":"sm";var mr=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var i=-1;return e.some(function(e,s){return e[0]===t&&(i=s,!0)}),i}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var i=e(this.__entries__,t),s=this.__entries__[i];return s&&s[1]},t.prototype.set=function(t,i){var s=e(this.__entries__,t);~s?this.__entries__[s][1]=i:this.__entries__.push([t,i])},t.prototype.delete=function(t){var i=this.__entries__,s=e(i,t);~s&&i.splice(s,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var i=0,s=this.__entries__;i<s.length;i++){var a=s[i];e.call(t,a[1],a[0])}},t}()}(),vr="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,yr="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),br="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(yr):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)};var wr=["top","right","bottom","left","width","height","size","weight"],xr="undefined"!=typeof MutationObserver,kr=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e,t){var i=!1,s=!1,a=0;function r(){i&&(i=!1,e()),s&&o()}function n(){br(r)}function o(){var e=Date.now();if(i){if(e-a<2)return;s=!0}else i=!0,s=!1,setTimeout(n,t);a=e}return o}(this.refresh.bind(this),20)}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,i=t.indexOf(e);~i&&t.splice(i,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter(function(e){return e.gatherActive(),e.hasActive()});return e.forEach(function(e){return e.broadcastActive()}),e.length>0},e.prototype.connect_=function(){vr&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),xr?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){vr&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,i=void 0===t?"":t;wr.some(function(e){return!!~i.indexOf(e)})&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),Sr=function(e,t){for(var i=0,s=Object.keys(t);i<s.length;i++){var a=s[i];Object.defineProperty(e,a,{value:t[a],enumerable:!1,writable:!1,configurable:!0})}return e},Er=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||yr},Pr=Rr(0,0,0,0);function Tr(e){return parseFloat(e)||0}function Lr(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return t.reduce(function(t,i){return t+Tr(e["border-"+i+"-width"])},0)}function Cr(e){var t=e.clientWidth,i=e.clientHeight;if(!t&&!i)return Pr;var s=Er(e).getComputedStyle(e),a=function(e){for(var t={},i=0,s=["top","right","bottom","left"];i<s.length;i++){var a=s[i],r=e["padding-"+a];t[a]=Tr(r)}return t}(s),r=a.left+a.right,n=a.top+a.bottom,o=Tr(s.width),d=Tr(s.height);if("border-box"===s.boxSizing&&(Math.round(o+r)!==t&&(o-=Lr(s,"left","right")+r),Math.round(d+n)!==i&&(d-=Lr(s,"top","bottom")+n)),!function(e){return e===Er(e).document.documentElement}(e)){var l=Math.round(o+r)-t,c=Math.round(d+n)-i;1!==Math.abs(l)&&(o-=l),1!==Math.abs(c)&&(d-=c)}return Rr(a.left,a.top,o,d)}var _r="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof Er(e).SVGGraphicsElement}:function(e){return e instanceof Er(e).SVGElement&&"function"==typeof e.getBBox};function Ar(e){return vr?_r(e)?function(e){var t=e.getBBox();return Rr(0,0,t.width,t.height)}(e):Cr(e):Pr}function Rr(e,t,i,s){return{x:e,y:t,width:i,height:s}}var Ir=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Rr(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=Ar(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),Dr=function(e,t){var i,s,a,r,n,o,d,l=(s=(i=t).x,a=i.y,r=i.width,n=i.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,d=Object.create(o.prototype),Sr(d,{x:s,y:a,width:r,height:n,top:a,right:s+r,bottom:n+a,left:s}),d);Sr(this,{target:e,contentRect:l})},Mr=function(){function e(e,t,i){if(this.activeObservations_=[],this.observations_=new mr,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=i}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof Er(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new Ir(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof Er(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach(function(t){t.isActive()&&e.activeObservations_.push(t)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map(function(e){return new Dr(e.target,e.broadcastRect())});this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),Or="undefined"!=typeof WeakMap?new WeakMap:new mr,Ur=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var i=kr.getInstance(),s=new Mr(t,i,this);Or.set(this,s)};["observe","unobserve","disconnect"].forEach(function(e){Ur.prototype[e]=function(){var t;return(t=Or.get(this))[e].apply(t,arguments)}});var $r=void 0!==yr.ResizeObserver?yr.ResizeObserver:Ur;const Fr=["top","right","bottom","left"],Nr=["start","end"],jr=Fr.reduce((e,t)=>e.concat(t,t+"-"+Nr[0],t+"-"+Nr[1]),[]),zr=Math.min,Br=Math.max,Gr=Math.round,Hr=e=>({x:e,y:e}),Vr={left:"right",right:"left",bottom:"top",top:"bottom"},qr={start:"end",end:"start"};function Kr(e,t,i){return Br(e,zr(t,i))}function Yr(e,t){return"function"==typeof e?e(t):e}function Wr(e){return e.split("-")[0]}function Zr(e){return e.split("-")[1]}function Qr(e){return"x"===e?"y":"x"}function Xr(e){return"y"===e?"height":"width"}function Jr(e){return["top","bottom"].includes(Wr(e))?"y":"x"}function en(e){return Qr(Jr(e))}function tn(e,t,i){void 0===i&&(i=!1);const s=Zr(e),a=en(e),r=Xr(a);let n="x"===a?s===(i?"end":"start")?"right":"left":"start"===s?"bottom":"top";return t.reference[r]>t.floating[r]&&(n=an(n)),[n,an(n)]}function sn(e){return e.replace(/start|end/g,e=>qr[e])}function an(e){return e.replace(/left|right|bottom|top/g,e=>Vr[e])}function rn(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function nn(e){const{x:t,y:i,width:s,height:a}=e;return{width:s,height:a,top:i,left:t,right:t+s,bottom:i+a,x:t,y:i}}function on(e,t,i){let{reference:s,floating:a}=e;const r=Jr(t),n=en(t),o=Xr(n),d=Wr(t),l="y"===r,c=s.x+s.width/2-a.width/2,h=s.y+s.height/2-a.height/2,p=s[o]/2-a[o]/2;let u;switch(d){case"top":u={x:c,y:s.y-a.height};break;case"bottom":u={x:c,y:s.y+s.height};break;case"right":u={x:s.x+s.width,y:h};break;case"left":u={x:s.x-a.width,y:h};break;default:u={x:s.x,y:s.y}}switch(Zr(t)){case"start":u[n]-=p*(i&&l?-1:1);break;case"end":u[n]+=p*(i&&l?-1:1)}return u}async function dn(e,t){var i;void 0===t&&(t={});const{x:s,y:a,platform:r,rects:n,elements:o,strategy:d}=e,{boundary:l="clippingAncestors",rootBoundary:c="viewport",elementContext:h="floating",altBoundary:p=!1,padding:u=0}=Yr(t,e),g=rn(u),f=o[p?"floating"===h?"reference":"floating":h],m=nn(await r.getClippingRect({element:null==(i=await(null==r.isElement?void 0:r.isElement(f)))||i?f:f.contextElement||await(null==r.getDocumentElement?void 0:r.getDocumentElement(o.floating)),boundary:l,rootBoundary:c,strategy:d})),v="floating"===h?{x:s,y:a,width:n.floating.width,height:n.floating.height}:n.reference,y=await(null==r.getOffsetParent?void 0:r.getOffsetParent(o.floating)),b=await(null==r.isElement?void 0:r.isElement(y))&&await(null==r.getScale?void 0:r.getScale(y))||{x:1,y:1},w=nn(r.convertOffsetParentRelativeRectToViewportRelativeRect?await r.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:v,offsetParent:y,strategy:d}):v);return{top:(m.top-w.top+g.top)/b.y,bottom:(w.bottom-m.bottom+g.bottom)/b.y,left:(m.left-w.left+g.left)/b.x,right:(w.right-m.right+g.right)/b.x}}function ln(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function cn(e){return Fr.some(t=>e[t]>=0)}function hn(){return"undefined"!=typeof window}function pn(e){return fn(e)?(e.nodeName||"").toLowerCase():"#document"}function un(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function gn(e){var t;return null==(t=(fn(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function fn(e){return!!hn()&&(e instanceof Node||e instanceof un(e).Node)}function mn(e){return!!hn()&&(e instanceof Element||e instanceof un(e).Element)}function vn(e){return!!hn()&&(e instanceof HTMLElement||e instanceof un(e).HTMLElement)}function yn(e){return!(!hn()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof un(e).ShadowRoot)}function bn(e){const{overflow:t,overflowX:i,overflowY:s,display:a}=Pn(e);return/auto|scroll|overlay|hidden|clip/.test(t+s+i)&&!["inline","contents"].includes(a)}function wn(e){return["table","td","th"].includes(pn(e))}function xn(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch(e){return!1}})}function kn(e){const t=Sn(),i=mn(e)?Pn(e):e;return["transform","translate","scale","rotate","perspective"].some(e=>!!i[e]&&"none"!==i[e])||!!i.containerType&&"normal"!==i.containerType||!t&&!!i.backdropFilter&&"none"!==i.backdropFilter||!t&&!!i.filter&&"none"!==i.filter||["transform","translate","scale","rotate","perspective","filter"].some(e=>(i.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(i.contain||"").includes(e))}function Sn(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function En(e){return["html","body","#document"].includes(pn(e))}function Pn(e){return un(e).getComputedStyle(e)}function Tn(e){return mn(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ln(e){if("html"===pn(e))return e;const t=e.assignedSlot||e.parentNode||yn(e)&&e.host||gn(e);return yn(t)?t.host:t}function Cn(e){const t=Ln(e);return En(t)?e.ownerDocument?e.ownerDocument.body:e.body:vn(t)&&bn(t)?t:Cn(t)}function _n(e,t,i){var s;void 0===t&&(t=[]);const a=Cn(e),r=a===(null==(s=e.ownerDocument)?void 0:s.body),n=un(a);return r?(An(n),t.concat(n,n.visualViewport||[],bn(a)?a:[],[])):t.concat(a,_n(a,[]))}function An(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Rn(e){const t=Pn(e);let i=parseFloat(t.width)||0,s=parseFloat(t.height)||0;const a=vn(e),r=a?e.offsetWidth:i,n=a?e.offsetHeight:s,o=Gr(i)!==r||Gr(s)!==n;return o&&(i=r,s=n),{width:i,height:s,$:o}}function In(e){return mn(e)?e:e.contextElement}function Dn(e){const t=In(e);if(!vn(t))return Hr(1);const i=t.getBoundingClientRect(),{width:s,height:a,$:r}=Rn(t);let n=(r?Gr(i.width):i.width)/s,o=(r?Gr(i.height):i.height)/a;return n&&Number.isFinite(n)||(n=1),o&&Number.isFinite(o)||(o=1),{x:n,y:o}}const Mn=Hr(0);function On(e){const t=un(e);return Sn()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Mn}function Un(e,t,i,s){void 0===t&&(t=!1),void 0===i&&(i=!1);const a=e.getBoundingClientRect(),r=In(e);let n=Hr(1);t&&(s?mn(s)&&(n=Dn(s)):n=Dn(e));const o=function(e,t,i){return void 0===t&&(t=!1),!(!i||t&&i!==un(e))&&t}(r,i,s)?On(r):Hr(0);let d=(a.left+o.x)/n.x,l=(a.top+o.y)/n.y,c=a.width/n.x,h=a.height/n.y;if(r){const e=un(r),t=s&&mn(s)?un(s):s;let i=e,a=An(i);for(;a&&s&&t!==i;){const e=Dn(a),t=a.getBoundingClientRect(),s=Pn(a),r=t.left+(a.clientLeft+parseFloat(s.paddingLeft))*e.x,n=t.top+(a.clientTop+parseFloat(s.paddingTop))*e.y;d*=e.x,l*=e.y,c*=e.x,h*=e.y,d+=r,l+=n,i=un(a),a=An(i)}}return nn({width:c,height:h,x:d,y:l})}function $n(e,t){const i=Tn(e).scrollLeft;return t?t.left+i:Un(gn(e)).left+i}function Fn(e,t,i){void 0===i&&(i=!1);const s=e.getBoundingClientRect();return{x:s.left+t.scrollLeft-(i?0:$n(e,s)),y:s.top+t.scrollTop}}function Nn(e,t,i){let s;if("viewport"===t)s=function(e,t){const i=un(e),s=gn(e),a=i.visualViewport;let r=s.clientWidth,n=s.clientHeight,o=0,d=0;if(a){r=a.width,n=a.height;const e=Sn();(!e||e&&"fixed"===t)&&(o=a.offsetLeft,d=a.offsetTop)}return{width:r,height:n,x:o,y:d}}(e,i);else if("document"===t)s=function(e){const t=gn(e),i=Tn(e),s=e.ownerDocument.body,a=Br(t.scrollWidth,t.clientWidth,s.scrollWidth,s.clientWidth),r=Br(t.scrollHeight,t.clientHeight,s.scrollHeight,s.clientHeight);let n=-i.scrollLeft+$n(e);const o=-i.scrollTop;return"rtl"===Pn(s).direction&&(n+=Br(t.clientWidth,s.clientWidth)-a),{width:a,height:r,x:n,y:o}}(gn(e));else if(mn(t))s=function(e,t){const i=Un(e,!0,"fixed"===t),s=i.top+e.clientTop,a=i.left+e.clientLeft,r=vn(e)?Dn(e):Hr(1);return{width:e.clientWidth*r.x,height:e.clientHeight*r.y,x:a*r.x,y:s*r.y}}(t,i);else{const i=On(e);s={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return nn(s)}function jn(e,t){const i=Ln(e);return!(i===t||!mn(i)||En(i))&&("fixed"===Pn(i).position||jn(i,t))}function zn(e,t,i){const s=vn(t),a=gn(t),r="fixed"===i,n=Un(e,!0,r,t);let o={scrollLeft:0,scrollTop:0};const d=Hr(0);function l(){d.x=$n(a)}if(s||!s&&!r)if(("body"!==pn(t)||bn(a))&&(o=Tn(t)),s){const e=Un(t,!0,r,t);d.x=e.x+t.clientLeft,d.y=e.y+t.clientTop}else a&&l();r&&!s&&a&&l();const c=!a||s||r?Hr(0):Fn(a,o);return{x:n.left+o.scrollLeft-d.x-c.x,y:n.top+o.scrollTop-d.y-c.y,width:n.width,height:n.height}}function Bn(e){return"static"===Pn(e).position}function Gn(e,t){if(!vn(e)||"fixed"===Pn(e).position)return null;if(t)return t(e);let i=e.offsetParent;return gn(e)===i&&(i=i.ownerDocument.body),i}function Hn(e,t){const i=un(e);if(xn(e))return i;if(!vn(e)){let t=Ln(e);for(;t&&!En(t);){if(mn(t)&&!Bn(t))return t;t=Ln(t)}return i}let s=Gn(e,t);for(;s&&wn(s)&&Bn(s);)s=Gn(s,t);return s&&En(s)&&Bn(s)&&!kn(s)?i:s||function(e){let t=Ln(e);for(;vn(t)&&!En(t);){if(kn(t))return t;if(xn(t))return null;t=Ln(t)}return null}(e)||i}const Vn={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:i,offsetParent:s,strategy:a}=e;const r="fixed"===a,n=gn(s),o=!!t&&xn(t.floating);if(s===n||o&&r)return i;let d={scrollLeft:0,scrollTop:0},l=Hr(1);const c=Hr(0),h=vn(s);if((h||!h&&!r)&&(("body"!==pn(s)||bn(n))&&(d=Tn(s)),vn(s))){const e=Un(s);l=Dn(s),c.x=e.x+s.clientLeft,c.y=e.y+s.clientTop}const p=!n||h||r?Hr(0):Fn(n,d,!0);return{width:i.width*l.x,height:i.height*l.y,x:i.x*l.x-d.scrollLeft*l.x+c.x+p.x,y:i.y*l.y-d.scrollTop*l.y+c.y+p.y}},getDocumentElement:gn,getClippingRect:function(e){let{element:t,boundary:i,rootBoundary:s,strategy:a}=e;const r=[..."clippingAncestors"===i?xn(t)?[]:function(e,t){const i=t.get(e);if(i)return i;let s=_n(e,[]).filter(e=>mn(e)&&"body"!==pn(e)),a=null;const r="fixed"===Pn(e).position;let n=r?Ln(e):e;for(;mn(n)&&!En(n);){const t=Pn(n),i=kn(n);i||"fixed"!==t.position||(a=null),(r?!i&&!a:!i&&"static"===t.position&&a&&["absolute","fixed"].includes(a.position)||bn(n)&&!i&&jn(e,n))?s=s.filter(e=>e!==n):a=t,n=Ln(n)}return t.set(e,s),s}(t,this._c):[].concat(i),s],n=r[0],o=r.reduce((e,i)=>{const s=Nn(t,i,a);return e.top=Br(s.top,e.top),e.right=zr(s.right,e.right),e.bottom=zr(s.bottom,e.bottom),e.left=Br(s.left,e.left),e},Nn(t,n,a));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}},getOffsetParent:Hn,getElementRects:async function(e){const t=this.getOffsetParent||Hn,i=this.getDimensions,s=await i(e.floating);return{reference:zn(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:s.width,height:s.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:i}=Rn(e);return{width:t,height:i}},getScale:Dn,isElement:mn,isRTL:function(e){return"rtl"===Pn(e).direction}},qn=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var i,s;const{x:a,y:r,placement:n,middlewareData:o}=t,d=await async function(e,t){const{placement:i,platform:s,elements:a}=e,r=await(null==s.isRTL?void 0:s.isRTL(a.floating)),n=Wr(i),o=Zr(i),d="y"===Jr(i),l=["left","top"].includes(n)?-1:1,c=r&&d?-1:1,h=Yr(t,e);let{mainAxis:p,crossAxis:u,alignmentAxis:g}="number"==typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return o&&"number"==typeof g&&(u="end"===o?-1*g:g),d?{x:u*c,y:p*l}:{x:p*l,y:u*c}}(t,e);return n===(null==(i=o.offset)?void 0:i.placement)&&null!=(s=o.arrow)&&s.alignmentOffset?{}:{x:a+d.x,y:r+d.y,data:{...d,placement:n}}}}},Kn=function(e){return void 0===e&&(e={}),{name:"autoPlacement",options:e,async fn(t){var i,s,a;const{rects:r,middlewareData:n,placement:o,platform:d,elements:l}=t,{crossAxis:c=!1,alignment:h,allowedPlacements:p=jr,autoAlignment:u=!0,...g}=Yr(e,t),f=void 0!==h||p===jr?function(e,t,i){return(e?[...i.filter(t=>Zr(t)===e),...i.filter(t=>Zr(t)!==e)]:i.filter(e=>Wr(e)===e)).filter(i=>!e||Zr(i)===e||!!t&&sn(i)!==i)}(h||null,u,p):p,m=await dn(t,g),v=(null==(i=n.autoPlacement)?void 0:i.index)||0,y=f[v];if(null==y)return{};const b=tn(y,r,await(null==d.isRTL?void 0:d.isRTL(l.floating)));if(o!==y)return{reset:{placement:f[0]}};const w=[m[Wr(y)],m[b[0]],m[b[1]]],x=[...(null==(s=n.autoPlacement)?void 0:s.overflows)||[],{placement:y,overflows:w}],k=f[v+1];if(k)return{data:{index:v+1,overflows:x},reset:{placement:k}};const S=x.map(e=>{const t=Zr(e.placement);return[e.placement,t&&c?e.overflows.slice(0,2).reduce((e,t)=>e+t,0):e.overflows[0],e.overflows]}).sort((e,t)=>e[1]-t[1]),E=(null==(a=S.filter(e=>e[2].slice(0,Zr(e[0])?2:3).every(e=>e<=0))[0])?void 0:a[0])||S[0][0];return E!==o?{data:{index:v+1,overflows:x},reset:{placement:E}}:{}}}},Yn=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:i,y:s,placement:a}=t,{mainAxis:r=!0,crossAxis:n=!1,limiter:o={fn:e=>{let{x:t,y:i}=e;return{x:t,y:i}}},...d}=Yr(e,t),l={x:i,y:s},c=await dn(t,d),h=Jr(Wr(a)),p=Qr(h);let u=l[p],g=l[h];if(r){const e="y"===p?"bottom":"right";u=Kr(u+c["y"===p?"top":"left"],u,u-c[e])}if(n){const e="y"===h?"bottom":"right";g=Kr(g+c["y"===h?"top":"left"],g,g-c[e])}const f=o.fn({...t,[p]:u,[h]:g});return{...f,data:{x:f.x-i,y:f.y-s,enabled:{[p]:r,[h]:n}}}}}},Wn=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var i,s;const{placement:a,middlewareData:r,rects:n,initialPlacement:o,platform:d,elements:l}=t,{mainAxis:c=!0,crossAxis:h=!0,fallbackPlacements:p,fallbackStrategy:u="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:f=!0,...m}=Yr(e,t);if(null!=(i=r.arrow)&&i.alignmentOffset)return{};const v=Wr(a),y=Jr(o),b=Wr(o)===o,w=await(null==d.isRTL?void 0:d.isRTL(l.floating)),x=p||(b||!f?[an(o)]:function(e){const t=an(e);return[sn(e),t,sn(t)]}(o)),k="none"!==g;!p&&k&&x.push(...function(e,t,i,s){const a=Zr(e);let r=function(e,t,i){const s=["left","right"],a=["right","left"],r=["top","bottom"],n=["bottom","top"];switch(e){case"top":case"bottom":return i?t?a:s:t?s:a;case"left":case"right":return t?r:n;default:return[]}}(Wr(e),"start"===i,s);return a&&(r=r.map(e=>e+"-"+a),t&&(r=r.concat(r.map(sn)))),r}(o,f,g,w));const S=[o,...x],E=await dn(t,m),P=[];let T=(null==(s=r.flip)?void 0:s.overflows)||[];if(c&&P.push(E[v]),h){const e=tn(a,n,w);P.push(E[e[0]],E[e[1]])}if(T=[...T,{placement:a,overflows:P}],!P.every(e=>e<=0)){var L,C;const e=((null==(L=r.flip)?void 0:L.index)||0)+1,t=S[e];if(t){if(!("alignment"===h&&y!==Jr(t))||T.every(e=>e.overflows[0]>0&&Jr(e.placement)===y))return{data:{index:e,overflows:T},reset:{placement:t}}}let i=null==(C=T.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:C.placement;if(!i)switch(u){case"bestFit":{var _;const e=null==(_=T.filter(e=>{if(k){const t=Jr(e.placement);return t===y||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:_[0];e&&(i=e);break}case"initialPlacement":i=o}if(a!==i)return{reset:{placement:i}}}return{}}}},Zn=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){const{rects:i}=t,{strategy:s="referenceHidden",...a}=Yr(e,t);switch(s){case"referenceHidden":{const e=ln(await dn(t,{...a,elementContext:"reference"}),i.reference);return{data:{referenceHiddenOffsets:e,referenceHidden:cn(e)}}}case"escaped":{const e=ln(await dn(t,{...a,altBoundary:!0}),i.floating);return{data:{escapedOffsets:e,escaped:cn(e)}}}default:return{}}}}},Qn=e=>({name:"arrow",options:e,async fn(t){const{x:i,y:s,placement:a,rects:r,platform:n,elements:o,middlewareData:d}=t,{element:l,padding:c=0}=Yr(e,t)||{};if(null==l)return{};const h=rn(c),p={x:i,y:s},u=en(a),g=Xr(u),f=await n.getDimensions(l),m="y"===u,v=m?"top":"left",y=m?"bottom":"right",b=m?"clientHeight":"clientWidth",w=r.reference[g]+r.reference[u]-p[u]-r.floating[g],x=p[u]-r.reference[u],k=await(null==n.getOffsetParent?void 0:n.getOffsetParent(l));let S=k?k[b]:0;S&&await(null==n.isElement?void 0:n.isElement(k))||(S=o.floating[b]||r.floating[g]);const E=w/2-x/2,P=S/2-f[g]/2-1,T=zr(h[v],P),L=zr(h[y],P),C=T,_=S-f[g]-L,A=S/2-f[g]/2+E,R=Kr(C,A,_),I=!d.arrow&&null!=Zr(a)&&A!==R&&r.reference[g]/2-(A<C?T:L)-f[g]/2<0,D=I?A<C?A-C:A-_:0;return{[u]:p[u]+D,data:{[u]:R,centerOffset:A-R-D,...I&&{alignmentOffset:D}},reset:I}}}),Xn=(e,t,i)=>{const s=new Map,a={platform:Vn,...i},r={...a.platform,_c:s};return(async(e,t,i)=>{const{placement:s="bottom",strategy:a="absolute",middleware:r=[],platform:n}=i,o=r.filter(Boolean),d=await(null==n.isRTL?void 0:n.isRTL(t));let l=await n.getElementRects({reference:e,floating:t,strategy:a}),{x:c,y:h}=on(l,s,d),p=s,u={},g=0;for(let i=0;i<o.length;i++){const{name:r,fn:f}=o[i],{x:m,y:v,data:y,reset:b}=await f({x:c,y:h,initialPlacement:s,placement:p,strategy:a,middlewareData:u,rects:l,platform:n,elements:{reference:e,floating:t}});c=null!=m?m:c,h=null!=v?v:h,u={...u,[r]:{...u[r],...y}},b&&g<=50&&(g++,"object"==typeof b&&(b.placement&&(p=b.placement),b.rects&&(l=!0===b.rects?await n.getElementRects({reference:e,floating:t,strategy:a}):b.rects),({x:c,y:h}=on(l,p,d))),i=-1)}return{x:c,y:h,placement:p,strategy:a,middlewareData:u}})(e,t,{...a,platform:r})},Jn=e=>e.map(e=>{switch(e.type){case"a":if("string"==typeof e.content)return t=e.content,z("a",{class:"link",href:t,target:"_blank",rel:"noopener noreferrer"},t);case"b":return(e=>z("b",null,"string"==typeof e?e:Jn(e)))(e.content);case"i":return(e=>z("i",null,"string"==typeof e?e:Jn(e)))(e.content);case"s":return(e=>"string"==typeof e?z("s",null,e):z("b",null,Jn(e)))(e.content);case"q":return z("span",{class:"block-quote"});default:return(e=>"string"==typeof e?e:z("p",null,Jn(e)))(e.content)}var t}),eo=({message:e})=>{const t=e.slice(0,Qi),i=Wi(t,!0),s=Zi(t);return z("p",null,0!==i.length&&z("blockquote",null,i.split("\n").map(e=>{const t=Ji(e);return z("p",null,Jn(t))})),s.split("\n").map(e=>{const t=Ji(e);return z("p",null,Jn(t))}))},to=console,io={joined:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3",left:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_join.mp3",message:"https://dyte-uploads.s3.ap-south-1.amazonaws.com/notification_message.mp3"};class so{constructor(e){this.meeting=e,this.audio=document.createElement("audio"),this.audio.volume=.3}play(e,t=3e3){var i;this.playing||(this.playing=!0,this.audio.src=io[e],this.audio.volume=.3,null===(i=this.audio.play())||void 0===i||i.catch(i=>{to.error("[dyte-notifications] play() failed\n",{sound:e,duration:t},i)}),setTimeout(()=>{this.playing=!1},t))}async setDevice(e){var t,i,s;ut(this.meeting)||await(null===(s=null===(i=null===(t=this.audio)||void 0===t?void 0:t.setSinkId)||void 0===i?void 0:i.call(t,e))||void 0===s?void 0:s.catch(e=>{to.error("[dyte-notifications] setSinkId() error\n",e)}))}}const ao=(e,t)=>{if(null==e)return;const i=Math.round(1.5),s=[...Array(3)].map((e,s)=>{let a=s;return a>i-1&&(a=3-a-1),Math.round((a+1)/(i+1)*t)}),{width:a,height:r}=e,n=e.getContext("2d");let o=2;const d=1*a/s.length,l=d-4;n.clearRect(0,0,a,r),n.fillStyle="rgb(0,0,0,0.0)",n.fillRect(0,0,a,r);const c=getComputedStyle(e).getPropertyValue("color");n.fillStyle=c,n.strokeStyle=c,n.lineCap="round",n.lineWidth=4,n.beginPath();for(const e of s){const t=Math.min(-Math.abs(1.2*e/10*r)+r/2,r/2-2.5),i=Math.max(2*(r/2-t),5);n.moveTo(o+l/2,t),n.lineTo(o+l/2,t+i),o+=d}n.stroke()};var ro=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const no=class{constructor(e){o(this,e),this.variant="bars",this.iconPack=Vt,this.t=Ht(),this.hideMuted=!1,this.isScreenShare=!1,this.volume=0}connectedCallback(){this.participantChanged(this.participant)}componentDidLoad(){ao(this.visualizer,0)}disconnectedCallback(){var e,t,i;null===(e=this.hark)||void 0===e||e.stop(),this.audioUpdateListener&&(null===(t=this.participant)||void 0===t||t.removeListener("audioUpdate",this.audioUpdateListener)),this.screenShareUpdateListener&&(null===(i=this.participant)||void 0===i||i.removeListener("screenShareUpdate",this.screenShareUpdateListener))}participantChanged(e){null!=e&&(this.audioUpdateListener=({audioEnabled:e,audioTrack:t})=>{var i;if(null===(i=this.hark)||void 0===i||i.stop(),e&&null!=t){this.audioEnabled=!0;const e=new MediaStream;e.addTrack(t),this.calcVolume(e),ao(this.visualizer,0)}else this.volume=0,this.audioEnabled=!1},this.isScreenShare?(this.screenShareUpdateListener=({screenShareEnabled:e,screenShareTracks:t})=>{this.audioUpdateListener({audioEnabled:e&&null!=t.audio,audioTrack:t.audio})},this.screenShareUpdateListener({screenShareEnabled:e.screenShareEnabled,screenShareTracks:{audio:e.screenShareTracks.audio,video:e.screenShareTracks.video}}),e.addListener("screenShareUpdate",this.screenShareUpdateListener)):(this.audioUpdateListener(e),e.addListener("audioUpdate",this.audioUpdateListener)))}calcVolume(e){this.hark=et(e,{play:!1,interval:100}),this.hark.on("volume_change",e=>{const t=this.volume;let i=Math.round(10**(e/115)*10);i<3&&(i=0);let s=Math.round((2*t+i)/3);t!==s&&(this.volume=s,ao(this.visualizer,this.volume))})}render(){return z(G,{key:"544351071e0d4766dcadb3b9a6b5c714b8c8a0c2"},z("div",{key:"d52567ede61844a23d21cbf32a7d185b0790f435",class:{hideMuted:this.hideMuted}},z("canvas",{key:"d9e71f8d75cae5465e661df0381c00d5b75e88a9",width:"24",height:"24",class:{bars:!0,visible:this.audioEnabled},ref:e=>this.visualizer=e,part:"canvas"}),!this.isScreenShare&&!this.audioEnabled&&!0!==this.hideMuted&&z("dyte-icon",{key:"107a86c8b02c044ba5e7a22a1d1dc6f250da9720",icon:this.iconPack.mic_off,part:"mic-off-icon"})))}static get watchers(){return{participant:["participantChanged"]}}};ro([si()],no.prototype,"size",void 0),ro([si()],no.prototype,"iconPack",void 0),ro([si()],no.prototype,"t",void 0),no.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block;width:-moz-fit-content;width:fit-content}.hideMuted{padding:var(--dyte-space-1, 4px)}canvas,dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}:host([size='sm']){transform:scale(0.9)}canvas{display:none}canvas.visible{display:block}canvas.bars{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}";var oo=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const lo=class{constructor(e){o(this,e),this.variant="circular",this.iconPack=Vt,this.t=Ht(),this.imageState="loading",this.getAvatar=()=>{var e;const t=oi((null===(e=this.participant)||void 0===e?void 0:e.name)||"");let i;if(null!=this.participant&&"picture"in this.participant&&(i=this.participant.picture),i&&i.length>0&&"errored"!==this.imageState)return z("div",{class:"image-ctr"},"loading"===this.imageState&&z("dyte-spinner",{iconPack:this.iconPack}),z("img",{src:i,class:{loaded:"loaded"===this.imageState},loading:"lazy",title:t,onLoad:()=>this.imageState="loaded",onError:()=>this.imageState="errored",part:"image"}));const s=ci(t);return z("div",{class:"initials",title:t,part:"initials"},s)}}render(){return z(G,{key:"c57eb98421d28fbc9e6f8ddd9c7c0205c843aa81"},this.getAvatar(),z("slot",{key:"7e1e8618d0b077c1c4633804e06b602a474d3490"}))}};oo([si()],lo.prototype,"size",void 0),oo([si()],lo.prototype,"iconPack",void 0),oo([si()],lo.prototype,"t",void 0),lo.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:var(--dyte-space-32, 128px);width:var(--dyte-space-32, 128px);align-items:center;justify-content:center;font-size:28px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));overflow:clip;border-radius:9999px;-webkit-user-select:none;-moz-user-select:none;user-select:none}dyte-icon{height:50%;width:50%}.image-ctr{display:flex;height:100%;width:100%;align-items:center;justify-content:center;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}img{height:var(--dyte-space-0, 0px);width:var(--dyte-space-0, 0px);-o-object-fit:cover;object-fit:cover}img.loaded{height:100%;width:100%}.initials{display:flex;height:100%;width:100%;align-items:center;justify-content:center;text-transform:uppercase}.image{display:flex;height:100%;width:100%;align-items:center;justify-content:center}.image img{display:none;height:100%;width:100%;-o-object-fit:cover;object-fit:cover}.image img.loaded{display:block}:host([variant='hexagon']){border-radius:var(--dyte-border-radius-none, 0);clip-path:polygon(50% 0, 95% 25%, 95% 75%, 50% 100%, 5% 75%, 5% 25%)}:host([variant='square']){border-radius:var(--dyte-border-radius-none, 0);clip-path:polygon(0% 0%, 100% 0%, 100% 100%, 0% 100%)}:host([size='sm']){height:var(--dyte-space-14, 56px);width:var(--dyte-space-14, 56px);font-size:12px}:host([size='md']){height:var(--dyte-space-28, 112px);width:var(--dyte-space-28, 112px)}:host([size='lg']){height:var(--dyte-space-32, 128px);width:var(--dyte-space-32, 128px)}";var co=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const ho=class{constructor(e){o(this,e),this.onParticipantsAdd=W(this,"participantsAdd",7),this.onParticipantDelete=W(this,"participantDelete",7),this.onRoomJoin=W(this,"roomJoin",7),this.deleteRoom=W(this,"delete",7),this.updateRoom=W(this,"update",7),this.allowDelete=!0,this.iconPack=Vt,this.t=Ht(),this.isDragMode=!1,this.defaultExpanded=!1,this.editingTitleRoomId=null,this.newTitle=null,this.showExpandedCard=!1,this.glowingCard=!1,this.permissionsUpdateListener=()=>{this.permissions=this.meeting.self.permissions.connectedMeetings},this.reset=()=>{this.editingTitleRoomId=null,this.newTitle=null},this.onEditClick=()=>{if(this.editingTitleRoomId){if(this.newTitle.length<3)return;this.roomTitle=this.newTitle,this.updateRoom.emit({title:this.newTitle,id:this.editingTitleRoomId}),this.glowCard(),this.reset()}else this.editingTitleRoomId=this.room.id,P(()=>{this.inputTextEl.focus(),this.inputTextEl.select()})},this.onDrop=e=>{e.currentTarget instanceof HTMLParagraphElement&&(e.currentTarget.classList.remove("drop-zone-active"),this.onAssign())},this.onDragOver=e=>{e.currentTarget instanceof HTMLParagraphElement&&(e.currentTarget.classList.add("drop-zone-active"),e.preventDefault())}}connectedCallback(){var e;this.allParticipants=yt(this.meeting),this.permissionsUpdateListener(),this.showExpandedCard=this.defaultExpanded,this.roomTitle=this.room.isParent?this.t("breakout_rooms.main_room"):null===(e=this.room)||void 0===e?void 0:e.title,this.canEditMeetingTitle=this.permissions.canAlterConnectedMeetings&&!this.room.isParent&&!this.meeting.connectedMeetings.isActive,this.meeting.self.permissions.on("permissionsUpdate",this.permissionsUpdateListener)}disconnectedCallback(){this.meeting.self.permissions.off("permissionsUpdate",this.permissionsUpdateListener)}onDragLeave(e){e.currentTarget instanceof HTMLParagraphElement&&e.currentTarget.classList.remove("drop-zone-active")}getAssignmentHint(){return this.assigningParticipants&&this.isDragMode?this.t("breakout_rooms.drag_drop_participants"):this.assigningParticipants?this.t("breakout_rooms.click_drop_participants"):0===this.room.participants.length?this.t("breakout_rooms.none_assigned"):void 0}toggleCardDisplay(){this.showExpandedCard=!this.showExpandedCard}glowCard(){this.glowingCard=!0,setTimeout(()=>{this.glowingCard=!1},2e3)}onAssign(){this.onParticipantsAdd.emit(),this.glowCard()}onJoin(){this.onRoomJoin.emit()}onTitleChanged(e){"Enter"===e.key&&(this.newTitle=e.target.value,this.onEditClick())}renderPeer(e){const{displayPictureUrl:t}=this.allParticipants.find(t=>vt(t)===vt(e)),i=oi(e.displayName||"");return z("div",{class:"peer-ui-container"},z("dyte-avatar",{participant:{name:i,picture:t},size:"sm"}),z("p",{class:"name",title:i},ai(i,16),this.meeting.self.userId===e.id&&` (${this.t("you")})`))}renderExpandedCardMaybe(){if(this.showExpandedCard&&!this.room.isParent&&this.getAssignmentHint()&&this.permissions.canAlterConnectedMeetings)return z("div",{class:"message-container"},z("p",{class:{"compact-height":0!==this.room.participants.length},onClick:()=>this.onAssign(),onDragOver:this.onDragOver,onDragLeave:this.onDragLeave,onDrop:this.onDrop},this.getAssignmentHint()))}renderParticipantsMaybe(){if(this.showExpandedCard&&!this.room.isParent&&0!==this.room.participants.length)return z("div",{class:"participant-list",onClick:()=>{this.onAssign()}},this.room.participants.map(e=>z("div",{class:"participant-item",role:"listitem",key:e.id},this.renderPeer(e),this.permissions.canAlterConnectedMeetings&&z("dyte-icon",{class:"show-on-hover",icon:this.iconPack.dismiss,onClick:()=>{this.onParticipantDelete.emit(e)}}))))}render(){var e,t,i;return z(G,{key:"55d8c00978d9710c5bedd9ab0e34ba18afa50733"},z("div",{key:"a82630203869a94d2ecc4e33103ada61eedb19bc",class:{"assign-mode":this.assigningParticipants,"selector-mode":!this.assigningParticipants,"glowing-card":this.glowingCard}},z("div",{key:"d6286509a9917de384d80648d5171f94851906b9",class:"header"},z("input",{key:"76304ed7452bfac9e03998578c8ffb8ea03b82fb",ref:e=>this.inputTextEl=e,placeholder:this.t("breakout_rooms.room_name"),disabled:!(this.editingTitleRoomId===this.room.id),value:this.roomTitle,minlength:3,onChange:e=>{this.newTitle=e.target.value},onKeyPress:e=>this.onTitleChanged(e),class:{"editing-enabled":this.editingTitleRoomId===this.room.id},style:{width:`${this.roomTitle.length+1}ch`}}),this.editingTitleRoomId!==this.room.id&&z("span",{key:"4f31320550907e0dcb44f31b4b929167795a1850",class:"participant-count"},"(",z("dyte-icon",{key:"697420b64dd947349e736ac381a526a1f340606f",icon:this.iconPack.people}),null!==(i=null===(t=null===(e=this.room)||void 0===e?void 0:e.participants)||void 0===t?void 0:t.length)&&void 0!==i?i:"0",")"),this.canEditMeetingTitle&&z("dyte-tooltip",{key:"3e826e83ac09e69b1c90c4f6e0e7c93638a1eed1",label:this.editingTitleRoomId===this.room.id?this.t("breakout_rooms.save_room_name"):this.t("breakout_rooms.edit_room_name")},z("dyte-icon",{key:"8735226fb881ad3b06d4130e8ec51a85c037949b",icon:this.editingTitleRoomId===this.room.id?this.iconPack.checkmark:this.iconPack.edit,class:"show-on-hover",onClick:this.onEditClick})),z("div",{key:"e06e9e8f30ebdbeb3cb16dfb2c3fc23822f13187",class:"rooms-container"},this.permissions.canAlterConnectedMeetings&&!this.room.isParent&&this.allowDelete&&z("dyte-tooltip",{key:"30b872574e985b00191d277e3e2ed0d75a3291a1",label:this.t("breakout_rooms.delete"),class:"danger"},z("dyte-icon",{key:"2c92407f1589e22a9198594f5c3d7cb2cf345521",icon:this.iconPack.delete,class:"show-on-hover",onClick:()=>{this.deleteRoom.emit()}})),this.assigningParticipants&&this.permissions.canAlterConnectedMeetings&&!this.room.isParent&&z("dyte-button",{key:"2e1bae37a6410fecf22228b16cbbcd744972c41f",kind:"button",variant:"ghost",class:"assign-button",size:"md",onClick:()=>this.onAssign()},this.t("breakout_rooms.assign")),"edit"===this.mode&&!this.assigningParticipants&&this.permissions.canSwitchConnectedMeetings&&z("dyte-button",{key:"ebf98a4e34ece75f1fe8fe41e8884d9d6e1e8292",kind:"button",variant:"ghost",class:"assign-button",size:"md",disabled:this.room.id===this.meeting.meta.meetingId,onClick:()=>this.onJoin()},this.room.id===this.meeting.meta.meetingId?this.t("joined"):this.t("join")),!this.room.isParent&&z("dyte-icon",{key:"fd3ce5aaae760638a9d32ac306be26f248cbd947",icon:this.showExpandedCard?this.iconPack.chevron_up:this.iconPack.chevron_down,onClick:()=>this.toggleCardDisplay()}))),this.renderExpandedCardMaybe(),this.renderParticipantsMaybe()))}};co([si()],ho.prototype,"meeting",void 0),co([si()],ho.prototype,"states",void 0),co([si()],ho.prototype,"iconPack",void 0),co([si()],ho.prototype,"t",void 0),ho.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));border-radius:var(--dyte-border-radius-sm, 4px)}@keyframes bg-glow{25%{background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / 0.2)}50%{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}75%{background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / 0.2)}}.glowing-card{animation:bg-glow 0.8s}.selector-mode,.assign-mode{display:flex;flex-direction:column;align-items:center;padding:var(--dyte-space-2, 8px);cursor:pointer}.selector:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.show-on-hover{display:none}.header{width:100%;display:flex;align-items:center}.header dyte-icon{margin-left:var(--dyte-space-2, 8px);height:var(--dyte-space-5, 20px);cursor:pointer}.header .danger{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}.header .hide{display:none}.header .rooms-container{display:flex;flex-grow:1;flex-direction:row;align-items:center;justify-content:flex-end}.header input{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));padding:var(--dyte-space-1, 4px);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));max-width:var(--dyte-space-36, 144px);font-size:14px;font-weight:500;border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;outline:2px solid transparent;outline-offset:2px;border-bottom-width:var(--dyte-border-width-sm, 1px);border-style:solid;--tw-border-opacity:1;border-bottom-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-border-opacity))}.header input:disabled{overflow-x:visible;border-radius:var(--dyte-border-radius-none, 0);border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent}.header input:invalid{border-bottom-width:var(--dyte-border-width-sm, 1px);border-style:dashed;--tw-border-opacity:1;border-bottom-color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-border-opacity))}.header input.editing-enabled{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}.header .participant-count{display:flex;align-items:center;font-size:14px;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.header .participant-count dyte-icon{margin:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-0\\.5, 2px);width:var(--dyte-space-3, 12px)}.header .assign-button{height:var(--dyte-space-6, 24px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity));text-decoration-line:underline}.header .assign-button:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.participant-list{display:grid;flex-grow:1;grid-template-columns:repeat(2, minmax(0, 1fr));gap:var(--dyte-space-2, 8px);margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);width:100%;border-radius:var(--dyte-border-radius-sm, 4px)}.participant-list::-webkit-scrollbar{width:var(--dyte-space-1\\.5, 6px)}.participant-list::-webkit-scrollbar-thumb{border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.participant-list::-webkit-scrollbar-track{border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.participant-item{display:flex;align-items:center;justify-content:space-between;margin-right:var(--dyte-space-2, 8px);height:-moz-fit-content;height:fit-content;padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px)}.participant-item:hover{border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.selector-mode:hover .show-on-hover{display:flex}.message-container{margin:var(--dyte-space-0, 0px);display:flex;width:100%;padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px)}.message-container p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0, 0px);height:var(--dyte-space-20, 80px);display:flex;width:100%;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);font-size:12px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));border-style:dashed;--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-border-opacity))}.message-container p:hover{--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-border-opacity));background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / 0.25)}.message-container .drop-zone-active{--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-border-opacity));background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / 0.25)}dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}.show-on-hover{margin-left:var(--dyte-space-4, 16px);height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);display:none}:host(:hover) .show-on-hover{display:flex}.peer-ui-container{position:relative;display:flex;align-items:center;gap:var(--dyte-space-2, 8px);height:var(--dyte-space-10, 40px);cursor:pointer;border-radius:var(--dyte-border-radius-sm, 4px);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.peer-ui-container dyte-avatar{height:var(--dyte-space-7, 28px);width:var(--dyte-space-7, 28px);font-size:14px;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.peer-ui-container .name{font-size:14px;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}";var po=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const uo=class{constructor(e){o(this,e),this.onSelectedParticipantsUpdate=W(this,"selectedParticipantsUpdate",7),this.onAllToggled=W(this,"allParticipantsToggleUpdate",7),this.onParticipantsDragging=W(this,"participantsDragging",7),this.participantIds=[],this.iconPack=Vt,this.t=Ht(),this.search="",this.participantsToShow=[],this.selectedParticipantIds=[],this.isDragging=!1,this.onSearchInput=e=>{this.search=e.target.value},this.onDragStart=e=>{this.isDragging=!0,this.onParticipantsDragging.emit(!0),this.updateSelectedParticipants(e,!0)},this.onDragEnd=e=>{this.isDragging=!1,this.onParticipantsDragging.emit(!1),this.updateSelectedParticipants(e,!1)},this.onClick=e=>{const t=this.selectedParticipantIds.includes(vt(e));this.updateSelectedParticipants(e,!t)},this.onToggleAll=e=>{const t=e?this.participantsToShow.map(vt):[];this.onAllToggled.emit(t)}}connectedCallback(){this.meetingChanged(this.meeting),this.searchChanged(this.search)}disconnectedCallback(){this.meeting}updateSelectedParticipants(e,t){const i=vt(e);let s=[];s=t&&!this.selectedParticipantIds.includes(i)?[...this.selectedParticipantIds,i]:[...this.selectedParticipantIds.filter(e=>e!==i)],this.onSelectedParticipantsUpdate.emit(s)}meetingChanged(e){null!=e&&this.getParticipants(this.search)}participantsChanged(){this.getParticipants(this.search)}searchChanged(e){this.getParticipants(e)}getParticipants(e){const t=yt(this.meeting);this.participantsToShow=t.filter(t=>{var i;return this.participantIds.includes(vt(t))&&(null!==(i=t.displayName)&&void 0!==i?i:"").toLowerCase().includes(e.toLowerCase())})}renderPeer(e){const t=oi(e.displayName||"");return z("div",{class:"peer-ui-container"},z("dyte-avatar",{participant:{name:e.displayName,picture:e.displayPictureUrl},size:"sm"}),z("p",{class:"name",title:t},ai(t,16),this.meeting.self.userId===e.id&&` (${this.t("you")})`))}render(){return z(G,{key:"f2d84e849f539e0c6fc709258c280894ed33bf03"},z("div",{key:"7a837d42639e0577ec6a263ad8551b7ad0d26178",class:"search-wrapper"},z("div",{key:"3297c0dd3654ebfc017bac54b0b88f3703894456",class:"search",part:"search"},z("dyte-icon",{key:"3703973e874502d500aa1e814bce881f6731e132",icon:this.iconPack.search,part:"search-icon",class:"search-icon"}),z("input",{key:"3a3ad70f36122385f7da50c018d2e326c0d37e5e",type:"search",autocomplete:"off",placeholder:this.t("search"),onInput:this.onSearchInput,part:"search-input"})),z("slot",{key:"94570b18dbed22c304a86f571e7eb3a58a341d2e",name:"shuffle-button"})),z("div",{key:"1945693901357dbcb608199c9ed460745390ab03",class:"header"},z("div",{key:"3929f5c2d37a6a60f8b21345535420ea5cc30d9e",class:"title-wrapper"},z("span",{key:"fdcda41de05fc7a6cc1ce40af7d6b1a3d891e551"},this.t("breakout_rooms.main_room")),z("span",{key:"67730b14ab4b77e2d5f469ffeb187d631793bddb",class:"participant-count"},"(",z("dyte-icon",{key:"19d758f1f0bee73b1100754a7f4d369592f60bd2",icon:this.iconPack.people}),this.participantsToShow.length,")")),0!==this.selectedParticipantIds.length&&z("dyte-tooltip",{key:"47eff73a22c4471e3f5c44bda4b966f2b3ad5e44",label:this.t("breakout_rooms.select_all")},z("input",{key:"d180c3d5f879b263de54b7d449cf88b00dbfe1d7",type:"checkbox",checked:this.selectedParticipantIds.length===this.participantsToShow.length,onChange:e=>this.onToggleAll(!!e.target.checked)}))),z("div",{key:"33ea623c6378203774429d0964e35af32a4541d0",class:"ctr scrollbar",part:"container"},this.participantsToShow.length>0&&z("ul",{key:"89e4e47c8d67cac9eda4d3f6e4aab9cfa9fbede2",class:"participants",part:"participants"},this.participantsToShow.map(e=>z("li",{class:{"participant-item":!0,dragging:this.isDragging},onClick:()=>this.onClick(e),onDragStart:()=>this.onDragStart(e),onDragEnd:()=>this.onDragEnd(e),draggable:0===this.selectedParticipantIds.length,role:"listitem",key:e.id},this.renderPeer(e),!this.isDragging&&z("input",{type:"checkbox",class:{"hide-checkbox":0===this.selectedParticipantIds.length},checked:this.selectedParticipantIds.includes(vt(e))})))),0===this.participantsToShow.length&&this.search.length>0&&z("div",{key:"749a308a9fd64ebf4d0a0d92dee2cf1e03f6c3b9",class:"empty-message"},this.t("participants.errors.empty_results")),0===this.participantsToShow.length&&0===this.search.length&&z("div",{key:"0bc4d11ad0d47d5222ed886963888481aa21d1af",class:"empty-room"},z("dyte-icon",{key:"75fb66ad3077eaf45ea103147b7f74620d9bb2a7",icon:this.iconPack.people_checked,part:"search-icon",class:"search-icon"}),z("p",{key:"b94340bb40d335b1f5833c105b22c348c4e13cf6"},this.t("breakout_rooms.all_assigned")),z("span",{key:"807499efca10da51093eec42229356cd5acce1ec"},this.t("breakout_rooms.empty_main_room")))))}static get watchers(){return{meeting:["meetingChanged"],participantIds:["participantsChanged"],search:["searchChanged"]}}};po([si()],uo.prototype,"meeting",void 0),po([si()],uo.prototype,"iconPack",void 0),po([si()],uo.prototype,"t",void 0),uo.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{display:flex;height:100%;flex-direction:column;font-size:14px}:host input[type='checkbox']{margin:var(--dyte-space-0, 0px);cursor:pointer;-webkit-appearance:none;-moz-appearance:none;appearance:none;border-radius:var(--dyte-border-radius-sm, 4px);position:relative;height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);border-width:var(--dyte-border-width-sm, 1px);border-style:solid;border-color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}:host input[type='checkbox']:checked{--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-border-opacity));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity))}:host input[type='checkbox']:checked::before{position:absolute;top:1px;left:1px;height:var(--dyte-space-3, 12px);width:var(--dyte-space-3, 12px);background-color:rgb(var(--dyte-colors-text-1000, 255 255 255));content:'';clip-path:polygon(5% 60%, 35% 93%, 100% 19%, 86% 4%, 36% 62%, 19% 44%)}*{box-sizing:border-box}.participants{margin-top:var(--dyte-space-2, 8px);padding:var(--dyte-space-0, 0px)}.ctr{box-sizing:border-box;padding-top:var(--dyte-space-0, 0px);padding-bottom:var(--dyte-space-0, 0px);overflow-y:auto;flex-grow:1;flex-basis:0}.empty-message{margin-top:var(--dyte-space-10, 40px);margin-bottom:var(--dyte-space-10, 40px);text-align:center;font-size:14px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.empty-room{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:var(--dyte-space-2, 8px);height:100%;text-align:center;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.empty-room dyte-icon{height:var(--dyte-space-7, 28px);width:var(--dyte-space-7, 28px)}.empty-room p{font-size:16px;font-weight:500;margin:var(--dyte-space-0, 0px)}.empty-room span{font-size:12px;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}.search-wrapper{margin-bottom:var(--dyte-space-1, 4px);display:flex;align-items:center;gap:var(--dyte-space-2, 8px)}.search{position:sticky;box-sizing:border-box;display:flex;align-items:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0, 0px);height:var(--dyte-space-8, 32px)}.search .search-icon{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}.search input{box-sizing:border-box;width:100%;padding-right:var(--dyte-space-2, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:inherit;color:rgb(var(--dyte-colors-text-1000, 255 255 255));outline:2px solid transparent;outline-offset:2px;border-radius:var(--dyte-border-radius-sm, 4px);font-size:14px}.search input::-moz-placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.search input::placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.header{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-1\\.5, 6px);height:var(--dyte-space-9, 36px);padding-top:var(--dyte-space-3, 12px);padding-bottom:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-0\\.5, 2px);border-bottom-width:var(--dyte-border-width-sm, 1px);border-top-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-none, 0);border-left-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-bottom-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-border-opacity));font-size:12px;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));display:flex;align-items:center;justify-content:space-between}.title-wrapper{display:flex;align-items:center;gap:var(--dyte-space-2, 8px)}.participant-count{display:flex;align-items:center;font-size:14px}.participant-count dyte-icon{margin-right:var(--dyte-space-0\\.5, 2px);width:var(--dyte-space-3, 12px)}.participant-item{display:flex;align-items:center;justify-content:space-between;margin-top:var(--dyte-space-1, 4px);margin-bottom:var(--dyte-space-1, 4px);border-radius:var(--dyte-border-radius-sm, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);cursor:pointer}.participant-item input.hide-checkbox{display:none}.participant-item input:checked{display:inline-block}.dragging input{display:none}.participant-item:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.participant-item:hover input{display:inline-block}.peer-ui-container{position:relative;display:flex;align-items:center;gap:var(--dyte-space-2, 8px);height:var(--dyte-space-10, 40px);cursor:pointer;border-radius:var(--dyte-border-radius-sm, 4px);color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.peer-ui-container dyte-avatar{height:var(--dyte-space-7, 28px);width:var(--dyte-space-7, 28px);font-size:14px;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.peer-ui-container .name{font-size:14px;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}";var go=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const fo=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.loading=!1,this.roomConfig={rooms:2,step:"room-config",mode:"create",applyingChanges:!1},this.assigningParticipants=!1,this.selectedParticipants=[],this.ephemeralStatusText="",this.isDragMode=!1,this.iconPack=Vt,this.t=Ht(),this.permissionsUpdateListener=()=>{this.permissions=this.meeting.self.permissions.connectedMeetings},this.updateLocalState=e=>{this.stateManager.updateCurrentState(e),this.draftState=this.stateManager.currentState,this.meeting.connectedMeetings.isActive&&(this.roomConfig=Object.assign(Object.assign({},this.roomConfig),{mode:"edit"})),"create"!==this.roomConfig.mode||this.meeting.connectedMeetings.isActive||(gt=0),["edit","view"].includes(this.roomConfig.mode)&&(this.roomConfig=Object.assign(Object.assign({},this.roomConfig),{rooms:e.meetings.length,step:"participants-config"}),this.selectedParticipants=[])},this.onAddNewRoom=()=>{this.stateManager.addNewMeeting(),this.draftState=this.stateManager.currentState,this.selectorRef.scrollTo({top:this.selectorRef.scrollHeight,behavior:"smooth"})},this.onRoomUpdate=e=>{const{detail:t}=e;this.stateManager.updateMeetingTitle(t.id,t.title),this.draftState=this.stateManager.currentState},this.onRoomDelete=e=>{this.stateManager.allConnectedMeetings.find(t=>t.id===e)&&(this.stateManager.deleteMeeting(e),this.draftState=this.stateManager.currentState)},this.unassignParticipant=e=>{this.stateManager.unassignParticipants([e]),this.draftState=this.stateManager.currentState},this.onUnassignAll=()=>{this.stateManager.unassignAllParticipants(),this.draftState=this.stateManager.currentState},this.assignParticipantsToRoom=e=>{0!==this.selectedParticipants.length&&0!=this.assigningParticipants&&(this.stateManager.assignParticipantsToMeeting(this.selectedParticipants,e),this.draftState=this.stateManager.currentState,this.selectedParticipants=[],this.assigningParticipants=!1,this.setEphemeralStatus(this.t("breakout_rooms.ephemeral_status.participants_assigned")))},this.handleClose=(e,t)=>{e.emit({activeBreakoutRoomsManager:{active:!0}}),t.activeBreakoutRoomsManager={active:!0}},this.enableConfirmationModal=(e="start-breakout")=>{let t={active:!0,header:"breakout_rooms.confirm_modal.start_breakout.header",content:"breakout_rooms.confirm_modal.start_breakout.content",variant:"primary",cancelText:"breakout_rooms.confirm_modal.start_breakout.cancelText",ctaText:"breakout_rooms.confirm_modal.start_breakout.ctaText",onClick:()=>this.applyChanges(),onClose:this.handleClose};"close-breakout"===e&&(t={active:!0,header:"breakout_rooms.confirm_modal.close_breakout.header",content:"breakout_rooms.confirm_modal.close_breakout.content",variant:"danger",cancelText:"cancel",ctaText:"breakout_rooms.confirm_modal.close_breakout.ctaText",onClick:()=>this.closeBreakout(),onClose:this.handleClose}),this.stateUpdate.emit({activeBreakoutRoomsManager:{active:!1},activeConfirmationModal:t})},this.close=()=>{this.stateManager.discardChanges(),this.stateUpdate.emit({activeBreakoutRoomsManager:{active:!1}})},this.applyChanges=async()=>{this.roomConfig=Object.assign(Object.assign({},this.roomConfig),{applyingChanges:!0}),await this.stateManager.applyChanges(this.meeting),this.close(),this.roomConfig=Object.assign(Object.assign({},this.roomConfig),{applyingChanges:!1})}}onSelectedParticipantsChanged(e){e.length>0?this.assigningParticipants=!0:this.assigningParticipants=!1}connectedCallback(){this.permissionsUpdateListener(),this.meeting.connectedMeetings.on("stateUpdate",this.updateLocalState),this.meeting.connectedMeetings.on("changingMeeting",this.close),this.meeting.self.permissions.on("permissionsUpdate",this.permissionsUpdateListener),this.stateManager=new $t,this.fetchRoomState()}disconnectedCallback(){this.meeting.connectedMeetings.off("stateUpdate",this.updateLocalState),this.meeting.connectedMeetings.off("changingMeeting",this.close),this.meeting.self.permissions.off("permissionsUpdate",this.permissionsUpdateListener)}async fetchRoomState(){this.loading=!0,await this.meeting.connectedMeetings.getConnectedMeetings(),this.loading=!1}setEphemeralStatus(e){this.ephemeralStatusText=e,setTimeout(()=>{this.ephemeralStatusText=""},3e3)}onCreateRooms(){this.selectedParticipants=[],this.stateManager.addNewMeetings(this.roomConfig.rooms),this.draftState=this.stateManager.currentState,this.roomConfig=Object.assign(Object.assign({},this.roomConfig),{step:"participants-config"})}onParticipantDelete(e){const{detail:t}=e,i=vt(t);null!=i&&this.unassignParticipant(i)}toggleDragMode(e){this.isDragMode=e.detail}assignParticipantsRandomly(){0!==this.stateManager.unassignedParticipants.length&&(this.stateManager.assignParticipantsRandomly(),this.draftState=this.stateManager.currentState,this.setEphemeralStatus(this.t("breakout_rooms.ephemeral_status.participants_assigned_randomly")))}async joinRoom(e){const t=vt(this.meeting.self);this.stateManager.assignParticipantsToMeeting([t],e),await this.applyChanges()}async closeBreakout(){this.stateManager.allConnectedMeetings.forEach(e=>this.stateManager.deleteMeeting(e.id)),await this.applyChanges()}updateSelectedParticipants(e){this.selectedParticipants=e.detail}updateAllParticipants(e){this.selectedParticipants=e.detail}getStatusText(){if(""!==this.ephemeralStatusText)return this.ephemeralStatusText;let e="";return"create"===this.roomConfig.mode&&(e=this.t("breakout_rooms.status.assign_multiple"),0!==this.selectedParticipants.length&&(e=this.t("breakout_rooms.status.select_room"))),e}getApproxDistribution(){const e=this.stateManager.unassignedParticipants.length/(this.roomConfig.rooms||1);return Math.max(1,Math.round(e))}deselectAll(){this.selectedParticipants=[]}async discardChanges(){this.stateManager.discardChanges(),await this.fetchRoomState(),this.setEphemeralStatus(this.t("breakout_rooms.ephemeral_status.changes_discarded"))}shouldShowOnlyRoomSwitcher(){return!1===this.permissions.canAlterConnectedMeetings}getPermittedRooms(){return this.permissions.canAlterConnectedMeetings||this.permissions.canSwitchConnectedMeetings?this.stateManager.allConnectedMeetings:this.stateManager.allConnectedMeetings.filter(e=>e.id===this.meeting.meta.meetingId)}renderMainRoomMaybe(){return this.meeting.connectedMeetings.isActive&&this.permissions.canSwitchToParentMeeting?z("dyte-breakout-room-manager",{key:this.stateManager.currentState.parentMeeting.id,assigningParticipants:this.assigningParticipants,isDragMode:this.isDragMode,meeting:this.meeting,mode:this.roomConfig.mode,onParticipantsAdd:()=>this.assignParticipantsToRoom(this.stateManager.currentState.parentMeeting.id),onRoomJoin:()=>this.joinRoom(this.stateManager.currentState.parentMeeting.id),onUpdate:this.onRoomUpdate,states:this.states,room:Object.assign({},this.stateManager.currentState.parentMeeting),iconPack:this.iconPack,t:this.t}):null}renderRoomSwitcher(){return z(G,null,z("div",{class:"room-switcher-container"},z("header",null,z("dyte-icon",{icon:this.iconPack.breakout_rooms}),z("span",null,this.t("breakout_rooms.join_breakout_header"))),z("div",{class:"rooms",ref:e=>this.selectorRef=e},this.renderMainRoomMaybe(),this.getPermittedRooms().map((e,t)=>z("dyte-breakout-room-manager",{key:e.id,assigningParticipants:this.assigningParticipants,isDragMode:this.isDragMode,defaultExpanded:0===t,meeting:this.meeting,mode:this.roomConfig.mode,onDelete:()=>this.onRoomDelete(e.id),onParticipantsAdd:()=>this.assignParticipantsToRoom(e.id),onRoomJoin:()=>this.joinRoom(e.id),states:this.states,room:Object.assign({},e),iconPack:this.iconPack,t:this.t,allowDelete:!1})))))}renderLoading(){return z(G,null,z("div",{class:"loading-content"},z("dyte-spinner",{size:"xl"})))}renderRoomConfig(){return z(G,null,z("div",{class:"room-config"},z("header",null,z("dyte-icon",{icon:this.iconPack.breakout_rooms}),z("span",null,this.t("breakout_rooms.room_config_header"))),z("div",{class:"create-room"},z("p",null,this.t("breakout_rooms.num_of_rooms")),z("dyte-counter",{value:this.roomConfig.rooms,minValue:1,iconPack:this.iconPack,t:this.t,onValueChange:e=>{this.roomConfig=Object.assign(Object.assign({},this.roomConfig),{rooms:Math.max(+e.detail,1)})}})),z("span",{class:"distribution-hint"},`${this.t("breakout_rooms.approx")} `," ",z("em",null,this.getApproxDistribution()," ",this.t("breakout_rooms.participants_per_room"))," ",this.t("breakout_rooms.division_text")),z("footer",null,z("dyte-button",{kind:"button",size:"lg",title:this.t("create"),disabled:0===this.roomConfig.rooms,onClick:()=>this.onCreateRooms()},this.t("create")))))}render(){return this.loading?this.renderLoading():this.shouldShowOnlyRoomSwitcher()?this.renderRoomSwitcher():"room-config"===this.roomConfig.step?this.renderRoomConfig():z(G,null,z("div",{class:"participant-config-wrapper"},z("div",{class:"participant-config"},z("aside",{part:"menu"},z("header",null,this.t("breakout_rooms.assign_participants")),z("dyte-breakout-room-participants",{meeting:this.meeting,iconPack:this.iconPack,t:this.t,participantIds:this.stateManager.unassignedParticipants.map(vt),selectedParticipantIds:this.selectedParticipants},z("dyte-tooltip",{label:this.t("breakout_rooms.shuffle_participants"),slot:"shuffle-button"},z("dyte-button",{disabled:"edit"===this.roomConfig.mode||0===this.stateManager.unassignedParticipants.length,kind:"button",variant:"secondary",size:"md",onClick:()=>this.assignParticipantsRandomly(),class:"shuffle-button br-primary-btn"},z("dyte-icon",{icon:this.iconPack.shuffle})))),0!==this.selectedParticipants.length&&z("div",{class:"participants-assign-actions"},z("span",null,`${this.selectedParticipants.length} ${this.t("breakout_rooms.selected")}`),z("dyte-button",{disabled:"edit"===this.roomConfig.mode,kind:"button",variant:"ghost",size:"md",onClick:()=>this.deselectAll(),class:"deselect-button color-danger"},this.t("breakout_rooms.deselect")))),z("div",{class:"assign-rooms"},z("div",{class:"row"},z("p",{class:"row-header"},this.t("breakout_rooms.rooms")," (",this.stateManager.allConnectedMeetings.length,")"),!this.assigningParticipants&&z("div",{class:"cta-buttons"},z("dyte-button",{kind:"button",variant:"secondary",class:"br-primary-btn"},z("div",{onClick:this.onAddNewRoom},z("dyte-icon",{icon:this.iconPack.add}),this.t("breakout_rooms.add_room"))),0!==this.stateManager.allConnectedMeetings.flatMap(e=>e.participants).length&&z("dyte-button",{kind:"button",variant:"ghost",onClick:this.onUnassignAll},this.t("breakout_rooms.unassign_all")))),z("div",{class:"rooms",ref:e=>this.selectorRef=e},this.renderMainRoomMaybe(),this.getPermittedRooms().map((e,t)=>z("dyte-breakout-room-manager",{key:e.id,assigningParticipants:this.assigningParticipants,isDragMode:this.isDragMode,defaultExpanded:0===t,meeting:this.meeting,mode:this.roomConfig.mode,onDelete:()=>this.onRoomDelete(e.id),onParticipantsAdd:()=>this.assignParticipantsToRoom(e.id),onRoomJoin:()=>this.joinRoom(e.id),onUpdate:this.onRoomUpdate,states:this.states,room:Object.assign({},e),iconPack:this.iconPack,t:this.t,allowDelete:this.stateManager.allConnectedMeetings.length>1})),z("dyte-button",{kind:"button",variant:"secondary",onClick:this.onAddNewRoom,class:"add-room-jumbo-btn br-secondary-btn"},z("div",null,z("dyte-icon",{icon:this.iconPack.add}),z("span",null,this.t("breakout_rooms.add_room_brief"))))))),z("div",{class:"participant-config-actions"},z("div",{class:{"status-bar":!0,"ephemeral-status":""!==this.ephemeralStatusText}},""!==this.ephemeralStatusText&&z("dyte-icon",{icon:this.iconPack.checkmark}),this.getStatusText()),z("div",{class:"breakout-actions"},"create"===this.roomConfig.mode&&this.permissions.canAlterConnectedMeetings&&z("dyte-button",{size:"md",class:"start-breakout-button",onClick:()=>this.enableConfirmationModal("start-breakout")},this.t("breakout_rooms.start_breakout")),"edit"===this.roomConfig.mode&&this.stateManager.hasLocalChanges&&this.permissions.canAlterConnectedMeetings&&z("dyte-button",{size:"md",class:"color-danger",variant:"ghost",onClick:()=>this.discardChanges()},this.t("breakout_rooms.discard_changes")),"edit"===this.roomConfig.mode&&this.stateManager.hasLocalChanges&&this.permissions.canAlterConnectedMeetings&&z("dyte-button",{size:"md",class:"update-breakout-button",onClick:this.applyChanges},this.t("breakout_rooms.update_breakout")),"edit"===this.roomConfig.mode&&!this.stateManager.hasLocalChanges&&this.permissions.canAlterConnectedMeetings&&z("dyte-button",{size:"md",class:"close-breakout-button",onClick:()=>this.enableConfirmationModal("close-breakout")},this.t("breakout_rooms.close_breakout"))))))}static get watchers(){return{selectedParticipants:["onSelectedParticipantsChanged"]}}};go([si()],fo.prototype,"meeting",void 0),go([si()],fo.prototype,"states",void 0),go([si()],fo.prototype,"iconPack",void 0),go([si()],fo.prototype,"t",void 0),fo.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.color-brand{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}.color-danger{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}.loading-content{height:var(--dyte-space-60, 240px);width:var(--dyte-space-96, 384px);padding:var(--dyte-space-9, 36px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));display:flex;align-items:center;justify-content:center}.room-config{overflow:hidden;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));display:flex;flex-direction:column;width:var(--dyte-space-96, 384px);padding-left:var(--dyte-space-9, 36px);padding-right:var(--dyte-space-9, 36px);padding-top:var(--dyte-space-10, 40px);padding-bottom:var(--dyte-space-10, 40px)}header{margin-bottom:var(--dyte-space-8, 32px);display:flex;align-items:center;gap:var(--dyte-space-2, 8px);font-size:24px;font-weight:600}header dyte-icon{height:var(--dyte-space-7, 28px);width:var(--dyte-space-7, 28px)}.create-room{margin-bottom:var(--dyte-space-4, 16px);display:flex;align-items:center;gap:var(--dyte-space-3, 12px);width:100%}.create-room p{margin:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-1, 4px);font-size:16px}.distribution-hint{margin-bottom:var(--dyte-space-8, 32px);font-size:14px;font-weight:400;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}.distribution-hint em{font-style:normal;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}footer{display:flex;flex-direction:row;vertical-align:middle;justify-content:center}footer dyte-button{width:100%;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}label{margin-bottom:var(--dyte-space-3, 12px);font-weight:400;color:rgb(var(--dyte-colors-text-1000, 255 255 255));opacity:0.4}.participant-config-wrapper{width:850px;height:595px;max-width:100%;max-height:100%;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));display:flex;flex-direction:column}.participant-config-actions{display:flex;justify-content:space-between;padding-left:var(--dyte-space-8, 32px);padding-right:var(--dyte-space-8, 32px);padding-top:var(--dyte-space-5, 20px);padding-bottom:var(--dyte-space-5, 20px);border-bottom-right-radius:var(--dyte-border-radius-md, 8px);border-bottom-left-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.participant-config{display:flex;flex-grow:1;flex-direction:row;overflow:hidden}aside{box-sizing:border-box;display:flex;width:var(--dyte-space-96, 384px);flex-grow:1;flex-direction:column;padding-left:var(--dyte-space-8, 32px);padding-right:var(--dyte-space-4, 16px);border-right-width:var(--dyte-border-width-sm, 1px);border-top-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-none, 0);border-left-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-right-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-border-opacity))}aside header{margin-bottom:var(--dyte-space-4, 16px);width:100%;padding-left:var(--dyte-space-0, 0px);padding-right:var(--dyte-space-0, 0px);padding-top:var(--dyte-space-8, 32px);font-size:20px;font-weight:500;line-height:2rem}.shuffle-button{display:flex;flex-direction:row;align-items:center}.shuffle-button dyte-icon{height:var(--dyte-space-8, 32px)}.participants-assign-actions{display:flex;flex-direction:row;align-items:center;justify-content:space-between;font-size:14px;padding-left:var(--dyte-space-8, 32px);padding-right:var(--dyte-space-2, 8px);margin-left:calc(var(--dyte-space-8, 32px) * -1);margin-right:calc(var(--dyte-space-4, 16px) * -1);padding-top:var(--dyte-space-0\\.5, 2px);padding-bottom:var(--dyte-space-0\\.5, 2px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}.participants-assign-actions .deselect-button{height:var(--dyte-space-6, 24px)}.participants-assign-actions .deselect-button:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}.assign-rooms{padding:var(--dyte-space-8, 32px);display:flex;width:100%;flex-direction:column}.assign-rooms .disabled{opacity:0.2}.assign-rooms .back{display:flex;cursor:pointer;flex-direction:row;align-items:center;justify-content:flex-start;padding:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-0, 0px);font-size:14px;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.assign-rooms .back dyte-icon{height:var(--dyte-space-5, 20px)}.assign-rooms .row{display:flex;flex-direction:row;align-items:center;justify-content:flex-start;gap:var(--dyte-space-3, 12px);margin-bottom:var(--dyte-space-4, 16px);font-size:14px}.assign-rooms .row-header{margin:var(--dyte-space-0, 0px);font-size:16px;line-height:2rem}.assign-rooms .cta-buttons{display:flex;align-items:center;justify-content:flex-start;gap:var(--dyte-space-2, 8px)}.assign-rooms .cta-buttons dyte-button div{display:flex;flex-direction:row;align-items:center}.assign-rooms .cta-buttons dyte-button div dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}.rooms{margin-bottom:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-1, 4px);display:flex;flex-grow:1;flex-direction:column;gap:var(--dyte-space-2, 8px);overflow-y:auto;max-height:500px}.rooms::-webkit-scrollbar{width:var(--dyte-space-1\\.5, 6px);border-radius:var(--dyte-border-radius-sm, 4px)}.rooms::-webkit-scrollbar-thumb{border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.rooms::-webkit-scrollbar-track{border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.breakout-actions{display:flex;flex-direction:row;align-items:center;justify-content:flex-end;gap:var(--dyte-space-2, 8px)}.breakout-actions .start-breakout-button{color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.breakout-actions .close-breakout-button{color:rgb(var(--dyte-colors-text-1000, 255 255 255));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-bg-opacity))}.breakout-actions .update-breakout-button{background-color:transparent;--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity));border-width:var(--dyte-border-width-sm, 1px);border-style:solid;--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-border-opacity))}.status-bar{display:flex;align-items:center;font-size:14px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));width:var(--dyte-space-80, 320px)}.ephemeral-status{--tw-text-opacity:1;color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-text-opacity))}.ephemeral-status dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}.room-switcher-container{border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));width:468px;padding:var(--dyte-space-8, 32px)}.add-room-jumbo-btn div{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);font-size:14px;--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}.add-room-jumbo-btn div dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}.br-primary-btn:not([disabled]){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.br-primary-btn:not([disabled]):hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-600, 13 81 253) / var(--tw-bg-opacity))}.br-secondary-btn:not([disabled]){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.br-secondary-btn:not([disabled]):hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}";var mo=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const vo=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.iconPack=Vt,this.t=Ht(),this.messagePayload={to:"Everyone",message:""},this.successMessage=!1}close(){var e;null===(e=this.stateUpdate)||void 0===e||e.emit({activeBroadcastMessageModal:!1})}sendMessage(){this.successMessage=!0,setTimeout(()=>{this.close()},2e3)}render(){return z(G,{key:"942c56592847886706d37d042922de10bc1d9ba2"},z("div",{key:"870f1187ffaad036b5bf08d85a2a90c947fe3475",class:"content-col"},z("h2",{key:"18764e77a37c5d4f2a8f6fdf7dd877e75d7e6cc1"},"Broadcast message to"),z("select",{key:"4ee081d8cc2c06a43b0f3b19d4a65b99ec8a35e4",onChange:e=>{this.messagePayload=Object.assign(Object.assign({},this.messagePayload),{to:e.target.value})}},z("option",{key:"37165f1fe83d97ca45a1c52393331601dab36f20"},"Everyone"),z("option",{key:"5fb75c26d28b155bd6b410ece1e55552c9a14444"},"List of rooms")),z("textarea",{key:"4173fc0b3f7811b99c15cdf4549ba18af8bf0f71",placeholder:"Type message here...",onInput:e=>{this.messagePayload=Object.assign(Object.assign({},this.messagePayload),{message:e.target.value})}}),this.successMessage?z("p",null,"Message sent to ",this.messagePayload.to,z("dyte-icon",{icon:this.iconPack.checkmark})):z("div",{class:"content-row"},z("dyte-button",{onClick:()=>this.close(),variant:"secondary"},"Cancel"),"",z("dyte-button",{variant:"primary",onClick:()=>this.sendMessage()},"Send"))))}};mo([si()],vo.prototype,"meeting",void 0),mo([si()],vo.prototype,"states",void 0),mo([si()],vo.prototype,"iconPack",void 0),mo([si()],vo.prototype,"t",void 0),vo.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;flex-direction:column;overflow:hidden;border-radius:var(--dyte-border-radius-md, 8px);padding:var(--dyte-space-4, 16px);width:100%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));width:400px;max-width:80%}.content-col{display:flex;width:100%;flex-direction:column}h2{margin:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-2, 8px)}.content-row{display:flex;width:100%;flex-direction:row}.content-row dyte-button{margin-top:var(--dyte-space-4, 16px);width:100%}textarea{margin-top:var(--dyte-space-3, 12px);resize:none;border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;font-family:var(--dyte-font-family, sans-serif);outline:2px solid transparent;outline-offset:2px;height:var(--dyte-space-16, 64px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding:var(--dyte-space-2, 8px);color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}textarea::-moz-placeholder{color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}textarea::placeholder{color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}select{border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;padding-top:var(--dyte-space-3, 12px);padding-bottom:var(--dyte-space-3, 12px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);outline:2px solid transparent;outline-offset:2px;border-right-width:var(--dyte-border-width-md, 2px);border-style:solid;border-color:transparent;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}p{margin:var(--dyte-space-0, 0px);margin-top:var(--dyte-space-2, 8px);width:100%;text-align:center;font-size:14px;--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));display:flex;flex-direction:row;align-items:center;justify-content:center}p dyte-icon{margin-left:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px)}";const yo=class{constructor(e){o(this,e),this.variant="primary",this.kind="button",this.reverse=!1,this.disabled=!1,this.type="button"}render(){return z(G,{key:"b6b2dd78e9e260a8009f6936800e94cee2146826"},z("button",{key:"d607bc0d6e12ba1dcd050691ef7a23636b72ea17",part:"button",type:this.type,disabled:this.disabled},z("span",{key:"26166623d5ce0d9f9f23a57ff3793fab736bc90b",class:"start"},z("slot",{key:"2c3ee6d68ac313347e4acf8b05af72c492d56d85",name:"start"})),z("span",{key:"db86595c8d5763d45301c4a883e9ba3d013ed982",class:"content",part:"content"},z("slot",{key:"3b3b5541f807f71779195e9b0e559add82805e6b"})),z("span",{key:"689b910116fd34150302a05f97d54a02df05431f",class:"end"},z("slot",{key:"296ea6a1eec98b235f8ebaaf096acfcac88ffc20",name:"end"}))))}};!function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);r>3&&n&&Object.defineProperty(t,i,n)}([si()],yo.prototype,"size",void 0),yo.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{--icon-size:var(--dyte-button-icon-size, var(--dyte-space-5, 20px));--transition-property:var(--dyte-transition-property, all);--transition-duration:100ms;display:inline-flex;height:var(--dyte-space-8, 32px);cursor:pointer;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));font-size:14px;-webkit-user-select:none;-moz-user-select:none;user-select:none;border-radius:var(--dyte-border-radius-sm, 4px);transition-property:var(--transition-property);transition-duration:var(--transition-duration)}button{box-sizing:border-box;background-color:transparent;color:inherit;border:var(--dyte-border-width-sm, 1px) solid transparent;padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);display:inline-flex;flex-grow:1;justify-content:center;vertical-align:baseline;gap:var(--dyte-space-1, 4px);transition-property:var(--transition-property);transition-duration:var(--transition-duration);outline:none;height:inherit;border-radius:inherit;fill:inherit;cursor:inherit;font-weight:inherit;font-family:inherit;font-size:inherit;line-height:inherit}.start,.content,.end{align-self:center}::slotted(dyte-icon),::slotted(dyte-spinner){height:var(--icon-size);width:var(--icon-size)}:host([variant='primary']){color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}:host(:hover){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-600, 13 81 253) / var(--tw-bg-opacity))}button:focus-visible{border-color:rgb(var(--dyte-colors-text-1000, 255 255 255))}:host(:active){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-700, 2 70 253) / var(--tw-bg-opacity))}:host([disabled]:not([disabled='false'])){cursor:not-allowed;opacity:0.6}:host([variant='secondary']){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}:host([variant='secondary']:hover){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}:host([variant='secondary']:active){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}:host([variant='danger']){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-bg-opacity))}:host([variant='danger']:hover){background-color:rgba(var(--dyte-colors-danger, 255 45 45) / 0.7)}:host([variant='danger']:active){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-bg-opacity))}:host([variant='ghost']){background-color:transparent;color:inherit}:host([variant='ghost'].active){--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}:host([variant='ghost']:hover){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}:host([variant='ghost']:active){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}:host([kind='icon']){--icon-size:var(--dyte-space-5, 20px);width:var(--dyte-space-8, 32px)}:host([kind='icon']) button{padding-left:var(--dyte-space-0, 0px);padding-right:var(--dyte-space-0, 0px)}:host([kind='wide']){width:100%}:host([size='lg']){--icon-size:var(--dyte-space-5, 20px);height:var(--dyte-space-10, 40px);font-size:16px}:host([size='lg'][kind='icon']){--icon-size:var(--dyte-space-6, 24px);height:var(--dyte-space-10, 40px);width:var(--dyte-space-10, 40px)}:host([size='sm']){--icon-size:var(--dyte-space-4, 16px);height:var(--dyte-space-6, 24px);font-size:12px}:host([size='sm'][kind='icon']){height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}";var bo=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const wo=class{constructor(e){o(this,e),this.iconPack=Vt,this.variant="full",this.t=Ht(),this.videoDevices=[],this.canProduceVideo=!0,this.stageStateListener=()=>{this.canProduceVideo="ALLOWED"===this.meeting.self.permissions.canProduceVideo},this.deviceListUpdateListener=({devices:e})=>{this.videoDevices=e.filter(e=>"videoinput"===e.kind)},this.deviceUpdateListener=({device:e})=>{"videoinput"===e.kind&&(this.currentDevice=e)},this.mediaPermissionUpdateListener=async({kind:e,message:t})=>{this.meeting&&"video"===e&&"ACCEPTED"===t&&(this.videoDevices=await this.meeting.self.getVideoDevices())}}meetingChanged(e){var t,i,s;null!=e&&(null===(t=e.self)||void 0===t||t.addListener("deviceListUpdate",this.deviceListUpdateListener),null===(i=e.self)||void 0===i||i.addListener("deviceUpdate",this.deviceUpdateListener),null===(s=e.self)||void 0===s||s.addListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),P(async()=>{var t,i;const s=await e.self.getVideoDevices(),a=null===(t=e.self.getCurrentDevices())||void 0===t?void 0:t.video;this.videoDevices=null!=a?[null!==(i=s.find(e=>e.deviceId===a.deviceId))&&void 0!==i?i:a,...s.filter(e=>e.deviceId!==a.deviceId)]:s}))}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e,t,i,s,a;null===(t=null===(e=this.meeting)||void 0===e?void 0:e.stage)||void 0===t||t.removeListener("stageStatusUpdate",this.stageStateListener),null===(i=this.meeting)||void 0===i||i.self.removeListener("deviceListUpdate",this.deviceListUpdateListener),null===(s=this.meeting)||void 0===s||s.self.removeListener("deviceUpdate",this.deviceUpdateListener),null===(a=this.meeting)||void 0===a||a.self.removeListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener)}async setDevice(e){var t;const i=this.videoDevices.find(t=>t.deviceId===e);this.currentDevice=i,null!=i&&await(null===(t=this.meeting)||void 0===t?void 0:t.self.setDevice(i))}render(){if(null==this.meeting)return null;let e=0;return z(G,null,this.canProduceVideo&&z("div",{class:"group container "+this.variant,part:"camera-selection"},z("label",null,"inline"!==this.variant&&this.t("camera"),z("dyte-icon",{icon:this.iconPack.video_on,size:"sm"})),z("div",{class:"row"},z("select",{class:"dyte-select",onChange:e=>this.setDevice(e.target.value)},this.videoDevices.map(({deviceId:t,label:i})=>{var s;return z("option",{selected:(null===(s=this.currentDevice)||void 0===s?void 0:s.deviceId)===t,value:t},i||"Camera "+ ++e)})))))}static get watchers(){return{meeting:["meetingChanged"]}}};bo([si()],wo.prototype,"meeting",void 0),bo([si()],wo.prototype,"size",void 0),bo([si()],wo.prototype,"iconPack",void 0),bo([si()],wo.prototype,"t",void 0),wo.style=".dyte-select{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.dyte-select:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.dyte-select{display:block;border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:var(--dyte-space-3, 12px);font-size:16px;--icon-size:var(--dyte-select-chevron-size, var(--dyte-space-6, 24px));--icon-right-position:var(--dyte-select-chevron-right-position, var(--dyte-space-2, 8px));background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e\");background-position:right var(--icon-right-position) center;background-repeat:no-repeat;background-size:var(--icon-size) var(--icon-size);padding-right:calc(var(--icon-right-position) * 5);width:100%;max-width:100%;text-overflow:ellipsis}.inline .dyte-select{margin-top:var(--dyte-space-1, 4px);width:100%;padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-1\\.5, 6px);padding-right:var(--dyte-space-1\\.5, 6px);padding-right:var(--dyte-space-8, 32px);font-size:14px}.row{margin-bottom:var(--dyte-space-2, 8px);display:flex;width:100%;align-items:center;justify-content:space-between;gap:var(--dyte-space-3, 12px)}.group{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px)}.group>*{margin-bottom:var(--dyte-space-2, 8px)}.group>*:last-child{margin-bottom:var(--dyte-space-0, 0px)}.group select{flex:1 1 0%}.group{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0, 0px)}.group>*{margin-bottom:var(--dyte-space-0, 0px)}label{display:flex;-webkit-user-select:none;-moz-user-select:none;user-select:none;align-items:center;gap:var(--dyte-space-1, 4px);font-size:14px}.inline.container{display:flex;align-items:center;justify-content:flex-start;gap:var(--dyte-space-2, 8px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px)}";var xo=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const ko=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.switchChannel=W(this,"switchChannel",7),this.t=Ht(),this.iconPack=Vt,this.channelName="",this.searchQuery="",this.step=1,this.loading=!1,this.selectedMemberIds=new Set,this.focusedMemberIndex=-1,this.showAllMembersList=!1,this.allMembers=new Map,this.inputTextRef=null,this.searchInputTextRef=null,this.focusOnSearch=(e=!1)=>{this.focusedMemberIndex=-1,P(()=>{var t,i;null===(t=this.searchInputTextRef)||void 0===t||t.focus(),e&&(null===(i=this.searchInputTextRef)||void 0===i||i.select())})},this.onClickHandler=async()=>{if(0!==this.channelName.length){if(1===this.step){const e=this.meeting.participants.all.toArray(),t=this.meeting.self.userId;return e.filter(e=>e.userId!==t).forEach(e=>this.allMembers.set(e.userId,e)),this.step=2,void this.focusOnSearch()}await this.createChannel()}},this.createChannel=async()=>{const e=Array.from(this.selectedMemberIds),t=await this.meeting.chat.createChannel(this.channelName,e,{displayPictureUrl:"",visibility:"public",isDirectMessage:!1});this.switchChannel.emit(t.id),this.stateUpdate.emit({activeChannelCreator:!1})},this.onMemberAdd=e=>{this.showAllMembersList=!1,this.selectedMemberIds.add(e),this.searchQuery="",this.focusOnSearch()},this.keyDownHandler=(e,t)=>{if("ArrowDown"===e.key)this.focusedMemberIndex=Math.min(this.focusedMemberIndex+1,t.length-1);else if("ArrowUp"===e.key){if(-1===this.focusedMemberIndex)return;if(0===this.focusedMemberIndex)return void this.focusOnSearch(!0);this.focusedMemberIndex=Math.max(this.focusedMemberIndex-1,0)}else if("Enter"===e.key)this.onMemberAdd(t[this.focusedMemberIndex].userId);else if("Backspace"===e.key){if(0!==this.searchQuery.length)return;if(0===this.selectedMemberIds.size)return;const e=Array.from(this.selectedMemberIds.values()).at(-1);this.selectedMemberIds.delete(e),De(this.$el)}},this.renderMemberSelector=()=>{const e=Array.from(this.allMembers.values()).filter(e=>!this.selectedMemberIds.has(e.userId)&&e.name.toLowerCase().includes(this.searchQuery.toLowerCase())),t=Array.from(this.selectedMemberIds.values()).map(e=>this.allMembers.get(e)),i=this.selectedMemberIds.size===this.allMembers.size;return z("div",{class:"input-container"},z("ul",{class:"members scrollbar",onClick:()=>{var e;null===(e=this.searchInputTextRef)||void 0===e||e.focus()}},t.map(e=>z("li",{class:"pill"},z("dyte-avatar",{participant:{name:e.name,picture:e.picture},size:"sm"}),z("span",null,e.name),z("dyte-icon",{icon:this.iconPack.dismiss,onClick:()=>{this.selectedMemberIds.delete(e.userId),De(this.$el),this.focusOnSearch()}}))),!i&&z("input",{type:"text",ref:e=>this.searchInputTextRef=e,value:this.searchQuery,placeholder:0===this.selectedMemberIds.size?this.t("chat.member_name"):"",class:{"wide-input":0===this.selectedMemberIds.size},onInput:e=>{this.searchQuery=e.target.value.trim()},onClick:()=>{this.showAllMembersList=!this.showAllMembersList},onKeyDown:t=>this.keyDownHandler(t,e)})),(0!==this.searchQuery.length||this.showAllMembersList)&&z("ul",{class:"search-results"},e.map((e,t)=>z("li",{class:{member:!0,selected:t===this.focusedMemberIndex},onClick:()=>this.onMemberAdd(e.userId),ref:e=>{t===this.focusedMemberIndex&&P(()=>{e&&e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})})}},z("dyte-avatar",{participant:{name:e.name,picture:e.picture},size:"sm"}),z("span",null,e.name))),0===e.length&&z("li",{class:"member"},z("span",null,this.t("chat.error.empty_results")))))}}componentDidLoad(){var e;null===(e=this.inputTextRef)||void 0===e||e.focus()}render(){return z(G,{key:"4c1ae6e4b774e23f4a594a8471975bc67978c5ed"},z("header",{key:"fc502cce45ea3d03814aadbf683b934866e2f1f0"},1===this.step?this.t("chat.new_channel"):this.t("chat.add_members")),1===this.step&&z("input",{key:"5ed3f19504ea6d2393a0ad9edb51d930a1a53c98",class:"channel-name-input",type:"text",placeholder:this.t("chat.channel_name"),ref:e=>this.inputTextRef=e,onInput:e=>{this.channelName=e.target.value.trim()}}),2===this.step&&this.renderMemberSelector(),z("footer",{key:"5d671033919ef077b067098abffb93ca41cc9736"},z("dyte-button",{key:"c9016f42e4ca922ca6dbd2f35ab10be972bdd0b5",kind:"button",size:"lg",disabled:0===this.channelName.length,onClick:this.onClickHandler},1===this.step?this.t("chat.add_members"):this.t("create"))))}get $el(){return Y(this)}};xo([si()],ko.prototype,"meeting",void 0),xo([si()],ko.prototype,"t",void 0),xo([si()],ko.prototype,"iconPack",void 0),ko.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));display:flex;flex-direction:column;width:var(--dyte-space-96, 384px);padding-left:var(--dyte-space-9, 36px);padding-right:var(--dyte-space-9, 36px);padding-top:var(--dyte-space-10, 40px);padding-bottom:var(--dyte-space-10, 40px)}header{margin-bottom:var(--dyte-space-8, 32px);display:flex;align-items:center;gap:var(--dyte-space-2, 8px);font-size:24px;font-weight:600}.channel-name-input{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;padding:var(--dyte-space-3, 12px);font-size:16px;-webkit-appearance:none;-moz-appearance:none;appearance:none;line-height:1.25;outline:2px solid transparent;outline-offset:2px}.channel-name-input:focus{outline-width:2px;outline-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}footer{margin-top:var(--dyte-space-5, 20px);display:flex;justify-content:flex-end}.member{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);padding:var(--dyte-space-2, 8px)}.member dyte-avatar{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);font-size:14px;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.input-container{position:relative;-webkit-appearance:none;-moz-appearance:none;appearance:none;line-height:1.25;outline:2px solid transparent;outline-offset:2px;outline-width:2px;outline-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5);border-radius:var(--dyte-border-radius-sm, 4px)}.input-container .members{margin:var(--dyte-space-0, 0px);max-height:var(--dyte-space-28, 112px);border-radius:var(--dyte-border-radius-sm, 4px);padding:var(--dyte-space-2, 8px);list-style-type:none;display:flex;flex-wrap:wrap;gap:var(--dyte-space-1, 4px);cursor:text;font-size:16px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));overflow-y:auto;min-height:var(--dyte-space-7, 28px)}.input-container .pill{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);border-radius:var(--dyte-border-radius-sm, 4px);padding:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.input-container .pill dyte-avatar{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);font-size:14px;color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.input-container .pill span{max-width:var(--dyte-space-32, 128px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.input-container .pill dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);cursor:pointer}.input-container input{width:var(--dyte-space-24, 96px);border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;padding:var(--dyte-space-1, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));outline:2px solid transparent;outline-offset:2px;font-size:16px;line-height:1.25rem}.input-container input.wide-input{width:100%}.search-results{margin:var(--dyte-space-0, 0px);margin-top:var(--dyte-space-1, 4px);max-height:var(--dyte-space-28, 112px);width:100%;padding:var(--dyte-space-0, 0px);position:absolute;list-style-type:none;overflow-y:auto;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));border-radius:var(--dyte-border-radius-md, 8px);--tw-border-spacing-x:var(--dyte-space-2, 8px);--tw-border-spacing-y:var(--dyte-space-2, 8px);border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y);border-style:solid;border-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.search-results .member{cursor:pointer}.search-results .member dyte-avatar{color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.search-results .member:hover,.search-results .member.selected{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-700, 2 70 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}";var So=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Eo=class{constructor(e){o(this,e),this.t=Ht(),this.iconPack=Vt,this.members=[]}renderMembers(){return z("ul",{class:"scrollbar"},this.members.map(e=>z("li",null,z("dyte-avatar",{participant:{name:e.name,picture:e.picture},size:"sm"}),z("span",null,e.name))))}render(){return z(G,{key:"7dc9ef6f5d052016ccb53bf943ef1ca26dd36e62"},z("header",{key:"c113e7cd4271301e032d364954938e3f73f999dd"},this.t("chat.channel_members")),this.renderMembers())}};So([si()],Eo.prototype,"t",void 0),So([si()],Eo.prototype,"iconPack",void 0),Eo.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));display:flex;flex-direction:column;width:var(--dyte-space-72, 288px);padding-top:var(--dyte-space-5, 20px);padding-bottom:var(--dyte-space-5, 20px);padding-left:var(--dyte-space-8, 32px);padding-right:var(--dyte-space-8, 32px)}header{font-size:20px}dyte-spinner{margin-top:var(--dyte-space-10, 40px);margin-bottom:var(--dyte-space-10, 40px);margin-left:auto;margin-right:auto}ul{margin-left:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-0, 0px);margin-top:var(--dyte-space-6, 24px);margin-bottom:var(--dyte-space-4, 16px);height:var(--dyte-space-48, 192px);padding:var(--dyte-space-0, 0px);overflow-y:auto;list-style-type:none;display:flex;flex-direction:column;gap:var(--dyte-space-2, 8px)}ul li{margin-right:var(--dyte-space-2, 8px);display:flex;align-items:center;gap:var(--dyte-space-2, 8px);padding:var(--dyte-space-2, 8px);cursor:pointer;border-radius:var(--dyte-border-radius-sm, 4px)}ul li:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}ul li dyte-avatar{height:var(--dyte-space-7, 28px);width:var(--dyte-space-7, 28px);font-size:14px;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}";var Po=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const To=class{constructor(e){o(this,e),this.search=W(this,"search",7),this.searchDismissed=W(this,"searchDismissed",7),this.back=W(this,"back",7),this.iconPack=Vt,this.t=Ht(),this.showChannelDetailsDialog=!1,this.showSearchBar=!1,this.members=[],this.showBackButton=!1}onChannelChanged(){this.$searchInput&&(this.$searchInput.value=""),this.showSearchBar=!1,this.channel.isDirectMessage||this.meeting.chat.getChannelMembers(this.channel.id).then(e=>{this.members=e})}connectedCallback(){this.onChannelChanged()}renderChannelDetails(){return z("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.showChannelDetailsDialog=!1},iconPack:this.iconPack,t:this.t},z("dyte-channel-details",{members:this.members,channel:this.channel}))}render(){return this.channel?z(G,null,this.showChannelDetailsDialog&&this.renderChannelDetails(),z("header",{class:{searching:this.showSearchBar}},this.showBackButton&&z("dyte-button",{kind:"icon",variant:"secondary",class:"back-btn",onClick:()=>{this.back.emit()}},z("dyte-icon",{icon:this.iconPack.chevron_left})),z("div",{class:"channel-details"},z("span",{class:"name"},this.channel.displayName),!this.channel.isDirectMessage&&z("span",{class:"members"},this.members.map(e=>e.name).join(", "))),z("div",{class:"channel-tools"},!this.channel.isDirectMessage&&z("dyte-tooltip",{label:this.t("chat.channel_members"),variant:"primary"},z("dyte-button",{kind:"button",variant:"secondary",size:"md",onClick:()=>{this.showChannelDetailsDialog=!this.showChannelDetailsDialog},class:"br-primary-btn"},z("dyte-icon",{icon:this.iconPack.people})))))):null}static get watchers(){return{channel:["onChannelChanged"]}}};Po([si()],To.prototype,"meeting",void 0),Po([si()],To.prototype,"iconPack",void 0),Po([si()],To.prototype,"t",void 0),To.style="header{box-sizing:border-box;height:var(--dyte-space-16, 64px);width:100%;padding:var(--dyte-space-4, 16px);display:flex;justify-content:space-between;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));border-left-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-sm, 1px);border-top-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-bottom-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-border-opacity))}header.searching{justify-content:flex-end}header.searching .channel-details{display:none}header .channel-details{display:flex;flex-grow:1;flex-direction:column;justify-content:center;height:var(--dyte-space-9, 36px);width:var(--dyte-space-1, 4px)}header .channel-details .name{font-weight:500}header .channel-details .members{margin-top:var(--dyte-space-0\\.5, 2px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:12px;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}header .channel-tools{display:flex;flex-shrink:0;justify-content:flex-end;gap:var(--dyte-space-1, 4px);min-width:var(--dyte-space-24, 96px)}header .channel-tools dyte-tooltip{height:var(--dyte-space-8, 32px);width:var(--dyte-space-10, 40px);display:flex}header .search-input{height:var(--dyte-space-8, 32px);width:var(--dyte-space-48, 192px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;outline:2px solid transparent;outline-offset:2px;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}header .name{font-size:16px}header .br-primary-btn{background-color:transparent}header .br-primary-btn:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}@media (orientation: landscape) and (min-width: 400px){header.searching .channel-details{display:flex}}.back-btn{margin-right:var(--dyte-space-3, 12px)}";var Lo=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Co=class{constructor(e){o(this,e),this.channelChange=W(this,"channelChange",7),this.disableSearch=!1,this.hideAvatar=!1,this.iconPack=Vt,this.t=Ht(),this.viewAs="list",this.searchQuery="",this.showDropdown=!1,this.calculateListHeight=Oi(()=>{if("list"===this.viewAs&&this.$listEl){let e=0;const t=this.$el.shadowRoot.querySelector('slot[name="header"]');t&&t.assignedElements().forEach(t=>e+=t.offsetHeight),this.$searchEl&&(e+=this.$searchEl.offsetHeight),this.$listEl.style.height=window.innerHeight-e-16+"px"}},60),this.getFilteredChannels=()=>""===this.searchQuery.trim()?this.channels:this.channels.filter(e=>e.name.toLowerCase().includes(this.searchQuery.toLowerCase())),this.toggleDropdown=()=>{this.showDropdown=!this.showDropdown},this.getChannelById=e=>this.channels.find(t=>t.id===e),this.getTotalUnreads=()=>this.channels.reduce((e,t)=>e+t.unreadCount,0),this.onChannelClickHandler=e=>{this.channelChange.emit(e),"dropdown"===this.viewAs&&(this.showDropdown=!1)}}connectedCallback(){this.resizeObserver=new ResizeObserver(this.calculateListHeight)}componentDidLoad(){this.resizeObserver.observe(this.$el),this.calculateListHeight()}disconnectedCallback(){var e;null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.calculateListHeight.cancel()}getTimeLabel(e){const t=new Date,i=new Date(t);i.setDate(t.getDate()-1);const s=new Date(t);if(s.setDate(t.getDate()-t.getDay()-1),e.toDateString()===t.toDateString())return e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(e.toDateString()===i.toDateString())return this.t("date.yesteday");if(e>s){const t=["date.sunday","date.monday","date.tuesday","date.wednesday","date.thursday","date.friday","date.saturday"];return this.t(t[e.getDay()])}return Intl.DateTimeFormat([],{day:"2-digit",month:"2-digit",year:"2-digit"}).format(e)}render(){const e=this.getFilteredChannels(),t="list"===this.viewAs||"dropdown"===this.viewAs&&this.showDropdown;return z(G,{key:"ade72de18b78275705bb0b39f9923977b8ef479e"},"list"===this.viewAs&&z("slot",{key:"879f77f7f57896e2ef37ba1abfede94bbdd66b8c",name:"header"}),t&&z("div",{key:"a0d9818c26533cf1a65ec70cb385d6ac33ad6c6f",class:{dropdown:"dropdown"===this.viewAs,scrollbar:"dropdown"===this.viewAs,list:"list"===this.viewAs}},!this.disableSearch&&z("div",{key:"428ca579360c29a390084c8f1969091c6b904a5a",class:"search-container",ref:e=>this.$searchEl=e},z("input",{key:"255cbcd3cda43fd2fd8bd3a65cda1f6271476fb9",type:"text",placeholder:this.t("chat.search_conversations"),value:this.searchQuery,onInput:e=>this.searchQuery=e.target.value}),z("dyte-icon",{key:"e85c4413dcd97df62fc96cf23aab4c0ef7276d79",icon:this.iconPack.search})),z("div",{key:"a09eb0f58d6341be68cfc52832e84048f11946be",class:"channels-container scrollbar",ref:e=>this.$listEl=e},e.map(e=>z("button",{class:{channel:!0,active:this.selectedChannelId===e.id},onClick:()=>this.onChannelClickHandler(e)},!this.hideAvatar&&z("div",null,e.icon?z("dyte-icon",{class:"avatar-icon",icon:this.iconPack[e.icon]}):z("dyte-avatar",{participant:{name:e.name,picture:e.avatarUrl}})),z("div",{class:"channel-data"},z("div",{class:"col"},z("div",{class:"name"},e.name),e.latestMessage&&z("div",{class:{"last-message":!0,"no-message":!e.latestMessage}},z("dyte-text-message-view",{isMarkdown:!0,text:e.latestMessage}))),z("div",{class:"col channel-meta"},e.latestMessageTime&&z("time",{class:"time"},this.getTimeLabel(e.latestMessageTime)),e.unreadCount>0&&z("div",{class:"unread-count"},e.unreadCount))))))),"dropdown"===this.viewAs&&z("button",{key:"af78d56510b62beeee9e17162a0fbe5a75b0b1af",class:"dropdown-trigger",onClick:this.toggleDropdown},z("span",{key:"10c170707e3c084d4a0a1a322128f6e685c075ed"},this.selectedChannelId&&`${this.t("to")} ${this.getChannelById(this.selectedChannelId).name}`,this.getTotalUnreads()>0&&z("div",{key:"b45263bedbb36f6b25cb595067a2418a110e9e45",class:"unread-count"},this.getTotalUnreads())),z("dyte-icon",{key:"ca61473ab2f859378fea75468dbf194a137ceba0",icon:this.showDropdown?this.iconPack.chevron_up:this.iconPack.chevron_down})))}get $el(){return Y(this)}};Lo([si()],Co.prototype,"iconPack",void 0),Lo([si()],Co.prototype,"t",void 0),Co.style=".scrollbar {\n  /* For Firefox */\n  scrollbar-width: thin;\n  scrollbar-color: var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent);\n}\n\n/* For WebKit */\n.scrollbar::-webkit-scrollbar {\n  height: var(--dyte-space-1\\.5, 6px);\n  width: var(--dyte-space-1\\.5, 6px);\n  border-radius: 9999px;\n  background-color: var(--dyte-scrollbar-background, transparent);\n}\n\n.scrollbar::-webkit-scrollbar-thumb {\n  border-radius: 9999px;\n  background-color: var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)));\n}\n\n\n:host {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));\n  position: relative;\n  z-index: 10;\n  height: var(--dyte-space-12, 48px);\n  min-height: 48px;\n}\n\n.dropdown-trigger {\n  height: 100%;\n  width: 100%;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  padding: var(--dyte-space-4, 16px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));\n  font-size: 14px;\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  cursor: pointer;\n  position: absolute;\n  z-index: 20;\n}\n\n.dropdown-trigger span {\n  display: flex;\n  flex: 1 1 0%;\n  align-items: center;\n  justify-content: space-between;\n}\n\n.dropdown-trigger dyte-icon {\n  margin-left: var(--dyte-space-1, 4px);\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  flex-shrink: 0;\n}\n\n@container chatcontainer (height < 360px) {\n  .dropdown-trigger {\n    padding: var(--dyte-space-2, 8px);\n  }\n  .dropdown {\n    top: var(--dyte-space-8, 32px) !important;\n  }\n  .search-container {\n    padding-left: var(--dyte-space-0, 0px) !important;\n    padding-right: var(--dyte-space-0, 0px) !important;\n    padding-top: var(--dyte-space-0, 0px) !important;\n    padding-bottom: var(--dyte-space-0, 0px) !important;\n  }\n  input {\n    height: var(--dyte-space-8, 32px) !important;\n    border-radius: var(--dyte-border-radius-none, 0) !important;\n  }\n  .channel {\n    height: var(--dyte-space-8, 32px) !important;\n    border-radius: var(--dyte-border-radius-sm, 4px) !important;\n  }\n  .avatar-icon {\n    height: var(--dyte-space-3, 12px) !important;\n    width: var(--dyte-space-3, 12px) !important;\n    padding: var(--dyte-space-1, 4px) !important;\n  }\n\n  dyte-avatar {\n    height: var(--dyte-space-5, 20px) !important;\n    width: var(--dyte-space-5, 20px) !important;\n  }\n}\n\n.dropdown {\n  position: absolute;\n  width: 100%;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));\n  top: var(--dyte-space-12, 48px);\n  z-index: 10;\n  animation: 0.3s slide-down ease;\n}\n\n.dropdown .channels-container {\n  max-height: var(--dyte-space-80, 320px);\n}\n\n.list {\n  display: flex;\n  flex-direction: column;\n}\n\n.list .channel .channel-data {\n  align-items: flex-start;\n}\n\n.unread-count {\n  display: flex;\n  justify-content: center;\n  height: var(--dyte-space-5, 20px);\n  min-width: var(--dyte-space-3, 12px);\n  border-radius: 9999px;\n  padding-left: var(--dyte-space-1, 4px);\n  padding-right: var(--dyte-space-1, 4px);\n  font-size: 12px;\n  line-height: 1.25rem;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\ninput {\n  height: var(--dyte-space-9, 36px);\n  width: 100%;\n  padding-left: var(--dyte-space-3, 12px);\n  padding-right: var(--dyte-space-3, 12px);\n  box-sizing: border-box;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n  border-radius: var(--dyte-border-radius-sm, 4px);\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.search-container {\n  display: flex;\n  flex-shrink: 0;\n  flex-grow: 0;\n  flex-basis: auto;\n  align-items: center;\n  padding-top: var(--dyte-space-3, 12px);\n  padding-bottom: var(--dyte-space-3, 12px);\n  padding-left: var(--dyte-space-2, 8px);\n  padding-right: var(--dyte-space-2, 8px);\n  border-bottom: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-700, 44 44 44));\n}\n\n.search-container dyte-icon {\n  margin-left: calc(var(--dyte-space-8, 32px) * -1);\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  color: rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76));\n}\n\n.channels-container {\n  display: flex;\n  flex-direction: column;\n  gap: var(--dyte-space-1, 4px);\n  padding: var(--dyte-space-2, 8px);\n  flex: 1 1 auto;\n  overflow-y: auto;\n}\n\n.channel {\n  flex-shrink: 0;\n  box-sizing: border-box;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  background-color: transparent;\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n  cursor: pointer;\n  border-radius: var(--dyte-border-radius-md, 8px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: var(--dyte-space-2, 8px);\n  height: var(--dyte-space-16, 64px);\n  width: 100%;\n  padding-left: var(--dyte-space-2, 8px);\n  padding-right: var(--dyte-space-3, 12px);\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n\n.channel:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));\n}\n\n.channel .channel-data {\n  flex: 1 1 0%;\n  align-items: center;\n  justify-content: space-between;\n  display: flex;\n  gap: var(--dyte-space-2, 8px);\n}\n\n.channel .name {\n  font-size: 16px;\n}\n\n.channel .name, \n  .channel .last-message {\n  max-width: var(--dyte-space-40, 160px);\n  text-align: left;\n  overflow: hidden;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 1;\n}\n\n.channel .no-message {\n  font-style: italic;\n}\n\n.channel dyte-avatar {\n  height: var(--dyte-space-12, 48px);\n  width: var(--dyte-space-12, 48px);\n  overflow: clip;\n  border-radius: 9999px;\n  font-size: 14px;\n}\n\n.channel .avatar-icon {\n  height: var(--dyte-space-6, 24px);\n  width: var(--dyte-space-6, 24px);\n  padding: var(--dyte-space-3, 12px);\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n  overflow: clip;\n  border-radius: 9999px;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n}\n\n.channel time, \n  .channel .last-message {\n  font-size: 12px;\n  color: rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76));\n}\n\n.channel.active {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\n.channel.active .unread-count {\n  background-color: rgb(var(--dyte-colors-text-on-brand-800, var(--dyte-colors-text-800, 255 255 255 / 0.76)));\n  --tw-text-opacity: 1;\n  color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity));\n}\n\n.channel.active time {\n  color: rgb(var(--dyte-colors-text-on-brand-800, var(--dyte-colors-text-800, 255 255 255 / 0.76)));\n}\n\n.channel.active .last-message {\n  color: rgb(var(--dyte-colors-text-on-brand-700, var(--dyte-colors-text-700, 255 255 255 / 0.64)));\n}\n\n.channel.active dyte-avatar {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));\n}\n\n.col {\n  gap: var(--dyte-space-1, 4px);\n  display: flex;\n  flex-direction: column;\n}\n\n.channel-meta {\n  flex-shrink: 0;\n  align-items: flex-end;\n}\n\n@keyframes slide-down {\n  from {\n    transform: translateY(-50px);\n  }\n  to {\n    transform: translateY(0%);\n  }\n}\n";var _o=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Ao=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.chatUpdateListener=({message:e})=>{e.channelId||this.displayFilter&&!this.displayFilter(e)||(this.addToChatGroup(e),this.chatGroups=Object.assign({},this.chatGroups))},this.chatPermissionUpdateListener=()=>{this.canSend=this.meeting.self.permissions.chatPublic.canSend,this.canSendTextMessage=this.meeting.self.permissions.chatPublic.text,this.canSendFiles=this.meeting.self.permissions.chatPublic.files},this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.disablePrivateChat=!1,this.canPinMessages=!1,this.privatePresetFilter=[],this.displayFilter=void 0,this.unreadCountGroups={},this.chatGroups={everyone:[]},this.selectedGroup="everyone",this.now=new Date,this.dropzoneActivated=!1,this.showLatestMessageButton=!1,this.canSend=!1,this.canSendTextMessage=!1,this.canSendFiles=!1,this.canPrivateMessage=!1,this.canSendPrivateTexts=!1,this.canSendPrivateFiles=!1,this.emojiPickerEnabled=!1,this.chatRecipientId="everyone",this.participants=[],this.channels=[],this.editingMessage=null,this.replyMessage=null,this.searchQuery="",this.selectorState="hide",this.creatingChannel=!1,this.showPinnedMessages=!1,this.channelMap=new Map,this.onDragOver=e=>{e.preventDefault(),this.dropzoneActivated=!0},this.onDragLeave=()=>{this.dropzoneActivated=!1},this.onDrop=e=>{e.preventDefault(),this.dropzoneActivated=!1,Ni(e.dataTransfer.items,(e,t)=>{var i,s,a,r;switch(e){case"image":this.isFileMessagingAllowed()&&(null===(s=null===(i=this.meeting)||void 0===i?void 0:i.chat)||void 0===s||s.sendImageMessage(t,this.getRecipientPeerIds()));break;case"file":this.isFileMessagingAllowed()&&(null===(r=null===(a=this.meeting)||void 0===a?void 0:a.chat)||void 0===r||r.sendFileMessage(t,this.getRecipientPeerIds()))}})},this.disconnectMeeting=e=>{var t,i,s,a,r,n;this.isPrivateChatSupported()&&(null==e||e.participants.joined.removeListener("participantJoined",this.onParticipantUpdate),null==e||e.participants.joined.removeListener("participantLeft",this.onParticipantUpdate)),null===(t=null==e?void 0:e.chat)||void 0===t||t.removeListener("chatUpdate",this.chatUpdateListener),null===(i=null==e?void 0:e.chat)||void 0===i||i.removeListener("channelCreate",this.onChannelCreateOrUpdate),null===(s=null==e?void 0:e.chat)||void 0===s||s.removeListener("channelUpdate",this.onChannelCreateOrUpdate),null===(a=null==e?void 0:e.chat)||void 0===a||a.removeListener("channelMessageUpdate",this.onChannelCreateOrUpdate),null===(n=null===(r=null==e?void 0:e.participants)||void 0===r?void 0:r.all)||void 0===n||n.removeListener("participantsUpdate",this.onChannelCreateOrUpdate),e.self.permissions.removeListener("*",this.chatPermissionUpdateListener)},this.getFilteredParticipants=()=>0===this.privatePresetFilter.length?this.participants:this.participants.filter(e=>this.privatePresetFilter.includes(e.presetName)),this.onParticipantUpdate=()=>{this.participants=this.meeting.participants.joined.toArray().filter(e=>0===this.privatePresetFilter.length||this.privatePresetFilter.includes(e.presetName)),this.selectedParticipant&&!this.participants.includes(this.selectedParticipant)&&(this.selectedParticipant=null,this.chatRecipientId=this.selectedGroup="everyone")},this.usePaginatedChat=()=>(!this.isGroupCall||!this.showPinnedMessages)&&("everyone"===this.selectedGroup&&pt(this.meeting)),this.updateUnreadCountGroups=e=>{this.unreadCountGroups=Object.assign(Object.assign({},this.unreadCountGroups),e)},this.isPrivateChatSupported=()=>this.canPrivateMessage&&!this.disablePrivateChat,this.updateRecipients=e=>{const{id:t}=e.detail;if(this.chatRecipientId=t,this.selectedParticipant=this.participants.find(e=>e.userId===t),"everyone"!==this.chatRecipientId){const e=Fi([this.chatRecipientId,this.meeting.self.userId]);this.selectedGroup=e}else this.selectedGroup="everyone";this.updateUnreadCountGroups({[this.selectedGroup]:0})},this.isTextMessagingAllowed=()=>"everyone"===this.chatRecipientId?this.canSend&&this.canSendTextMessage:this.canPrivateMessage&&this.canSendPrivateTexts,this.isFileMessagingAllowed=()=>"everyone"===this.chatRecipientId?this.canSend&&this.canSendFiles:this.canPrivateMessage&&this.canSendPrivateFiles,this.onChannelChanged=e=>{const t=e.detail;t.id.includes(ji)?this.createDMChannel(t.id.replace(ji,"")):this.selectedChannelId=t.id,this.cleanup(),"desktop"!==this.selectorState&&(this.selectorState="hide")},this.createDMChannel=async e=>{this.creatingChannel=!0;const t=await this.meeting.chat.createChannel("Direct Message",[e],{visibility:"private",isDirectMessage:!0});this.creatingChannel=!1,this.selectedChannelId=t.id},this.cleanup=()=>{this.editingMessage=null,this.replyMessage=null,this.searchQuery=""},this.onQuotedMessageDismiss=()=>{this.replyMessage=null},this.onChannelCreateOrUpdate=e=>{e?this.channelMap.set(e.id,e):this.meeting.chat.channels.forEach(e=>this.channelMap.set(e.id,e));const t=Array.from(this.channelMap.values()),i=t.filter(e=>!zi(e)).sort((e,t)=>$i(e.displayName,t.displayName)),s=t.filter(zi).map(e=>Object.assign(Object.assign({},e),{displayName:this.getMemberDisplayName(e)})),a=this.meeting.participants.all.toArray().filter(e=>{if(e.userId===this.meeting.self.userId)return!1;const t=Bi([this.meeting.self.userId,e.userId]);return s.every(e=>Bi(e.memberIds)!==t)}).map(e=>({id:`${ji}${e.userId}`,displayName:e.name,displayPictureUrl:e.picture,isDirectMessage:!0,unreadCount:0})),r=[...s,...a].sort((e,t)=>$i(e.displayName,t.displayName));this.channels=[...i,...r];const n=[...i,...s];this.selectedChannelId||0===n.length||(this.selectedChannelId=n[0].id)},this.getMemberDisplayName=e=>{var t;let i;i=1===e.memberIds.length?e.memberIds[0]:e.memberIds[0]===this.meeting.self.userId?e.memberIds[1]:e.memberIds[0];const s=this.meeting.participants.all.toArray().find(e=>e.userId===i);return null!==(t=null==s?void 0:s.name)&&void 0!==t?t:i},this.onNewMessageHandler=async e=>{const t=e.detail;this.isChatViewType?(await this.meeting.chat.sendMessageToChannel(t,this.selectedChannelId,this.replyMessage?{replyTo:this.replyMessage}:{}),this.replyMessage=null):this.meeting.chat.sendMessage(t,this.getRecipientPeerIds())},this.onEditMessageHandler=async e=>{var t,i;await(null===(i=null===(t=this.meeting)||void 0===t?void 0:t.chat)||void 0===i?void 0:i.editTextMessage(this.editingMessage.id,e.detail,this.editingMessage.channelId)),this.editingMessage=null},this.onEditCancel=()=>{this.editingMessage=null},this.onSearchHandler=async e=>{this.searchQuery=e.detail},this.onSearchDismissed=()=>{this.searchQuery=""},this.onChannelCreateClicked=()=>{this.stateUpdate.emit({activeChannelCreator:!0})},this.onPinMessage=e=>{const t=e.detail;t.pinned?this.meeting.chat.unpin(t.id):this.meeting.chat.pin(t.id)},this.onDeleteMessage=e=>{const t=e.detail;this.meeting.chat.deleteMessage(t.id)},this.getChannelItems=()=>this.channels.map(e=>{const t={id:e.id,name:e.displayName,avatarUrl:e.displayPictureUrl};return e.latestMessage&&(t.latestMessage="text"===e.latestMessage.type?Zi(e.latestMessage.message):"",t.latestMessageTime=e.latestMessage.time),t}),this.getPrivateChatRecipients=()=>{const e=this.getFilteredParticipants().map(e=>{const t=Fi([e.userId,this.meeting.self.userId]);return{id:e.userId,name:e.name,avatarUrl:e.picture,unreadCount:this.unreadCountGroups[t]}});return[{id:"everyone",name:this.t("chat.everyone"),icon:"participants",unreadCount:this.unreadCountGroups.everyone},...e]},this.onTogglePinnedMessages=()=>{this.showPinnedMessages=!this.showPinnedMessages},this.renderPinnedMessagesHeader=()=>0===this.meeting.chat.pinned.length?null:z("dyte-tooltip",{label:this.t("chat.toggle_pinned_msgs")},z("div",{class:{"pinned-messages-header":!0,active:this.showPinnedMessages},onClick:this.onTogglePinnedMessages},z("dyte-icon",{icon:this.iconPack.pin}),this.t("chat.pinned_msgs"),` (${this.meeting.chat.pinned.length})`))}connectedCallback(){this.meeting&&(this.meetingChanged(this.meeting),this.meeting&&!this.meeting.chat||this.isFileMessagingAllowed()&&(this.host.addEventListener("dragover",this.onDragOver),this.host.addEventListener("dragleave",this.onDragLeave),this.host.addEventListener("drop",this.onDrop)))}onEditMessageInit(e){e.detail.flags.isReply?this.replyMessage=e.detail.payload:e.detail.flags.isEdit&&(this.editingMessage=e.detail.payload)}disconnectedCallback(){var e;null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.disconnectMeeting(this.meeting),this.host.removeEventListener("dragover",this.onDragOver),this.host.removeEventListener("dragleave",this.onDragLeave),this.host.removeEventListener("drop",this.onDrop)}meetingChanged(e,t){var i,s,a,r,n,o;if(null!=t&&this.disconnectMeeting(t),(!e||e.chat)&&null!=e){if(this.canSend=e.self.permissions.chatPublic.canSend,this.canSendTextMessage=e.self.permissions.chatPublic.text,this.canSendFiles=e.self.permissions.chatPublic.files,this.canPrivateMessage=!(!(null===(i=e.self.permissions.chatPrivate)||void 0===i?void 0:i.canSend)&&!(null===(s=e.self.permissions.chatPrivate)||void 0===s?void 0:s.canReceive)),this.canSendPrivateTexts=!!(null===(a=e.self.permissions.chatPrivate)||void 0===a?void 0:a.text),this.canSendPrivateFiles=!!(null===(r=e.self.permissions.chatPrivate)||void 0===r?void 0:r.files),this.canPinMessages=(null===(n=null==e?void 0:e.__internals__)||void 0===n?void 0:n.features.hasFeature(ht))&&e.self.permissions.pinParticipant,this.isGroupCall="GROUP_CALL"===e.meta.viewType,this.isChatViewType="CHAT"===e.meta.viewType,this.isChatViewType){this.onChannelCreateOrUpdate();this.channels.filter(e=>!e.id.includes(ji)).length&&(this.selectedChannelId=this.channels[0].id),this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver(e=>{for(const t of e)t.contentBoxSize[0].inlineSize<758?this.selectorState="hide":this.selectorState="desktop"}),this.isChatViewType&&this.resizeObserver.observe(this.host)}this.initializeChatGroups(),this.chatGroups=Object.assign({},this.chatGroups),e.self.permissions.on("*",this.chatPermissionUpdateListener),this.onParticipantUpdate(),null===(o=e.chat)||void 0===o||o.addListener("chatUpdate",this.chatUpdateListener),this.isPrivateChatSupported()&&(e.participants.joined.addListener("participantJoined",this.onParticipantUpdate),e.participants.joined.addListener("participantLeft",this.onParticipantUpdate)),this.isChatViewType&&(e.chat.addListener("channelCreate",this.onChannelCreateOrUpdate),e.chat.addListener("channelUpdate",this.onChannelCreateOrUpdate),e.chat.addListener("channelMessageUpdate",this.onChannelCreateOrUpdate),e.participants.all.addListener("participantsUpdate",this.onChannelCreateOrUpdate))}}chatGroupsChanged(e){var t,i;if(!this.isPrivateChatSupported())return;const s={};for(const a in e){const r=null!==(t=Jt[a])&&void 0!==t?t:0;s[a]=e[a].filter(e=>"chat"==e.type&&e.message.time>r&&e.message.userId!==this.meeting.self.userId).length,(a===Fi([this.meeting.self.userId,null===(i=this.selectedParticipant)||void 0===i?void 0:i.userId])||"everyone"===a&&null===this.selectedParticipant)&&(s[a]=0,Jt[a]=new Date)}this.updateUnreadCountGroups(s)}initializeChatGroups(){var e;null===(e=this.meeting.chat)||void 0===e||e.messages.forEach(e=>{this.displayFilter&&!this.displayFilter(e)||this.addToChatGroup(e)})}onDisplayFilterChanged(e,t){e!==t&&(this.chatGroups={},this.initializeChatGroups())}addToChatGroup(e){var t;const i=Ui(e);let s="everyone";if((null===(t=i.targetUserIds)||void 0===t?void 0:t.length)>0){const e=new Set([i.userId,...i.targetUserIds]);s=Fi(Array.from(e))}void 0===this.chatGroups[s]&&(this.chatGroups[s]=[]);let a=!1,r=[];this.chatGroups[s].forEach(t=>{"chat"===t.type&&t.message.id===e.id?(a=!0,r.push({type:"chat",message:i})):r.push(t)}),a||r.push({type:"chat",message:i}),this.chatGroups[s]=r}getRecipientPeerIds(){let e=[];return"everyone"!==this.chatRecipientId&&(e=[this.selectedParticipant.id]),e}channelSwitchListener(e){this.onChannelChanged(e)}renderHeadlessComponents(){return z(He,null,z("dyte-dialog-manager",{meeting:this.meeting}),z("dyte-notifications",{meeting:this.meeting}))}renderComposerUI(){var e,t,i;if(this.isChatViewType&&0===this.channels.length)return null;if(this.isChatViewType&&""!==this.searchQuery)return null;if(this.isChatViewType&&!this.selectedChannelId)return null;if("everyone"===this.chatRecipientId){if(!this.canSendTextMessage&&!this.canSendFiles)return null}else if(!this.canSendPrivateTexts&&!this.canSendPrivateFiles)return null;const s={iconPack:this.iconPack,t:this.t,size:this.size},a=this.editingMessage?this.editingMessage.message:"",r=this.replyMessage?this.replyMessage.message:"";return z("dyte-chat-composer-view",Object.assign({message:a,storageKey:null!==(e=this.selectedChannelId)&&void 0!==e?e:`draft-${this.selectedChannelId}`,quotedMessage:r,isEditing:!!this.editingMessage,canSendTextMessage:this.isTextMessagingAllowed(),canSendFiles:this.isFileMessagingAllowed(),disableEmojiPicker:!!(null===(i=null===(t=this.meeting)||void 0===t?void 0:t.__internals__)||void 0===i?void 0:i.features.hasFeature(ot)),maxLength:this.meeting.chat.maxTextLimit,rateLimits:this.meeting.chat.rateLimits,inputTextPlaceholder:this.t("chat.message_placeholder"),onNewMessage:this.onNewMessageHandler,onEditMessage:this.onEditMessageHandler,onEditCancel:this.onEditCancel,onQuotedMessageDismiss:this.onQuotedMessageDismiss},s),z("slot",{name:"chat-addon",slot:"chat-addon"}))}renderFullChat(){if(this.creatingChannel)return z("div",{class:"banner"},z("dyte-spinner",{size:"lg"}));if(0===this.channels.length||!this.selectedChannelId)return z("div",{class:"banner"},z("dyte-icon",{icon:this.iconPack.create_channel_illustration,slot:"start",class:"create-channel-illustration"}),z("dyte-button",{kind:"wide",variant:"primary",size:"md",onClick:this.onChannelCreateClicked,class:"welcome-new-channel"},z("dyte-icon",{icon:this.iconPack.add,slot:"start"}),z("span",null,this.t("chat.new_channel"))),("mobile"===this.selectorState||"hide"===this.selectorState)&&z("dyte-button",{kind:"button",variant:"secondary",size:"md",class:"view-chats-btn",onClick:()=>{this.selectorState="mobile"}},z("dyte-icon",{icon:this.iconPack.chat,slot:"start"}),z("span",null,this.t("chat.view_chats"))));const e=this.channels.find(e=>e.id===this.selectedChannelId);return z("div",{class:"chat"},z("dyte-channel-header",{slot:"header",meeting:this.meeting,channel:e,onSearch:this.onSearchHandler,onSearchDismissed:this.onSearchDismissed,showBackButton:"mobile"===this.selectorState||"hide"===this.selectorState,onBack:()=>{this.selectorState="mobile"}}),""!==this.searchQuery&&z("dyte-chat-search-results",{meeting:this.meeting,query:this.searchQuery,channelId:this.selectedChannelId}),""===this.searchQuery&&z("dyte-chat-messages-ui-paginated",{meeting:this.meeting,size:this.size,iconPack:this.iconPack,t:this.t,selectedChannelId:this.selectedChannelId,selectedChannel:e}))}render(){var e,t;if(!this.meeting)return null;const i={iconPack:this.iconPack,t:this.t,size:this.size},s=null===(e=this.meeting)||void 0===e?void 0:e.self.userId;let a=this.chatGroups[this.selectedGroup]||[];return this.showPinnedMessages&&0!==this.meeting.chat.pinned.length&&(a=a.filter(e=>"chat"===e.type&&e.message.pinned)),z(G,null,this.isChatViewType&&this.renderHeadlessComponents(),z("div",{class:"chat-container"},this.isChatViewType&&z("div",{class:{"selector-container":!0,[this.selectorState]:!0}},z("dyte-channel-selector-view",{channels:this.getChannelItems(),selectedChannelId:this.selectedChannelId,onChannelChange:this.onChannelChanged,t:this.t},z("div",{class:"channel-selector-header",slot:"header"},z("dyte-logo",{meeting:this.meeting,config:this.config,t:this.t}),z("dyte-tooltip",{label:this.t("chat.new_channel")},z("dyte-button",{kind:"button",variant:"ghost",size:"md",onClick:this.onChannelCreateClicked,class:"channel-create-btn"},z("dyte-icon",{icon:this.iconPack.add}))))),z("dyte-button",{kind:"icon",variant:"ghost",class:"mobile-close-btn",onClick:()=>this.selectorState="hide"},z("dyte-icon",{icon:this.iconPack.dismiss}))),z("div",{class:"chat"},this.isFileMessagingAllowed()&&z("div",{id:"dropzone",class:{active:this.dropzoneActivated},part:"dropzone"},z("dyte-icon",{icon:this.iconPack.attach}),z("p",null,this.t("chat.send_attachment"))),this.renderPinnedMessagesHeader(),this.isPrivateChatSupported()&&z("dyte-channel-selector-view",{channels:this.getPrivateChatRecipients(),selectedChannelId:(null===(t=this.selectedParticipant)||void 0===t?void 0:t.userId)||"everyone",onChannelChange:this.updateRecipients,t:this.t,viewAs:"dropdown"}),this.isChatViewType?this.renderFullChat():this.usePaginatedChat()?z("dyte-chat-messages-ui-paginated",{meeting:this.meeting,onPinMessage:this.onPinMessage,onDeleteMessage:this.onDeleteMessage,size:this.size,iconPack:this.iconPack,t:this.t}):z("dyte-chat-messages-ui",Object.assign({messages:a,selfUserId:s,selectedGroup:this.selectedGroup,onPinMessage:this.onPinMessage,canPinMessages:this.canPinMessages},i)),this.renderComposerUI())))}get host(){return Y(this)}static get watchers(){return{meeting:["meetingChanged"],chatGroups:["chatGroupsChanged"],displayFilter:["onDisplayFilterChanged"]}}};_o([si()],Ao.prototype,"meeting",void 0),_o([si()],Ao.prototype,"size",void 0),_o([si()],Ao.prototype,"iconPack",void 0),_o([si()],Ao.prototype,"t",void 0),Ao.style=":host {\n  line-height: initial;\n  font-family: var(--dyte-font-family, sans-serif);\n\n  font-feature-settings: normal;\n  font-variation-settings: normal;\n}\n\np {\n  margin: var(--dyte-space-0, 0px);\n  padding: var(--dyte-space-0, 0px);\n}\n\n.scrollbar {\n  /* For Firefox */\n  scrollbar-width: thin;\n  scrollbar-color: var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent);\n}\n\n/* For WebKit */\n.scrollbar::-webkit-scrollbar {\n  height: var(--dyte-space-1\\.5, 6px);\n  width: var(--dyte-space-1\\.5, 6px);\n  border-radius: 9999px;\n  background-color: var(--dyte-scrollbar-background, transparent);\n}\n\n.scrollbar::-webkit-scrollbar-thumb {\n  border-radius: 9999px;\n  background-color: var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)));\n}\n\n\n:host {\n  display: flex;\n  height: 100%;\n  width: 100%;\n  flex-direction: column;\n  font-size: 14px;\n  position: relative;\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\nh3 {\n  margin: var(--dyte-space-0, 0px);\n  display: flex;\n  height: var(--dyte-space-12, 48px);\n  align-items: center;\n  justify-content: center;\n  font-size: 16px;\n  font-weight: 400;\n  color: rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));\n  text-align: center;\n}\n\n#dropzone {\n  position: absolute;\n  top: var(--dyte-space-0, 0px);\n  right: var(--dyte-space-0, 0px);\n  bottom: var(--dyte-space-0, 0px);\n  left: var(--dyte-space-0, 0px);\n  z-index: 10;\n  display: none;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));\n}\n\n#dropzone.active {\n  display: flex;\n  animation: 0.2s slide-up ease-in;\n}\n\ndyte-chat-messages-ui,\ndyte-chat-messages-ui-paginated {\n  flex: 1 0 0;\n}\n\ndyte-chat-composer-view {\n  margin: var(--dyte-space-2, 8px);\n}\n\n.chat-container {\n  display: flex;\n  height: 100%;\n  width: 100%;\n  flex-direction: row;\n  container-type: size;\n  container-name: chatcontainer;\n}\n\n@container chatcontainer (height < 360px) {\n  dyte-channel-selector-view {\n    height: var(--dyte-space-8, 32px);\n    min-height: 24px;\n  }\n}\n\n.chat {\n  display: flex;\n  flex: 1 1 0%;\n  flex-direction: column;\n}\n\n.banner {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n\n.banner .welcome-new-channel {\n  width: var(--dyte-space-48, 192px);\n}\n\n.banner .create-channel-illustration {\n  height: var(--dyte-space-40, 160px);\n  width: var(--dyte-space-40, 160px);\n}\n\n.channel-selector-header {\n  box-sizing: border-box;\n  height: var(--dyte-space-16, 64px);\n  padding: var(--dyte-space-4, 16px);\n  display: flex;\n  justify-content: space-between;\n  border-bottom: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-700, 44 44 44));\n}\n\n.channel-selector-header .channel-create-btn {\n  width: var(--dyte-space-8, 32px);\n  justify-content: center;\n}\n\n.channel-selector-header .channel-create-btn:hover {\n  --tw-text-opacity: 1;\n  color: rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));\n}\n\n.view-chats-btn {\n  margin-top: var(--dyte-space-4, 16px);\n}\n\n.selector-container {\n  z-index: 50;\n  width: 100%;\n  max-width: var(--dyte-space-80, 320px);\n  border-right: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n}\n\n.selector-container.hide {\n  display: none;\n}\n\n.mobile-close-btn {\n  display: none;\n}\n\n.selector-container.mobile {\n  height: 100%;\n  width: 100%;\n  max-width: 100%;\n  position: absolute;\n  top: var(--dyte-space-0, 0px);\n  right: var(--dyte-space-0, 0px);\n  bottom: var(--dyte-space-0, 0px);\n  left: var(--dyte-space-0, 0px);\n  background-color: rgba(var(--dyte-colors-background-1000, 8 8 8) / 0.6);\n  display: flex;\n}\n\n.selector-container.mobile dyte-channel-selector-view {\n  max-width: var(--dyte-space-96, 384px);\n    animation: 0.3s swipe-in;\n}\n\n.selector-container.mobile .mobile-close-btn {\n  margin-top: var(--dyte-space-4, 16px);\n  margin-bottom: var(--dyte-space-4, 16px);\n  margin-left: var(--dyte-space-6, 24px);\n  margin-right: var(--dyte-space-6, 24px);\n  display: block;\n}\n\n.pinned-messages-header {\n  display: flex;\n  align-items: center;\n  gap: var(--dyte-space-2, 8px);\n  padding: var(--dyte-space-2, 8px);\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));\n  font-size: 12px;\n  cursor: pointer;\n}\n\n.pinned-messages-header dyte-icon {\n  height: var(--dyte-space-3, 12px);\n  width: var(--dyte-space-3, 12px);\n}\n\n.pinned-messages-header:hover {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n}\n\n.pinned-messages-header.active {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n}\n\n@keyframes swipe-in {\n  from {\n    transform: translateX(-100%);\n  }\n  to {\n    transform: translateX(0);\n  }\n}\n";var Ro=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Io={messagesSent:0,startTime:0},Do=class{constructor(e){o(this,e),this.onNewMessage=W(this,"newMessage",7),this.onEditMessage=W(this,"editMessage",7),this.onEditCancel=W(this,"editCancel",7),this.onQuotedMessageDismiss=W(this,"quotedMessageDismiss",7),this.canSendTextMessage=!0,this.canSendFiles=!0,this.message="",this.quotedMessage="",this.storageKey="dyte-text-message",this.inputTextPlaceholder="Enter your message",this.isEditing=!1,this.iconPack=Vt,this.t=Ht(),this.disableEmojiPicker=!1,this.rateLimits={period:60,maxInvocations:60},this.fileToUpload=null,this.isEmojiPickerOpen=!1,this.disableSendButton=!1,this.rateLimitsBreached=!1,this.textMessage="",this.sendFile=()=>{this.canSendFiles&&("image"===this.fileToUpload.type?this.onNewMessage.emit({type:"image",image:this.fileToUpload.file}):this.onNewMessage.emit({type:"file",file:this.fileToUpload.file}),this.fileToUpload=null)},this.handleSendMessage=()=>{if(!this.canSendTextMessage||this.rateLimitsBreached)return;if(null!==this.fileToUpload)return void this.sendFile();const e=this.textMessage,t=Date.now();t-Io.startTime>1e3*this.rateLimits.period&&(Io.startTime=t,Io.messagesSent=0),Io.messagesSent+=1,this.checkRateLimitBreached(t),e.length>0&&(this.quotedMessage.length,this.onNewMessage.emit({type:"text",message:e}),this.cleanup())},this.handleEditMessage=()=>{this.onEditMessage.emit(this.textMessage),this.cleanup()},this.handleEditCancel=()=>{this.onEditCancel.emit(),this.cleanup()},this.onTextChangeHandler=e=>{var t;this.textMessage=e.detail,this.textMessage.length>=(null!==(t=this.maxLength)&&void 0!==t?t:Qi)?this.disableSendButton=!0:this.disableSendButton&&(this.disableSendButton=!1),Yt.setItem(this.storageKey,e.detail)},this.onKeyDownHandler=e=>{"Enter"===e.key&&e.shiftKey||this.disableSendButton||"Enter"===e.key&&(e.preventDefault(),this.isEditing?this.handleEditMessage():this.handleSendMessage())},this.onFileUploadHandler=(e,t)=>{this.fileToUpload={type:e,file:t}},this.onQuotedMessageDismissHandler=()=>{this.onQuotedMessageDismiss.emit()},this.cleanup=()=>{this.textMessage="",this.fileToUpload=null,Yt.setItem(this.storageKey,""),this.$textComposer.setText("",!0),this.isEmojiPickerOpen=!1},this.onKeyDownHandler=this.onKeyDownHandler.bind(this)}connectedCallback(){this.textMessage=this.message||Yt.getItem(this.storageKey)||"",this.checkRateLimitBreached(Date.now())}componentWillUpdate(){this.textMessage=this.message||Yt.getItem(this.storageKey)||""}componentDidLoad(){this.message&&P(()=>this.$textComposer.setText(this.message,!0))}checkRateLimitBreached(e){if(Io.messagesSent>=this.rateLimits.maxInvocations){this.disableSendButton=!0,this.rateLimitsBreached=!0;const t=e-Io.startTime+1e3*this.rateLimits.period;setTimeout(()=>{Io.messagesSent=0,Io.startTime=Date.now(),this.disableSendButton=!1,this.rateLimitsBreached=!1},t)}}render(){var e;const t={iconPack:this.iconPack,t:this.t};return z(G,{key:"d0cb57c1d3b74db36e3ddfa5453a960de7968a1b"},this.canSendTextMessage&&this.isEmojiPickerOpen&&z("dyte-emoji-picker",Object.assign({key:"d26c303b8d1e460eabe0fdbadb4f1ab3381b16cc",part:"emoji-picker",onPickerClose:()=>{this.isEmojiPickerOpen=!1},onDyteEmojiClicked:e=>{this.textMessage+=e.detail,this.$textComposer.setText(this.textMessage,!0)}},t)),z("slot",{key:"93a6e0c49183a080be84172ce0a69b0d0a9b274a",name:"chat-addon"}),this.quotedMessage&&0!==this.quotedMessage.length&&z("div",{key:"9b235c2f65766cc80f40091b6d4e01f614f910f3",class:"quoted-message-container",part:"quoted-message-container"},z("div",{key:"3e2582d7ccc9747be95f140ea0f3c9151b5fc365",class:"quoted-message scrollbar"},z("dyte-text-message-view",{key:"d5ef25a57bf0f2a026c5fd92b202e0d337a3e52a",text:this.quotedMessage,isMarkdown:!0})),z("div",{key:"c0d69d22711c6dd7e9a84f18f3bdb2f4e0b60a20"},z("dyte-icon",{key:"9a9b6cd5df08157b411cbcbfb628a714f04cd291","aria-label":this.t("dismiss"),class:"dismiss",icon:this.iconPack.dismiss,onClick:this.onQuotedMessageDismissHandler}))),z("div",{key:"9dc15207103dceeded2a03c69a75bfa7919b98eb",class:"composer-container"},z("div",{key:"f456c8bd28ee60155b3735458aa172aa55b574f8",class:"composers"},this.fileToUpload&&z("dyte-draft-attachment-view",Object.assign({key:"0417d1e33ac0e4fc0df52bdc0a04661701c4efcf"},t,{attachment:this.fileToUpload,onDeleteAttachment:()=>this.fileToUpload=null})),!this.fileToUpload&&z("dyte-text-composer-view",{key:"83b68d635390774b5f931f5e00e0caa8f8b739d9",value:this.textMessage,placeholder:this.inputTextPlaceholder,onTextChange:this.onTextChangeHandler,keyDownHandler:this.onKeyDownHandler,maxLength:null!==(e=this.maxLength)&&void 0!==e?e:Qi,rateLimitBreached:this.rateLimitsBreached,t:this.t,iconPack:this.iconPack,ref:e=>this.$textComposer=e})),z("div",{key:"033cfe3365464c83af8d0ef0b590c0ffa900c146",class:"chat-buttons",part:"chat-buttons"},z("div",{key:"fcc9ae557a0f31c15611694a6073486fa6b22986",class:"left",part:"chat-buttons-left"},!this.fileToUpload&&!this.isEditing&&z("div",{key:"d9b9f602c036d8dec831daec2065097a987fa213"},this.canSendFiles&&[z("dyte-file-picker-button",Object.assign({key:"31270adc1fb72d8817e3218d596823cbffd0b032"},t,{onFileChange:e=>this.onFileUploadHandler("file",e.detail)})),z("dyte-file-picker-button",Object.assign({key:"1168afc0827bc2b63463c1eaf1e805abea7388d7",filter:"image/*",label:this.t("chat.send_img"),icon:"image",onFileChange:e=>this.onFileUploadHandler("image",e.detail)},t))],this.canSendTextMessage&&!this.disableEmojiPicker&&z("dyte-emoji-picker-button",Object.assign({key:"ef781c8e02daadede1ddc1eab5ef52598484b6d0",isActive:this.isEmojiPickerOpen,onClick:()=>{this.isEmojiPickerOpen=!this.isEmojiPickerOpen}},t)),z("slot",{key:"e80c453df4dcd546e804ea68ad9e5a783048662d",name:"chat-buttons"}))),z("div",{key:"e76f5c295316bc20e52d150f3a005cd91c90e210",class:"right",part:"chat-buttons-right"},!this.isEditing&&z("dyte-tooltip",{key:"d26dee018b74152225a19258165534ed7f793066",variant:"primary",label:this.t("chat.send_msg"),delay:2e3},z("dyte-button",{key:"5ad58b3709f82d11006bbc05a80c9c74134fe598",kind:"icon",disabled:this.disableSendButton,onClick:()=>this.handleSendMessage(),title:this.t("chat.send_msg")},z("dyte-icon",{key:"785be312a087790413e75151d352085585f8be31",icon:this.iconPack.send}))),this.isEditing&&z("div",{key:"5ee9a079da42dd6ef58d39dd611a170d324d1783",class:"edit-buttons"},z("dyte-tooltip",{key:"35ed375683386ff3a411e84b0bff663fd2d9cdfd",variant:"secondary",label:this.t("cancel"),delay:2e3},z("dyte-button",{key:"80b21a18537664018306abf9b8b099d2b1ec354f",kind:"icon",variant:"secondary",onClick:()=>this.handleEditCancel(),title:this.t("cancel")},z("dyte-icon",{key:"d65f2a1c97cd5c36effcfa78fcd7ebe42b095be8",icon:this.iconPack.dismiss}))),z("dyte-tooltip",{key:"56ff8d5fd854720ec93f65d5bdcb88b4e2621e12",variant:"primary",label:this.t("chat.update_msg"),delay:2e3},z("dyte-button",{key:"81eb4a8f97baa957bfe718720fedbb8504010dae",kind:"icon",onClick:()=>this.handleEditMessage(),title:this.t("chat.send_msg")},z("dyte-icon",{key:"3fc29bac3ee52f825de73e81b19c49d92981dd4a",icon:this.iconPack.checkmark}))))))))}};Ro([si()],Do.prototype,"iconPack",void 0),Ro([si()],Do.prototype,"t",void 0),Do.style=":host {\n  display: flex;\n  flex-direction: column;\n  font-family: var(--dyte-font-family, sans-serif);\n  font-size: 14px;\n  position: relative;\n}\n\n.quoted-message-container {\n  margin-bottom: var(--dyte-space-2, 8px);\n  display: flex;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  border-radius: var(--dyte-border-radius-md, 8px);\n  border: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n}\n\n.quoted-message-container .quoted-message {\n  flex: 1 1 0%;\n  padding: var(--dyte-space-2, 8px);\n  border-radius: var(--dyte-border-radius-md, 8px);\n  max-height: var(--dyte-space-24, 96px);\n  overflow-y: auto;\n  word-break: break-all;\n}\n\n.quoted-message-container .quoted-message blockquote {\n  display: none;\n}\n\n.quoted-message-container dyte-icon.dismiss {\n  margin-left: auto;\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  padding: var(--dyte-space-2, 8px);\n  border-radius: var(--dyte-border-radius-md, 8px);\n  color: rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52));\n}\n\n.quoted-message-container dyte-icon.dismiss:hover {\n  cursor: pointer;\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.quoted-message-container dyte-icon.dismiss {\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-duration: 150ms;\n}\n\n.composer-container {\n  position: relative;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  border-radius: var(--dyte-border-radius-md, 8px);\n  overflow: hidden;\n  border: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n}\n\n.composer-container > .composers {\n    min-height: 60px;\n  }\n\n@container chatcontainer (height < 360px) {\n    .composer-container > .composers {\n      min-height: 30px;\n    }\n}\n\n.chat-buttons {\n  padding: var(--dyte-space-3, 12px);\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n}\n\n.chat-buttons .right {\n  z-index: 10;\n}\n\n.chat-buttons .right .edit-buttons {\n  display: flex;\n  gap: var(--dyte-space-2, 8px);\n}\n\n.chat-buttons > div {\n  display: flex;\n  align-items: center;\n}\n\ndyte-emoji-picker {\n  z-index: 20;\n  position: absolute;\n  top: calc(var(--dyte-space-72, 288px) * -1);\n  border-top: var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));\n  animation: 0.3s slide-up ease;\n}\n\n@keyframes slide-up {\n  from {\n    transform: translateY(100%);\n  }\n  to {\n    transform: translateY(0%);\n  }\n}\n";var Mo=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Oo=class{constructor(e){o(this,e),this.edit=W(this,"edit",7),this.reply=W(this,"reply",7),this.pin=W(this,"pin",7),this.delete=W(this,"delete",7),this.iconPack=Vt,this.t=Ht(),this.isSelf=!1,this.canEdit=!1,this.canDelete=!1,this.canReply=!1,this.canPin=!1,this.disableControls=!1,this.alignRight=!1,this.hideAvatar=!1,this.now=new Date,this.leftAlign=!1,this.renderMessage=()=>{switch(this.message.type){case"text":return z("div",{"is-continued":this.isContinued,key:this.message.id},this.isUnread&&z("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),z("dyte-text-message",{message:this.message,now:this.now,isContinued:this.isContinued,"data-timestamp":this.message.time.getTime(),iconPack:this.iconPack,t:this.t,showBubble:!0}));case"image":return z("div",{"is-continued":this.isContinued,key:this.message.id},this.isUnread&&z("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),z("dyte-image-message",{message:this.message,now:this.now,isContinued:this.isContinued,iconPack:this.iconPack,"data-timestamp":this.message.time.getTime(),t:this.t,showBubble:!0}));case"file":return z("div",{"is-continued":this.isContinued,key:this.message.id},this.isUnread&&z("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),z("dyte-file-message",{message:this.message,now:this.now,isContinued:this.isContinued,iconPack:this.iconPack,t:this.t,"data-timestamp":this.message.time.getTime(),showBubble:!0}));case"custom":this.child.setAttribute("message",JSON.stringify(this.message));const e=this.child.cloneNode(!0);return z("div",{"is-continued":this.isContinued,key:this.message.id,ref:t=>t.appendChild(e)})}},this.onReply=()=>{this.reply.emit(this.message)},this.onPinned=()=>{this.pin.emit(this.message)},this.onDelete=()=>{this.delete.emit(this.message)},this.onEdit=async()=>{this.edit.emit(this.message)},this.isTouchDevice=()=>"ontouchstart"in window||navigator.maxTouchPoints>0}renderControls(){if(!this.disableControls)return z("dyte-menu",{placement:this.alignRight?"bottom-end":"bottom-start"},z("button",{slot:"trigger",class:"actions"},z("dyte-icon",{icon:this.iconPack.chevron_down})),z("dyte-menu-list",null,this.canReply&&z("dyte-menu-item",{onClick:this.onReply},z("dyte-icon",{icon:this.iconPack.back,slot:"start"}),this.t("chat.reply")),this.canPin&&z("dyte-menu-item",{onClick:this.onPinned},z("dyte-icon",{icon:this.iconPack.pin,slot:"start"}),this.t("pin")),this.canEdit&&z("dyte-menu-item",{onClick:this.onEdit},z("dyte-icon",{icon:this.iconPack.edit,slot:"start"}),this.t("chat.edit_msg")),this.canDelete&&z("dyte-menu-item",{onClick:this.onDelete},z("dyte-icon",{icon:this.iconPack.delete,slot:"start"}),this.t("chat.delete_msg"))))}renderAvatar(){if(!this.hideAvatar)return this.isContinued?z("div",{class:"avatar"}):z("div",{class:"avatar"},z("dyte-avatar",{size:"sm",participant:{name:this.message.displayName,picture:this.senderDisplayPicture}}))}render(){return z(G,{key:"e9019b771308fb2ccbd6b42066db30ff9afac88f"},z("div",{key:"2b7364203c9f2f20db564fe2d98e787b2e7879d0",class:{"message-wrapper":!0,"align-right":this.alignRight,"left-align":this.leftAlign},"is-continued":this.isContinued},this.renderAvatar(),z("div",{key:"b98ffba657e3699b3011682dff7b87724b044ade",class:{message:!0,"show-on-hover":!this.isTouchDevice()},"is-continued":this.isContinued},this.renderMessage(),this.renderControls())))}get $el(){return Y(this)}};Mo([si()],Oo.prototype,"size",void 0),Mo([si()],Oo.prototype,"iconPack",void 0),Mo([si()],Oo.prototype,"t",void 0),Oo.style=".message-wrapper{display:flex;gap:var(--dyte-space-2, 8px);margin-left:var(--dyte-space-4, 16px);margin-right:var(--dyte-space-4, 16px);margin-top:var(--dyte-space-4, 16px)}[is-continued] .message-wrapper{margin-top:var(--dyte-space-0, 0px)}.message-wrapper.align-right{flex-direction:row-reverse}.file-picker{display:none}.message{position:relative;display:flex}.show-on-hover dyte-menu{visibility:hidden}.show-on-hover:hover dyte-menu{visibility:visible}.align-right .message{justify-content:flex-end;margin-left:auto}.align-right .message .head{margin-right:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-0, 0px);flex-direction:row-reverse;gap:var(--dyte-space-4, 16px)}.align-right .message dyte-text-message .bubble,.align-right .message dyte-image-message .bubble,.align-right .message dyte-file-message .bubble{padding-right:var(--dyte-space-5, 20px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.align-right .message .actions dyte-icon{color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.align-right dyte-menu{left:auto;right:var(--dyte-space-0, 0px)}.head{margin-bottom:var(--dyte-space-2, 8px);margin-left:var(--dyte-space-1, 4px);display:flex;align-items:center;gap:var(--dyte-space-2, 8px)}.head .name{font-size:14px;font-weight:600}.head .time{font-size:12px;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}dyte-menu{position:absolute;left:var(--dyte-space-0, 0px);top:var(--dyte-space-6, 24px);border-radius:var(--dyte-border-radius-lg, 12px)}dyte-menu dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);cursor:pointer}[is-continued] dyte-menu{top:var(--dyte-space-2, 8px)}.actions{display:flex;align-items:center;justify-content:center;padding:var(--dyte-space-0\\.5, 2px);border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent}.actions dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.body{margin-top:var(--dyte-space-1, 4px);margin-bottom:var(--dyte-space-1, 4px);overflow-wrap:break-word;font-size:14px;line-height:1.375}.body .emoji{font-size:24px}.body.bubble{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-1, 4px);max-width:var(--dyte-space-96, 384px);padding-top:var(--dyte-space-3, 12px);padding-bottom:var(--dyte-space-3, 12px);padding-left:var(--dyte-space-5, 20px);padding-right:var(--dyte-space-5, 20px);overflow-wrap:break-word;font-size:14px;line-height:1.375;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.body.bubble p{margin:var(--dyte-space-0, 0px);word-break:break-word}p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px)}dyte-text-message,dyte-image-message,dyte-file-message{display:block;font-family:var(--dyte-font-family, sans-serif);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));box-sizing:border-box}*[is-continued]{margin-top:var(--dyte-space-0, 0px)}.image{position:relative;height:var(--dyte-space-40, 160px);max-width:var(--dyte-space-64, 256px);cursor:pointer}.image img{display:none;height:100%;width:100%;border-radius:var(--dyte-border-radius-sm, 4px);-o-object-fit:cover;object-fit:cover}.image .image-spinner{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.image .image-spinner dyte-spinner{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}.image .image-errored{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);background-color:rgba(var(--dyte-colors-danger, 255 45 45) / 0.1);--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}.image .actions{display:none;height:var(--dyte-space-8, 32px);align-items:center;position:absolute;top:var(--dyte-space-2, 8px);right:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.image .actions .action{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);border-radius:var(--dyte-border-radius-none, 0);border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.image .actions .action:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.image.loaded img{display:block}.image.loaded .image-spinner{display:none}.image:hover .actions,.image:focus .actions{display:flex}.file{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);padding-top:var(--dyte-space-1\\.5, 6px);padding-bottom:var(--dyte-space-1\\.5, 6px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.file .file-data{flex:1 1 0%}.file .file-data .name{word-break:break-all;color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.file .file-data .file-data-split{margin-top:var(--dyte-space-0\\.5, 2px);display:flex;align-items:center;font-size:12px}.file .file-data .file-data-split .ext{margin-right:var(--dyte-space-2, 8px);text-transform:uppercase;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.file .file-data .file-data-split .divider{height:var(--dyte-space-4, 16px);width:var(--dyte-space-0\\.5, 2px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.file .file-data .file-data-split .size{margin-left:var(--dyte-space-2, 8px)}a{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));text-decoration-line:none}a:hover{text-decoration-line:underline}.new-chat-marker{display:flex;width:100%;align-items:center;gap:var(--dyte-space-2, 8px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}.new-chat-marker::before{content:'';height:1px;flex:1 1 0%;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.show-new-messages-ctr{pointer-events:none;display:flex;justify-content:flex-end;padding:var(--dyte-space-3, 12px);z-index:0;margin-top:calc(var(--dyte-space-14, 56px) * -1)}.show-new-messages{pointer-events:auto;--tw-translate-y:calc(var(--dyte-space-6, 24px) * -1);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:0;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.show-new-messages.active{--tw-translate-y:var(--dyte-space-0, 0px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:1}blockquote{margin:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px);background-color:transparent}.block-quote,blockquote{--tw-border-spacing-x:1px;--tw-border-spacing-y:1px;border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y);border-top-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-none, 0);border-left-width:var(--dyte-border-width-md, 2px);border-right-width:var(--dyte-border-width-none, 0);border-style:solid;border-left-color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));padding:var(--dyte-space-0\\.5, 2px);padding-left:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px) !important;border-radius:var(--dyte-border-radius-sm, 4px);border-top-left-radius:var(--dyte-border-radius-none, 0);border-bottom-left-radius:var(--dyte-border-radius-none, 0)}.link{color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.align-right .block-quote{border-color:rgb(var(--dyte-colors-text-on-brand-600, var(--dyte-colors-text-600, 255 255 255 / 0.52)));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity))}.align-right .link{color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.align-right .image .actions dyte-icon{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}.avatar{display:flex;width:var(--dyte-space-6, 24px)}.avatar dyte-avatar{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px);font-size:10px}.message{width:75%}.left-align .body{margin-top:var(--dyte-space-4, 16px)}.left-align [is-continued] .body{margin-top:var(--dyte-space-0, 0px)}.left-align .body{--tw-translate-x:calc(var(--dyte-space-8, 32px) * -1);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}";var Uo=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const $o=class{constructor(e){o(this,e),this.onPinMessage=W(this,"pinMessage",7),this.stateUpdate=W(this,"dyteStateUpdate",7),this.observingEl=[],this.autoScrollEnabled=!0,this.messages=[],this.canPinMessages=!1,this.iconPack=Vt,this.t=Ht(),this.now=new Date,this.showLatestMessageButton=!1,this.onScroll=e=>{const t=e.target;P(()=>{const{scrollTop:e,clientHeight:i,scrollHeight:s}=t;e+i+10>=s?(this.autoScrollEnabled=!0,this.showLatestMessageButton=!1):this.autoScrollEnabled=!1})},this.scrollToBottom=()=>{rs(this.$chat)},this.observeMessage=e=>{e&&this.observingEl.push(e);try{this.intersectionObserver.observe(e)}catch(e){}},this.getMessageActions=e=>{const t=[];return!e.pinned&&this.canPinMessages&&t.push({id:"pin_message",label:this.t("pin"),icon:this.iconPack.pin}),t},this.onMessageActionHandler=(e,t)=>{if("pin_message"===e)this.onPinMessage.emit(t)}}connectedCallback(){var e;this.lastReadTimestamp=null!==(e=Jt.everyone)&&void 0!==e?e:new Date("0001-01-01T00:00:00Z"),this.intersectionObserver=new IntersectionObserver(e=>{document.hasFocus()&&P(()=>{for(const t of e)if(t.isIntersecting){parseInt(t.target.getAttribute("data-timestamp"))>this.lastReadTimestamp.getTime()&&(Jt[this.selectedGroup]=new Date)}})});const t=()=>{this.now=new Date,this.timeout=setTimeout(()=>{null!=this.request&&(this.request=requestAnimationFrame(t))},6e4)};this.request=requestAnimationFrame(t),this.chatChanged(this.messages)}componentDidLoad(){this.$chat.addEventListener("scroll",this.onScroll),this.$chat.scrollTop=this.$chat.scrollHeight}componentDidRender(){this.autoScrollEnabled?rs(this.$chat):null==this.autoScrollEnabled&&rs(this.$chat,!1)}chatChanged(e){if(null!=this.$chat&&!this.autoScrollEnabled&&this.$chat.clientHeight!==this.$chat.scrollHeight)for(let t=e.length-1;t>=0;t--)if(e[t].message.time>this.lastReadTimestamp&&e[t].message.userId!==this.selfUserId){this.showLatestMessageButton=!0;break}}selectedBucketChanged(){this.autoScrollEnabled=void 0,this.observingEl.forEach(e=>{this.intersectionObserver.unobserve(e)}),this.observingEl=[]}disconnectedCallback(){this.$chat.removeEventListener("scroll",this.onScroll),this.intersectionObserver.disconnect(),clearTimeout(this.timeout),cancelAnimationFrame(this.request)}render(){var e;let t=null,i=!1;return z(G,{key:"01c61fd2a60ca11df413406967eb80af92d07de0"},z("div",{key:"b1a6ad7904236a7fdb50034f33de979faa080ef6",class:"chat-container scrollbar",ref:e=>this.$chat=e,part:"container"},z("div",{key:"95664e4f9b8faae0c31c128abc6f54cf5bcd6acf",class:"spacer",part:"spacer"}),z("div",{key:"e0c40200e05026bb748e608ba6abb6f02b5a701c",class:"chat",part:"chat"},null===(e=this.messages)||void 0===e?void 0:e.map(e=>{if("chat"===e.type){const{message:s}=e,a=!(s.userId===this.selfUserId)&&!this.autoScrollEnabled&&!i&&s.time>this.lastReadTimestamp;a&&(i=a);const r=!a&&s.userId===(null==t?void 0:t.userId)&&ts(s.time,null==t?void 0:t.time)<2;return t=s,z("div",{"is-continued":r,key:e.message.id,ref:this.observeMessage,"data-timestamp":s.time.getTime(),class:s.pinned?"pinned":""},a&&z("div",{class:"new-chat-marker",part:"new-chat-marker"},this.t("chat.new")),z("div",{class:"message-wrapper"},z("dyte-message-view",{time:s.time,actions:this.getMessageActions(s),authorName:s.displayName,hideAuthorName:!0,hideAvatar:!0,hideMetadata:!0,viewType:"incoming",variant:"bubble",onAction:e=>this.onMessageActionHandler(e.detail,s)},z("div",null,!r&&z("div",{class:"head"},z("div",{class:"name"},s.displayName),!!s.time&&z("div",{class:"time",title:ss(s.time)},is(s.time,new Date(Date.now())))),z("div",{class:"body"},"text"===s.type&&z("dyte-text-message-view",{text:s.message,isMarkdown:!0}),"file"===s.type&&z("dyte-file-message-view",{name:s.name,url:s.link,size:s.size}),"image"===s.type&&z("dyte-image-message-view",{url:s.link,onPreview:()=>{this.stateUpdate.emit({image:s})}})))),s.pinned&&z("div",{class:"pin-button",part:"pin-button"},z("dyte-tooltip",{label:this.t("unpin")},z("dyte-button",{kind:"icon",variant:"ghost",onClick:()=>this.onMessageActionHandler("pin_message",s),disabled:!this.canPinMessages},z("dyte-icon",{icon:this.iconPack.pin,size:"sm"}))))))}return null}))),z("div",{key:"518df977aebf5ecfc26a3f93904e24f92f607fc4",class:"show-new-messages-ctr"},z("dyte-button",{key:"7b6f0a1461957ec5947e4976d6457125e1096f16",class:{"show-new-messages":!0,active:this.showLatestMessageButton},kind:"icon",part:"show-new-messages",onClick:this.scrollToBottom},z("dyte-icon",{key:"0af3acc46412913b7555d8e2256ad2840c6f6226",icon:this.iconPack.chevron_down}))))}static get watchers(){return{messages:["chatChanged"],selectedGroup:["selectedBucketChanged"]}}};Uo([si()],$o.prototype,"size",void 0),Uo([si()],$o.prototype,"iconPack",void 0),Uo([si()],$o.prototype,"t",void 0),$o.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));word-break:break-word}.chat-container{box-sizing:border-box;display:flex;flex-direction:column;padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px);flex:1 0 0px;overflow-y:scroll}.chat-container .spacer{flex:1 1 auto}.chat-container .chat{flex:0 0 auto}.file-picker{display:none}.chat .head{display:flex;align-items:center}.chat .head .name{margin-right:var(--dyte-space-4, 16px);font-size:12px;font-weight:700}.chat .head .time{font-size:12px;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.chat .body{margin-top:var(--dyte-space-2, 8px);overflow-wrap:break-word;line-height:1.375}.chat .body .emoji{font-size:24px}p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px)}dyte-message-view{margin-top:var(--dyte-space-4, 16px);display:block;padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));box-sizing:border-box}dyte-message-view::part(message){flex-grow:1}*[is-continued] dyte-message-view{margin-top:var(--dyte-space-1, 4px)}.pinned .message-wrapper{position:relative}.pinned .pin-button{position:absolute;right:var(--dyte-space-4, 16px);top:calc(var(--dyte-space-4, 16px) * -1);display:flex;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.pinned .pin-button:hover dyte-button{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-600, 13 81 253) / var(--tw-bg-opacity))}.pinned dyte-message-view{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px)}a{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));text-decoration-line:none}a:hover{text-decoration-line:underline}.new-chat-marker{display:flex;width:100%;align-items:center;gap:var(--dyte-space-2, 8px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity))}.new-chat-marker::before{content:'';height:1px;flex:1 1 0%;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.show-new-messages-ctr{pointer-events:none;display:flex;justify-content:flex-end;padding:var(--dyte-space-3, 12px);z-index:0;margin-top:calc(var(--dyte-space-14, 56px) * -1)}.show-new-messages{pointer-events:auto;--tw-translate-y:var(--dyte-space-16, 64px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:0;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.show-new-messages.active{--tw-translate-y:var(--dyte-space-0, 0px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:1}";var Fo=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const No=class{constructor(e){o(this,e),this.editMessageInit=W(this,"editMessageInit",7),this.onPinMessage=W(this,"pinMessage",7),this.onDeleteMessage=W(this,"deleteMessage",7),this.stateUpdate=W(this,"dyteStateUpdate",7),this.iconPack=Vt,this.t=Ht(),this.leftAlign=!1,this.permissionsChanged=!1,this.pageSize=25,this.lastReadMessageIndex=-1,this.permissionsUpdateListener=()=>{this.permissionsChanged=!this.permissionsChanged},this.maybeMarkChannelAsRead=e=>{if(!this.selectedChannelId)return;if(0===e.length)return;if(-1!==this.lastReadMessageIndex)return;const t=e.at(0).time>e.at(-1).time?e.at(0):e.at(-1);t.channelIndex&&(this.lastReadMessageIndex=parseInt(t.channelIndex,10),this.meeting.chat.markLastReadMessage(this.selectedChannelId,t))},this.getChatMessages=async(e,t,i)=>{const{messages:s}=await this.meeting.chat.getMessages(e,t,i,void 0,this.selectedChannelId);return this.maybeMarkChannelAsRead(s),s},this.createChatNodes=e=>e.map((t,i)=>{var s;const a=t.userId===(null===(s=e[i-1])||void 0===s?void 0:s.userId);return this.createChatNode(t,a)}),this.disconnectMeeting=e=>{var t,i;null===(t=null==e?void 0:e.chat)||void 0===t||t.removeListener("chatUpdate",this.chatUpdateListener),null===(i=this.meeting)||void 0===i||i.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener)},this.getMessageActions=e=>{const t=[];return this.meeting.self.permissions.pinParticipant&&t.push({id:"pin_message",label:e.pinned?this.t("unpin"):this.t("pin"),icon:this.iconPack.pin}),t},this.onMessageActionHandler=(e,t)=>{switch(e){case"pin_message":this.onPinMessage.emit(t);break;case"delete_message":this.onDeleteMessage.emit(t)}},this.createChatNode=(e,t)=>{var i,s,a,r;if(0!==e.targetUserIds.length)return null;let n;return n="CHAT"===this.meeting.meta.viewType?null===(i=this.meeting.participants.all.toArray().find(t=>t.userId===e.userId))||void 0===i?void 0:i.picture:this.meeting.self.userId===e.userId?this.meeting.self.picture:null!==(a=null===(s=this.meeting.participants.joined.toArray().find(t=>t.userId===e.userId))||void 0===s?void 0:s.picture)&&void 0!==a?a:null===(r=this.meeting.participants.waitlisted.toArray().find(t=>t.userId===e.userId))||void 0===r?void 0:r.picture,z("div",{class:{pinned:e.pinned}},z("div",{class:"message-wrapper"},z("dyte-message-view",{time:e.time,actions:this.getMessageActions(e),authorName:e.displayName,avatarUrl:n,hideAuthorName:t,viewType:"incoming",variant:"bubble",onAction:t=>this.onMessageActionHandler(t.detail,e)},z("div",null,z("div",{class:"body"},"text"===e.type&&z("dyte-text-message-view",{text:e.message,isMarkdown:!0}),"file"===e.type&&z("dyte-file-message-view",{name:e.name,url:e.link,size:e.size}),"image"===e.type&&z("dyte-image-message-view",{url:e.link,onPreview:()=>{this.stateUpdate.emit({image:e})}})),e.pinned&&z("div",{class:"pin-icon",part:"pin-icon"},z("dyte-icon",{icon:this.iconPack.pin,size:"sm"}))))))},this.chatUpdateListener=e=>{this.selectedChannelId&&e.message.channelId!==this.selectedChannelId||("add"===e.action?(this.$paginatedListRef.onNewNode(e.message),this.lastReadMessageIndex=-1,this.maybeMarkChannelAsRead([e.message])):"delete"===e.action?this.$paginatedListRef.onNodeDelete(e.message.id):"edit"===e.action&&this.$paginatedListRef.onNodeUpdate(e.message.id,e.message))}}componentDidLoad(){const e=this.host.shadowRoot.querySelector("slot");e&&(this.children=e.assignedElements()[0])}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.disconnectMeeting(this.meeting)}meetingChanged(e,t){var i;null!=t&&this.disconnectMeeting(t),e&&!e.chat||(null!=e&&(null===(i=e.chat)||void 0===i||i.addListener("chatUpdate",this.chatUpdateListener),e.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener)),this.permissionsUpdateListener())}channelChanged(){this.lastReadMessageIndex=-1}render(){return z(G,{key:"0f87ae87443f5ebcb771924591c9b9d30af425f6"},z("dyte-paginated-list",{key:"f3a82fc12cf42265eb838da5d3bd36e2e3402fae",ref:e=>this.$paginatedListRef=e,pageSize:this.pageSize,pagesAllowed:3,fetchData:this.getChatMessages,createNodes:this.createChatNodes,selectedItemId:this.selectedChannelId,emptyListLabel:this.t("chat.empty_channel")},z("slot",{key:"89d54672424cfff5fe73d8ece157cdcf5534fa30"})))}get host(){return Y(this)}static get watchers(){return{meeting:["meetingChanged"],selectedChannelId:["channelChanged"]}}};Fo([si()],No.prototype,"meeting",void 0),Fo([si()],No.prototype,"size",void 0),Fo([si()],No.prototype,"iconPack",void 0),Fo([si()],No.prototype,"t",void 0),No.style=":host{display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));flex:1 0 0px}";var jo=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const zo=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht(),this.pageSize=50,this.searchMessages=async(e,t,i)=>this.meeting.chat.searchMessages(this.query,{channelId:this.channelId,timestamp:e,size:t,reversed:i}),this.nodeRenderer=e=>e.map(e=>z("dyte-chat-message",{key:e.id,message:e,disableControls:!0}))}render(){return z(G,{key:"984a388e6c194e27c5cb7918806bd9f156220ec7"},z("dyte-paginated-list",{key:"444fa000de6428b4c0c6e0c829eb4ef944d2a211",pageSize:this.pageSize,pagesAllowed:3,fetchData:this.searchMessages,createNodes:this.nodeRenderer,selectedItemId:this.query}))}};jo([si()],zo.prototype,"meeting",void 0),jo([si()],zo.prototype,"iconPack",void 0),jo([si()],zo.prototype,"t",void 0),zo.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:100%;flex-direction:column;position:relative;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}";var Bo=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Go=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.keyPressListener=e=>{"Escape"===e.key&&this.close()},this.iconPack=Vt,this.t=Ht(),this.close=()=>{this.states.activeConfirmationModal.onClose(this.stateUpdate,this.states,this.meeting),this.stateUpdate.emit({activeConfirmationModal:{active:!1}}),this.states.activeConfirmationModal={active:!1}},this.onConfirmation=async()=>{this.states.activeConfirmationModal.onClick(this.stateUpdate,this.states,this.meeting),this.stateUpdate.emit({activeConfirmationModal:{active:!1}}),this.states.activeConfirmationModal={active:!1}}}connectedCallback(){document.addEventListener("keydown",this.keyPressListener)}componentDidLoad(){}disconnectedCallback(){document.removeEventListener("keydown",this.keyPressListener)}render(){var e,t;const i=this.states.activeConfirmationModal;return z(G,{key:"bfb08e8cf23236412b9aa1a03ef0ea59e57fcc8f"},z("div",{key:"19031e843eeae492331dc2b70cb53ed7e34b7e1c",class:"leave-modal"},z("div",{key:"b06ee1276a63a09327f91ee94923b58e5e13dff7",class:"header"},z("h2",{key:"fe549a012577be074c4aeae7daf5f2b1d6431090",class:"title"},i.header?this.t(i.header):this.t("cta.confirmation"))),z("p",{key:"142ba47a0723cd6f8e3826ba0ea50a343eb3c4c0",class:"message"},i.content?this.t(i.content):""),z("div",{key:"695140e0148911b611c4e9ca85961059e78e5279",class:"content"},z("div",{key:"a5cfbf4dcf926dad8bbba83a0af1843605641a59",class:"leave-meeting"},z("dyte-button",{key:"42e5022b094fe7f8a7138975b7a987e3ba8357cb",variant:"secondary",title:i.cancelText?this.t(i.cancelText):this.t("cancel"),onClick:this.close,class:"br-secondary-btn"},i.cancelText?this.t(i.cancelText):this.t("cancel")),z("dyte-button",{key:"1e53176e5e5bfb774cd7169784823340b383c740",onClick:()=>this.onConfirmation(),variant:null!==(t=null===(e=this.states.activeConfirmationModal)||void 0===e?void 0:e.variant)&&void 0!==t?t:"danger",title:i.ctaText?this.t(i.ctaText):this.t("yes")},i.ctaText?this.t(i.ctaText):this.t("yes"))))))}};Bo([si()],Go.prototype,"meeting",void 0),Bo([si()],Go.prototype,"states",void 0),Bo([si()],Go.prototype,"iconPack",void 0),Bo([si()],Go.prototype,"t",void 0),Go.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;flex-direction:column;overflow:hidden;border-radius:var(--dyte-border-radius-md, 8px);padding:var(--dyte-space-8, 32px);width:100%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));width:400px;max-width:80%}.leave-modal{width:100%;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.leave-modal .header h2{margin:var(--dyte-space-0, 0px)}.leave-modal .content{font-size:14px}.leave-message p{margin-top:var(--dyte-space-3, 12px);margin-bottom:var(--dyte-space-3, 12px)}.leave-meeting{display:flex;flex-direction:row;justify-content:space-between;gap:var(--dyte-space-4, 16px)}.leave-meeting dyte-button{color:rgb(var(--dyte-colors-text-1000, 255 255 255));flex:1 1 0%}.end-meeting{margin-top:var(--dyte-space-2, 8px)}.br-secondary-btn{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.br-secondary-btn:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}";var Ho=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Vo=class{constructor(e){o(this,e),this.onChange=W(this,"valueChange",7),this.input="1",this.minValue=0,this.iconPack=Vt,this.t=Ht()}connectedCallback(){this.watchStateHandler(this.input),this.input=this.value.toString()}watchStateHandler(e){this.onChange.emit(e)}increment(){this.input=Math.max(parseInt(this.input)+1,this.minValue).toString()}decrement(){this.input=Math.max(this.minValue,parseInt(this.input)-1).toString()}render(){return z(G,{key:"001a8ab33d9ce321c040396bdb8de97399c72644"},z("dyte-button",{key:"90bc0534d63d549d34da72bdc98a260922905dd4",kind:"icon",variant:"ghost",onClick:()=>this.decrement()},z("dyte-icon",{key:"08efdbb92413cc53c280c24aa4c0b0267326f423",icon:this.iconPack.subtract})),z("input",{key:"71fb967f4f8896ec0f6435dd4011f7735bf53dd1",type:"number",value:this.input,min:this.minValue,onInput:e=>{const t=parseInt(e.target.value,10);isNaN(t)||t<this.minValue?this.input=this.minValue.toString():this.input=t.toString()}}),z("dyte-button",{key:"bb5df90fb048044238c7427903f455d870446539",kind:"icon",variant:"ghost",onClick:()=>this.increment()},z("dyte-icon",{key:"5ae0a6e2f3acec1e13cab00d1ec15c9b2f66363a",icon:this.iconPack.add})))}static get watchers(){return{input:["watchStateHandler"]}}};Ho([si()],Vo.prototype,"size",void 0),Ho([si()],Vo.prototype,"iconPack",void 0),Ho([si()],Vo.prototype,"t",void 0),Vo.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;flex-direction:row;align-items:center;justify-content:center;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));width:-moz-fit-content;width:fit-content;border-radius:var(--dyte-border-radius-sm, 4px);padding:var(--dyte-space-1, 4px)}p{margin:var(--dyte-space-0, 0px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px)}input{margin:var(--dyte-space-0, 0px);width:var(--dyte-space-6, 24px);padding:var(--dyte-space-2, 8px);border-width:var(--dyte-border-width-sm, 1px);border-style:solid;border-color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));text-align:center;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));border-radius:var(--dyte-border-radius-sm, 4px);font-size:16px;outline:2px solid transparent;outline-offset:2px;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{margin:var(--dyte-space-0, 0px);appearance:none;-webkit-appearance:none}input[type='number']{-moz-appearance:textfield}";var qo=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Ko=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.keyPressListener=e=>{"Escape"===e.key&&this.close()},this.iconPack=Vt,this.t=Ht(),this.activeTab="audio",this.isMobileMainVisible=!1,this.progress=0}connectedCallback(){document.addEventListener("keydown",this.keyPressListener)}disconnectedCallback(){this.keyPressListener&&document.removeEventListener("keydown",this.keyPressListener)}progressUpdate(e){this.progress=e.detail}changeTab(e){this.activeTab=e,"sm"===this.size&&(this.isMobileMainVisible||(this.isMobileMainVisible=!0))}close(){this.stateUpdate.emit({activeDebugger:!1})}getActiveTab(){switch(this.activeTab){case"audio":return this.t("debugger.audio.troubleshooting.label");case"screenshare":return this.t("debugger.screenshare.troubleshooting.label");case"video":return this.t("debugger.video.troubleshooting.label");case"system":return this.t("debugger.system.troubleshooting.label");default:return this.t("debugger.troubleshooting.label")}}render(){if(null==this.meeting)return null;const e={meeting:this.meeting,states:this.states,iconPack:this.iconPack,t:this.t,size:this.size},t=this.getActiveTab(),i=void 0!==navigator.getBattery;return z(G,null,z("aside",{class:{hide:this.isMobileMainVisible},part:"menu"},z("header",null,z("h3",null,this.t("debugger.troubleshooting.label"))),z("button",{type:"button",class:{active:"audio"===this.activeTab},onClick:()=>this.changeTab("audio")},this.t("debugger.audio.label"),z("div",{class:"right"},z("dyte-icon",{icon:this.iconPack.mic_on}),"sm"===this.size&&z("dyte-icon",{icon:this.iconPack.chevron_right}))),z("button",{type:"button",class:{active:"video"===this.activeTab},onClick:()=>this.changeTab("video")},this.t("debugger.video.label"),z("div",{class:"right"},z("dyte-icon",{icon:this.iconPack.video_on}),"sm"===this.size&&z("dyte-icon",{icon:this.iconPack.chevron_right}))),z("button",{type:"button",class:{active:"screenshare"===this.activeTab},onClick:()=>this.changeTab("screenshare")},this.t("debugger.screenshare.label"),z("div",{class:"right"},z("dyte-icon",{icon:this.iconPack.share_screen_start}),"sm"===this.size&&z("dyte-icon",{icon:this.iconPack.chevron_right}))),z("button",{type:"button",class:{active:"system"===this.activeTab,hidden:!i},onClick:()=>this.changeTab("system")},this.t("debugger.system.label"),z("div",{class:"right"},z("dyte-icon",{icon:this.iconPack.settings}),"sm"===this.size&&z("dyte-icon",{icon:this.iconPack.chevron_right})))),z("main",{class:{active:this.isMobileMainVisible},part:"main-content"},"sm"===this.size&&z("header",null,z("dyte-button",{kind:"icon",class:"back-btn",onClick:()=>this.isMobileMainVisible=!1},z("dyte-icon",{icon:this.iconPack.chevron_left})),z("h4",null,t)),"audio"===this.activeTab&&z("dyte-debugger-audio",Object.assign({},e)),"video"===this.activeTab&&z("dyte-debugger-video",Object.assign({},e)),"screenshare"===this.activeTab&&z("dyte-debugger-screenshare",Object.assign({},e)),"system"===this.activeTab&&i&&z("dyte-debugger-system",Object.assign({},e))))}};function Yo({stats:e}){if(!e||!e.length)return null;let t="Good";const i=e.map(e=>e.verdict);return i.includes("Poor")?t="Poor":i.includes("Average")&&(t="Average"),t}function Wo({packetLossPercentage:e}){let t="Good";return e>4?t="Poor":e>=1&&e<=4&&(t="Average"),t}function Zo({jitterInMS:e}){let t="Good";return e>100?t="Poor":e>=50&&e<=100&&(t="Average"),t}function Qo({bitrate:e}){let t="Good";return 0===Math.round(e/1024)&&(t="Poor"),t}function Xo({batteryLevelPercentage:e}){let t="Good";return e<20?t="Poor":e<50&&(t="Average"),t}function Jo({charging:e,dischargingTimeInSeconds:t,batteryLevelPercentage:i}){return i<20?"Poor":e?"Good":t<1800?"Poor":"Average"}qo([si()],Ko.prototype,"meeting",void 0),qo([si()],Ko.prototype,"states",void 0),qo([si()],Ko.prototype,"size",void 0),qo([si()],Ko.prototype,"iconPack",void 0),qo([si()],Ko.prototype,"t",void 0),Ko.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;overflow:hidden;border-radius:var(--dyte-border-radius-md, 8px);width:100%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}header{margin-right:var(--dyte-space-2, 8px);display:flex;align-items:center;justify-content:space-between;padding-top:var(--dyte-space-0, 0px);padding-bottom:var(--dyte-space-0, 0px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px)}header h3{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-4, 16px)}.back-btn{border-radius:var(--dyte-border-radius-sm, 4px);background-color:transparent;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.back-btn:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}aside{box-sizing:border-box;display:flex;max-width:var(--dyte-space-56, 224px) !important;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));padding-left:var(--dyte-space-2, 8px)}aside button{margin-top:var(--dyte-space-4, 16px);box-sizing:border-box;display:flex;width:100%;align-items:center;justify-content:space-between;border-top-left-radius:var(--dyte-border-radius-sm, 4px);border-bottom-left-radius:var(--dyte-border-radius-sm, 4px);padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px);padding-top:var(--dyte-space-3, 12px);padding-bottom:var(--dyte-space-3, 12px);background-color:transparent;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));cursor:default;font-size:14px;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);border-width:var(--dyte-border-width-none, 0);border-style:none;outline:2px solid transparent;outline-offset:2px}aside button .right{display:flex;align-items:center}aside button .right dyte-icon{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}aside button .right dyte-icon:last-child{margin-left:var(--dyte-space-4, 16px)}aside button[type='button']{cursor:pointer;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}aside button[type='button']:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}aside button[type='button']{border-right:var(--dyte-border-width-md, 2px) solid transparent}aside button.active{--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-border-opacity));background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / 0.2)}aside button.active:hover{background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / 0.2)}aside button.hidden{display:none}main{position:relative;box-sizing:border-box;display:flex;height:100%;width:100%;flex-direction:column}:host([size='sm']) aside{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));width:100% !important;max-width:100% !important;padding-left:var(--dyte-space-0, 0px)}:host([size='sm']) aside button{border-radius:var(--dyte-border-radius-none, 0)}:host([size='sm']) aside button.active{border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent}:host([size='sm']) aside button.active:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}:host([size='sm']) aside button.hidden{display:none}:host([size='sm']) aside.hide{display:none}aside button:host([size='sm']) aside.hide{display:none}:host([size='sm']) aside button:host([size='sm']) aside.hide{display:none}:host([size='sm']) main{display:none;height:100%;width:100%;padding:var(--dyte-space-0, 0px)}aside button:host([size='sm']) main{display:none}:host([size='sm']) aside button:host([size='sm']) main{display:none}:host([size='sm']) main.active{display:block}:host([size='sm']) header{margin:var(--dyte-space-0, 0px);justify-content:center}:host([size='sm']) header dyte-button{position:absolute;left:var(--dyte-space-4, 16px)}::-webkit-scrollbar{width:8px}::-webkit-scrollbar-track{border-radius:var(--dyte-border-radius-lg, 12px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}::-webkit-scrollbar-thumb{border-radius:var(--dyte-border-radius-lg, 12px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}::-webkit-scrollbar-thumb:hover{border-radius:var(--dyte-border-radius-lg, 12px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.progress-bar{height:var(--dyte-space-1, 4px);width:100%;overflow:hidden;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.progress-indicator{height:100%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity))}";var ed=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const td=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht(),this.isNetworkOpen=!0,this.isDevicesOpen=!1,this.audioProducerFormattedStats=[],this.audioProducerScoreStats=null,this.networkBasedMediaHealth=null,this.devicesHealth=null,this.mediaScoreUpdateListener=({kind:e,isScreenshare:t,scoreStats:i})=>{"audio"!==e||t||(this.audioProducerScoreStats=i)},this.deviceListUpdateListener=async()=>{const e=await this.meeting.self.getAudioDevices();this.devicesHealth=(null==e?void 0:e.length)>0?"Good":"Poor"},this.audioUpdateListener=()=>{this.meeting.self.audioEnabled||(this.audioProducerScoreStats=null)}}async audioProducerScoreStatsChanged(e){if(!e)return void(this.audioProducerFormattedStats=[]);const t=e,i=[];i.push({name:this.t("debugger.stats.bitrate.label"),value:`${Math.round(t.bitrate/1024)} kbps`,description:this.t("debugger.stats.bitrate.description"),verdict:Qo({bitrate:t.bitrate})}),i.push({name:this.t("debugger.stats.packet_loss.label"),value:`${t.packetsLostPercentage}%`,description:this.t("debugger.stats.packet_loss.description"),verdict:Wo({packetLossPercentage:t.packetsLostPercentage})}),i.push({name:this.t("debugger.stats.jitter.label"),value:`${Math.round(1e3*t.jitter)} ms`,description:this.t("debugger.stats.jitter.description"),verdict:Zo({jitterInMS:1e3*t.jitter})}),this.audioProducerFormattedStats=i,this.networkBasedMediaHealth=Yo({stats:i})}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.meeting&&(this.meeting.self.off("mediaScoreUpdate",this.mediaScoreUpdateListener),this.meeting.self.off("audioUpdate",this.audioUpdateListener),this.meeting.self.off("deviceListUpdate",this.deviceListUpdateListener))}async meetingChanged(e){e&&(e.self.on("mediaScoreUpdate",this.mediaScoreUpdateListener),e.self.on("audioUpdate",this.audioUpdateListener),e.self.on("deviceListUpdate",this.deviceListUpdateListener),await this.deviceListUpdateListener())}render(){var e,t;if(this.meeting)return z(G,null,z("div",{id:"header"}),z("div",{class:"tab-body"},z("div",{class:"status-container"},z("div",{class:"status-section"},z("div",{class:"section-header "+(this.networkBasedMediaHealth?"":"only-child")},z("span",null,this.t("debugger.audio.sections.network_media")),this.networkBasedMediaHealth&&z("span",{class:`status ${null===(e=this.networkBasedMediaHealth)||void 0===e?void 0:e.toLowerCase()}`},this.t(`debugger.quality.${null===(t=this.networkBasedMediaHealth)||void 0===t?void 0:t.toLowerCase()}`))),this.isNetworkOpen&&!this.audioProducerFormattedStats.length&&z("div",{class:"section-body missing-stats"},this.meeting.self.audioEnabled?z("span",null,this.t("debugger.audio.messages.generating_report")):z("span",null,this.t("debugger.audio.messages.enable_media"))),this.isNetworkOpen&&!!this.audioProducerFormattedStats.length&&z("div",{class:"section-body network-table"},this.audioProducerFormattedStats.map(e=>{var t,i;return z("div",{class:"network-row"},z("div",{class:"network-cell label"},z("strong",null,e.name),z("span",{class:"description"},e.description)),z("div",{class:"network-cell value"},z("span",{class:`status ${null===(t=e.verdict)||void 0===t?void 0:t.toLowerCase()}`},this.t(`debugger.quality.${null===(i=e.verdict)||void 0===i?void 0:i.toLowerCase()}`)),z("span",{class:"value"},e.value)))}))))))}static get watchers(){return{audioProducerScoreStats:["audioProducerScoreStatsChanged"],meeting:["meetingChanged"]}}};ed([si()],td.prototype,"meeting",void 0),ed([si()],td.prototype,"states",void 0),ed([si()],td.prototype,"size",void 0),ed([si()],td.prototype,"iconPack",void 0),ed([si()],td.prototype,"t",void 0),td.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;flex-direction:column;overflow:hidden;height:100%;width:100%;color:rgb(var(--dyte-colors-text-1000, 255 255 255));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.tab-body::-webkit-scrollbar{width:var(--dyte-space-1\\.5, 6px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.tab-body::-webkit-scrollbar-thumb{border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}h3{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:600}#header{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-5, 20px);display:flex;align-items:center;justify-content:space-evenly}.tab-body{margin:var(--dyte-space-4, 16px);display:flex;height:100%;flex-direction:column;justify-content:space-between;overflow-y:auto}.status-container{border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));border-radius:8px;padding:16px}.status-section{margin-bottom:12px}.section-header{display:flex;justify-content:space-between;align-items:center;font-weight:bold;padding:8px 0}.section-header.only-child{justify-content:center}.section-body.missing-stats{display:flex;text-align:center;justify-content:center}.section-header .status{color:rgba(var(--dyte-colors-success));font-weight:bold}.section-header .arrow{font-size:14px}.network-table{border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));border-radius:8px;margin-top:8px;overflow:hidden}.network-row{display:flex;justify-content:space-between;padding:12px;border-bottom:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60))}.network-row:last-child{border-bottom:none}.network-cell{display:flex;flex-direction:column}.network-cell.label strong{font-size:14px}.network-cell.label .description{font-size:12px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));margin-top:4px}.network-cell.value{text-align:right}.status.good{color:rgba(var(--dyte-colors-success))}.status.average{color:rgba(var(--dyte-colors-warning))}.status.poor{color:rgba(var(--dyte-colors-danger))}.value{font-size:14px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));margin-top:4px}dyte-settings-audio{display:flex;flex-direction:column}";var id=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const sd=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht(),this.isNetworkOpen=!0,this.isDevicesOpen=!1,this.videoProducerFormattedStats=[],this.videoProducerScoreStats=null,this.audioProducerFormattedStats=[],this.audioProducerScoreStats=null,this.networkBasedMediaHealth=null,this.mediaScoreUpdateListener=({kind:e,isScreenshare:t,scoreStats:i})=>{"video"===e&&t&&(this.videoProducerScoreStats=i),"audio"===e&&t&&(this.audioProducerScoreStats=i)},this.screenShareUpdateListener=()=>{this.meeting.self.screenShareEnabled||(this.videoProducerScoreStats=null,this.audioProducerScoreStats=null)}}async videoProducerScoreStatsChanged(e){if(!e)return void(this.videoProducerFormattedStats=[]);const t=e,i=[];i.push({name:this.t("debugger.stats.cpu_limitations.label"),value:t.cpuLimitations?"Yes":"No",description:this.t("debugger.stats.cpu_limitations.description"),verdict:t.cpuLimitations?"Poor":"Good"}),i.push({name:this.t("debugger.stats.bandwidth_limitations.label"),value:t.bandwidthLimitations?"Yes":"No",description:this.t("debugger.stats.bandwidth_limitations.description"),verdict:t.bandwidthLimitations?"Poor":"Good"}),i.push({name:this.t("debugger.stats.bitrate.label"),value:`${Math.round(t.bitrate/1024)} kbps`,description:this.t("debugger.stats.bitrate.description"),verdict:Qo({bitrate:t.bitrate})}),i.push({name:this.t("debugger.stats.packet_loss.label"),value:`${t.packetsLostPercentage}%`,description:this.t("debugger.stats.packet_loss.description"),verdict:Wo({packetLossPercentage:t.packetsLostPercentage})}),i.push({name:this.t("debugger.stats.jitter.label"),value:`${Math.round(1e3*t.jitter)} ms`,description:this.t("debugger.stats.jitter.description"),verdict:Zo({jitterInMS:1e3*t.jitter})}),this.videoProducerFormattedStats=i,this.networkBasedMediaHealth=Yo({stats:i})}async audioProducerScoreStatsChanged(e){if(!e)return void(this.audioProducerFormattedStats=[]);const t=e,i=[];i.push({name:this.t("debugger.stats.bitrate.label"),value:`${Math.round(t.bitrate/1024)} kbps`,description:this.t("debugger.stats.bitrate.description"),verdict:Qo({bitrate:t.bitrate})}),i.push({name:this.t("debugger.stats.packet_loss.label"),value:`${t.packetsLostPercentage}%`,description:this.t("debugger.stats.packet_loss.description"),verdict:Wo({packetLossPercentage:t.packetsLostPercentage})}),i.push({name:this.t("debugger.stats.jitter.label"),value:`${Math.round(1e3*t.jitter)} ms`,description:this.t("debugger.stats.jitter.description"),verdict:Zo({jitterInMS:1e3*t.jitter})}),this.audioProducerFormattedStats=i}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.meeting&&(this.meeting.self.off("mediaScoreUpdate",this.mediaScoreUpdateListener),this.meeting.self.off("screenShareUpdate",this.screenShareUpdateListener))}async meetingChanged(e){e&&(e.self.on("mediaScoreUpdate",this.mediaScoreUpdateListener),e.self.on("screenShareUpdate",this.screenShareUpdateListener))}render(){var e,t;if(this.meeting)return z(G,null,z("div",{id:"header"}),z("div",{class:"tab-body"},z("div",{class:"status-container"},z("div",{class:"status-section"},z("div",{class:"section-header "+(this.networkBasedMediaHealth?"":"only-child")},z("span",null,this.t("debugger.screenshare.sections.network_media")),this.networkBasedMediaHealth&&z("span",{class:`status ${null===(e=this.networkBasedMediaHealth)||void 0===e?void 0:e.toLowerCase()}`},this.t(`debugger.quality.${null===(t=this.networkBasedMediaHealth)||void 0===t?void 0:t.toLowerCase()}`))),this.isNetworkOpen&&!this.videoProducerFormattedStats.length&&z("div",{class:"section-body missing-stats"},this.meeting.self.screenShareEnabled?z("span",null,this.t("debugger.screenshare.messages.generating_report")):z("span",null,this.t("debugger.screenshare.messages.enable_media"))),this.isNetworkOpen&&!!this.videoProducerFormattedStats.length&&z("div",{class:"section-body network-table"},this.videoProducerFormattedStats.map(e=>{var t,i;return z("div",{class:"network-row"},z("div",{class:"network-cell label"},z("strong",null,e.name),z("span",{class:"description"},e.description)),z("div",{class:"network-cell value"},z("span",{class:`status ${null===(t=e.verdict)||void 0===t?void 0:t.toLowerCase()}`},this.t(`debugger.quality.${null===(i=e.verdict)||void 0===i?void 0:i.toLowerCase()}`)),z("span",{class:"value"},e.value)))}))))))}static get watchers(){return{videoProducerScoreStats:["videoProducerScoreStatsChanged"],audioProducerScoreStats:["audioProducerScoreStatsChanged"],meeting:["meetingChanged"]}}};id([si()],sd.prototype,"meeting",void 0),id([si()],sd.prototype,"states",void 0),id([si()],sd.prototype,"size",void 0),id([si()],sd.prototype,"iconPack",void 0),id([si()],sd.prototype,"t",void 0),sd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;flex-direction:column;overflow:hidden;height:100%;width:100%;color:rgb(var(--dyte-colors-text-1000, 255 255 255));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.tab-body::-webkit-scrollbar{width:var(--dyte-space-1\\.5, 6px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.tab-body::-webkit-scrollbar-thumb{border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}h3{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:600}#header{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-5, 20px);display:flex;align-items:center;justify-content:space-evenly}.tab-body{margin:var(--dyte-space-4, 16px);display:flex;height:100%;flex-direction:column;justify-content:space-between;overflow-y:auto}.status-container{border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));border-radius:8px;padding:16px}.status-section{margin-bottom:12px}.section-header{display:flex;justify-content:space-between;align-items:center;font-weight:bold;padding:8px 0}.section-header.only-child{justify-content:center}.section-body.missing-stats{display:flex;text-align:center;justify-content:center}.section-header .status{color:rgba(var(--dyte-colors-success));font-weight:bold}.section-header .arrow{font-size:14px}.network-table{border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));border-radius:8px;margin-top:8px;overflow:hidden}.network-row{display:flex;justify-content:space-between;padding:12px;border-bottom:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60))}.network-row:last-child{border-bottom:none}.network-cell{display:flex;flex-direction:column}.network-cell.label strong{font-size:14px}.network-cell.label .description{font-size:12px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));margin-top:4px}.network-cell.value{text-align:right}.status.good{color:rgba(var(--dyte-colors-success))}.status.average{color:rgba(var(--dyte-colors-warning))}.status.poor{color:rgba(var(--dyte-colors-danger))}.value{font-size:14px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));margin-top:4px}";var ad=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const rd=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht(),this.isBatterySectionOpen=!0,this.batterySectionHealth=null,this.battery=null,this.batteryFormattedStats=[],this.batteryUpdateListener=()=>{const e=Math.round(100*this.battery.level),t=[];t.push({name:this.t("debugger.system.battery.level.label"),value:`${e}%`,description:this.t("debugger.system.battery.level.description"),verdict:Xo({batteryLevelPercentage:e})}),t.push({name:this.t("debugger.system.battery.charging.label"),value:`${this.battery.charging?this.t("debugger.system.battery.charging.is_charging"):this.t("debugger.system.battery.charging.is_not_charging")}`,description:this.t("debugger.system.battery.charging.description"),verdict:Jo({batteryLevelPercentage:e,chargingTimeInSeconds:this.battery.chargingTime,dischargingTimeInSeconds:this.battery.dischargingTime,charging:this.battery.charging})}),this.batterySectionHealth=function({stats:e}){if(!e||!e.length)return null;let t="Good";const i=e.map(e=>e.verdict);return i.includes("Poor")?t="Poor":i.includes("Average")&&(t="Average"),t}({stats:t}),this.batteryFormattedStats=t}}toggleSection(e){"battery"===e&&(this.isBatterySectionOpen=!this.isBatterySectionOpen)}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.meeting&&this.battery&&(this.battery.removeEventListener("levelchange",this.batteryUpdateListener),this.battery.removeEventListener("chargingchange",this.batteryUpdateListener))}async meetingChanged(e){e&&void 0!==navigator.getBattery&&(this.battery=await navigator.getBattery(),this.battery.addEventListener("levelchange",this.batteryUpdateListener),this.battery.addEventListener("chargingchange",this.batteryUpdateListener),this.batteryUpdateListener())}render(){var e,t;if(this.meeting)return z(G,null,z("div",{id:"header"}),z("div",{class:"tab-body"},z("div",{class:"status-container"},z("div",{class:"status-section"},z("div",{class:"section-header",onClick:()=>this.toggleSection("battery")},z("span",null,this.t("debugger.system.sections.battery")),this.batterySectionHealth&&z("span",{class:`status ${null===(e=this.batterySectionHealth)||void 0===e?void 0:e.toLowerCase()}`},this.t(`debugger.quality.${null===(t=this.batterySectionHealth)||void 0===t?void 0:t.toLowerCase()}`))),this.isBatterySectionOpen&&!!this.batteryFormattedStats.length&&z("div",{class:"section-body battery-table"},this.batteryFormattedStats.map(e=>{var t,i;return z("div",{class:"battery-row"},z("div",{class:"battery-cell label"},z("strong",null,e.name),z("span",{class:"description"},e.description)),z("div",{class:"battery-cell value"},z("span",{class:`status ${null===(t=e.verdict)||void 0===t?void 0:t.toLowerCase()}`},this.t(`debugger.quality.${null===(i=e.verdict)||void 0===i?void 0:i.toLowerCase()}`)),z("span",{class:"value"},e.value)))}))))))}static get watchers(){return{meeting:["meetingChanged"]}}};ad([si()],rd.prototype,"meeting",void 0),ad([si()],rd.prototype,"states",void 0),ad([si()],rd.prototype,"size",void 0),ad([si()],rd.prototype,"iconPack",void 0),ad([si()],rd.prototype,"t",void 0),rd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;flex-direction:column;overflow:hidden;height:100%;width:100%;color:rgb(var(--dyte-colors-text-1000, 255 255 255));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.tab-body::-webkit-scrollbar{width:var(--dyte-space-1\\.5, 6px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.tab-body::-webkit-scrollbar-thumb{border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}h3{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:600}#header{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-5, 20px);display:flex;align-items:center;justify-content:space-evenly}.tab-body{margin:var(--dyte-space-4, 16px);display:flex;height:100%;flex-direction:column;justify-content:space-between;overflow-y:auto}.status-container{border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));border-radius:8px;padding:16px}.status-section{margin-bottom:12px}.section-header{display:flex;justify-content:space-between;align-items:center;font-weight:bold;padding:8px 0}.section-body.missing-stats{display:flex;text-align:center;justify-content:center}.section-header .status{color:rgba(var(--dyte-colors-success));font-weight:bold}.section-header .arrow{font-size:14px}.battery-table{border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));border-radius:8px;margin-top:8px;overflow:hidden}.battery-row{display:flex;justify-content:space-between;padding:12px;border-bottom:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60))}.battery-row:last-child{border-bottom:none}.battery-cell{display:flex;flex-direction:column}.battery-cell.label strong{font-size:14px}.battery-cell.label .description{font-size:12px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));margin-top:4px}.battery-cell.value{text-align:right}.status.good{color:rgba(var(--dyte-colors-success))}.status.average{color:rgba(var(--dyte-colors-warning))}.status.poor{color:rgba(var(--dyte-colors-danger))}.value{font-size:14px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));margin-top:4px}dyte-settings-video{display:flex;flex-direction:column}";var nd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const od=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht(),this.isNetworkOpen=!0,this.isDevicesOpen=!1,this.videoProducerFormattedStats=[],this.videoProducerScoreStats=null,this.networkBasedMediaHealth=null,this.devicesHealth=null,this.mediaScoreUpdateListener=({kind:e,isScreenshare:t,scoreStats:i})=>{"video"!==e||t||(this.videoProducerScoreStats=i)},this.deviceListUpdateListener=async()=>{const e=await this.meeting.self.getVideoDevices();this.devicesHealth=(null==e?void 0:e.length)>0?"Good":"Poor"},this.videoUpdateListener=()=>{this.meeting.self.videoEnabled||(this.videoProducerScoreStats=null)}}async videoProducerScoreStatsChanged(e){if(!e)return void(this.videoProducerFormattedStats=[]);const t=e,i=[];i.push({name:this.t("debugger.stats.cpu_limitations.label"),value:t.cpuLimitations?"Yes":"No",description:this.t("debugger.stats.cpu_limitations.description"),verdict:t.cpuLimitations?"Poor":"Good"}),i.push({name:this.t("debugger.stats.bandwidth_limitations.label"),value:t.bandwidthLimitations?"Yes":"No",description:this.t("debugger.stats.bandwidth_limitations.description"),verdict:t.bandwidthLimitations?"Poor":"Good"}),i.push({name:this.t("debugger.stats.bitrate.label"),value:`${Math.round(t.bitrate/1024)} kbps`,description:this.t("debugger.stats.bitrate.description"),verdict:Qo({bitrate:t.bitrate})}),i.push({name:this.t("debugger.stats.packet_loss.label"),value:`${t.packetsLostPercentage}%`,description:this.t("debugger.stats.packet_loss.description"),verdict:Wo({packetLossPercentage:t.packetsLostPercentage})}),i.push({name:this.t("debugger.stats.jitter.label"),value:`${Math.round(1e3*t.jitter)} ms`,description:this.t("debugger.stats.jitter.description"),verdict:Zo({jitterInMS:1e3*t.jitter})}),this.videoProducerFormattedStats=i,this.networkBasedMediaHealth=Yo({stats:i})}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.meeting&&(this.meeting.self.off("mediaScoreUpdate",this.mediaScoreUpdateListener),this.meeting.self.off("videoUpdate",this.videoUpdateListener),this.meeting.self.off("deviceListUpdate",this.deviceListUpdateListener))}async meetingChanged(e){e&&(e.self.on("mediaScoreUpdate",this.mediaScoreUpdateListener),e.self.on("videoUpdate",this.videoUpdateListener),e.self.on("deviceListUpdate",this.deviceListUpdateListener),await this.deviceListUpdateListener())}render(){var e,t;if(this.meeting)return z(G,null,z("div",{id:"header"}),z("div",{class:"tab-body"},z("div",{class:"status-container"},z("div",{class:"status-section"},z("div",{class:"section-header "+(this.networkBasedMediaHealth?"":"only-child")},z("span",null,this.t("debugger.video.sections.network_media")),this.networkBasedMediaHealth&&z("span",{class:`status ${null===(e=this.networkBasedMediaHealth)||void 0===e?void 0:e.toLowerCase()}`},this.t(`debugger.quality.${null===(t=this.networkBasedMediaHealth)||void 0===t?void 0:t.toLowerCase()}`))),this.isNetworkOpen&&!this.videoProducerFormattedStats.length&&z("div",{class:"section-body missing-stats"},this.meeting.self.videoEnabled?z("span",null,this.t("debugger.video.messages.generating_report")):z("span",null,this.t("debugger.video.messages.enable_media"))),this.isNetworkOpen&&!!this.videoProducerFormattedStats.length&&z("div",{class:"section-body network-table"},this.videoProducerFormattedStats.map(e=>{var t,i;return z("div",{class:"network-row"},z("div",{class:"network-cell label"},z("strong",null,e.name),z("span",{class:"description"},e.description)),z("div",{class:"network-cell value"},z("span",{class:`status ${null===(t=e.verdict)||void 0===t?void 0:t.toLowerCase()}`},this.t(`debugger.quality.${null===(i=e.verdict)||void 0===i?void 0:i.toLowerCase()}`)),z("span",{class:"value"},e.value)))}))))))}static get watchers(){return{videoProducerScoreStats:["videoProducerScoreStatsChanged"],meeting:["meetingChanged"]}}};nd([si()],od.prototype,"meeting",void 0),nd([si()],od.prototype,"states",void 0),nd([si()],od.prototype,"size",void 0),nd([si()],od.prototype,"iconPack",void 0),nd([si()],od.prototype,"t",void 0),od.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;flex-direction:column;overflow:hidden;height:100%;width:100%;color:rgb(var(--dyte-colors-text-1000, 255 255 255));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.tab-body::-webkit-scrollbar{width:var(--dyte-space-1\\.5, 6px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.tab-body::-webkit-scrollbar-thumb{border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}h3{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:600}#header{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-5, 20px);display:flex;align-items:center;justify-content:space-evenly}.tab-body{margin:var(--dyte-space-4, 16px);display:flex;height:100%;flex-direction:column;justify-content:space-between;overflow-y:auto}.status-container{border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));border-radius:8px;padding:16px}.status-section{margin-bottom:12px}.section-header{display:flex;justify-content:space-between;align-items:center;font-weight:bold;padding:8px 0}.section-header.only-child{justify-content:center}.section-body.missing-stats{display:flex;text-align:center;justify-content:center}.section-header .status{color:rgba(var(--dyte-colors-success));font-weight:bold}.section-header .arrow{font-size:14px}.network-table{border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));border-radius:8px;margin-top:8px;overflow:hidden}.network-row{display:flex;justify-content:space-between;padding:12px;border-bottom:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60))}.network-row:last-child{border-bottom:none}.network-cell{display:flex;flex-direction:column}.network-cell.label strong{font-size:14px}.network-cell.label .description{font-size:12px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));margin-top:4px}.network-cell.value{text-align:right}.status.good{color:rgba(var(--dyte-colors-success))}.status.average{color:rgba(var(--dyte-colors-warning))}.status.poor{color:rgba(var(--dyte-colors-danger))}.value{font-size:14px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));margin-top:4px}dyte-settings-video{display:flex;flex-direction:column}";var dd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const ld=class{constructor(e){o(this,e),this.onClose=W(this,"dyteDialogClose",7),this.hideCloseButton=!1,this.disableEscapeKey=!1,this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.open=!0,this.close=()=>{this.open=!1,this.onClose.emit()},this.keydownListener=e=>{!this.disableEscapeKey&&"Escape"===e.key&&this.open&&this.close()}}connectedCallback(){document.addEventListener("keydown",this.keydownListener)}disconnectedCallback(){document.removeEventListener("keydown",this.keydownListener)}render(){return this.open?z(G,null,z("div",{id:"dialog",part:"container",role:"dialog","aria-modal":"true"},z("slot",null),!this.hideCloseButton&&z("dyte-button",{part:"close-button",id:"dismiss-btn",kind:"icon",variant:"ghost",onClick:()=>this.close(),type:"button","aria-label":this.t("dialog.close"),role:"button"},z("dyte-icon",{icon:this.iconPack.dismiss})))):null}};dd([si()],ld.prototype,"meeting",void 0),dd([si()],ld.prototype,"states",void 0),dd([si()],ld.prototype,"size",void 0),dd([si()],ld.prototype,"iconPack",void 0),dd([si()],ld.prototype,"t",void 0),ld.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:fixed;top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);box-sizing:border-box;padding:var(--dyte-space-4, 16px);flex-direction:column;align-items:center;justify-content:center;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / 0.5);color:rgb(var(--dyte-colors-text-1000, 255 255 255));visibility:hidden;display:none;overflow-wrap:break-word;word-wrap:break-word;z-index:60;-webkit-backdrop-filter:blur(12px) saturate(180%);backdrop-filter:blur(12px) saturate(180%)}#dialog{position:relative;max-height:100%;max-width:100%}#dismiss-btn{position:absolute;top:var(--dyte-space-3, 12px);right:var(--dyte-space-3, 12px);z-index:50}::slotted(*){max-height:100%;max-width:100%}:host([open]){visibility:visible;display:flex}:host([open='false']){visibility:hidden;display:none}";var cd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const hd=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.updateStoreState=(e,t)=>{this.stateUpdate.emit({[e]:t})},this.cancelJoinStage=async()=>{var e,t,i;"ACCEPTED_TO_JOIN_STAGE"===(null===(e=this.meeting.stage)||void 0===e?void 0:e.status)&&await(null===(i=null===(t=this.meeting)||void 0===t?void 0:t.stage)||void 0===i?void 0:i.leave()),this.updateStoreState("activeJoinStage",!1)},this.joinStage=async()=>{await this.meeting.stage.join()},this.stageStatusUpdateListener=e=>{var t;(null===(t=this.states)||void 0===t?void 0:t.activeJoinStage)&&"ON_STAGE"===e&&this.updateStoreState("activeJoinStage",!1)}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e;null===(e=this.meeting.stage)||void 0===e||e.removeListener("stageStatusUpdate",this.stageStatusUpdateListener)}meetingChanged(e){if(null==e)return;const{stage:t}=e;null==t||t.addListener("stageStatusUpdate",this.stageStatusUpdateListener)}render(){var e,t,i,s;const a={meeting:this.meeting,states:this.states,config:this.config,size:this.size,iconPack:this.iconPack,t:this.t},r=this.states;if(null!=(null==r?void 0:r.image)){const e=r.image,t=()=>{this.stateUpdate.emit({image:null})};return z(G,null,z("dyte-dialog",{open:!0,onDyteDialogClose:t,hideCloseButton:!0,iconPack:this.iconPack,t:this.t},z("dyte-image-viewer",Object.assign({},a,{image:e,onClose:t}))))}if(!0===(null==r?void 0:r.activeSettings))return z(G,null,z("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeSettings",!1),iconPack:this.iconPack,t:this.t},z("dyte-settings",Object.assign({},a))));if(!0===(null==r?void 0:r.activeDebugger))return z(G,null,z("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeDebugger",!1),iconPack:this.iconPack,t:this.t},z("dyte-debugger",Object.assign({},a))));if(!0===(null==r?void 0:r.activeLeaveConfirmation))return z(G,null,z("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeLeaveConfirmation",!1),iconPack:this.iconPack,t:this.t},z("dyte-leave-meeting",Object.assign({},a))));if(!0===(null===(e=null==r?void 0:r.activePermissionsMessage)||void 0===e?void 0:e.enabled))return z(G,null,z("dyte-dialog",{open:!0,hideCloseButton:!0,iconPack:this.iconPack,t:this.t},z("dyte-permissions-message",Object.assign({},a))));if(!0===(null===(t=null==r?void 0:r.activeBreakoutRoomsManager)||void 0===t?void 0:t.active))return z(G,null,z("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeBreakoutRoomsManager",{active:!1,data:void 0}),iconPack:this.iconPack,t:this.t},z("dyte-breakout-rooms-manager",Object.assign({},a))));if(!0===(null===(i=null==r?void 0:r.activeConfirmationModal)||void 0===i?void 0:i.active))return z(G,null,z("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeConfirmationModal",!1),iconPack:this.iconPack,t:this.t},z("dyte-confirmation-modal",Object.assign({},a))));if(!0===(null===(s=null==r?void 0:r.activeOverlayModal)||void 0===s?void 0:s.active))return z(G,null,z("dyte-overlay-modal",{meeting:this.meeting,states:this.states,iconPack:this.iconPack,t:this.t}));if(null==r?void 0:r.activeBroadcastMessageModal)return z(G,null,z("dyte-dialog",{open:!0,onDyteDialogClose:()=>this.updateStoreState("activeBroadcastMessageModal",!1),iconPack:this.iconPack,t:this.t},z("dyte-broadcast-message-modal",Object.assign({},a))));if(!0===(null==r?void 0:r.activeJoinStage)){const e={title:this.t("stage.join_title"),label:{accept:this.t("stage.join_confirm"),reject:this.t("stage.join_cancel")},description:this.t("stage.join_summary")};return z(G,null,z("dyte-dialog",{open:!0,onDyteDialogClose:this.cancelJoinStage,iconPack:this.iconPack,t:this.t},z("dyte-join-stage",Object.assign({dataConfig:e,onDyteJoinStage:this.joinStage,onDyteLeaveStage:this.cancelJoinStage},a))))}return!0===(null==r?void 0:r.activeMuteAllConfirmation)?z(G,null,z("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.updateStoreState("activeMuteAllConfirmation",!1)},iconPack:this.iconPack,t:this.t},z("dyte-mute-all-confirmation",Object.assign({},a)))):(null==r?void 0:r.activeChannelCreator)?z(G,null,z("dyte-dialog",{open:!0,onDyteDialogClose:()=>{this.updateStoreState("activeChannelCreator",!1)},iconPack:this.iconPack,t:this.t},z("dyte-channel-creator",Object.assign({},a)))):null}static get watchers(){return{meeting:["meetingChanged"]}}};cd([si()],hd.prototype,"meeting",void 0),cd([si()],hd.prototype,"states",void 0),cd([si()],hd.prototype,"size",void 0),cd([si()],hd.prototype,"iconPack",void 0),cd([si()],hd.prototype,"t",void 0),hd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";var pd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const ud=class{constructor(e){o(this,e),this.onDeleteAttachment=W(this,"deleteAttachment",7),this.iconPack=Vt,this.t=Ht(),this.attachment=null,this.filePreview=null,this.fileReader=new FileReader,this.generatePreview=()=>{"image"===this.attachment.type?this.fileReader.readAsDataURL(this.attachment.file):"file"===this.attachment.type&&(this.filePreview=this.attachment.file.name)},this.onDeleteClickHandler=()=>{this.filePreview=null,this.onDeleteAttachment.emit()}}onAttachmentChange(){this.generatePreview()}connectedCallback(){this.fileReader.onload=e=>{"string"==typeof e.target.result&&(this.filePreview=e.target.result)}}componentWillLoad(){this.onAttachmentChange()}render(){return z(G,{key:"9ac12b9992619fe12ab30d07dfcd3113562e6d12"},z("div",{key:"3540e19bd3d7b5185c55359e128bdee18a31d32d",class:"preview-overlay"},z("div",{key:"2792a2f153702696ce4bb3803b6a401cb2075238",class:"preview"},z("dyte-tooltip",{key:"f1ae3139d0199a03a9e85a7366c766c8cb9f84b2",label:this.t("chat.cancel_upload")},z("dyte-button",{key:"99d6e020c4b7042a7f91861c799ff251193bd16c",variant:"secondary",kind:"icon",onClick:this.onDeleteClickHandler},z("dyte-icon",{key:"e8809cbd2ee916275de659a4eed986ab71351235",icon:this.iconPack.dismiss}))),"image"===this.attachment.type?z("img",{class:"preview-image",src:this.filePreview}):z("div",{class:"preview-file"},z("span",null,this.filePreview)))))}static get watchers(){return{attachment:["onAttachmentChange"]}}};pd([si()],ud.prototype,"iconPack",void 0),pd([si()],ud.prototype,"t",void 0),ud.style=":host{display:flex;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));border-top-left-radius:var(--dyte-border-radius-md, 8px);border-top-right-radius:var(--dyte-border-radius-md, 8px)}.preview-overlay{position:absolute;top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);background-color:inherit}.preview{position:absolute;top:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);max-width:-moz-fit-content;max-width:fit-content;max-height:var(--dyte-space-20, 80px)}.preview:hover dyte-tooltip{display:block}.preview dyte-tooltip{position:absolute;top:calc(var(--dyte-space-1, 4px) * -1);left:calc(var(--dyte-space-1, 4px) * -1);display:none;margin-left:calc(var(--dyte-space-1, 4px) * -1);margin-top:calc(var(--dyte-space-1, 4px) * -1)}.preview dyte-button{display:flex;height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);align-items:center;justify-content:center;border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));border:1px solid rgb(var(--dyte-colors-text-1000, 255 255 255))}.preview dyte-icon{height:var(--dyte-space-3, 12px);width:var(--dyte-space-3, 12px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.preview-image{height:var(--dyte-space-16, 64px);width:var(--dyte-space-16, 64px);-o-object-fit:cover;object-fit:cover;max-height:100%;max-width:100%;overflow:clip;border-radius:var(--dyte-border-radius-md, 8px)}.preview-file{padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));overflow:hidden;text-overflow:ellipsis;white-space:nowrap;border-radius:var(--dyte-border-radius-md, 8px);max-width:200px}";let gd;var fd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const md=class{constructor(e){o(this,e),this.pickerClose=W(this,"pickerClose",7),this.emojiClicked=W(this,"dyteEmojiClicked",7),this.iconPack=Vt,this.t=Ht(),this.focusWhenOpened=!0,this.filterVal="",this.filteredEmojis=[]}componentWillLoad(){(async()=>{if(!gd){const e=await fetch("https://cdn.dyte.in/assets/emojis-data.json");gd=e.json()}return gd})().then(e=>{this.emojiList=e,this.handleInputChange(this.inputElement)})}componentDidLoad(){this.focusWhenOpened&&this.inputElement.focus()}handleInputChange(e){this.filterVal=e.value;const t=new RegExp(`([^,]*?${this.filterVal}[^,]*):(\\d+)`,"g");this.filteredEmojis=Array.from(this.emojiList.search.matchAll(t)).map(e=>({name:e[1],emoji:this.emojiList.emojis[e[2]]}))}handleEmojiClick(e){this.emojiClicked.emit(e)}mapEmojiList(){var e;return(null===(e=this.emojiList)||void 0===e?void 0:e.length)>0?z("div",{id:"loader"},z("dyte-spinner",{iconPack:this.iconPack})):z("div",{id:"emoji-grid",class:"scrollbar max-w-40"},this.filteredEmojis.map(e=>z("dyte-button",{key:`emoji-button-${e.name}`,class:"emoji",variant:"ghost",kind:"icon",title:e.name,onClick:()=>this.handleEmojiClick(e.emoji)},e.emoji)))}render(){return z(G,{key:"332fe557a1fd6c4813a20dc67218583ed52f8080"},z("div",{key:"c33a2a916b8bb69a6890de686837f26a2a52ca66",class:"close-parent"},z("dyte-button",{key:"68957f915e70a98008dfe083e4cc1b5b01fcffb1",variant:"ghost",kind:"icon",class:"close",onClick:()=>{var e;return null===(e=this.pickerClose)||void 0===e?void 0:e.emit()},"aria-label":this.t("close")},z("dyte-icon",{key:"95d651fdde6aa3c3ae93bfcce89449ef85adf278",icon:this.iconPack.dismiss}))),z("div",{key:"71eb89294bd37df1d38e8f890fc96eee692c751f",class:"emoji-parent"},z("input",{key:"6650cd87c893fbed52aac4a1017b81fa2c7a920b",value:this.filterVal,onInput:e=>this.handleInputChange(e.target),placeholder:this.t("search"),ref:e=>this.inputElement=e}),this.mapEmojiList()))}};fd([si()],md.prototype,"iconPack",void 0),fd([si()],md.prototype,"t",void 0),md.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{width:100%}.emoji-parent{box-sizing:border-box;display:inline-flex;height:var(--dyte-space-64, 256px);width:100%;max-width:640px;flex-direction:column;padding:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-0, 0px);-webkit-user-select:none;-moz-user-select:none;user-select:none;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.close-parent{display:flex;flex:1 1 0%;justify-content:flex-end;padding:var(--dyte-space-0, 0px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}#emoji-grid{margin-top:var(--dyte-space-2, 8px);box-sizing:border-box;display:flex;flex-direction:row;flex-wrap:wrap;align-content:flex-start;overflow-x:hidden;overflow-y:scroll;height:100%;grid-auto-rows:minmax(min-content, max-content)}#loader{display:flex;height:100%;width:100%;align-items:center;justify-content:center}input{display:block;height:var(--dyte-space-8, 32px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);font-size:14px;border-width:var(--dyte-border-width-none, 0);border-style:solid;border-style:none;border-color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}input::-moz-placeholder{color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}input::placeholder{color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}input{border-radius:var(--dyte-border-radius-sm, 4px);outline:2px solid transparent;outline-offset:2px;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms;border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60))}input:focus{--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-border-opacity));--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);--tw-ring-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-ring-opacity));--tw-ring-opacity:0.3}.emoji{height:var(--dyte-space-10, 40px);width:var(--dyte-space-10, 40px);font-size:20px;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}";var vd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const yd=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht()}render(){return z("dyte-tooltip",{key:"ed7771da8c8790052743bc9fe8da64c352b99826",label:this.t("chat.send_emoji")},z("dyte-button",{key:"16c59bbb9a708844c96569b89bbc246653c9d601",variant:"ghost",kind:"icon",class:{active:this.isActive},title:this.t("chat.send_emoji")},z("dyte-icon",{key:"27baf076cb231a538a31fd3759154a62d02c28b9",icon:this.iconPack.emoji_multiple})))}};vd([si()],yd.prototype,"iconPack",void 0),vd([si()],yd.prototype,"t",void 0),yd.style=":host{}";const bd=e=>e.split(/[#?]/)[0].split(".").pop().trim(),wd=e=>{if(!e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return`${(e/1024**t).toFixed(2)} ${["B","kB","MB","GB","TB"][t]}`},xd=async(e,t)=>{e=ni(e);let i=null==t?void 0:t.name;const s=await fetch(e);if(!s.ok)return void window.open(e,"_blank");const a=URL.createObjectURL(await s.blob()),r=document.createElement("a");r.href=a,r.download=null!=i?i:((e,t="file")=>{try{const i=new URL(e).pathname.split("/").pop();return"/"!==i?i:t}catch(e){return t}})(e,null==t?void 0:t.fallbackName),r.click()};var kd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Sd=class{constructor(e){o(this,e),this.now=new Date,this.isContinued=!1,this.iconPack=Vt,this.t=Ht(),this.showBubble=!1}render(){const e=ni(this.message.link);return z(G,{key:"f5befc2c8ec9cb19a0bdf188a3313be725601841"},!this.isContinued&&z(as,{key:"127c8691596fe2b2ea236ecf754d6ceca18dee08",name:this.message.displayName,time:this.message.time,now:this.now}),z("div",{key:"209f10f73b231b9d7ccd5de677ff812dfc235950",class:{body:!0,bubble:this.showBubble},part:"body"},z("div",{key:"47834225c4d6b625db6823f979ae0b592f897ff8",class:"file"},z("div",{key:"14516331f804e78977f0b718758cf71b6e57ff33",class:"file-data"},z("div",{key:"fa03e638f47d8af6b66eca2b9155c3683d51eb8a",class:"name"},this.message.name),z("div",{key:"e9060694813e9d9d90692c70a52ff782a156268d",class:"file-data-split"},z("div",{key:"7955b2e62e52a2d23cb026badbb1b8960b8ac6e1",class:"ext"},bd(this.message.name)),z("span",{key:"84d6ba7a76be685a3f1509c59d24844d29fd6fee",class:"divider"}),z("div",{key:"9070a6bac59bd947f0b73d4508bc1ff26a493f5d",class:"size"},wd(this.message.size)))),z("dyte-button",{key:"8ff6e3be0173975f1ab73220317f7171a9923383",variant:"secondary",kind:"icon",onClick:()=>xd(e,{name:this.message.name,fallbackName:"file"}),part:"button"},z("dyte-icon",{key:"da690564e3361a9f1ff1e4a933b21020636bd23e",icon:this.iconPack.download})))))}};kd([si()],Sd.prototype,"iconPack",void 0),kd([si()],Sd.prototype,"t",void 0);const Ed=class{constructor(e){o(this,e),this.iconPack=Vt}render(){return z("div",{key:"27ef49cd85552610eb2aa9cfb2046f13e98f0b87",class:"file"},z("dyte-button",{key:"5553484477a3363eaa1a786f66a3e6a86036b7e3",variant:"secondary",kind:"icon",onClick:()=>xd(ni(this.url),{name:this.name,fallbackName:"file"}),part:"button"},z("dyte-icon",{key:"f929d033d0a67ea654cb306bb5c175860f935af3",icon:this.iconPack.download})),z("div",{key:"238b4f2a4b47ef5d7f58d1e767cb409476073950",class:"file-data"},z("div",{key:"a7497d08623ef878d05c91d02114dbe3b1e5ac9d",class:"name"},this.name),z("div",{key:"3d361ca77f97b4f5d55ffa14173fb6be5e961140",class:"file-data-split"},z("div",{key:"d793ed396da5455431ca9a8937683a559531b575",class:"ext"},bd(this.name)),z("span",{key:"098df4e883f1dfb51e6d4274ca6761f6ad5467a7",class:"divider"}),z("div",{key:"f11132ba5caa159139a94edb1213904b51886a7d",class:"size"},wd(this.size)))))}};!function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);r>3&&n&&Object.defineProperty(t,i,n)}([si()],Ed.prototype,"iconPack",void 0),Ed.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.file{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);min-width:var(--dyte-space-40, 160px);max-width:var(--dyte-space-64, 256px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.file .file-data{margin-left:var(--dyte-space-1, 4px);flex:1 1 0%}.file .file-data .name{word-break:break-all;color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.file .file-data .file-data-split{margin-top:var(--dyte-space-0\\.5, 2px);display:flex;align-items:center;font-size:12px}.file .file-data .file-data-split .ext{margin-right:var(--dyte-space-2, 8px);text-transform:uppercase;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.file .file-data .file-data-split .divider{height:var(--dyte-space-4, 16px);width:var(--dyte-space-0\\.5, 2px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.file .file-data .file-data-split .size{margin-left:var(--dyte-space-2, 8px)}";var Pd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Td=class{constructor(e){o(this,e),this.onFileChange=W(this,"fileChange",7),this.icon="attach",this.iconPack=Vt,this.t=Ht(),this.uploadFile=()=>{const e=this.fileInputField;e.type="file",this.filter&&(e.accept=this.filter),e.onchange=e=>{const{validity:t,files:[i]}=e.target;t.valid&&this.onFileChange.emit(i)},e.click()}}connectedCallback(){this.fileInputField=document.createElement("input")}disconnectedCallback(){this.fileInputField=void 0}render(){const e=this.label||this.t("chat.send_file"),t=this.iconPack[this.icon];return z("dyte-tooltip",{key:"334c14777babe9de198038dd3b37926176d1a08a",label:e},z("dyte-button",{key:"0bc4d797c62074d3ffe9531d04c9087b21b16e0f",variant:"ghost",kind:"icon",onClick:()=>this.uploadFile(),title:e},z("dyte-icon",{key:"99066f2ba8c7eb773b1e9d5d9895d340af1d11fe",icon:t})))}};Pd([si()],Td.prototype,"iconPack",void 0),Pd([si()],Td.prototype,"t",void 0),Td.style=":host{}";const Ld=e=>{try{return JSON.parse(e)}catch(t){return e}},Cd=class{constructor(e){o(this,e),this.variant="primary",this.size="lg"}render(){return z(G,{key:"7c30027e6133e5ec64063771c08d37a75b5435bd"},z("div",{key:"74cf660575c383f53e38ba4688612bc69dbe9b34",class:"icon-wrapper",innerHTML:Ld(this.icon),part:"wrapper"}))}};!function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);r>3&&n&&Object.defineProperty(t,i,n)}([si()],Cd.prototype,"size",void 0),Cd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block;height:var(--dyte-space-10, 40px);outline:2px solid transparent;outline-offset:2px}:host .icon-wrapper{display:flex;height:100%;width:100%;flex-direction:column;align-items:center}:host svg{height:100%;width:100%;outline:2px solid transparent;outline-offset:2px}:host([size='xl']){box-sizing:border-box;display:block;height:var(--dyte-space-16, 64px) !important;width:var(--dyte-space-16, 64px) !important;--dyte-spinner-color:currentColor}:host([size='md']){box-sizing:border-box;display:block;height:var(--dyte-space-6, 24px) !important;width:var(--dyte-space-6, 24px) !important;--dyte-spinner-color:currentColor}:host([size='sm']){box-sizing:border-box;display:block;height:var(--dyte-space-4, 16px) !important;width:var(--dyte-space-4, 16px) !important;--dyte-spinner-color:currentColor}:host([variant='secondary']) .icon-wrapper{--tw-text-opacity:1;color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-text-opacity))}:host([variant='danger']) .icon-wrapper{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}";var _d=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Ad=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.now=new Date,this.isContinued=!1,this.iconPack=Vt,this.t=Ht(),this.showBubble=!1,this.status="loading"}render(){return z(G,{key:"fa9c168429dd5f92a542b7ca092dd4cc805743bd"},!this.isContinued&&z(as,{key:"dfd15b9192fc7198fef6c4b5f2964a83d912e53d",name:this.message.displayName,time:this.message.time,now:this.now}),z("div",{key:"cefee5d9928f506c9ff758c858cc53c12827ff35",class:{body:!0,bubble:this.showBubble},part:"body"},z("div",{key:"643e1d4703eac657c73467d0791307fba8aedcd8",class:{image:!0,loaded:"loaded"===this.status}},z("img",{key:"4453724021e1f2c83221cde8aebff82aceaf2e16",src:ni(this.message.link),onLoad:()=>{this.status="loaded"},onError:()=>{this.status="errored"},onClick:()=>{"loaded"===this.status&&this.stateUpdate.emit({image:this.message})}}),"loading"===this.status&&z("div",{key:"ee3cf0052083e8468c9aed66fb8716e541424c5a",class:"image-spinner",title:this.t("chat.img.loading"),"aria-label":this.t("chat.img.loading")},z("dyte-spinner",{key:"a1e1563ab6269ce75dc319c6896d609b45fbd76e",iconPack:this.iconPack})),"errored"===this.status&&z("div",{key:"9a17301d149d6aa957408592ba5ea004f204c638",class:"image-errored",title:this.t("chat.error.img_not_found"),"aria-label":this.t("chat.error.img_not_found")},z("dyte-icon",{key:"ee5672f1c3708329f9d6a299c8186d9383b6c963",icon:this.iconPack.image_off})),"loaded"===this.status&&z("div",{key:"6b15f2e58846b2d3bbdb706c939d6c0e174ef45b",class:"actions"},z("dyte-button",{key:"b4c0904c8b31f2e8e0fed72d8147e106827ca8b8",class:"action",variant:"secondary",kind:"icon",onClick:()=>{this.stateUpdate.emit({image:this.message})}},z("dyte-icon",{key:"4745d25ee35fe6ce31f7cf037a6e6b6da07c7047",icon:this.iconPack.full_screen_maximize})),z("dyte-button",{key:"51d687441df970faf55c745bdbb39186188e2da0",class:"action",variant:"secondary",kind:"icon",onClick:()=>xd(this.message.link,{fallbackName:"image"})},z("dyte-icon",{key:"cd488683796615bc0dd3c622338bf5949c0af89e",icon:this.iconPack.download}))))))}};_d([si()],Ad.prototype,"iconPack",void 0),_d([si()],Ad.prototype,"t",void 0),Ad.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.image-spinner{cursor:wait}.image-errored{cursor:not-allowed}";var Rd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Id=class{constructor(e){o(this,e),this.onPreview=W(this,"preview",7),this.iconPack=Vt,this.t=Ht(),this.status="loading"}render(){return z("div",{key:"4ab60c036ede1e5ff46471a978c68e5eafa615d3",class:{image:!0,loaded:"loaded"===this.status}},z("img",{key:"2eed0ef93098727817592425da81ff2357c60f72",src:ni(this.url),onLoad:()=>{this.status="loaded"},onError:()=>{this.status="errored"},onClick:()=>{"loaded"===this.status&&this.onPreview.emit(this.url)}}),"loading"===this.status&&z("div",{key:"13efea611d39c5eb679d7cf5603dec9f95edc775",class:"image-spinner",title:this.t("chat.img.loading"),"aria-label":this.t("chat.img.loading")},z("dyte-spinner",{key:"afc0eb62f76007c1a15da942fb53fe79ee4aa37f",iconPack:this.iconPack})),"errored"===this.status&&z("div",{key:"c7aa254df37a2eaacb29f94ef22c2f7c056114ad",class:"image-errored",title:this.t("chat.error.img_not_found"),"aria-label":this.t("chat.error.img_not_found")},z("dyte-icon",{key:"873385f922410dd9c86192326c0470e2d310e08d",icon:this.iconPack.image_off})),"loaded"===this.status&&z("div",{key:"70a59be0b7b21af1a440ba8165cc2e55c249323d",class:"actions"},z("dyte-button",{key:"62801cc02ea09562a895e983f62e5e3271e89039",class:"action",variant:"secondary",kind:"icon",onClick:()=>{this.onPreview.emit(this.url)}},z("dyte-icon",{key:"60d0fdacecec31d24af48016dc2f58d95aaa71f2",icon:this.iconPack.full_screen_maximize})),z("dyte-button",{key:"adacc2b4023f5acc00e4b39304312593d7e74d62",class:"action",variant:"secondary",kind:"icon",onClick:()=>xd(this.url,{fallbackName:"image"})},z("dyte-icon",{key:"5a455e504d1db35dcf8564458425dafd200129a3",icon:this.iconPack.download}))))}};Rd([si()],Id.prototype,"iconPack",void 0),Rd([si()],Id.prototype,"t",void 0),Id.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.image-spinner{cursor:wait}.image-errored{cursor:not-allowed}.image{display:block;font-family:var(--dyte-font-family, sans-serif);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));position:relative;height:var(--dyte-space-40, 160px);max-width:var(--dyte-space-64, 256px);cursor:pointer}.image img{display:none;height:100%;width:100%;border-radius:var(--dyte-border-radius-sm, 4px);-o-object-fit:cover;object-fit:cover}.image .image-spinner{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.image .image-spinner dyte-spinner{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}.image .image-errored{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);background-color:rgba(var(--dyte-colors-danger, 255 45 45) / 0.1);--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}.image .actions{display:none;height:var(--dyte-space-8, 32px);align-items:center;position:absolute;top:var(--dyte-space-2, 8px);right:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.image .actions .action{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);border-radius:var(--dyte-border-radius-none, 0);border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.image .actions .action:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.image.loaded img{display:block}.image.loaded .image-spinner{display:none}.image:hover .actions,.image:focus .actions{display:flex}";var Dd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Md=class{constructor(e){o(this,e),this.close=W(this,"close",7),this.t=Ht(),this.iconPack=Vt,this.keypressListener=e=>{"Escape"===e.key&&this.close.emit()},this.handleOutsideClick=()=>this.close.emit()}connectedCallback(){document.addEventListener("keydown",this.keypressListener),document.addEventListener("click",this.handleOutsideClick)}disconnectedCallback(){document.removeEventListener("keydown",this.keypressListener),document.removeEventListener("click",this.handleOutsideClick)}render(){return z(G,{key:"2491b39127e06ed796c380216cab38773f36209a",class:"scrollbar",onClick:e=>e.stopPropagation()},z("div",{key:"27dac52e6465f3e9dbfd415bcc1f34c6c1596635",class:"header"},z("div",{key:"7e9dab9f453cbc1bb7cd6cb2bab297bf671ca7d1",class:"shared-by-user"},this.t("chat.img.shared_by")," ",z("span",{key:"3ef88112f23a713d229b55d3bbc07cde28f5c461",class:"displayName"},oi(ai(this.image.displayName)))),z("div",{key:"15a34a4d4b095ff64acd4682e7b5c8b8c85e8ca3",class:"actions"},z("dyte-button",{key:"88195fbcf9286c332d460e787ec378944779db1b",onClick:()=>xd(this.image.link,{fallbackName:"image"})},z("dyte-icon",{key:"867a85747399a09446c0fde37738a898b999782d",icon:this.iconPack.download,slot:"start"}),"Download"),z("dyte-button",{key:"21a3c92ac5c52cd64911a3bbe115c5d7b0cf3397",kind:"icon",variant:"secondary",onClick:()=>this.close.emit()},z("dyte-icon",{key:"84d6450e7669cf9155c4cd2bb3be3d5f726033dc",icon:this.iconPack.dismiss})))),z("div",{key:"8db9e6e84b7836f089a6a98068c26dbfafd73529",class:"image-ctr"},z("img",{key:"200e0b6906bed300a4514b3b1baac10645803202",src:this.image.link})))}};Dd([si()],Md.prototype,"size",void 0),Dd([si()],Md.prototype,"t",void 0),Dd([si()],Md.prototype,"iconPack",void 0),Md.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{width:1140px;max-width:100%;box-sizing:border-box;display:flex;flex-direction:column;padding:var(--dyte-space-6, 24px);padding-top:var(--dyte-space-5, 20px);overflow-y:auto;color:rgb(var(--dyte-colors-text-1000, 255 255 255));z-index:40;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}.displayName{font-weight:700}.image-ctr{margin-top:var(--dyte-space-2, 8px);box-sizing:border-box;display:flex;justify-content:center;overflow:hidden}.actions{display:flex;align-items:center;justify-content:flex-end;gap:var(--dyte-space-2, 8px)}img{box-sizing:border-box;display:block;max-height:100%;max-width:100%;-o-object-fit:contain;object-fit:contain}.header{display:flex;align-items:center;justify-content:space-between;padding-bottom:var(--dyte-space-4, 16px)}.shared-by-user{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}:host([size='sm']) .header{flex-direction:column}:host([size='sm']) .header .actions{margin-top:var(--dyte-space-4, 16px)}";var Od=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Ud=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.joinStage=W(this,"dyteJoinStage",7),this.leaveStage=W(this,"dyteLeaveStage",7),this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.dataConfig={title:this.t("stage.join_title"),label:{accept:this.t("stage.join_confirm"),reject:this.t("stage.join_cancel")},description:this.t("stage.join_summary")},this.isLoading=!1}render(){var e,t;const i={meeting:this.meeting,size:this.size,states:this.states,config:this.config,iconPack:this.iconPack,t:this.t};return z(G,{key:"4fc08232560ec90d3cc13efaf69d7be2b7083c84",class:{stage:!0}},z("header",{key:"670578993c90490fb5184d710bbdee77218f0ae4"},z("h2",{key:"ea7574fa697829772e2840cf730536e6a2974e86"},this.dataConfig.title)),z(ls,{key:"25136ca653e3bf08f45628c18ec4885fc5bca31f",element:"dyte-participant-setup",defaults:i,props:{participant:null===(e=this.meeting)||void 0===e?void 0:e.self,size:"md"},childProps:{participant:null===(t=this.meeting)||void 0===t?void 0:t.self,size:"md"},deepProps:!0}),z("div",{key:"06fdd1149e50508c662781aae6e5a7a6e5c786bd",class:"summary"},this.dataConfig.description),z("div",{key:"fbd5720696f7c415be96410b1d948c909c41ae36",class:"container"},z("dyte-button",{key:"f81130f39cca1c774d0bf2bfb0b2b30d88758cbd",variant:"secondary",onClick:()=>this.leaveStage.emit(),title:this.dataConfig.label.reject},this.dataConfig.label.reject),z("dyte-button",{key:"53dd411070bcde6b0c933855a7530e129d0c6b1c",onClick:()=>{this.isLoading||(this.isLoading=!0,this.joinStage.emit())},title:this.dataConfig.label.accept},this.isLoading?z("dyte-icon",{icon:this.iconPack.spinner}):this.dataConfig.label.accept)))}};Od([si()],Ud.prototype,"meeting",void 0),Od([si()],Ud.prototype,"states",void 0),Od([si()],Ud.prototype,"size",void 0),Od([si()],Ud.prototype,"iconPack",void 0),Od([si()],Ud.prototype,"t",void 0),Ud.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host::-webkit-scrollbar{width:var(--dyte-space-1\\.5, 6px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}:host::-webkit-scrollbar-thumb{border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}:host(.stage){box-sizing:border-box;display:block;width:512px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));padding:var(--dyte-space-6, 24px);-webkit-user-select:none;-moz-user-select:none;user-select:none;overflow:auto;border-radius:var(--dyte-border-radius-md, 8px);line-height:1.25}:host(.stage) dyte-participant-setup{display:flex;flex:1 1 0%;align-items:center;justify-content:space-around;margin-left:auto;margin-right:auto}:host(.stage) .container dyte-button{flex-grow:1;padding:var(--dyte-space-1, 4px);width:50%}:host(.stage) .container dyte-button:nth-child(1){margin-right:var(--dyte-space-1\\.5, 6px)}:host(.stage) .container dyte-button:nth-child(2){margin-left:var(--dyte-space-1\\.5, 6px)}:host(.stage) h2{font-size:24px;font-weight:500;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}:host(.stage) header{padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px)}:host(.stage) .summary{padding:var(--dyte-space-4, 16px)}.deny-access{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}.container{width:100%;max-width:1080px;display:flex;flex:1 1 0%;align-items:center;justify-content:space-around}header{display:flex;align-items:center;justify-content:space-between}";var $d=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Fd=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.keyPressListener=e=>{"Escape"===e.key&&this.close()},this.iconPack=Vt,this.t=Ht(),this.canEndMeeting=!1,this.isBreakoutRoomsActive=!1,this.isChildMeeting=!1,this.canJoinMainRoom=!1,this.permissionsUpdateListener=()=>{this.canEndMeeting=this.meeting.self.permissions.kickParticipant,this.canJoinMainRoom=this.meeting.self.permissions.connectedMeetings.canSwitchToParentMeeting},this.close=()=>{this.stateUpdate.emit({activeLeaveConfirmation:!1})},this.handleLeave=()=>{var e;null===(e=this.meeting)||void 0===e||e.leaveRoom(),this.close()},this.handleJoinMainRoom=()=>{this.meeting.connectedMeetings.moveParticipants(this.meeting.meta.meetingId,this.meeting.connectedMeetings.parentMeeting.id,[this.meeting.self.userId]),this.close()},this.handleEndMeeting=()=>{var e;null===(e=this.meeting)||void 0===e||e.participants.kickAll(),this.close()}}connectedCallback(){this.meetingChanged(this.meeting),document.addEventListener("keydown",this.keyPressListener)}disconnectedCallback(){var e;document.removeEventListener("keydown",this.keyPressListener),null===(e=this.meeting)||void 0===e||e.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener)}meetingChanged(e){null!=e&&(this.isBreakoutRoomsActive=this.meeting.connectedMeetings.supportsConnectedMeetings&&this.meeting.connectedMeetings.isActive,this.isChildMeeting=this.meeting.connectedMeetings.supportsConnectedMeetings&&this.meeting.connectedMeetings.meetings.some(t=>t.id===e.meta.meetingId),this.meeting.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener),this.permissionsUpdateListener())}render(){return z(G,{key:"c5753a8ebb2736da351d10529f002fc53f71cf6e"},z("div",{key:"1d08a38e0f9036a77981a6d48154e795b456c1fe",class:"leave-modal"},z("div",{key:"be3b122e0d37cab7898ce22c77885084fdc71a37",class:"header"},z("h2",{key:"57f69bc17c5d9ab5a246eb5e35651cd191993a2f",class:"title"},this.t("leave"))),z("p",{key:"be794688b2d9ab0039e0b34673ba2cfd384195a8",class:"message"},this.isBreakoutRoomsActive&&this.isChildMeeting?this.t("breakout_rooms.leave_confirmation"):this.t("leave_confirmation")),z("div",{key:"757a3aa9203f57b24fa9c1176a2d34b3106695e0",class:"content"},z("dyte-button",{key:"b5b39f76686aea039ff7cb3225e4948104386210",variant:"secondary",onClick:this.close,class:"secondary-btn"},this.t("cancel")),this.isBreakoutRoomsActive&&this.isChildMeeting&&this.canJoinMainRoom&&z("dyte-button",{key:"6a816c70fd6846a5da006e244074d7e72d9ce05c",variant:"secondary",onClick:this.handleJoinMainRoom,class:"secondary-btn"},this.t("breakout_rooms.leave_confirmation.main_room_btn")),z("dyte-button",{key:"7a978e721f7f1630fd21fff21210705fb4cbd37c",variant:this.canEndMeeting?"secondary":"danger",title:this.t("leave"),onClick:this.handleLeave,class:{"secondary-btn":this.canEndMeeting,"secondary-danger-btn":this.canEndMeeting}},this.t("leave")),this.canEndMeeting&&z("dyte-button",{key:"d204e9b3f2019e2352b0f5b5689ca37727d08f94",variant:"danger",onClick:this.handleEndMeeting},this.t("end.all")))))}static get watchers(){return{meeting:["meetingChanged"]}}};$d([si()],Fd.prototype,"meeting",void 0),$d([si()],Fd.prototype,"states",void 0),$d([si()],Fd.prototype,"iconPack",void 0),$d([si()],Fd.prototype,"t",void 0),Fd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.leave-modal{width:var(--dyte-space-72, 288px)}@media (min-width: 768px){.leave-modal{width:var(--dyte-space-96, 384px)}}.leave-modal{position:relative;display:flex;flex-direction:column;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));padding:var(--dyte-space-8, 32px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.leave-modal .header h2{margin:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px)}.leave-modal .message{color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}.leave-modal .content{margin-top:var(--dyte-space-4, 16px);font-size:14px;display:flex;flex-wrap:wrap;gap:var(--dyte-space-4, 16px)}.leave-modal .content dyte-button{height:var(--dyte-space-9, 36px);min-width:var(--dyte-space-44, 176px);flex-grow:1}.leave-modal .content .secondary-btn{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.leave-modal .content .secondary-btn:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.leave-modal .content .secondary-danger-btn{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}";var Nd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const jd=class{constructor(e){o(this,e),this.config=Ft,this.t=Ht()}connectedCallback(){this.configChanged(this.config),this.meetingChanged(this.meeting)}configChanged(e){var t;if(null!=e){const i=null===(t=null==e?void 0:e.designTokens)||void 0===t?void 0:t.logo;null!=i&&null==this.logoUrl&&(this.logoUrl=i)}}meetingChanged(e){var t,i,s,a;if(null!=e){const r=null===(a=null===(s=null===(i=null===(t=e.self)||void 0===t?void 0:t.config)||void 0===i?void 0:i.header)||void 0===s?void 0:s.elements)||void 0===a?void 0:a.logo;null!=r&&null==this.logoUrl&&(this.logoUrl=r)}}render(){if(!this.logoUrl||""===this.logoUrl)return null;const e=this.logoUrl,t=this.t("logo");return z(G,{class:"loaded"},z("img",{src:e,alt:t}))}static get watchers(){return{config:["configChanged"],meeting:["meetingChanged"]}}};Nd([si()],jd.prototype,"meeting",void 0),Nd([si()],jd.prototype,"t",void 0),jd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;flex-direction:column;align-items:center;justify-content:center;color:rgb(var(--dyte-colors-text-1000, 255 255 255));height:100%;width:auto}svg,img{height:100%;width:auto}.brand-color{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}";const zd=class{constructor(e){o(this,e),this.maxLength=Qi,this.restoreEmpty=(e,t,i)=>0===e.trim().length?`${t}${e}${t}`:i(e),this.renderLink=e=>z("a",{class:"link",href:e,target:"_blank",rel:"noopener noreferrer"},e),this.renderBold=e=>"string"==typeof e?this.restoreEmpty(e,"*",e=>z("b",null,e)):z("b",null,this.renderTokens(e)),this.renderItalic=e=>"string"==typeof e?this.restoreEmpty(e,"_",e=>z("i",null,e)):z("i",null,this.renderTokens(e)),this.renderStrikethrough=e=>"string"==typeof e?this.restoreEmpty(e,"~",e=>z("s",null,e)):z("b",null,this.renderTokens(e)),this.renderPlainText=e=>"string"==typeof e?e:z("p",null,this.renderTokens(e)),this.renderTokens=e=>e.map(e=>{switch(e.type){case"a":if("string"==typeof e.content)return this.renderLink(e.content);case"b":return this.renderBold(e.content);case"i":return this.renderItalic(e.content);case"s":return this.renderStrikethrough(e.content);case"q":return z("span",{class:"block-quote"});default:return this.renderPlainText(e.content)}})}renderMessage(e){let t=e.split("\n"),i=!1;"```"===t[0]&&"```"===t[t.length-1]&&(i=!0,t=t.slice(1,-1));const s=t.map(e=>{const t=Ji(e);return z("p",null,this.renderTokens(t))});return i?z("pre",{style:{whiteSpace:"pre",overflow:"scroll"}},t.join("\n")):s}render(){const e=this.text.slice(0,this.maxLength),t=Wi(e,!0),i=Zi(e);return z("p",{key:"b3115390fc6d21369673cb6c92ba90b7a710173a"},0!==t.length&&z("blockquote",{key:"5aa48ffc60bb71da150b161582b9ab1b1ee59ff7"},this.renderMessage(t)),0!==i.length&&this.renderMessage(i))}};zd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{overflow-wrap:break-word}a{color:currentColor}.block-quote,blockquote{margin:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px);--tw-border-spacing-x:1px;--tw-border-spacing-y:1px;border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y);border-top-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-none, 0);border-left-width:var(--dyte-border-width-md, 2px);border-right-width:var(--dyte-border-width-none, 0);border-style:solid;padding:var(--dyte-space-0\\.5, 2px);padding-left:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-sm, 4px);border-top-left-radius:var(--dyte-border-radius-none, 0);border-bottom-left-radius:var(--dyte-border-radius-none, 0)}pre{white-space:pre-wrap}";var Bd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Gd=class{constructor(e){o(this,e),this.statesUpdate=W(this,"dyteStatesUpdate",7),this.roomJoinedListener=()=>{this.updateStates({meeting:"joined"})},this.waitlistedListener=()=>{this.updateStates({meeting:"waiting"})},this.roomLeftListener=({state:e})=>{"disconnected"!==e&&"failed"!==e&&this.updateStates({meeting:"ended",roomLeftState:e})},this.mediaPermissionUpdateListener=({kind:e,message:t})=>{if(["audio","video"].includes(e)&&("DENIED"===t||"SYSTEM_DENIED"===t)&&!0!==ii.states.activeDebugger){const t={enabled:!0,kind:e};this.updateStates({activePermissionsMessage:t})}},this.socketConnectionUpdateListener=({state:e})=>{"failed"===e&&setTimeout(()=>{this.meeting.leave("disconnected")},this.leaveRoomTimer)},this.loadConfigFromPreset=!1,this.applyDesignSystem=!1,this.mode="fixed",this.leaveOnUnmount=!1,this.t=Ht(),this.config=Ft,this.gridLayout="row",this.iconPack=Vt,this.handleChangingMeeting=e=>{this.updateStates({activeBreakoutRoomsManager:Object.assign(Object.assign({},ii.states.activeBreakoutRoomsManager),{destinationMeetingId:e})})}}connectedCallback(){var e;"undefined"!=typeof window&&(this.authErrorListener=e=>{e.detail.message.includes("401")&&this.updateStates({meeting:"ended",roomLeftState:"unauthorized"})},window.addEventListener("dyteError",this.authErrorListener)),this.leaveRoomTimer=1e4,this.loadConfigFromPreset=!0,this.applyDesignSystem=!0,this.resizeObserver=new $r(()=>this.handleResize()),this.resizeObserver.observe(this.host),this.applyDesignSystem&&null!=(null===(e=this.config)||void 0===e?void 0:e.designTokens)&&"undefined"!=typeof document&&Na(document.documentElement,this.config.designTokens),this.meetingChanged(this.meeting)}clearListeners(e){e&&(e.self.removeListener("roomLeft",this.roomLeftListener),e.self.removeListener("roomJoined",this.roomJoinedListener),e.self.removeListener("waitlisted",this.waitlistedListener),e.self.removeListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),e.meta.removeListener("socketConnectionUpdate",this.socketConnectionUpdateListener))}disconnectedCallback(){var e;this.leaveOnUnmount&&(null===(e=this.meeting)||void 0===e||e.leaveRoom()),this.resizeObserver.disconnect(),this.clearListeners(this.meeting),window.removeEventListener("dyteError",this.authErrorListener)}meetingChanged(e){var t,i;if(e){if(this.updateStates({viewType:e.meta.viewType}),this.loadConfigFromPreset&&null!=e.self.config){const i=e.self.config,{config:s,data:a}=pr(i,e);this.config===Ft&&(this.config=s),null==this.showSetupScreen&&(this.showSetupScreen=a.showSetupScreen),e.connectedMeetings.supportsConnectedMeetings&&(null===(t=ii.states.activeBreakoutRoomsManager)||void 0===t?void 0:t.destinationMeetingId)&&(this.showSetupScreen=!1)}this.applyDesignSystem&&null!=(null===(i=this.config)||void 0===i?void 0:i.designTokens)&&"undefined"!=typeof document&&Na(document.documentElement,this.config.designTokens),e.self.addListener("roomJoined",this.roomJoinedListener),e.self.addListener("waitlisted",this.waitlistedListener),e.self.addListener("roomLeft",this.roomLeftListener),e.self.addListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),e.meta.addListener("socketConnectionUpdate",this.socketConnectionUpdateListener),e.connectedMeetings.supportsConnectedMeetings&&e.connectedMeetings.once("changingMeeting",this.handleChangingMeeting),e.self.roomJoined?this.updateStates({meeting:"joined"}):this.showSetupScreen?this.updateStates({meeting:"setup"}):e.joinRoom(),window.removeEventListener("dyteError",this.authErrorListener)}}listenState(e){this.updateStates(e.detail)}handleResize(){this.size=fr(this.host.clientWidth)}updateStates(e){const t=Object.assign({},ii.states);ii.states=hr(t,e),this.statesUpdate.emit(ii.states)}render(){const e={meeting:this.meeting,size:this.size,states:ii.states,config:this.config,iconPack:this.iconPack,t:this.t};if("CHAT"===ii.states.viewType)return z("dyte-chat",Object.assign({},e));const t={"dyte-grid":{layout:this.gridLayout}};return z(ls,{element:"dyte-meeting",defaults:e,asHost:!0,elementProps:t})}get host(){return Y(this)}static get watchers(){return{meeting:["meetingChanged"]}}};Bd([si()],Gd.prototype,"meeting",void 0),Bd([si()],Gd.prototype,"t",void 0),Bd([si()],Gd.prototype,"iconPack",void 0),Gd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{box-sizing:border-box;display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));overflow:hidden;position:fixed;top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);height:100%;width:100%}:host([mode='fill']){position:relative}";var Hd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Vd=class{constructor(e){o(this,e),this.clickedThis=!1,this.placement="bottom-end",this.offset=10,this.iconPack=Vt,this.t=Ht(),this.handleOutsideClick=()=>{this.clickedThis||(this.menuListEl.style.display="none"),this.clickedThis=!1}}componentDidLoad(){document.addEventListener("click",this.handleOutsideClick),this.update()}disconnectedCallback(){document.removeEventListener("click",this.handleOutsideClick)}update(){Xn(this.triggerEl,this.menuListEl,{placement:this.placement,middleware:[qn(this.offset),Wn(),Yn({padding:5})]}).then(({x:e,y:t})=>{Object.assign(this.menuListEl.style,{left:`${e}px`,top:`${t}px`})})}render(){return z(G,{key:"8fce9cdf74c107e0438f30cd2c1ed33b5eb0570e"},z("span",{key:"bfe2fcfcac4f87a60cc2762d758c34e42c1ab653",id:"trigger",ref:e=>this.triggerEl=e,onClick:()=>{this.clickedThis=!0,"block"!==this.menuListEl.style.display?(this.menuListEl.style.display="block",this.update()):this.menuListEl.style.display="none"}},z("slot",{key:"09c4699c881002da8ffaab3cfef27e06d8ceae60",name:"trigger"})),z("span",{key:"1feae9bc99d7379471552ea2ea8a39c795259826",part:"menu-list",id:"menu-list",ref:e=>this.menuListEl=e},z("slot",{key:"01cc566916d96fb30a0845b975431c9202a20ebb"})))}};Hd([si()],Vd.prototype,"size",void 0),Hd([si()],Vd.prototype,"iconPack",void 0),Hd([si()],Vd.prototype,"t",void 0),Vd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:inline-block;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}#menu-list{position:absolute;z-index:20;display:none}";var qd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Kd=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht()}render(){return z(G,{key:"2e3a7e78987d9544820b74e2c83e8cd2c1b38e0b"},z("slot",{key:"be5768e5d7ec85f4d9e5c7fc43d3edd612f518c7",name:"start"}),z("slot",{key:"ce236f02c727fb4e42ee8cae25bc7bf00479be01"}),z("slot",{key:"92a2fb4f3a5fa3f03c396a1483b1eabfa83235e7",name:"end"}))}};qd([si()],Kd.prototype,"size",void 0),qd([si()],Kd.prototype,"iconPack",void 0),qd([si()],Kd.prototype,"t",void 0),Kd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;align-items:center;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);cursor:pointer;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms;color:rgb(var(--dyte-colors-text-1000, 255 255 255));font-size:14px}::slotted([slot='start']){margin-right:var(--dyte-space-2, 8px)}::slotted([slot='end']){margin-left:var(--dyte-space-2, 8px)}:host(:hover){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}:host(.red){--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}";var Yd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Wd=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht()}render(){return z(G,{key:"9aecbc06a89da8a7ea5ac9f5f8f47ad21ec389e8"},z("slot",{key:"3dfd067eec2d74e5e3751942b73f72fc2c6272cb"}))}};Yd([si()],Wd.prototype,"iconPack",void 0),Yd([si()],Wd.prototype,"t",void 0),Wd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;width:-moz-max-content;width:max-content;flex-direction:column;padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;border-radius:var(--dyte-border-radius-sm, 4px);--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}";const Zd=class{constructor(e){o(this,e),this.onAction=W(this,"action",7),this.actions=[],this.variant="bubble",this.viewType="outgoing",this.hideAvatar=!1,this.hideAuthorName=!1,this.hideMetadata=!1,this.iconPack=Vt}renderActions(){return z("dyte-menu",{placement:"top-end",offset:1},z("button",{slot:"trigger",class:"actions"},z("dyte-icon",{icon:this.iconPack.chevron_down})),z("dyte-menu-list",null,this.actions.map(e=>z("dyte-menu-item",{onClick:()=>this.onAction.emit(e.id)},e.icon&&z("dyte-icon",{icon:e.icon,slot:"start"}),e.label))))}render(){return z(G,{key:"2a443309dfcb77b650bf1378ec13f77f2bf01593"},z("div",{key:"989baadfe7e60a3888be667fa0984c97c5a0f597",class:{"message-wrapper":!0,[this.viewType]:!0}},!this.hideAvatar&&z("aside",{key:"2513cf0da43268c39efd3a84c74aab3ec5adc85d",class:"avatar",part:"avatar"},z("dyte-avatar",{key:"18b94987038b10c30393a97f30025f31fe25c411",participant:{name:this.authorName,picture:this.avatarUrl},size:"sm"})),z("div",{key:"f88598f9114ef02ce5f8daa62a09220f0752ba79",class:"message",part:"message"},!this.hideAuthorName&&z("div",{key:"aaa59e19099a9c7d239e3f53b9017f257fe23165",class:"header"},this.authorName),z("div",{key:"4fe21121b123a49f30500ff488f12caa8a376c17",class:{body:!0,bubble:"bubble"===this.variant}},z("slot",{key:"4e8c4c9fa533cd920890648535fdb4203d320027"}),!this.hideMetadata&&!!this.time&&z("div",{key:"2612946059903647ac4172157cef2626e45c5dc7",class:"metadata",title:ss(this.time)},is(this.time,new Date(Date.now()))),0!==this.actions.length&&this.renderActions()))))}};!function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);r>3&&n&&Object.defineProperty(t,i,n)}([si()],Zd.prototype,"iconPack",void 0),Zd.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}.message-wrapper{display:flex;flex-direction:row-reverse;gap:var(--dyte-space-2, 8px)}.message-wrapper.incoming{flex-direction:row}.message{display:flex;flex-direction:column}.header{margin-bottom:var(--dyte-space-1, 4px);align-self:flex-end;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));font-size:14px;font-weight:600}.incoming .header{align-self:flex-start}.body{display:flex;flex-direction:column;min-width:var(--dyte-space-24, 96px);font-family:var(--dyte-font-family, sans-serif);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));font-size:14px;line-height:1.375;position:relative}.body .metadata{margin-top:var(--dyte-space-2, 8px);align-self:flex-end;font-size:10px}.bubble{max-width:var(--dyte-space-96, 384px);padding:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));border-radius:var(--dyte-border-radius-md, 8px)}.incoming .bubble{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.avatar{display:none}dyte-menu{position:absolute;right:var(--dyte-space-0, 0px);top:var(--dyte-space-0, 0px);border-radius:var(--dyte-border-radius-lg, 12px)}dyte-menu dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);cursor:pointer}.actions{display:flex;align-items:center;justify-content:center;padding-left:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);padding-top:var(--dyte-space-1, 4px);padding-right:var(--dyte-space-1, 4px);border-radius:var(--dyte-border-radius-md, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;background:radial-gradient(\n    at top right,\n    rgb(var(--dyte-colors-brand-300, 73 124 253)) 60%,\n    rgba(255, 255, 255, 0) 80%\n  )}.actions dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.incoming .actions{background:radial-gradient(\n      at top right,\n      rgb(var(--dyte-colors-background-800, 30 30 30)) 60%,\n      rgba(255, 255, 255, 0) 80%\n    )}.incoming .actions dyte-icon{color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.incoming dyte-avatar{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}@media (min-width: 400px){.avatar{display:flex;width:var(--dyte-space-6, 24px)}.avatar dyte-avatar{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px);font-size:10px;overflow:clip;border-radius:9999px}}@media (hover: hover){dyte-menu{visibility:hidden}.body:hover dyte-menu{visibility:visible}}";var Qd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Xd=class{constructor(e){o(this,e),this.iconPack=Vt,this.variant="full",this.t=Ht(),this.audioinputDevices=[],this.canProduceAudio=!0,this.currentDevices={audio:void 0},this.stageStateListener=()=>{this.canProduceAudio="ALLOWED"===this.meeting.self.permissions.canProduceAudio},this.deviceListUpdateListener=async()=>{const e=await this.meeting.self.getAudioDevices();this.audioinputDevices=e},this.deviceUpdateListener=({device:e})=>{"audioinput"===e.kind&&(this.currentDevices={audio:e})},this.mediaPermissionUpdateListener=async({kind:e,message:t})=>{this.meeting&&"audio"===e&&"ACCEPTED"===t&&(this.audioinputDevices=await this.meeting.self.getAudioDevices())}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e,t,i,s,a;null===(t=null===(e=this.meeting)||void 0===e?void 0:e.stage)||void 0===t||t.removeListener("stageStatusUpdate",this.stageStateListener),null===(i=this.meeting)||void 0===i||i.self.removeListener("deviceListUpdate",this.deviceListUpdateListener),null===(s=this.meeting)||void 0===s||s.self.removeListener("deviceUpdate",this.deviceUpdateListener),null===(a=this.meeting)||void 0===a||a.self.removeListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener)}meetingChanged(e){null!=e&&P(async()=>{var t,i;const{self:s,stage:a}=e,r=await e.self.getAudioDevices(),n=null===(t=e.self.getCurrentDevices())||void 0===t?void 0:t.audio;this.currentDevices={audio:n},this.canProduceAudio="ALLOWED"===this.meeting.self.permissions.canProduceAudio,null==a||a.addListener("stageStatusUpdate",this.stageStateListener),s.addListener("deviceListUpdate",this.deviceListUpdateListener),s.addListener("deviceUpdate",this.deviceUpdateListener),s.addListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),this.audioinputDevices=null!=n?[null!==(i=r.find(e=>e.deviceId===n.deviceId))&&void 0!==i?i:n,...r.filter(e=>e.deviceId!==n.deviceId)]:r})}setDevice(e){var t;if(ut(this.meeting))return;const i=this.audioinputDevices.find(t=>t.deviceId===e);null!=i&&(this.currentDevices={audio:i},null===(t=this.meeting)||void 0===t||t.self.setDevice(i))}render(){if(null==this.meeting)return null;let e=0;return z(G,null,this.canProduceAudio&&z("div",{part:"microphone-selection",class:"group container "+this.variant},z("label",{slot:"label"},"inline"!==this.variant&&this.t("settings.microphone_input"),z("dyte-icon",{icon:this.iconPack.mic_on,size:"sm"})),z("div",{class:"row"},z("select",{class:"dyte-select",onChange:e=>this.setDevice(e.target.value)},this.audioinputDevices.map(({deviceId:t,label:i})=>{var s;return z("option",{value:t,selected:(null===(s=this.currentDevices.audio)||void 0===s?void 0:s.deviceId)===t},i||"Microphone "+ ++e)})),z("slot",{name:"indicator"}))))}static get watchers(){return{meeting:["meetingChanged"]}}};Qd([si()],Xd.prototype,"meeting",void 0),Qd([si()],Xd.prototype,"size",void 0),Qd([si()],Xd.prototype,"iconPack",void 0),Qd([si()],Xd.prototype,"t",void 0),Xd.style=".dyte-select{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.dyte-select:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.dyte-select{display:block;border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:var(--dyte-space-3, 12px);font-size:16px;--icon-size:var(--dyte-select-chevron-size, var(--dyte-space-6, 24px));--icon-right-position:var(--dyte-select-chevron-right-position, var(--dyte-space-2, 8px));background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e\");background-position:right var(--icon-right-position) center;background-repeat:no-repeat;background-size:var(--icon-size) var(--icon-size);padding-right:calc(var(--icon-right-position) * 5);width:100%;max-width:100%;text-overflow:ellipsis}.inline .dyte-select{margin-top:var(--dyte-space-1, 4px);width:100%;padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-1\\.5, 6px);padding-right:var(--dyte-space-1\\.5, 6px);padding-right:var(--dyte-space-8, 32px);font-size:14px}.row{margin-bottom:var(--dyte-space-2, 8px);display:flex;width:100%;align-items:center;justify-content:space-between;gap:var(--dyte-space-3, 12px)}.group{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px)}.group>*{margin-bottom:var(--dyte-space-2, 8px)}.group>*:last-child{margin-bottom:var(--dyte-space-0, 0px)}.group select{flex:1 1 0%}.inline.group{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0\\.5, 2px)}.inline.group>*{margin-bottom:var(--dyte-space-0, 0px)}label{display:flex;-webkit-user-select:none;-moz-user-select:none;user-select:none;align-items:center;gap:var(--dyte-space-1, 4px);font-size:14px}.inline.container{display:flex;align-items:center;justify-content:flex-start;gap:var(--dyte-space-2, 8px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px)}";var Jd=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const el=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.iconPack=Vt,this.t=Ht(),this.allowUnmute=!0,this.onClose=()=>{this.stateUpdate.emit({activeMuteAllConfirmation:!1})},this.onMuteAll=()=>{var e;null===(e=this.meeting)||void 0===e||e.participants.disableAllAudio(this.allowUnmute),this.onClose()}}render(){return z(G,{key:"8d447912a33466ac84c7104e3731e67e5d574201"},z("div",{key:"f36495740298c71957ecb4038ea11baa96150427",class:"leave-modal"},z("div",{key:"5c7d23277e2fb5300b4d34800eb62e7a93e431dc",class:"header"},z("h2",{key:"bb08708a5d462763d51228e5368389c848f770b1",class:"title"},this.t("mute_all.header"))),z("p",{key:"34273d1a512336de748ce1de4b498baebd2c7cfb",class:"message"},this.t("mute_all.description")),z("div",{key:"2fae2f55acb20556e3478c5a57c9d3f5d0dae5ab",class:"content"},z("div",{key:"67308bf61bfa8891e0193033779ab4952a95a8e1",class:"leave-meeting"},z("dyte-button",{key:"03835bed6fe212b2d893ebd6c1d1061b6ef548e4",variant:"secondary",title:this.t("close"),onClick:this.onClose},this.t("cancel")),z("dyte-button",{key:"e9f5a1ef27c92446d6955e4898757070d39629ce",variant:"danger",title:this.t("mute_all"),onClick:this.onMuteAll},this.t("mute_all"))))))}};Jd([si()],el.prototype,"meeting",void 0),Jd([si()],el.prototype,"states",void 0),Jd([si()],el.prototype,"iconPack",void 0),Jd([si()],el.prototype,"t",void 0),el.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block;-webkit-user-select:none;-moz-user-select:none;user-select:none}.leave-modal{position:relative;display:flex;flex-direction:column;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));padding:var(--dyte-space-4, 16px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.leave-modal .header h2{margin:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px)}.leave-modal .content{font-size:14px}.leave-message p{margin-top:var(--dyte-space-3, 12px);margin-bottom:var(--dyte-space-3, 12px)}.leave-meeting{display:flex;flex-direction:row;justify-content:space-between;gap:var(--dyte-space-2, 8px)}.leave-meeting dyte-button{flex:1 1 0%}.end-meeting{margin-top:var(--dyte-space-2, 8px)}.message{margin-bottom:var(--dyte-space-4, 16px)}label{display:flex;align-items:center}input[type='checkbox']{margin-right:var(--dyte-space-2, 8px);accent-color:rgb(var(--dyte-colors-brand-500, 33 96 253))}";var tl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const il=class{constructor(e){o(this,e),this.dismiss=W(this,"dyteNotificationDismiss",7),this.iconPack=Vt,this.t=Ht(),this.imageState="loading"}connectedCallback(){this.notificationChanged(this.notification)}notificationChanged(e){null!=e&&"number"==typeof e.duration&&setTimeout(()=>{this.dismiss.emit(e.id)},e.duration)}render(){var e;return z(G,{key:"d1b50e98469e3a31478ffb37eaf0d16b06a97f11"},z("div",{key:"ccbba0abd0b8b2126ed435aa22fad0ce4c09bbc3",class:"ctr"},null!=this.notification.icon&&z("dyte-icon",{key:"2977f801f26dc7bab7484ca3344375b59e912789",class:"icon",icon:this.notification.icon,variant:null!==(e=this.notification.iconVariant)&&void 0!==e?e:"primary"}),null!=this.notification.image&&null==this.notification.icon&&"errored"!==this.imageState&&z("img",{key:"bb74bf766c92d366ff57a64109e9321a755173d3",src:this.notification.image,class:{loaded:"loaded"===this.imageState},onLoad:()=>this.imageState="loaded",onError:()=>this.imageState="errored"}),z("p",{key:"9882e460b11e649d6ea72ac5d366f968092bfdce",class:"message"},z(eo,{key:"913d03c9028353d8b2b3d4a097a6cf588ac3ae9b",message:this.notification.message})),z("div",{key:"2c1458dc02e345bb3c1e3fc8285e6a561c4609eb",class:"right"},null!=this.notification.button&&z("dyte-button",{key:"2b5b9774b6f289ca2f533e5473080007b1390ec1",size:"sm",variant:this.notification.button.variant,onClick:()=>this.notification.button.onClick()},this.notification.button.text),z("dyte-icon",{key:"51b648dbc0c1411633a6e1e741080b82a7e95c5b","aria-label":this.t("dismiss"),class:"dismiss",icon:this.iconPack.dismiss,onClick:()=>this.dismiss.emit(this.notification.id)}))))}static get watchers(){return{notification:["notificationChanged"]}}};tl([si()],il.prototype,"size",void 0),tl([si()],il.prototype,"iconPack",void 0),tl([si()],il.prototype,"t",void 0),il.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{pointer-events:none;display:block;height:var(--dyte-space-10, 40px);color:rgb(var(--dyte-colors-text-1000, 255 255 255));animation:show 0.4s ease;transition:0.4s;z-index:100}.ctr{box-sizing:border-box;display:inline-flex;height:100%;min-width:var(--dyte-space-40, 160px);align-items:center;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);-webkit-user-select:none;-moz-user-select:none;user-select:none;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);--tw-shadow-color:rgb(var(--dyte-colors-background-1000, 8 8 8));--tw-shadow:var(--tw-shadow-colored);pointer-events:auto}img{margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-0, 0px);width:var(--dyte-space-0, 0px);border-radius:9999px}img.loaded{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}.message{margin-right:var(--dyte-space-2, 8px);max-width:var(--dyte-space-72, 288px) !important;font-size:14px !important;overflow:hidden !important;display:-webkit-box !important;-webkit-box-orient:vertical !important;-webkit-line-clamp:2 !important}.message p{margin:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-1, 4px)}.message blockquote{display:none}dyte-icon.icon{margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}dyte-icon.dismiss{margin-left:auto;height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);border-radius:var(--dyte-border-radius-md, 8px);color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}dyte-icon.dismiss:hover{cursor:pointer;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}dyte-icon.dismiss{transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}dyte-button{margin-left:var(--dyte-space-4, 16px);margin-right:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-sm, 4px)}.right{margin-left:auto;display:flex;align-items:center}.right>*{margin-left:var(--dyte-space-2, 8px)}.right>*:first-child{margin-left:var(--dyte-space-0, 0px)}:host(.exit){animation:exit 0.4s ease}@keyframes show{0%{opacity:0;transform:translateX(-120px)}100%{opacity:1;transform:translateX(0px)}}@keyframes exit{0%{opacity:1;transform:translateX(0)}100%{opacity:0;transform:translateX(-120px)}}:host([size='sm']){font-size:14px}";const sl=2e3,al=Object.freeze({notifications:{participant_joined:!0,participant_left:!0,participant_joined_waitlist:!0,chat:!0,polls:!0,webinar:!0,tab_sync:!0,recording_started:!0,recording_stopped:!0},notification_sounds:{participant_joined:!0,participant_left:!0,chat:!0,polls:!0,webinar:!0,participant_joined_waitlist:!0},notification_duration:{participant_joined:2100,participant_left:2100,participant_joined_waitlist:4e3,chat:sl,polls:sl,webinar:sl,tab_sync:sl,recording_started:sl,recording_stopped:sl},participant_joined_sound_notification_limit:10,participant_chat_message_sound_notification_limit:10});var rl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};function nl(e){return Object.keys(e).filter(t=>e[t])}const ol=class{constructor(e){o(this,e),this.permissions=al,this.enabledSounds=nl(al.notification_sounds),this.config=Ft,this.t=Ht(),this.iconPack=Vt,this.notifications=[],this.addStagePeersListeners=e=>{e.participants.joined.addListener("participantJoined",this.participantJoinedListener),e.participants.joined.addListener("participantLeft",this.participantLeftListener)},this.removeStagePeersListeners=e=>{e.participants.joined.removeListener("participantJoined",this.participantJoinedListener),e.participants.joined.removeListener("participantLeft",this.participantLeftListener)},this.onDyteNotification=e=>{this.add(e.detail);const t=e.detail.playSound;null!=t&&this.audio.play(t)},this.onRecordingUpdate=e=>{var t,i;"RECORDING"===e&&!1!==this.permissions.notifications.recording_started?this.add({id:"recording-started",icon:this.iconPack.recording,message:this.t("recording.started"),duration:null!==(t=this.permissions.notification_duration.recording_started)&&void 0!==t?t:sl}):"STOPPING"===e&&!1!==this.permissions.notifications.recording_stopped&&this.add({id:"recording-stopped",icon:this.iconPack.stop_recording,message:this.t("recording.stopped"),duration:null!==(i=this.permissions.notification_duration.recording_stopped)&&void 0!==i?i:sl})}}connectedCallback(){"undefined"!=typeof document&&(null===document||void 0===document||document.addEventListener("dyteNotification",this.onDyteNotification)),this.meetingChanged(this.meeting),this.configChanged(this.config),this.statesChanged(this.states)}clearListeners(e){var t,i,s,a,r,n,o,d;const l="LIVESTREAM"===e.meta.viewType;(l&&"ON_STAGE"===(null===(t=e.stage)||void 0===t?void 0:t.status)||!l)&&this.removeStagePeersListeners(e),this.chatUpdateListener&&(null===(i=e.chat)||void 0===i||i.removeListener("chatUpdate",this.chatUpdateListener)),this.pollUpdateListener&&(null===(s=e.polls)||void 0===s||s.removeListener("pollsUpdate",this.pollUpdateListener)),e.meta.removeListener("socketConnectionUpdate",this.socketConnectionUpdateListener),this.stageRequestAccepted&&(null===(a=e.stage)||void 0===a||a.removeListener("stageRequestApproved",this.stageRequestAccepted)),this.stageRequestRejected&&(null===(r=e.stage)||void 0===r||r.removeListener("stageRequestRejected",this.stageRequestRejected)),this.newStageRequests&&(null===(n=e.stage)||void 0===n||n.removeListener("newStageRequest",this.newStageRequests)),this.stageStatusUpdateListener&&(null===(o=e.stage)||void 0===o||o.removeListener("stageStatusUpdate",this.stageStatusUpdateListener)),null===(d=e.recording)||void 0===d||d.removeListener("recordingUpdate",this.onRecordingUpdate),clearTimeout(this.disconnectTimeout),e.self.removeListener("deviceUpdate",this.deviceUpdateListener)}disconnectedCallback(){var e;"undefined"!=typeof document&&(null===document||void 0===document||document.removeEventListener("dyteNotification",this.onDyteNotification)),null!=this.meeting&&(this.clearListeners(this.meeting),this.waitlistedParticipantJoinedListener&&this.meeting.participants.waitlisted.removeListener("participantJoined",this.waitlistedParticipantJoinedListener),this.waitlistedParticipantLeftListener&&this.meeting.participants.waitlisted.removeListener("participantLeft",this.waitlistedParticipantLeftListener),this.activeTabUpdateListener&&(null===(e=this.meeting.meta)||void 0===e||e.removeListener("activeTabUpdate",this.activeTabUpdateListener)),this.peerStageStatusListener&&this.meeting.participants.joined.removeListener("stageStatusUpdate",this.peerStageStatusListener))}meetingChanged(e,t){var i,s,a,r,n,o,d,l,c;if(clearTimeout(this.disconnectTimeout),void 0!==t&&this.clearListeners(t),null==e)return;const h="LIVESTREAM"===e.meta.viewType;this.audio=new so(e);const{notifications:p,notification_duration:u,notification_sounds:g}=this.permissions;if(this.participantJoinedListener=e=>{p.participant_joined&&this.add({id:`${e.id}-joined`,message:`${oi(e.name)} ${this.t("notifications.joined")}`,image:e.picture,duration:u.participant_joined}),g.participant_joined&&this.canPlayParticipantJoinedSound()&&this.audio.play("joined")},this.participantLeftListener=e=>{const{socketState:{state:t}}=this.meeting.meta;p.participant_left&&"connected"!==t&&this.add({id:`${e.id}-left`,message:`${oi(e.name)} ${this.t("notifications.left")}`,image:e.picture,duration:u.participant_left}),g.participant_left&&this.canPlayParticipantJoinedSound()&&this.audio.play("left")},this.waitlistedParticipantJoinedListener=e=>{if(!this.canAcceptWaitingRequests())return;const t=`${e.id}-joined-waitlist`;this.add({id:t,message:`${oi(e.name)} ${this.t("notifications.requesting_to_join_meeting")}`,image:e.picture,duration:u.participant_joined_waitlist,button:{text:this.t("notifications.accept"),variant:"primary",onClick:async()=>{await this.meeting.participants.acceptWaitingRoomRequest(e.id),this.remove(t)}}}),g.participant_joined_waitlist&&this.canPlayParticipantJoinedSound()&&this.audio.play("message")},this.waitlistedParticipantLeftListener=e=>{this.remove(`${e.id}-joined-waitlist`)},this.chatUpdateListener=({message:t})=>{const i=Ui(t);if(null!=i){if(i.userId===e.self.userId)return;"text"===i.type&&(p.chat&&this.add({id:`message-${Math.random().toString(36)}`,icon:this.iconPack.chat,message:`${i.displayName}: ${i.message}`,duration:u.chat}),g.chat&&this.canPlayChatSound()&&this.audio.play("message"))}},this.pollUpdateListener=({polls:e,newPoll:t})=>{!1!==t&&(p.polls&&this.meeting.self.userId!==e[e.length-1].createdByUserId&&this.add({id:`poll-${Math.random().toString(36)}`,icon:this.iconPack.poll,message:`${this.t("notifications.new_poll_created_by")} ${e[e.length-1].createdBy}`,duration:u.polls}),g.polls&&this.meeting.self.userId!==e[e.length-1].createdByUserId&&this.canPlayChatSound()&&this.audio.play("message"))},this.deviceUpdateListener=({device:e,preview:t})=>{t||("audiooutput"===e.kind&&(this.audio.setDevice(e.deviceId),this.remove("speaker-switched"),this.add({id:"speaker-switched",message:`${this.t("notifications.connected_to")} ${e.label}`,icon:this.iconPack.speaker,duration:5e3})),"videoinput"===e.kind&&(this.remove("camera-switched"),this.add({id:"camera-switched",message:`${this.t("notifications.connected_to")} ${e.label}`,icon:this.meeting.self.videoEnabled?this.iconPack.video_on:this.iconPack.video_off,iconVariant:this.meeting.self.videoEnabled?"primary":"danger",duration:5e3})),"audioinput"===e.kind&&(this.remove("mic-switched"),this.add({id:"mic-switched",message:`${this.t("notifications.connected_to")} ${e.label}`,icon:this.meeting.self.audioEnabled?this.iconPack.mic_on:this.iconPack.mic_off,iconVariant:this.meeting.self.audioEnabled?"primary":"danger",duration:5e3})))},this.socketConnectionUpdateListener=({state:e,reconnectionAttempt:t,reconnected:i})=>{switch(e){case"connected":this.remove("socket"),i&&this.add({id:"socket",icon:this.iconPack.wifi,message:this.t("network.restored"),duration:3e3});break;case"disconnected":this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.reconnecting")});break;case"reconnecting":t>=6?(this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.disconnected"),button:{text:this.t("end"),variant:"danger",onClick:()=>{var e;return null===(e=this.meeting)||void 0===e?void 0:e.leaveRoom()}}})):t>=4&&(this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.delay_extended")}));break;case"failed":this.remove("socket"),this.add({id:"socket",icon:this.iconPack.disconnected,message:this.t("network.leaving"),button:{text:this.t("end"),variant:"danger",onClick:()=>{var e;return null===(e=this.meeting)||void 0===e?void 0:e.leaveRoom()}}})}},this.activeTabUpdateListener=t=>{if(p.tab_sync)switch(t.type){case"plugin":const i=e.plugins.active.toArray().find(e=>e.id==t.id);null!=i&&this.add({id:"activeTab",message:`${this.t("notifications.plugin_switched_to")} ${i.name}`,duration:u.participant_joined});break;case"screenshare":const s=e.participants.joined.toArray().filter(e=>e.screenShareEnabled).find(e=>e.id==t.id);null!=s&&this.add({id:"spotlight",message:`Now watching ${s.name}'s screen`,duration:u.webinar})}},this.peerStageStatusListener=e=>{"REQUESTED_TO_JOIN_STAGE"===e.stageStatus&&(this.add({id:`stage-request-${e.id}`,message:`${e.name} ${this.t("notifications.requested_to_join_stage")}`,duration:u.webinar,button:{text:this.t("notifications.accept"),variant:"primary",onClick:async()=>{await this.meeting.stage.grantAccess([e.userId]),this.remove(`stage-request-${e.id}`)}}}),g.webinar&&this.audio.play("joined")),"ON_STAGE"===e.stageStatus&&(this.add({id:`stage-joined-${e.id}`,message:`${e.name} ${this.t("notifications.joined_stage")}`,duration:u.webinar}),g.webinar&&this.audio.play("joined"))},this.stageRequestAccepted=()=>{this.add({id:"stage-request-accepted",message:this.t("notifications.request_to_join_accepted"),duration:3e3})},this.stageRequestRejected=()=>{this.add({id:"stage-request-rejected",message:this.t("notifications.request_to_join_rejected"),duration:3e3})},this.newStageRequests=({count:e})=>{this.add({id:"new-stage-request",message:`You have ${e<0?"new stage":`${e} pending`} request${1===e?"":"s"}`,duration:3e3})},this.stageStatusUpdateListener=t=>{"ON_STAGE"===t?this.addStagePeersListeners(e):this.removeStagePeersListeners(e)},!st(e)&&(null===(i=e.chat)||void 0===i||i.addListener("chatUpdate",this.chatUpdateListener)),"CHAT"===(null===(s=e.self.config.viewType)||void 0===s?void 0:s.toString()))return;const f=e.self.getCurrentDevices();null!=f.speaker&&this.audio.setDevice(f.speaker.deviceId),h?null===(a=e.stage)||void 0===a||a.on("stageStatusUpdate",this.stageStatusUpdateListener):this.addStagePeersListeners(e),this.canAcceptWaitingRequests()&&(e.participants.waitlisted.addListener("participantJoined",this.waitlistedParticipantJoinedListener),e.participants.waitlisted.addListener("participantLeft",this.waitlistedParticipantLeftListener)),null===(r=e.polls)||void 0===r||r.addListener("pollsUpdate",this.pollUpdateListener),e.self.addListener("deviceUpdate",this.deviceUpdateListener),e.meta.addListener("socketConnectionUpdate",this.socketConnectionUpdateListener),null===(n=e.meta)||void 0===n||n.addListener("activeTabUpdate",this.activeTabUpdateListener),null===(o=e.recording)||void 0===o||o.addListener("recordingUpdate",this.onRecordingUpdate),null===(d=e.stage)||void 0===d||d.addListener("stageRequestApproved",this.stageRequestAccepted),null===(l=e.stage)||void 0===l||l.addListener("stageRequestRejected",this.stageRequestRejected),e.self.permissions.stageEnabled&&e.self.permissions.acceptStageRequests&&(null===(c=e.stage)||void 0===c||c.addListener("newStageRequest",this.newStageRequests))}configChanged(e){null!=e&&null!=(null==e?void 0:e.config)&&(this.permissions=function(e){const t=Object.assign({},al);return null==e||(Object.assign(t.notification_sounds,e.notification_sounds),Object.assign(t.notifications,e.notifications),Object.assign(t.notification_duration,e.notification_duration),t.participant_chat_message_sound_notification_limit=e.participant_chat_message_sound_notification_limit,t.participant_joined_sound_notification_limit=e.participant_joined_sound_notification_limit),t}(e.config),this.enabledSounds=nl(this.permissions.notification_sounds))}statesChanged(e){var t;if(null!=e){const i=!(null===(t=null==e?void 0:e.prefs)||void 0===t?void 0:t.muteNotificationSounds);for(const e of this.enabledSounds)e in this.permissions.notification_sounds&&(this.permissions.notification_sounds[e]=i)}}apiErrorListener({detail:e}){const{trace:t,message:i}=e;this.add({id:t,message:i,duration:sl,icon:this.iconPack.warning})}sendNotificationListener({detail:e}){const{trace:t,message:i}=e;this.add({id:t,message:i,duration:sl})}add(e){"visible"===document.visibilityState&&this.notifications.length<5&&(this.notifications=[...this.notifications,e])}remove(e){this.notifications=this.notifications.filter(t=>t.id!==e)}handleDismiss(e){e.stopPropagation();const t=e.detail,i=this.host.shadowRoot.querySelector(`[data-id="${t}"]`);null==i||i.classList.add("exit"),setTimeout(()=>{P(()=>{this.remove(t)})},400)}canPlayParticipantJoinedSound(){return null==this.permissions.participant_joined_sound_notification_limit||this.permissions.participant_joined_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_joined_sound_notification_limit}canPlayChatSound(){return null==this.permissions.participant_chat_message_sound_notification_limit||this.permissions.participant_chat_message_sound_notification_limit<=0||this.meeting.participants.count<=this.permissions.participant_chat_message_sound_notification_limit}canAcceptWaitingRequests(){return this.permissions.notifications.participant_joined_waitlist&&this.meeting.self.permissions.acceptWaitingRequests}render(){return z(G,{key:"1e122b16897a90f7c7900057849e89d5152f477f"},this.notifications.map(e=>z("dyte-notification",{size:this.size,key:e.id,"data-id":e.id,notification:e,onDyteNotificationDismiss:e=>this.handleDismiss(e),iconPack:this.iconPack,t:this.t})))}get host(){return Y(this)}static get watchers(){return{meeting:["meetingChanged"],config:["configChanged"],states:["statesChanged"]}}};rl([si()],ol.prototype,"meeting",void 0),rl([si()],ol.prototype,"states",void 0),rl([si()],ol.prototype,"t",void 0),rl([si()],ol.prototype,"size",void 0),rl([si()],ol.prototype,"iconPack",void 0),ol.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:absolute;top:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);bottom:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);top:auto;display:flex;flex-direction:column;pointer-events:none;z-index:100}dyte-notification{margin-top:var(--dyte-space-2, 8px)}";var dl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const ll=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.iconPack=Vt,this.t=Ht()}connectedCallback(){this.states.activeOverlayModal.timeout&&setTimeout(()=>{this.stateUpdate.emit({activeOverlayModal:{active:!1}})},this.states.activeOverlayModal.timeout)}render(){return z(G,{key:"b4fa570e714d3297c1f7f5b25038d877f6001319"},z("dyte-icon",{key:"df183bada8963c6fbb22f27768e96922232201b7",icon:this.states.activeOverlayModal.icon}),z("h2",{key:"c028667f07d9db82e27e9e25f6e1d8712edccf20"},this.states.activeOverlayModal.title),z("p",{key:"74e847ad00e26147494acfb74481025e5c62f27c"},this.states.activeOverlayModal.description))}};dl([si()],ll.prototype,"meeting",void 0),dl([si()],ll.prototype,"states",void 0),dl([si()],ll.prototype,"iconPack",void 0),dl([si()],ll.prototype,"t",void 0),ll.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / 0.6);position:fixed;top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);z-index:50}dyte-icon{height:var(--dyte-space-20, 80px)}h2{margin:var(--dyte-space-2, 8px);font-weight:500}p{margin:var(--dyte-space-0, 0px);font-size:16px}";var cl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const hl=class{constructor(e){o(this,e),this.autoScroll=!0,this.iconPack=Vt,this.t=Ht(),this.emptyListLabel=null,this.isLoading=!1,this.rerenderBoolean=!1,this.shouldRenderNewNodes=!0,this.hasNewNodesToRender=!1,this.showEmptyListLabel=!1,this.pagesToRender=[[]],this.currentTime=()=>(new Date).getTime(),this.observe=e=>{e&&this.intersectionObserver.observe(e)}}async onNewNode(e){this.shouldRenderNewNodes?(this.addNodeToRender(e,!1),this.rerender()):this.hasNewNodesToRender=!0}async onNodeDelete(e){const t=this.pagesToRender.flat().length;this.pagesToRender=this.pagesToRender.map(t=>t.filter(t=>t.id!==e)),t!==this.pagesToRender.flat().length&&this.rerender()}async onNodeUpdate(e,t){let i=!1;this.pagesToRender=this.pagesToRender.map(s=>s.map(s=>s.id===e?(i=!0,t):s)),i&&this.rerender()}onItemChanged(e,t){e!==t&&(this.pagesToRender=[[]],this.loadFirstPage().then(()=>this.rerender()))}connectedCallback(){this.rerender=Oi(this.rerender.bind(this),50,{maxWait:200}),this.intersectionObserver=new IntersectionObserver(e=>{P(()=>{for(const t of e)"bottom-scroll"===t.target.id&&(t.isIntersecting?this.loadBottom():this.shouldRenderNewNodes=!1),"top-scroll"===t.target.id&&t.isIntersecting&&this.loadTop()})})}disconnectedCallback(){this.intersectionObserver.disconnect()}componentDidLoad(){this.loadFirstPage(),this.observe(this.$topRef),this.observe(this.$bottomRef)}componentDidRender(){this.shouldRenderNewNodes&&this.autoScroll&&rs(this.$paginatedList)}loadFirstPage(){return this.loadPage(this.currentTime(),this.pageSize,!0,e=>{0===e.length&&(this.showEmptyListLabel=!0)})}loadTop(){if(0===this.pagesToRender.length)return;if(1===this.pagesToRender.length&&this.pagesToRender[0].length<this.pageSize)return;const e=this.pagesToRender[0][0].timeMs;this.loadPage(e-1,this.pageSize,!0,()=>{})}loadBottom(){if(0===this.pagesToRender.length)return void(this.shouldRenderNewNodes=!0);if(1===this.pagesToRender.length&&this.pagesToRender[0].length<this.pageSize)return void(this.shouldRenderNewNodes=!0);const e=this.pagesToRender.at(-1).at(-1).timeMs;this.loadPage(e+1,this.pageSize,!1,()=>rs(this.$paginatedList))}addNodeToRender(e,t){if(t){const t=this.pagesToRender[0];if(t&&(null==t?void 0:t.length)<this.pageSize)t.unshift(e);else{const t=[e];this.pagesToRender.unshift(t),this.removeLastPageIfNeeded(!1)}}else{const[t]=this.pagesToRender.slice(-1);if(t&&(null==t?void 0:t.length)<this.pageSize)t.push(e);else{const t=[e];this.pagesToRender.push(t),this.removeLastPageIfNeeded(!0)}}}async loadPage(e,t,i,s=()=>{}){this.isLoading=!0;const a=await this.fetchData(e,t,i);if(this.isLoading=!1,!(null==a?void 0:a.length))return i||(this.hasNewNodesToRender=!1,this.shouldRenderNewNodes=!0),void s([]);a.forEach(e=>this.addNodeToRender(e,i)),this.rerender(),s(a)}rerender(){this.rerenderBoolean=!this.rerenderBoolean}removeLastPageIfNeeded(e){this.pagesToRender.length>this.pagesAllowed&&(e?this.pagesToRender.shift():this.pagesToRender.pop())}onDownArrowClicked(){this.loadBottom()}render(){var e;return z(G,{key:"704a4d2f1669f83d2b609276c4e43b7d242dc204"},z("div",{key:"a73818c8a9db30909b021e5409a05e54b917172c",class:"scrollbar container",part:"container",ref:e=>this.$paginatedList=e},z("div",{key:"4f3c5bbde0e1e3d868b9f188c1de0aea83c57ef7",class:{"show-new-messages-ctr":!0,active:!this.shouldRenderNewNodes}},z("dyte-button",{key:"8bee70e062ccefaedf15495bb4be713b75c72c98",class:"show-new-messages",kind:"icon",variant:"secondary",part:"show-new-messages",onClick:()=>this.onDownArrowClicked()},z("dyte-icon",{key:"d8872dd2b18a05d9969ce4c0e79925e05ca511fe",icon:this.iconPack.chevron_down}))),z("div",{key:"fbd24ab1cc8352807661d6b78c771df69fa26d12",class:"smallest-dom-element",id:"bottom-scroll",ref:e=>this.$bottomRef=e}),this.isLoading&&0===this.pagesToRender.flat().length&&z("dyte-spinner",{key:"df59bc4e2d777d1ce98088930f5dd4e5bfead2dc",size:"lg"}),0===this.pagesToRender.flat().length&&this.showEmptyListLabel?z("div",{class:"empty-list"},null!==(e=this.emptyListLabel)&&void 0!==e?e:this.t("list.empty")):z("div",{class:"page-wrapper"},this.pagesToRender.map(e=>this.createNodes(e))),z("div",{key:"7b54f683c79b5df12e101fcbb5fb645ddaeca082",class:"smallest-dom-element",id:"top-scroll",ref:e=>this.$topRef=e})))}static get watchers(){return{selectedItemId:["onItemChanged"]}}};cl([si()],hl.prototype,"iconPack",void 0),cl([si()],hl.prototype,"t",void 0),hl.style=".scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;flex-direction:column;flex:1}.container{box-sizing:border-box;display:flex;flex-direction:column-reverse;padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px);flex:1 0 0px;overflow-y:scroll;}.file-picker{display:none}.chat *:first-child{margin-top:var(--dyte-space-0, 0px)}.chat .head{display:flex;align-items:center}.chat .head .name{margin-right:var(--dyte-space-4, 16px);font-size:12px;font-weight:700}.chat .head .time{font-size:12px;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.chat .body{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);overflow-wrap:break-word;font-size:14px;line-height:1.375}.chat .body .emoji{font-size:24px}p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-3, 12px)}dyte-text-message,dyte-image-message,dyte-file-message{margin-top:var(--dyte-space-4, 16px);display:block;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);font-family:var(--dyte-font-family, sans-serif);color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));box-sizing:border-box}*[is-continued]{margin-top:var(--dyte-space-3, 12px)}dyte-text-message[is-continued]{margin-top:var(--dyte-space-2, 8px)}.chat .image{position:relative;height:var(--dyte-space-40, 160px);max-width:var(--dyte-space-64, 256px);cursor:pointer}.chat .image img{display:none;height:100%;width:100%;border-radius:var(--dyte-border-radius-sm, 4px);-o-object-fit:cover;object-fit:cover}.chat .image .image-spinner{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.chat .image .image-spinner dyte-spinner{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}.chat .image .image-errored{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-sm, 4px);background-color:rgba(var(--dyte-colors-danger, 255 45 45) / 0.1);--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}.chat .image .actions{display:none;height:var(--dyte-space-8, 32px);align-items:center;position:absolute;top:var(--dyte-space-2, 8px);right:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.chat .image .actions .action{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);border-radius:var(--dyte-border-radius-none, 0);border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.chat .image .actions .action:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.image.loaded img{display:block}.image.loaded .image-spinner{display:none}.image:hover .actions,.image:focus .actions{display:flex}.chat .file{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);padding-top:var(--dyte-space-1\\.5, 6px);padding-bottom:var(--dyte-space-1\\.5, 6px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.chat .file .file-data{flex:1 1 0%}.chat .file .file-data .name{word-break:break-all;color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.chat .file .file-data .file-data-split{margin-top:var(--dyte-space-0\\.5, 2px);display:flex;align-items:center;font-size:12px}.chat .file .file-data .file-data-split .ext{margin-right:var(--dyte-space-2, 8px);text-transform:uppercase;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}.chat .file .file-data .file-data-split .divider{height:var(--dyte-space-4, 16px);width:var(--dyte-space-0\\.5, 2px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.chat .file .file-data .file-data-split .size{margin-left:var(--dyte-space-2, 8px)}.smallest-dom-element{width:1px}#top-scroll{transform:translateY(20vh)}#bottom-scroll{transform:translateY(-20vh)}a{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));text-decoration-line:none}a:hover{text-decoration-line:underline}.show-new-messages-ctr{pointer-events:none;position:absolute;bottom:var(--dyte-space-2, 8px);right:var(--dyte-space-4, 16px);z-index:10;margin-top:calc(var(--dyte-space-14, 56px) * -1);--tw-translate-y:var(--dyte-space-28, 112px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:0;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.show-new-messages-ctr.active{--tw-translate-y:var(--dyte-space-0, 0px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:1}.show-new-messages{pointer-events:auto;border-radius:9999px}.show-new-messages:hover{border-radius:9999px;--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);--tw-ring-opacity:1;--tw-ring-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-ring-opacity));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}dyte-spinner,.empty-list{margin:auto}.page-wrapper{margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px)}.message-wrapper{margin-bottom:var(--dyte-space-2, 8px)}.pinned .message-wrapper{position:relative}.pinned .pin-icon{position:absolute;right:calc(var(--dyte-space-1, 4px) * -1);top:calc(var(--dyte-space-1, 4px) * -1);display:flex;border-radius:var(--dyte-border-radius-sm, 4px)}.pinned dyte-message-view{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px)}";var pl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const ul=class{constructor(e){o(this,e),this.tileLoad=W(this,"tileLoad",7),this.tileUnload=W(this,"tileUnload",7),this.isPinned=!1,this.mediaConnectionError=!1,this.nameTagPosition="bottom-left",this.isPreview=!1,this.config=Ft,this.variant="solid",this.iconPack=Vt,this.t=Ht(),this.onPinned=({isPinned:e})=>{this.isPinned=e},this.isSelf=()=>{var e;return this.isPreview||this.participant.id===(null===(e=this.meeting)||void 0===e?void 0:e.self.id)},this.onPause=e=>{var t,i;this.isSelf()&&(null===(t=this.meeting)||void 0===t?void 0:t.__internals__.features.hasFeature(nt))&&(this.meeting.__internals__.logger.warn(`Video player paused for ${this.participant.id} isSelf: ${this.isSelf()}`),null===(i=null==e?void 0:e.target)||void 0===i||i.play())},this.onPlaying=()=>{this.playTimeout&&clearTimeout(this.playTimeout)}}onVideoRef(e){this.participant&&this.meeting&&e!==this.videoEl&&(this.videoEl=e,this.participant.registerVideoElement(this.videoEl,this.isPreview),this.tileLoad.emit({participant:this.participant,videoElement:this.videoEl}))}connectedCallback(){this.meeting?this.meetingChanged(this.meeting):this.participantsChanged(this.participant)}disconnectedCallback(){this.playTimeout&&clearTimeout(this.playTimeout),null!=this.participant&&(this.participant.deregisterVideoElement(this.videoEl,this.isPreview),this.participant.removeListener("pinned",this.onPinned),this.participant.removeListener("unpinned",this.onPinned),this.meeting.meta.off("mediaConnectionUpdate",this.mediaConnectionUpdateListener),this.tileUnload.emit(this.participant))}meetingChanged(e){null!=e&&this.participantsChanged(this.participant)}participantsChanged(e){null!=e&&(void 0!==this.meeting?(this.isPinned=e.isPinned,this.videoEl&&this.participant.registerVideoElement(this.videoEl,this.isPreview),e.addListener("pinned",this.onPinned),e.addListener("unpinned",this.onPinned),this.meeting.meta.on("mediaConnectionUpdate",this.mediaConnectionUpdateListener.bind(this))):this.isPreview&&this.videoEl&&this.participant.registerVideoElement(this.videoEl,this.isPreview))}mediaConnectionUpdateListener(){var e,t,i;const{recv:s,send:a}=null!==(i=null===(t=null===(e=this.meeting)||void 0===e?void 0:e.meta)||void 0===t?void 0:t.mediaState)&&void 0!==i?i:{};"connected"===(null==s?void 0:s.state)||this.isSelf()?"connected"!==(null==a?void 0:a.state)&&this.isSelf()?this.mediaConnectionError=!0:this.mediaConnectionError=!1:this.mediaConnectionError=!0}isMirrored(){var e;if(null!=this.participant&&this.isSelf()){const t=this.states,i=null===(e=null==t?void 0:t.prefs)||void 0===e?void 0:e.mirrorVideo;if("boolean"==typeof i)return i}return!1}render(){var e,t,i;const s={meeting:this.meeting,size:this.size,states:this.states,config:this.config,iconPack:this.iconPack,t:this.t};return z(G,{key:"ae0d125a5d4b2bd7cab5c4c286be3fd31d9b6b80"},z("video",{key:"46c326caaf26377c1a7e6ba2989eabbc89a3d4aa",ref:e=>this.onVideoRef(e),class:{mirror:this.isMirrored(),[null!==(i=null===(t=null===(e=this.config)||void 0===e?void 0:e.config)||void 0===t?void 0:t.videoFit)&&void 0!==i?i:"cover"]:!0},onPlaying:this.onPlaying,onPause:this.onPause,autoPlay:!0,playsInline:!0,muted:!0,part:"video"}),this.isPinned&&z("dyte-icon",{key:"8a3e9d03d2c69b9a281d6633a87f519cd36f8caf",class:"pinned-icon",icon:this.iconPack.pin,"aria-label":this.t("pinned"),part:"pinned-icon"}),this.mediaConnectionError&&z("div",{key:"b501ff04fcbe6c283b71c5bfa226cdc2b0127c6e",class:"network-container",part:"network-indicator"},z("dyte-icon",{key:"a200fd6ee5973cacd387ea38af916ac8d71355b5",class:"network-icon",icon:this.iconPack.disconnected,"aria-label":this.t("pinned"),part:"pinned-icon"})),z("slot",{key:"03c182c48452d89f381eecea6895a98f865a1b2f"},z(ls,{key:"459ff30c21c410a4cd7eea256d203fca6bf9d4bd",element:"dyte-participant-tile",defaults:s,childProps:{participant:this.participant},deepProps:!0,onlyChildren:!0})))}static get watchers(){return{meeting:["meetingChanged"],participant:["participantsChanged"]}}};pl([si()],ul.prototype,"meeting",void 0),pl([si()],ul.prototype,"states",void 0),pl([si()],ul.prototype,"size",void 0),pl([si()],ul.prototype,"iconPack",void 0),pl([si()],ul.prototype,"t",void 0),ul.style=":host {\n  line-height: initial;\n  font-family: var(--dyte-font-family, sans-serif);\n\n  font-feature-settings: normal;\n  font-variation-settings: normal;\n}\n\np {\n  margin: var(--dyte-space-0, 0px);\n  padding: var(--dyte-space-0, 0px);\n}\n\n\n:host {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  aspect-ratio: 16 / 9;\n  height: var(--dyte-space-56, 224px);\n  overflow: hidden;\n  border-radius: var(--dyte-border-radius-lg, 12px);\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-video-bg, 24 24 24) / var(--tw-bg-opacity));\n\n  transition-property: var(--dyte-transition-property, all);\n  transition-duration: 150ms;\n  container-type: inline-size;\n  container-name: participanttile;\n}\n\n@media (prefers-reduced-motion) {\n  /* No transitions when disabled */\n  :host {\n    --dyte-transition-property: none;\n  }\n}\n\ndyte-avatar {\n  z-index: -1;\n}\n\n/**\n  NOTE: provided :slotted(dyte-name-tag) & dyte-name-tag separately\n  because ::slotted isn't applied on default slots.\n*/\n\n::slotted(dyte-name-tag), \ndyte-name-tag {\n  position: absolute;\n  left: var(--dyte-space-3, 12px);\n  bottom: var(--dyte-space-3, 12px);\n}\n\n:host([size='sm'][variant='solid']) ::slotted(dyte-name-tag), \n  :host([size='sm'][variant='solid']) dyte-name-tag {\n  left: var(--dyte-space-2, 8px);\n  bottom: var(--dyte-space-2, 8px);\n  height: var(--dyte-space-4, 16px);\n}\n\n::slotted(dyte-network-indicator), \ndyte-network-indicator {\n  position: absolute;\n  right: var(--dyte-space-3, 12px);\n  bottom: var(--dyte-space-3, 12px);\n}\n\n:host([size='sm']) ::slotted(dyte-network-indicator), \n  :host([size='sm']) dyte-network-indicator {\n  right: var(--dyte-space-2, 8px);\n  bottom: var(--dyte-space-2, 8px);\n}\n\nvideo {\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  border-radius: var(--dyte-border-radius-lg, 12px);\n}\n\nvideo.contain {\n  -o-object-fit: contain;\n     object-fit: contain;\n}\n\nvideo.cover {\n  -o-object-fit: cover;\n     object-fit: cover;\n}\n\nvideo::-webkit-media-controls {\n  display: none !important;\n}\n\n.pinned-icon {\n  position: absolute;\n  left: var(--dyte-space-3, 12px);\n  top: var(--dyte-space-3, 12px);\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  padding: var(--dyte-space-1, 4px);\n  border-radius: var(--dyte-border-radius-md, 8px);\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));\n}\n\n.network-container {\n  position: absolute;\n  right: var(--dyte-space-3, 12px);\n  bottom: var(--dyte-space-3, 12px);\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding: var(--dyte-space-2, 8px);\n  font-size: 12px;\n  border-radius: var(--dyte-border-radius-md, 8px);\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));\n}\n.network-icon {\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n  --tw-text-opacity: 1;\n  color: rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity));\n}\n\n:host([size='sm']) .pinned-icon {\n  top: var(--dyte-space-2, 8px);\n  left: var(--dyte-space-2, 8px);\n}\n\n:host([variant='gradient']) ::slotted(dyte-audio-visualizer), \n  :host([variant='gradient']) dyte-audio-visualizer {\n  position: absolute;\n  top: var(--dyte-space-2, 8px);\n  right: var(--dyte-space-2, 8px);\n  border-radius: 9999px;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n  padding: var(--dyte-space-2, 8px);\n}\n\n:host([variant='gradient']) ::slotted(dyte-name-tag), \n  :host([variant='gradient']) dyte-name-tag {\n  bottom: var(--dyte-space-0, 0px);\n  left: var(--dyte-space-0, 0px);\n  display: flex;\n  width: 100%;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  background-color: transparent;\n  background-image: linear-gradient(to top, var(--tw-gradient-stops));\n  --tw-gradient-from: rgb(var(--dyte-colors-background-1000, 8 8 8));\n  --tw-gradient-to: rgba(var(--dyte-colors-background-1000, 8 8 8) / 0);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n  --tw-gradient-to: transparent;\n}\n\nvideo.mirror {\n  transform: scaleX(-1);\n}\n\n/** Name tag positions */\n\n:host([name-tag-position='bottom-right']) ::slotted(dyte-name-tag), \n  :host([name-tag-position='bottom-right']) dyte-name-tag {\n  left: auto;\n  right: var(--dyte-space-3, 12px);\n}\n\n:host([name-tag-position='bottom-center']) ::slotted(dyte-name-tag), \n  :host([name-tag-position='bottom-center']) dyte-name-tag {\n  left: auto;\n  right: auto;\n}\n\n:host([name-tag-position='top-left']) ::slotted(dyte-name-tag), \n  :host([name-tag-position='top-left']) dyte-name-tag {\n  top: var(--dyte-space-3, 12px);\n  bottom: auto;\n}\n\n:host([name-tag-position='top-right']) ::slotted(dyte-name-tag), \n  :host([name-tag-position='top-right']) dyte-name-tag {\n  top: var(--dyte-space-3, 12px);\n  right: var(--dyte-space-3, 12px);\n  left: auto;\n  bottom: auto;\n}\n\n:host([name-tag-position='top-center']) ::slotted(dyte-name-tag), \n  :host([name-tag-position='top-center']) dyte-name-tag {\n  left: auto;\n  right: auto;\n  bottom: auto;\n  top: var(--dyte-space-3, 12px);\n}\n\n@media only screen and (max-height: 480px) and (orientation: landscape) {\n  :host([size='sm']) {\n    border-radius: var(--dyte-border-radius-sm, 4px);\n  }\n\n  :host([size='sm']) > video {\n    border-radius: var(--dyte-border-radius-sm, 4px);\n  }\n\n  ::slotted(dyte-avatar), \n  dyte-avatar {\n    height: var(--dyte-space-12, 48px);\n    width: var(--dyte-space-12, 48px);\n  }\n    :host([size='sm'][variant='solid']) ::slotted(dyte-name-tag),\n    :host([size='sm'][variant='solid']) dyte-name-tag {\n      transform-origin: -2% 100%;\n      transform: scale(0.6);\n      z-index: 10;\n      left: var(--dyte-space-0, 0px);\n      bottom: var(--dyte-space-0, 0px);\n      border-radius: var(--dyte-border-radius-none, 0);\n    }\n}\n\n@media only screen and (max-width: 480px) and (orientation: portrait) {\n  :host([size='sm']) {\n    border-radius: var(--dyte-border-radius-sm, 4px);\n  }\n\n  :host([size='sm']) > video {\n    border-radius: var(--dyte-border-radius-sm, 4px);\n  }\n\n  ::slotted(dyte-avatar), \n  dyte-avatar {\n    height: var(--dyte-space-12, 48px);\n    width: var(--dyte-space-12, 48px);\n  }\n    :host([size='sm'][variant='solid']) ::slotted(dyte-name-tag),\n    :host([size='sm'][variant='solid']) dyte-name-tag {\n      transform-origin: -5% 110%;\n      transform: scale(0.6);\n      z-index: 10;\n      left: var(--dyte-space-0, 0px);\n      bottom: var(--dyte-space-0, 0px);\n      border-radius: var(--dyte-border-radius-none, 0);\n    }\n}\n\n@container participanttile (max-width: 300px) {\n  ::slotted(dyte-name-tag),\n  dyte-name-tag {\n    transform-origin: 0 100%;\n    transform: scale(0.8);\n  }\n\n  ::slotted(dyte-avatar), \n  dyte-avatar {\n    height: var(--dyte-space-8, 32px) !important;\n    width: var(--dyte-space-8, 32px) !important;\n  }\n}\n\n@container participanttile (max-width: 150px) {\n  ::slotted(dyte-name-tag),\n  dyte-name-tag[variant='solid'] {\n    transform-origin: -10% 130%;\n    transform: scale(0.6);\n    z-index: 10;\n    border-radius: 9999px;\n  }\n\n  ::slotted(dyte-avatar), \n  dyte-avatar {\n    height: 6 !important;\n    width: 6 !important;\n  }\n}\n";var gl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const fl={"Chrome.Desktop.audio":["Chrome1.svg","Chrome2.svg","Chrome3.svg"],"Chrome.Desktop.video":["Chrome1.svg","Chrome2.svg","Chrome3.svg"]},ml=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.t=Ht(),this.iconPack=Vt,this.currentStep=0,this.svgSteps=[],this.continue=()=>{this.stateUpdate.emit({activePermissionsMessage:{enabled:!1}})},this.reload=()=>{"undefined"!=typeof window&&window.location.reload()},this.getImage=async e=>{function t(e,t,i){return e.split(t).join(i)}const i=await fetch(`https://assets.dyte.io/ui-kit/permissions/${e}`);let s=await i.text();return s=t(s,"yoursite.com",location.host),s=t(s,"Yoursite",document.title.length>14?`${document.title.slice(0,14)}...`:document.title),s},this.nextStep=()=>{this.currentStep=(this.currentStep+1)%this.svgSteps.length},this.openMacSystemSettings=()=>{const e=document.createElement("a");switch(this.mediaType){case"audio":e.href="x-apple.systempreferences:com.apple.preference.security?Privacy_Microphone";break;case"screenshare":e.href="x-apple.systempreferences:com.apple.preference.security?Privacy_ScreenCapture";break;case"video":e.href="x-apple.systempreferences:com.apple.preference.security?Privacy_Camera"}e.click()}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.stepsTimer&&clearTimeout(this.stepsTimer)}meetingChanged(e){var t,i,s;if(null!=e){this.device=e.self.device;const a=(null===(t=this.device)||void 0===t?void 0:t.isMobile)?"Mobile":"Desktop",r=null!==(s=fl[`${null===(i=this.device)||void 0===i?void 0:i.browserName}.${a}.${this.mediaType}`])&&void 0!==s?s:[];Promise.all(r.map(this.getImage)).then(e=>{this.svgSteps=e})}}getLink(e){let t;switch(e){case"audio":t="microphone";break;case"video":t="camera";break;default:t="screenshare"}let i=`Allow+${t}+access`;if(null!=this.device){const{browserName:e,isMobile:t}=this.device;i+="+"+e,t&&(i+="+mobile")}return"https://www.google.com/search?q="+i}isDeniedBySystem(){var e;const t=null===(e=this.meeting)||void 0===e?void 0:e.self.mediaPermissions;return null!=t&&"SYSTEM_DENIED"===t[this.mediaType]}getTitle(){return this.isDeniedBySystem()?this.t(`perm_sys_denied.${this.mediaType}`):this.t(`perm_denied.${this.mediaType}`)}get mediaType(){var e,t,i;return null!==(i=null===(t=null===(e=this.states)||void 0===e?void 0:e.activePermissionsMessage)||void 0===t?void 0:t.kind)&&void 0!==i?i:"audio"}getMessage(){var e;const{browserName:t,osName:i}=this.meeting.self.device,s=this.isDeniedBySystem(),a=null!==(e=t.toLowerCase())&&void 0!==e?e:"others",r=null!=i?i:"others";if(s){const e=`perm_sys_denied.${this.mediaType}.${r.toLowerCase()}.message`;return this.t(e)===e?this.t(`perm_sys_denied.${this.mediaType}.others.message`):this.t(e)}const n=`perm_denied.${this.mediaType}.${a}.message`;return this.t(n)===n?this.t(`perm_denied.${this.mediaType}.others.message`):this.t(n)}render(){var e,t,i;const s=this.isDeniedBySystem();this.svgSteps.length>0&&(this.stepsTimer&&clearTimeout(this.stepsTimer),this.stepsTimer=setTimeout(this.nextStep,2500));const a=s&&"macOS"==this.meeting.self.device.osName;return z(G,{key:"fd3113af80de08603477d44313c51386dc18af5e"},z("h2",{key:"105d5ea31c336aa1cd436818328ccd782770c326"},z("dyte-icon",{key:"459d39bf025a2a86a5dc007d1d37da478de9cbb2",class:"text-icon",icon:this.iconPack.warning}),this.getTitle()),this.svgSteps.length>0&&z("div",{key:"d8795f8c99c3d3e2c7fc0e854d4a97df30501f7e",class:"svg-container"},this.svgSteps.map((e,t)=>z("p",{innerHTML:e,class:"svg-ins",key:this.currentStep,hidden:t!==this.currentStep}))),z("div",{key:"f3c61c410b2561a7554cf92335bd45095e026d60"},this.getMessage()),!s&&z("a",{key:"44c3c2a12fbfd15aff428089a795b567c0948c0d",class:"need-help-link",href:this.getLink(null!==(i=null===(t=null===(e=this.states)||void 0===e?void 0:e.activePermissionsMessage)||void 0===t?void 0:t.kind)&&void 0!==i?i:"audio"),target:"_blank",rel:"noreferrer external noreferrer noopener"},z("dyte-icon",{key:"98ce0ba2b7a86af4c855cd3ce4025c5a40b5d52c",class:"text-icon",icon:this.iconPack.attach}),this.t("cta.help")),z("div",{key:"3d1c026bee6a4c04bb0239c14af85d67475f66ce",class:"actions"},z("dyte-button",{key:"3ef491db07fc2ec207ad87ef1c814bd132107bda",size:"lg",kind:"wide",variant:"secondary",onClick:this.continue},this.t("cta.continue")),a?z("dyte-button",{size:"lg",kind:"wide",onClick:this.openMacSystemSettings},this.t("cta.system_settings")):z("dyte-button",{size:"lg",kind:"wide",onClick:this.reload},this.t("cta.reload"))),z("slot",{key:"ed5ac76fdf888a80b20f495d2b9daa005b1fd692"}))}static get watchers(){return{meeting:["meetingChanged"]}}};gl([si()],ml.prototype,"meeting",void 0),gl([si()],ml.prototype,"t",void 0),gl([si()],ml.prototype,"iconPack",void 0),gl([si()],ml.prototype,"states",void 0),ml.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{box-sizing:border-box;display:block;max-height:100%;width:600px;overflow-y:auto;padding:var(--dyte-space-6, 24px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));overflow-wrap:break-word;color:rgb(var(--dyte-colors-text-1000, 255 255 255));word-wrap:break-word}.actions{display:flex;align-items:center;gap:var(--dyte-space-2, 8px)}.text-icon{display:inline-block;vertical-align:middle}h2{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-4, 16px)}h2 .text-icon{margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-4, 16px)}.need-help-link{margin-top:var(--dyte-space-2, 8px);display:inline-block;text-underline-offset:2px;--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-400, 53 110 253) / var(--tw-text-opacity))}.need-help-link:hover{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-600, 13 81 253) / var(--tw-text-opacity))}a dyte-icon{margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}:host([size='sm']) .actions{flex-direction:column;align-items:flex-start;justify-content:center}:host([size='sm']) .action{width:100%;padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px)}.actions{margin-top:var(--dyte-space-6, 24px)}.actions dyte-button{flex:1 1 0%}.svg-container{display:flex;width:100%;justify-content:center !important}.svg-ins{width:80%;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}";var vl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const yl=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.keyPressListener=e=>{"Escape"===e.key&&this.close()},this.stageStatusListener=()=>{this.canProduceVideo="ALLOWED"===this.meeting.self.permissions.canProduceVideo},this.iconPack=Vt,this.t=Ht(),this.activeTab="connection",this.isMobileMainVisible=!1,this.networkStatus="good",this.canProduceVideo=!1}connectedCallback(){document.addEventListener("keydown",this.keyPressListener),this.meetingChanged(this.meeting)}disconnectedCallback(){var e;this.keyPressListener&&document.removeEventListener("keydown",this.keyPressListener),this.poorConnectionListener&&(null===(e=this.meeting)||void 0===e||e.meta.removeListener("poorConnection",this.poorConnectionListener)),this.meeting.stage.removeListener("stageStatusUpdate",this.stageStatusListener)}meetingChanged(e){null!=e&&(this.canProduceVideo="ALLOWED"===this.meeting.self.permissions.canProduceVideo,this.canProduceVideo?this.activeTab="video":this.activeTab="audio",this.poorConnectionListener=({score:e})=>{e<7?this.networkStatus="poor":e<4&&(this.networkStatus="poorest"),setTimeout(()=>{this.networkStatus="good"},5e3)},e.meta.addListener("poorConnection",this.poorConnectionListener),e.stage.addListener("stageStatusUpdate",this.stageStatusListener))}changeTab(e){this.activeTab=e,"sm"===this.size&&(this.isMobileMainVisible||(this.isMobileMainVisible=!0))}close(){this.stateUpdate.emit({activeSettings:!1})}render(){if(null==this.meeting)return null;const e={meeting:this.meeting,states:this.states,iconPack:this.iconPack,t:this.t};return z(G,null,z("aside",{class:{hide:this.isMobileMainVisible},part:"menu"},z("header",null,z("h2",null,this.t("settings"))),z("button",{type:"button",class:{active:"audio"===this.activeTab},onClick:()=>this.changeTab("audio")},this.t("audio"),z("div",{class:"right"},z("dyte-icon",{icon:this.iconPack.mic_on}),"sm"===this.size&&z("dyte-icon",{icon:this.iconPack.chevron_right}))),this.canProduceVideo&&z("button",{type:"button",class:{active:"video"===this.activeTab},onClick:()=>this.changeTab("video")},this.t("video"),z("div",{class:"right"},z("dyte-icon",{icon:this.iconPack.video_on}),"sm"===this.size&&z("dyte-icon",{icon:this.iconPack.chevron_right}))),z("button",{type:"none",title:`Your network condition is ${this.networkStatus}`},this.t("connection"),z("div",{class:"right"},z("dyte-icon",{icon:this.iconPack.wifi,class:this.networkStatus})))),z("main",{class:{active:this.isMobileMainVisible,scrollbar:!0},part:"main-content"},"sm"===this.size&&z("header",null,z("dyte-button",{kind:"icon",class:"back-btn",onClick:()=>this.isMobileMainVisible=!1},z("dyte-icon",{icon:this.iconPack.chevron_left})),z("h2",null,this.t("audio"===this.activeTab?"audio":"video"))),"audio"===this.activeTab&&z("dyte-settings-audio",Object.assign({},e)),"video"===this.activeTab&&z("dyte-settings-video",Object.assign({},e))))}static get watchers(){return{meeting:["meetingChanged"]}}};vl([si()],yl.prototype,"meeting",void 0),vl([si()],yl.prototype,"states",void 0),vl([si()],yl.prototype,"size",void 0),vl([si()],yl.prototype,"iconPack",void 0),vl([si()],yl.prototype,"t",void 0),yl.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;display:flex;overflow:hidden;border-radius:var(--dyte-border-radius-md, 8px);width:100%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}header{display:flex;align-items:center;justify-content:space-between;padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px)}.title{font-size:20px;line-height:1}.back-btn,.dismiss-btn{border-radius:var(--dyte-border-radius-sm, 4px);background-color:transparent;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.back-btn:hover,.dismiss-btn:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}aside{box-sizing:border-box;display:flex;min-width:var(--dyte-space-56, 224px);flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));padding-left:var(--dyte-space-2, 8px)}aside button{margin-top:var(--dyte-space-4, 16px);box-sizing:border-box;display:flex;width:100%;align-items:center;justify-content:space-between;border-top-left-radius:var(--dyte-border-radius-sm, 4px);border-bottom-left-radius:var(--dyte-border-radius-sm, 4px);padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px);padding-top:var(--dyte-space-3, 12px);padding-bottom:var(--dyte-space-3, 12px);background-color:transparent;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));cursor:default;font-size:16px;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);border-width:var(--dyte-border-width-none, 0);border-style:none;outline:2px solid transparent;outline-offset:2px}aside button .right{display:flex;align-items:center}aside button .right dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}aside button .right dyte-icon:last-child{margin-left:var(--dyte-space-4, 16px)}aside button[type='button']{cursor:pointer;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}aside button[type='button']:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}aside button[type='button']{border-right:var(--dyte-border-width-md, 2px) solid transparent}aside button.active{--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-border-opacity));background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / 0.2)}aside button.active:hover{background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / 0.2)}dyte-icon.poor{--tw-text-opacity:1;color:rgba(var(--dyte-colors-warning, 255 205 7) / var(--tw-text-opacity))}dyte-icon.poorest{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}dyte-icon.good{--tw-text-opacity:1;color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-text-opacity))}main{display:flex;flex:1 1 0%;align-items:center;justify-content:center;padding-left:var(--dyte-space-6, 24px);padding-right:var(--dyte-space-6, 24px);box-sizing:border-box;width:100%;max-width:calc(100% - var(--dyte-space-56, 224px))}.dismiss-btn{position:absolute;top:var(--dyte-space-3, 12px);right:var(--dyte-space-3, 12px);height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}:host([size='sm']) aside{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}:host([size='sm']) .dismiss-btn{top:var(--dyte-space-5, 20px);right:var(--dyte-space-4, 16px)}:host([size='sm']) aside{width:100%;padding-left:var(--dyte-space-0, 0px)}:host([size='sm']) aside button{border-radius:var(--dyte-border-radius-none, 0)}:host([size='sm']) aside button.active{border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent}:host([size='sm']) aside button.active:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}:host([size='sm']) aside.hide{display:none}:host([size='sm']) main{display:none;max-width:100%;overflow-y:auto;padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px)}:host([size='sm']) main header{justify-content:center}:host([size='sm']) main header dyte-button{position:absolute;left:var(--dyte-space-4, 16px)}:host([size='sm']) main.active{display:block}";var bl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const wl=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.iconPack=Vt,this.t=Ht()}render(){var e,t;if(null==this.meeting)return null;const i={meeting:this.meeting,states:this.states,size:this.size,iconPack:this.iconPack,t:this.t},s=this.states,a=!0===(null===(e=null==s?void 0:s.prefs)||void 0===e?void 0:e.muteNotificationSounds)||"true"===Qt("mute-notification-sounds");return z(G,null,z("dyte-microphone-selector",Object.assign({},i),z("dyte-audio-visualizer",{participant:null===(t=this.meeting)||void 0===t?void 0:t.self,iconPack:this.iconPack,t:this.t,slot:"indicator"})),z("dyte-speaker-selector",Object.assign({},i)),z("div",{class:"group",part:"notification-toggle"},z("div",{class:"row"},z("label",{htmlFor:"notification-toggle"},this.t("settings.notification_sound")),z("dyte-switch",{id:"notification-toggle",checked:!a,onDyteChange:e=>{const{checked:t}=e.target,i=!t;this.stateUpdate.emit({prefs:{muteNotificationSounds:i}}),Zt("mute-notification-sounds",i)},iconPack:this.iconPack,t:this.t}))))}};bl([si()],wl.prototype,"meeting",void 0),bl([si()],wl.prototype,"states",void 0),bl([si()],wl.prototype,"size",void 0),bl([si()],wl.prototype,"iconPack",void 0),bl([si()],wl.prototype,"t",void 0),wl.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;width:100%;flex-direction:column}audio{visibility:hidden}.group{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px)}.group>*{margin-bottom:var(--dyte-space-2, 8px)}.group>*:last-child{margin-bottom:var(--dyte-space-0, 0px)}.group select{flex:1 1 0%}dyte-audio-visualizer{flex-shrink:0}dyte-button{border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}dyte-button dyte-icon{margin-right:var(--dyte-space-2, 8px)}";var xl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const kl=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.iconPack=Vt,this.t=Ht(),this.onVideoUpdate=e=>{this.videoEnabled=e.videoEnabled}}componentDidLoad(){this.meetingChanged(this.meeting)}meetingChanged(e){var t;null!=e&&(this.videoEnabled=e.self.videoEnabled,null===(t=e.self)||void 0===t||t.addListener("videoUpdate",this.onVideoUpdate))}disconnectedCallback(){var e;null===(e=this.meeting.self)||void 0===e||e.removeListener("videoUpdate",this.onVideoUpdate)}render(){var e,t,i;if(null==this.meeting)return null;const s={meeting:this.meeting,states:this.states,size:this.size,iconPack:this.iconPack,t:this.t},a=this.states,r=!0===(null===(e=null==a?void 0:a.prefs)||void 0===e?void 0:e.mirrorVideo)||"true"===Qt("mirror-video");return z(G,null,z("div",{class:"section",part:"tile-preview"},z("div",{class:"group",part:"tile-preview"},!0===this.videoEnabled?z("dyte-participant-tile",{meeting:this.meeting,participant:null===(t=this.meeting)||void 0===t?void 0:t.self,iconPack:this.iconPack,t:this.t,states:a,size:this.size,isPreview:!0}):z("div",{class:"camera-off-helper"},z("dyte-participant-tile",{meeting:this.meeting,participant:null===(i=this.meeting)||void 0===i?void 0:i.self,size:this.size},z("div",null,z("dyte-icon",{id:"icon",icon:this.iconPack.video_off,tabIndex:-1,"aria-hidden":!0}),z("div",null,this.t("settings.camera_off"))))))),z("dyte-camera-selector",Object.assign({},s)),z("div",{class:"group",part:"mirror-toggle"},z("div",{class:"row"},z("label",{htmlFor:"mirror-toggle"},this.t("settings.mirror_video")),z("dyte-switch",{checked:r,iconPack:this.iconPack,t:this.t,onDyteChange:e=>{const{checked:t}=e.target;this.stateUpdate.emit({prefs:{mirrorVideo:t}}),Zt("mirror-video",t)}}))))}static get watchers(){return{meeting:["meetingChanged"]}}};xl([si()],kl.prototype,"meeting",void 0),xl([si()],kl.prototype,"states",void 0),xl([si()],kl.prototype,"size",void 0),xl([si()],kl.prototype,"iconPack",void 0),xl([si()],kl.prototype,"t",void 0),kl.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.dyte-select{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.dyte-select:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.dyte-select{display:block;border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:var(--dyte-space-3, 12px);font-size:16px;--icon-size:var(--dyte-select-chevron-size, var(--dyte-space-6, 24px));--icon-right-position:var(--dyte-select-chevron-right-position, var(--dyte-space-2, 8px));background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e\");background-position:right var(--icon-right-position) center;background-repeat:no-repeat;background-size:var(--icon-size) var(--icon-size);padding-right:calc(var(--icon-right-position) * 5)}:host{display:flex;width:100%;flex-direction:column}.dyte-select{width:100%;text-overflow:ellipsis}dyte-participant-tile{margin-left:auto;margin-right:auto;margin-bottom:var(--dyte-space-4, 16px);max-width:100%}#icon{padding-bottom:var(--dyte-space-1, 4px)}.apply-button{height:var(--dyte-space-10, 40px)}label{-webkit-user-select:none;-moz-user-select:none;user-select:none;font-size:14px}.group{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px)}.group>*{margin-bottom:var(--dyte-space-2, 8px)}.group>*:last-child{margin-bottom:var(--dyte-space-0, 0px)}.group select{flex:1 1 0%}.row{display:flex;align-items:center;justify-content:space-between;gap:var(--dyte-space-3, 12px)}.section{display:flex;flex-direction:column}@media only screen and (max-height: 480px) and (orientation: landscape){:host{flex-direction:row}:host([size='sm']){flex-direction:row}.section[part='tile-preview']{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);max-height:90%;max-width:40%;flex-shrink:1}.section[part='video-settings']{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);flex-grow:1}}";var Sl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const El=class{constructor(e){o(this,e),this.variant="full",this.iconPack=Vt,this.t=Ht(),this.speakerDevices=[],this.currentDevices={speaker:void 0},this.deviceListUpdateListener=async()=>{const e=await this.meeting.self.getSpeakerDevices();this.speakerDevices=e},this.deviceUpdateListener=({device:e})=>{"audiooutput"===e.kind&&(this.currentDevices={speaker:e})},this.mediaPermissionUpdate=async({kind:e,message:t})=>{this.meeting&&"audio"===e&&"ACCEPTED"===t&&(this.speakerDevices=await this.meeting.self.getSpeakerDevices())}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e,t,i;null===(e=this.meeting)||void 0===e||e.self.removeListener("deviceListUpdate",this.deviceListUpdateListener),null===(t=this.meeting)||void 0===t||t.self.removeListener("deviceUpdate",this.deviceUpdateListener),null===(i=this.meeting)||void 0===i||i.self.addListener("mediaPermissionUpdate",this.mediaPermissionUpdate)}meetingChanged(e){null!=e&&P(async()=>{var t,i;const{self:s}=e,a=await e.self.getSpeakerDevices(),r=null===(t=e.self.getCurrentDevices())||void 0===t?void 0:t.speaker;this.currentDevices={speaker:r},s.addListener("deviceListUpdate",this.deviceListUpdateListener),s.addListener("deviceUpdate",this.deviceUpdateListener),s.addListener("mediaPermissionUpdate",this.mediaPermissionUpdate),this.speakerDevices=null!=r?[null!==(i=a.find(e=>e.deviceId===r.deviceId))&&void 0!==i?i:r,...a.filter(e=>e.deviceId!==r.deviceId)]:a})}testAudio(){var e;null===(e=this.testAudioEl)||void 0===e||e.play()}setDevice(e){var t,i;if(ut(this.meeting))return;const s=this.speakerDevices.find(t=>t.deviceId===e);this.currentDevices={speaker:s},null!=s&&(null===(t=this.meeting)||void 0===t||t.self.setDevice(s),null===(i=this.testAudioEl)||void 0===i||i.setSinkId(s.deviceId))}render(){if(null==this.meeting)return null;let e=0;return z(G,null,z("audio",{preload:"auto",src:"https://assets.dyte.io/ui-kit/speaker-test.mp3",ref:e=>this.testAudioEl=e}),z("div",{class:"group "+this.variant,part:"speaker-selection"},this.speakerDevices.length>0&&!ut(this.meeting)&&z("div",{class:"container"},z("label",null,"inline"!==this.variant&&this.t("settings.speaker_output"),z("dyte-icon",{icon:this.iconPack.speaker,size:"sm"})),z("div",{class:"row"},z("select",{class:"dyte-select",onChange:e=>this.setDevice(e.target.value)},this.speakerDevices.map(({deviceId:t,label:i})=>{var s;return z("option",{value:t,selected:(null===(s=this.currentDevices.speaker)||void 0===s?void 0:s.deviceId)===t},i||"Speaker "+ ++e)})))),"full"===this.variant&&z("dyte-button",{variant:"secondary",onClick:()=>this.testAudio()},z("dyte-icon",{icon:this.iconPack.speaker,slot:"start"}),this.t("test"))))}static get watchers(){return{meeting:["meetingChanged"]}}};Sl([si()],El.prototype,"meeting",void 0),Sl([si()],El.prototype,"states",void 0),Sl([si()],El.prototype,"size",void 0),Sl([si()],El.prototype,"iconPack",void 0),Sl([si()],El.prototype,"t",void 0),El.style=".dyte-select{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.dyte-select:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(0px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.dyte-select{display:block;border-radius:var(--dyte-border-radius-sm, 4px);border-width:var(--dyte-border-width-none, 0);border-style:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:var(--dyte-space-3, 12px);font-size:16px;--icon-size:var(--dyte-select-chevron-size, var(--dyte-space-6, 24px));--icon-right-position:var(--dyte-select-chevron-right-position, var(--dyte-space-2, 8px));background-image:url(\"data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e\");background-position:right var(--icon-right-position) center;background-repeat:no-repeat;background-size:var(--icon-size) var(--icon-size);padding-right:calc(var(--icon-right-position) * 5);width:100%;max-width:100%;text-overflow:ellipsis}.inline .dyte-select{margin-top:var(--dyte-space-1, 4px);width:100%;padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-1\\.5, 6px);padding-right:var(--dyte-space-1\\.5, 6px);padding-right:var(--dyte-space-8, 32px);font-size:14px}.row{display:flex;width:100%;align-items:center;justify-content:space-between;gap:var(--dyte-space-3, 12px)}.group{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px)}.group>*{margin-bottom:var(--dyte-space-2, 8px)}.group>*:last-child{margin-bottom:var(--dyte-space-0, 0px)}.group select{flex:1 1 0%}.inline.group{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0\\.5, 2px)}.inline.group>*{margin-bottom:var(--dyte-space-0, 0px)}label{display:flex;-webkit-user-select:none;-moz-user-select:none;user-select:none;align-items:center;gap:var(--dyte-space-1, 4px);font-size:14px}.inline .container{display:flex;align-items:center;justify-content:flex-start;gap:var(--dyte-space-2, 8px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px)}";var Pl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Tl=class{constructor(e){o(this,e),this.iconPack=Vt,this.size="md"}render(){return z(G,{key:"f8333e747d1132d7bc402861ad4977d4c48ce101"},z("dyte-icon",{key:"5ba9127b0a2096f7315e1b349a2c1499f7bcf20c",class:"spinner",icon:this.iconPack.spinner}))}};Pl([si()],Tl.prototype,"iconPack",void 0),Pl([si()],Tl.prototype,"size",void 0),Tl.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{box-sizing:border-box;display:block;height:var(--dyte-space-10, 40px);width:var(--dyte-space-10, 40px);--dyte-spinner-color:currentColor}.spinner{height:100%;width:100%}@keyframes spin{to{transform:rotate(360deg)}}.spinner{animation:spin 1s linear infinite;border-radius:9999px;background-color:transparent;animation-duration:1.3s}:host([size='md']){height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}:host([size='sm']){height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}";var Ll=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Cl=class{constructor(e){o(this,e),this.dyteChange=W(this,"dyteChange",4),this.checked=!1,this.readonly=!1,this.disabled=!1,this.iconPack=Vt,this.t=Ht(),this.onClick=()=>{this.readonly||this.disabled||(this.checked=!this.checked)},this.onKeyPress=e=>{if(!this.readonly)switch(e.key){case"Enter":case" ":this.checked=!this.checked}}}connectedCallback(){this.checkedChange(this.checked)}checkedChange(e){this.checked=e,this.dyteChange.emit(e)}render(){return z(G,{key:"873702f9dfe5cff8482944e50c3d18cdbcc83185",role:"switch",tabIndex:this.disabled&&0,"aria-readonly":this.readonly,"aria-checked":this.checked,"aria-disabled":this.disabled,class:{checked:this.checked},onClick:this.onClick,onKeyPress:this.onKeyPress},z("div",{key:"01d727f8cbe301d7a1134b522dabd0d9a202923f",class:"switch",part:"switch"}))}static get watchers(){return{checked:["checkedChange"]}}};Ll([si()],Cl.prototype,"iconPack",void 0),Ll([si()],Cl.prototype,"t",void 0),Cl.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{box-sizing:border-box;display:inline-flex;height:var(--dyte-space-6, 24px);width:var(--dyte-space-10, 40px);align-items:center;padding:var(--dyte-space-1, 4px);border-radius:9999px;background-color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52));cursor:pointer}.switch{box-sizing:border-box;height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);background-color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));border-radius:9999px;transition-property:var(--dyte-transition-property, all);transition-duration:200ms}:host(.checked){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity))}:host(.checked) .switch{transform:translateX(100%)}:host([readonly]),:host([disabled]){cursor:not-allowed;opacity:0.6}";var _l=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Al=class{constructor(e){o(this,e),this.onTextChange=W(this,"textChange",7),this.disabled=!1,this.rateLimitBreached=!1,this.keyDownHandler=()=>{},this.iconPack=Vt,this.t=Ht(),this.maxLengthBreached=0,this.onInputHandler=()=>{const e=this.$textArea.value.trim();this.maybeResize(e),this.checkLength(e),this.onTextChange.emit(e)},this.maybeResize=e=>{const t=[...e.matchAll(/\n/g)].length;this.$textArea.style.height=`${Math.min(200,60+20*t)}px`}}componentDidLoad(){this.maxLength&&(this.$textArea.maxLength=this.maxLength);const e=this.$textArea.value.trim();""!==e&&this.maybeResize(e),this.$textArea.focus()}async setText(e,t=!1){this.$textArea.value=e,this.maybeResize(e),t&&this.$textArea.focus(),this.checkLength(e),this.onTextChange.emit(e)}checkLength(e){const t=e.length;t+10>=this.maxLength?this.maxLengthBreached=e.length:t+10<this.maxLength&&this.maxLengthBreached>0&&(this.maxLengthBreached=0)}render(){return z("div",{key:"61ed661cf0660b1fc1b4a7efb76ade09d536145d",class:"chat-input",part:"chat-input-container"},this.maxLengthBreached>0&&z("div",{key:"97aecab3860485a146fe4725ebe05bfb010baefa",class:"text-error "+(this.maxLengthBreached===this.maxLength?"breached":"")},z("dyte-icon",{key:"daebcf9e4728ea6a9efe79f0b1a781a863bd465d",id:"warning-indicator",icon:this.iconPack.warning,part:"warning-indicator"})," ",this.maxLengthBreached," / ",this.maxLength," ",this.t("chat.max_limit_warning")),this.rateLimitBreached&&z("div",{key:"92f309d491682582352bdc48b73f06fa9ab49bde",class:"text-error breached"},z("dyte-icon",{key:"7ff7d2636801892348061ea60473dd846f0d2b1d",id:"warning-indicator",icon:this.iconPack.warning,part:"warning-indicator"})," ",this.t("chat.rate_limit_error")),z("textarea",{key:"386477d46285c144ec055cf48bf59b5dbff3989c",ref:e=>this.$textArea=e,placeholder:this.placeholder,disabled:this.disabled,onInput:this.onInputHandler,onKeyDown:this.keyDownHandler,part:"chat-input",value:this.value}))}};_l([si()],Al.prototype,"iconPack",void 0),_l([si()],Al.prototype,"t",void 0),Al.style=".chat-input {\n  position: relative;\n  z-index: 10;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: column;\n  border-top-left-radius: var(--dyte-border-radius-md, 8px);\n  border-top-right-radius: var(--dyte-border-radius-md, 8px)\n}\n\n  .chat-input textarea {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));\n  box-sizing: border-box;\n  padding: var(--dyte-space-3, 12px);\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255))\n}\n\n  .chat-input textarea::-moz-placeholder {\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255))\n}\n\n  .chat-input textarea::placeholder {\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255))\n}\n\n  .chat-input textarea {\n  font-family: var(--dyte-font-family, sans-serif);\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n  resize: none;\n  overflow-y: auto;\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  min-height: 60px;\n  font-size: 14px\n}\n\n@container chatcontainer (height < 360px) {\n  textarea {\n    height: 30px !important;\n    min-height: 30px !important\n  }\n}\n\n.text-error {\n  left: var(--dyte-space-0, 0px);\n  z-index: 10;\n  margin-top: var(--dyte-space-1, 4px);\n  margin-left: var(--dyte-space-1, 4px);\n  display: flex;\n  width: -moz-fit-content;\n  width: fit-content;\n  align-items: center;\n  justify-content: flex-start;\n  border-radius: var(--dyte-border-radius-sm, 4px);\n  --tw-border-opacity: 1;\n  border-color: rgba(var(--dyte-colors-warning, 255 205 7) / var(--tw-border-opacity));\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));\n  padding-left: var(--dyte-space-2, 8px);\n  padding-right: var(--dyte-space-2, 8px);\n  font-size: 12px;\n  font-weight: 600;\n  --tw-text-opacity: 1;\n  color: rgba(var(--dyte-colors-warning, 255 205 7) / var(--tw-text-opacity));\n  border: 1px solid\n}\n\n#warning-indicator {\n  margin-right: var(--dyte-space-1, 4px);\n  height: var(--dyte-space-3, 12px);\n  width: var(--dyte-space-3, 12px)\n}\n\n.text-error.breached {\n  --tw-border-opacity: 1;\n  border-color: rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-border-opacity));\n  --tw-text-opacity: 1;\n  color: rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))\n}";var Rl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Il=class{constructor(e){o(this,e),this.now=new Date,this.isContinued=!1,this.iconPack=Vt,this.t=Ht(),this.showBubble=!1}render(){return z(G,{key:"e082f0075f22f97890614d9b15899a0ed09ade61"},!this.isContinued&&z(as,{key:"4b825acf9ef68956ff3ce22227de8b411adb34a1",name:this.message.displayName,time:this.message.time,now:this.now}),z("div",{key:"fdeaa70cd0f2b5bc0576e81269af073724081c5f",class:{body:!0,bubble:this.showBubble},part:"body"},z("div",{key:"6ecfefe0b50f26759757e88024e050551d32f370",class:{text:!0,emoji:ri(this.message.message)}},z(eo,{key:"8272d97cf01cd17426607194a9c39c6152db6e2c",message:this.message.message}))))}};Rl([si()],Il.prototype,"iconPack",void 0),Rl([si()],Il.prototype,"t",void 0);const Dl=class{constructor(e){o(this,e),this.isMarkdown=!1}render(){return z("p",{key:"0bfd2379f422f2ec89f13714fd40ca29b73bed0d",class:{text:!0,emoji:ri(this.text)}},this.isMarkdown?z("dyte-markdown-view",{text:this.text}):this.text)}};Dl.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.text{word-break:break-word;display:block;overflow-wrap:break-word;line-height:1.375}.text.emoji{font-size:24px}";const Ml=class{constructor(e){o(this,e),this.dyteOpenChange=W(this,"dyteOpenChange",7),this.label="",this.variant="secondary",this.disabled=!1,this.open=!1,this.kind="inline",this.placement="top",this.delay=0,this.isInFocus=!1,this.showMenu=()=>{this.disabled||(this.isInFocus=!0,setTimeout(()=>{this.isInFocus&&(this.tooltipEl.style.display="block",this.update(),this.dyteOpenChange.emit(!0),"sm"===this.size&&setTimeout(()=>{this.isInFocus&&this.hideMenu()},1e3))},this.delay))},this.hideMenu=()=>{this.open||this.disabled||(this.isInFocus=!1,this.tooltipEl.style.display="none",this.dyteOpenChange.emit(!1))}}componentDidLoad(){this.triggerEl.addEventListener("focusin",this.showMenu),this.triggerEl.addEventListener("mouseenter",this.showMenu),this.triggerEl.addEventListener("focusout",this.hideMenu),this.triggerEl.addEventListener("mouseleave",this.hideMenu),P(()=>{this.openChanged(this.open)})}disconnectedCallback(){this.triggerEl&&(this.triggerEl.removeEventListener("focusin",this.showMenu),this.triggerEl.removeEventListener("mouseenter",this.showMenu),this.triggerEl.removeEventListener("focusout",this.hideMenu),this.triggerEl.removeEventListener("mouseleave",this.hideMenu),this.triggerEl=void 0)}openChanged(e){e?this.showMenu():this.hideMenu()}update(){Xn(this.triggerEl,this.tooltipEl,{placement:this.placement,middleware:[qn(8),Wn(),Yn({padding:5}),Qn({element:this.arrowEl})]}).then(({x:e,y:t,placement:i,middlewareData:s})=>{Object.assign(this.tooltipEl.style,{left:`${e}px`,top:`${t}px`});const{x:a,y:r}=s.arrow,n={top:"bottom",right:"left",bottom:"top",left:"right"}[i.split("-")[0]];Object.assign(this.arrowEl.style,{left:null!=a?`${a}px`:"",top:null!=r?`${r}px`:"",right:"",bottom:"",[n]:"-4px"})})}render(){return z(G,{key:"408cc292b9ee81259eb1bb4b9df70eb2adf469a7"},z("span",{key:"4fb7a6d6ebe5a15dfe2e016c6a8e83f6c1571463",part:"trigger",id:"trigger",ref:e=>this.triggerEl=e},z("slot",{key:"7cec3218611b38d3de272f80b21aaf2406d6ea46"})),z("div",{key:"0bcf3a675eb667b2604d9f69fc8cf5c125ef0c5c",part:"tooltip",class:"tooltip",id:"tooltip",role:"tooltip",ref:e=>this.tooltipEl=e},z("div",{key:"51965a748edbb9ec286fc3f89a34e93e30ec958e",id:"arrow",ref:e=>this.arrowEl=e,part:"arrow"}),this.label,z("slot",{key:"6149d55b7fa3b346161d02d793717f5f839fafff",name:"tooltip"})))}static get watchers(){return{open:["openChanged"]}}};!function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);r>3&&n&&Object.defineProperty(t,i,n)}([si()],Ml.prototype,"size",void 0),Ml.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{--background-color:var(--dyte-tooltip-background-color, rgb(var(--dyte-colors-background-600, 60 60 60)));--color:var(--dyte-tooltip-color, rgb(var(--dyte-colors-text-1000, 255 255 255)));display:inline-flex}#trigger{display:block;width:100%;flex:1 1 0%}.tooltip{max-width:var(--dyte-space-64, 256px);position:fixed;z-index:20;display:none;width:-moz-max-content;width:max-content;padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);font-size:12px}.tooltip,#arrow{position:absolute;background-color:var(--background-color);color:var(--color)}#arrow{position:absolute;height:var(--dyte-space-2, 8px);width:var(--dyte-space-2, 8px);transform:rotate(45deg)}:host([variant='primary']){--background-color:rgb(var(--dyte-colors-brand-500, 33 96 253));--color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}:host([kind='block']){display:block}";var Ol=Object.freeze({__proto__:null,dyte_audio_visualizer:no,dyte_avatar:lo,dyte_breakout_room_manager:ho,dyte_breakout_room_participants:uo,dyte_breakout_rooms_manager:fo,dyte_broadcast_message_modal:vo,dyte_button:yo,dyte_camera_selector:wo,dyte_channel_creator:ko,dyte_channel_details:Eo,dyte_channel_header:To,dyte_channel_selector_view:Co,dyte_chat:Ao,dyte_chat_composer_view:Do,dyte_chat_message:Oo,dyte_chat_messages_ui:$o,dyte_chat_messages_ui_paginated:No,dyte_chat_search_results:zo,dyte_confirmation_modal:Go,dyte_counter:Vo,dyte_debugger:Ko,dyte_debugger_audio:td,dyte_debugger_screenshare:sd,dyte_debugger_system:rd,dyte_debugger_video:od,dyte_dialog:ld,dyte_dialog_manager:hd,dyte_draft_attachment_view:ud,dyte_emoji_picker:md,dyte_emoji_picker_button:yd,dyte_file_message:Sd,dyte_file_message_view:Ed,dyte_file_picker_button:Td,dyte_icon:Cd,dyte_image_message:Ad,dyte_image_message_view:Id,dyte_image_viewer:Md,dyte_join_stage:Ud,dyte_leave_meeting:Fd,dyte_logo:jd,dyte_markdown_view:zd,dyte_meeting:Gd,dyte_menu:Vd,dyte_menu_item:Kd,dyte_menu_list:Wd,dyte_message_view:Zd,dyte_microphone_selector:Xd,dyte_mute_all_confirmation:el,dyte_notification:il,dyte_notifications:ol,dyte_overlay_modal:ll,dyte_paginated_list:hl,dyte_participant_tile:ul,dyte_permissions_message:ml,dyte_settings:yl,dyte_settings_audio:wl,dyte_settings_video:kl,dyte_speaker_selector:El,dyte_spinner:Tl,dyte_switch:Cl,dyte_text_composer_view:Al,dyte_text_message:Il,dyte_text_message_view:Dl,dyte_tooltip:Ml});var Ul=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const $l=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.view="sidebar",this.close=()=>{this.stateUpdate.emit({activeAI:!1})}}connectedCallback(){this.viewChanged(this.view)}disconnectedCallback(){this.keydownListener&&document.removeEventListener("keydown",this.keydownListener)}viewChanged(e){"full-screen"===e&&(this.keydownListener=e=>{"Escape"===e.key&&this.close()},document.addEventListener("keydown",this.keydownListener))}render(){var e,t,i;if(!(null===(t=null===(e=this.meeting)||void 0===e?void 0:e.self)||void 0===t?void 0:t.permissions).transcriptionEnabled||!(null===(i=this.states)||void 0===i?void 0:i.activeAI))return null;const s={meeting:this.meeting,config:this.config,states:this.states,size:this.size,t:this.t,iconPack:this.iconPack};return z(G,null,z("h3",{class:"title"},this.t("ai.transcriptions")),z("dyte-button",{variant:"ghost",kind:"icon",class:"close",onClick:this.close,"aria-label":this.t("close")},z("dyte-icon",{icon:this.iconPack.dismiss})),z("dyte-ai-transcriptions",Object.assign({},s)))}static get watchers(){return{view:["viewChanged"]}}};Ul([si()],$l.prototype,"meeting",void 0),Ul([si()],$l.prototype,"states",void 0),Ul([si()],$l.prototype,"iconPack",void 0),Ul([si()],$l.prototype,"t",void 0),Ul([si()],$l.prototype,"size",void 0),$l.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;box-sizing:border-box;display:flex;width:100%;max-width:var(--dyte-space-80, 320px);flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));overflow:hidden}.close{position:absolute;top:var(--dyte-space-3, 12px);left:var(--dyte-space-3, 12px)}.title{margin-left:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-0, 0px);margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-2, 8px);-webkit-user-select:none;-moz-user-select:none;user-select:none;padding:var(--dyte-space-0, 0px);text-align:center;font-size:14px;font-weight:400}dyte-ai-transcriptions{flex:1}:host([view='sidebar']){margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-lg, 12px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}:host([view='full-screen']){position:absolute;top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);z-index:50;max-width:100%;border:none}";var Fl=Object.freeze({__proto__:null,dyte_ai:$l});var Nl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const jl=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.iconPack=Vt,this.t=Ht(),this.aiActive=!1}statesChanged(e){const t=e;this.aiActive=t.activeAI}toggleAI(){var e;this.aiActive=!(null===(e=this.states)||void 0===e?void 0:e.activeAI),this.stateUpdate.emit({activeAI:this.aiActive,activeMoreMenu:!1,activeSidebar:!1})}render(){var e,t;const i=this.t("ai.meeting_ai");return(null===(t=null===(e=this.meeting)||void 0===e?void 0:e.self)||void 0===t?void 0:t.permissions).transcriptionEnabled?z(G,{title:i},z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,class:{active:this.aiActive},onClick:()=>this.toggleAI(),icon:this.iconPack.meeting_ai,label:i,variant:this.variant,brandIcon:!0})):z(G,{"data-hidden":!0})}static get watchers(){return{states:["statesChanged"]}}};Nl([si()],jl.prototype,"states",void 0),Nl([si()],jl.prototype,"meeting",void 0),Nl([si()],jl.prototype,"size",void 0),Nl([si()],jl.prototype,"iconPack",void 0),Nl([si()],jl.prototype,"t",void 0),jl.style=":host{display:block}:host([data-hidden]){display:none}";var zl=Object.freeze({__proto__:null,dyte_ai_toggle:jl});var Bl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Gl=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht(),this.hideSelf=!1,this.activeParticipants=[],this.onStageParticipants=[],this.offStageParticipants=[],this.onParticipantListUpdate=()=>{if(!this.meeting)return;let e=this.meeting.participants.active.toArray();this.hideSelf||(e=[...e,this.meeting.self]);let t=this.meeting.participants.joined.toArray().filter(t=>!e.some(e=>e.id===t.id));this.activeParticipants=e,this.onStageParticipants=t}}connectedCallback(){this.meetingChanged(this.meeting)}meetingChanged(e){e&&"AUDIO_ROOM"===e.self.config.viewType&&(this.onParticipantListUpdate(),e.participants.active.addListener("participantJoined",this.onParticipantListUpdate),e.participants.active.addListener("participantLeft",this.onParticipantListUpdate),e.participants.joined.addListener("participantJoined",this.onParticipantListUpdate),e.participants.joined.addListener("participantLeft",this.onParticipantListUpdate))}disconnectedCallback(){this.resizeObserver.disconnect(),this.resizeObserver=void 0,this.meeting.participants.active.removeListener("participantJoined",this.onParticipantListUpdate),this.meeting.participants.active.removeListener("participantLeft",this.onParticipantListUpdate),this.meeting.participants.joined.removeListener("participantJoined",this.onParticipantListUpdate),this.meeting.participants.joined.removeListener("participantLeft",this.onParticipantListUpdate)}renderGrid(e=[]){const t={meeting:this.meeting,size:this.size,config:this.config,t:this.t,iconPack:this.iconPack,states:this.states};return e.map(e=>z(ls,{element:"dyte-audio-tile",defaults:t,props:{key:e.id,participant:e},childProps:{participant:e},deepProps:!0}))}render(){const e=this.activeParticipants.concat(this.onStageParticipants);return z(G,{key:"e6ed7876a5948aac4b9596698f2e3047eefc05b5"},z("div",{key:"94bb5d98a30cb29a6d949a6ad86cedff15590dc2",class:"content scrollbar"},z("div",{key:"c5521d2415aeb886b178d3792bf50d2942e8293a",class:"stage grid"},this.renderGrid(e)),this.offStageParticipants.length>0&&z("div",{key:"99a43051949d1496fdad0f73b26e6b6caaf14701",class:"waitlist-area"},z("div",{key:"fecc92badc9ce6517a47e98ae3ab28b486a3698a",class:"listening-title"},this.offStageParticipants.length," ",this.t("grid.listening")),z("div",{key:"eadea3da9dbc7fd01a9333def00649a1ababaf6c",class:"waitlist-grid grid"},this.renderGrid(this.offStageParticipants)))),z("slot",{key:"6e05c350e0ad677d3f2f00436ce5c985bf00e498"}))}get host(){return Y(this)}static get watchers(){return{meeting:["meetingChanged"]}}};Bl([si()],Gl.prototype,"meeting",void 0),Bl([si()],Gl.prototype,"states",void 0),Bl([si()],Gl.prototype,"iconPack",void 0),Bl([si()],Gl.prototype,"size",void 0),Bl([si()],Gl.prototype,"t",void 0),Gl.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{position:relative;height:100%;width:100%;box-sizing:border-box}.content{position:relative;display:flex;height:100%;width:100%;flex-direction:column;overflow-y:auto}.waitlist-area{display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}.listening-title{text-align:center;margin-top:var(--dyte-space-5, 20px);margin-bottom:var(--dyte-space-4, 16px)}.waitlist-grid{flex:1 1 0%}.grid{box-sizing:border-box;flex:1 1 0%;gap:var(--dyte-space-6, 24px);display:flex;align-content:center;justify-content:center;flex-wrap:wrap}:host([size='md']) .grid{gap:var(--dyte-space-4, 16px)}:host([size='sm']) .grid{gap:var(--dyte-space-3, 12px)}dyte-audio-tile{aspect-ratio:1 / 1;flex:none;width:calc(20%);max-width:var(--dyte-space-48, 192px);transition:all 0.3s}dyte-audio-tile[size='md']{width:100%;max-width:var(--dyte-space-36, 144px)}dyte-audio-tile[size='sm']{width:100%;max-width:var(--dyte-space-24, 96px)}";var Hl=Object.freeze({__proto__:null,dyte_audio_grid:Gl});var Vl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const ql=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht(),this.audioEnabled=!1,this.volume=0,this.onAudioUpdate=({audioEnabled:e,audioTrack:t})=>{if(this.participant)if(e&&t){const e=new MediaStream;e.addTrack(t),this.calcVolume(e),this.audioEnabled=!0}else this.volume=0,this.audioEnabled=!1}}connectedCallback(){this.participantChanged(this.participant)}disconnectedCallback(){var e,t;null===(e=this.hark)||void 0===e||e.stop(),null===(t=this.participant)||void 0===t||t.removeListener("audioUpdate",this.onAudioUpdate)}participantChanged(e){e&&(this.audioEnabled=e.audioEnabled,e.addListener("audioUpdate",this.onAudioUpdate))}calcVolume(e){this.hark=et(e,{play:!1,interval:100}),this.hark.on("volume_change",e=>{const t=this.volume;let i=Math.round(10**(e/115)*10);i<3&&(i=0);let s=Math.round((2*t+i)/3);t!==s&&(this.volume=s)})}render(){const e={meeting:this.meeting,size:this.size,config:this.config,states:this.states,iconPack:this.iconPack,t:this.t};let t="bar-0";return t=this.volume>5?"bar-5":this.volume<0?"bar-0":"bar-"+this.volume,z(G,{key:"857dc5cefa005a9f429a32b01ef482ad8b2b667f"},z("div",{key:"ea0841398dee55b4cae6fb8a740e0057d1f25071",class:{"avatar-ctr":!0,speaking:this.audioEnabled,[t]:!0}},z("dyte-avatar",{key:"84197cb9acc92408a7033c3d0e6e5459a8351e9d",participant:this.participant,size:this.size},!this.audioEnabled&&z("div",{key:"9a284bd8863f638321aae3e84a1ac39a73ee9840",class:"mic-icon"},z("dyte-icon",{key:"5ea4329213d65c112acf9e323c1c29f61f6f3117",icon:Vt.mic_off})))),z("dyte-name-tag",Object.assign({key:"d799227e0ad142d6832bd7796ce1f39a4040e19e",variant:"text",participant:this.participant},e)),z("slot",{key:"b2b8b06518be41c39ee1d9574192d57993a31bae"}))}static get watchers(){return{participant:["participantChanged"]}}};Vl([si()],ql.prototype,"meeting",void 0),Vl([si()],ql.prototype,"size",void 0),Vl([si()],ql.prototype,"states",void 0),Vl([si()],ql.prototype,"iconPack",void 0),Vl([si()],ql.prototype,"t",void 0),ql.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{box-sizing:border-box;display:flex;flex-direction:column}.avatar-ctr{box-sizing:border-box;width:100%;flex:1 1 0%;padding:var(--dyte-space-1\\.5, 6px);border:2px solid transparent;border-radius:calc(var(--dyte-border-radius-xl, 40px) + var(--dyte-space-1\\.5, 6px))}.avatar-ctr.speaking{--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-border-opacity));transition-property:box-shadow;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.bar-0{box-shadow:none}.bar-1{box-shadow:0 0 4px rgb(var(--dyte-colors-brand-500, 33 96 253))}.bar-2{box-shadow:0 0 8px rgb(var(--dyte-colors-brand-500, 33 96 253))}.bar-3{box-shadow:0 0 16px 1px rgb(var(--dyte-colors-brand-500, 33 96 253))}.bar-4{box-shadow:0 0 20px 3px rgb(var(--dyte-colors-brand-500, 33 96 253))}.bar-5{box-shadow:0 0 24px 6px rgb(var(--dyte-colors-brand-500, 33 96 253))}dyte-avatar{aspect-ratio:1 / 1;height:100%;width:100%;position:relative;border-radius:var(--dyte-border-radius-xl, 40px)}dyte-name-tag{display:block;height:var(--dyte-space-10, 40px);width:100%;text-align:center;line-height:2.5rem}:host([size='sm']) .avatar-ctr{border-radius:calc(var(--dyte-border-radius-lg, 12px) + var(--dyte-space-1\\.5, 6px))}:host([size='sm']) dyte-name-tag{height:var(--dyte-space-7, 28px);line-height:1.75rem}:host([size='sm']) dyte-avatar{border-radius:var(--dyte-border-radius-lg, 12px)}.mic-icon{position:absolute;bottom:calc(var(--dyte-space-1, 4px) * -1);right:calc(var(--dyte-space-1, 4px) * -1);border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));padding:var(--dyte-space-2, 8px);color:rgb(var(--dyte-colors-text-1000, 255 255 255));--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.mic-icon dyte-icon{height:var(--dyte-space-7, 28px);width:var(--dyte-space-7, 28px)}:host([size='sm']) .mic-icon dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}:host([size='md']) .mic-icon dyte-icon{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}";var Kl=Object.freeze({__proto__:null,dyte_audio_tile:ql});var Yl=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Wl=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.iconPack=Vt,this.t=Ht(),this.canToggle=!1,this.permissionsUpdateListener=()=>{this.canToggle=bt(this.meeting)},this.breakoutRoomToggle=()=>{var e,t;const i=this.meeting.connectedMeetings.isActive?"view":"create";this.stateUpdate.emit({activeBreakoutRoomsManager:{active:!(null===(t=null===(e=this.states)||void 0===e?void 0:e.activeBreakoutRoomsManager)||void 0===t?void 0:t.active),mode:i}})}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e,t,i;null===(i=null===(t=null===(e=this.meeting)||void 0===e?void 0:e.self)||void 0===t?void 0:t.permissions)||void 0===i||i.off("permissionsUpdate",this.permissionsUpdateListener)}meetingChanged(e){e&&(this.canToggle=bt(e),e.self.permissions.on("permissionsUpdate",this.permissionsUpdateListener))}render(){if(this.canToggle)return z(G,{title:this.t("breakout_rooms")},z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,onClick:this.breakoutRoomToggle,icon:this.iconPack.breakout_rooms,label:this.t("breakout_rooms"),variant:this.variant}))}static get watchers(){return{meeting:["meetingChanged"]}}};Yl([si()],Wl.prototype,"meeting",void 0),Yl([si()],Wl.prototype,"states",void 0),Yl([si()],Wl.prototype,"size",void 0),Yl([si()],Wl.prototype,"iconPack",void 0),Yl([si()],Wl.prototype,"t",void 0),Wl.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";var Zl=Object.freeze({__proto__:null,dyte_breakout_rooms_toggle:Wl});var Ql=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Xl=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.videoUpdateListener=({videoEnabled:e})=>{this.videoEnabled=e},this.stageStatusListener=()=>{this.stageStatus=this.meeting.stage.status,this.canProduceVideo="ALLOWED"===this.meeting.self.permissions.canProduceVideo},this.mediaPermissionUpdateListener=({kind:e,message:t})=>{"video"===e&&(this.cameraPermission=t)},this.meetingPermissionsUpdateListener=e=>{var t;(null===(t=null==e?void 0:e.media)||void 0===t?void 0:t.video)&&(this.canProduceVideo="ALLOWED"===this.meeting.self.permissions.canProduceVideo)},this.variant="button",this.iconPack=Vt,this.t=Ht(),this.videoEnabled=!1,this.canProduceVideo=!1,this.cameraPermission="NOT_REQUESTED",this.stageStatus="OFF_STAGE",this.toggleCamera=()=>{var e,t,i,s,a,r,n,o,d,l,c;if(null===(e=this.meeting)||void 0===e||e.__internals__.logger.info("dyteCameraToggle::toggleCamera",{media:{video:{enabled:Boolean(null===(i=null===(t=this.meeting)||void 0===t?void 0:t.self)||void 0===i?void 0:i.videoEnabled),permission:this.cameraPermission,canProduce:null===(r=null===(a=null===(s=this.meeting)||void 0===s?void 0:s.self)||void 0===a?void 0:a.permissions)||void 0===r?void 0:r.canProduceVideo}},webinar:{stageStatus:null===(n=this.meeting)||void 0===n?void 0:n.stage.status},livestream:{stageStatus:null===(d=null===(o=this.meeting)||void 0===o?void 0:o.stage)||void 0===d?void 0:d.status},moduleExists:{self:Boolean(null===(l=this.meeting)||void 0===l?void 0:l.self)}}),this.hasPermissionError()){const e={enabled:!0,kind:"video"};return this.stateUpdate.emit({activePermissionsMessage:e}),!1}const h=null===(c=this.meeting)||void 0===c?void 0:c.self;null!=h&&this.canProduceVideo&&(h.videoEnabled?h.disableVideo():h.enableVideo())}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e,t,i,s,a,r,n;null===(e=this.meeting)||void 0===e||e.self.removeListener("videoUpdate",this.videoUpdateListener),null===(t=this.meeting)||void 0===t||t.self.removeListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),null===(s=null===(i=this.meeting)||void 0===i?void 0:i.stage)||void 0===s||s.removeListener("stageStatusUpdate",this.stageStatusListener),null===(n=null===(r=null===(a=this.meeting)||void 0===a?void 0:a.self)||void 0===r?void 0:r.permissions)||void 0===n||n.removeListener("permissionsUpdate",this.meetingPermissionsUpdateListener)}meetingChanged(e){var t,i;if(null!=e){const{self:s,stage:a}=e;this.canProduceVideo="ALLOWED"===this.meeting.self.permissions.canProduceVideo,this.cameraPermission=s.mediaPermissions.video||"NOT_REQUESTED",this.videoEnabled=s.videoEnabled,this.stageStatus=e.stage.status,s.addListener("videoUpdate",this.videoUpdateListener),s.addListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),null==a||a.addListener("stageStatusUpdate",this.stageStatusListener),null===(i=null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions)||void 0===i||i.addListener("permissionsUpdate",this.meetingPermissionsUpdateListener)}}hasPermissionError(){return"DENIED"===this.cameraPermission||"SYSTEM_DENIED"===this.cameraPermission}getState(){let e="",t="",i="",s={},a=this.hasPermissionError(),r="COULD_NOT_START"===this.cameraPermission;return this.videoEnabled&&!a?(t=this.t("video_on"),i=this.iconPack.video_on):(t=this.t("video_off"),i=this.iconPack.video_off,s["red-icon"]=!0),e=r?this.t("perm_could_not_start.video"):"SYSTEM_DENIED"===this.cameraPermission?this.t("perm_sys_denied.video"):"DENIED"===this.cameraPermission?this.t("perm_denied.video"):this.videoEnabled?this.t("disable_video"):this.t("enable_video"),{tooltipLabel:e,label:t,icon:i,classList:s,showWarning:a||r,disable:a}}render(){var e;if(!this.canProduceVideo||"AUDIO_ROOM"===(null===(e=this.meeting)||void 0===e?void 0:e.meta.viewType)||["OFF_STAGE","REQUESTED_TO_JOIN_STAGE"].includes(this.stageStatus))return z(G,{"data-hidden":!0});const{tooltipLabel:t,label:i,icon:s,classList:a,showWarning:r,disable:n}=this.getState();return z(G,{title:i},z("dyte-tooltip",{kind:"block",label:t,part:"tooltip"},z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,class:a,variant:this.variant,label:i,icon:s,onClick:this.toggleCamera,showWarning:r,disabled:n})))}static get watchers(){return{meeting:["meetingChanged"]}}};Ql([si()],Xl.prototype,"meeting",void 0),Ql([si()],Xl.prototype,"size",void 0),Ql([si()],Xl.prototype,"iconPack",void 0),Ql([si()],Xl.prototype,"t",void 0),Xl.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}:host([data-hidden]){display:none}";var Jl=Object.freeze({__proto__:null,dyte_camera_toggle:Xl});var ec=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const tc=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.captionEnabled=!1,this.permissionsUpdateListener=()=>{var e;this.captionEnabled=null!==(e=this.meeting.self.permissions.transcriptionEnabled)&&void 0!==e&&e}}connectedCallback(){this.meetingChanged(this.meeting)}meetingChanged(e){null!==e&&(this.permissionsUpdateListener(),this.meeting.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener))}disconnectedCallback(){var e;null===(e=this.meeting)||void 0===e||e.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener)}toggleCaptions(){this.stateUpdate.emit({activeCaptions:!this.states.activeCaptions,activeMoreMenu:!1})}render(){if(!this.captionEnabled)return null;const e=this.states.activeCaptions;return z(G,{tabIndex:0,role:"log","aria-label":"Picture-in-Picture mode"},z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,onClick:()=>this.toggleCaptions(),icon:e?this.iconPack.captionsOff:this.iconPack.captionsOn,label:e?this.t("transcript.off"):this.t("transcript.on"),variant:this.variant}))}static get watchers(){return{meeting:["meetingChanged"]}}};ec([si()],tc.prototype,"meeting",void 0),ec([si()],tc.prototype,"states",void 0),ec([si()],tc.prototype,"iconPack",void 0),ec([si()],tc.prototype,"size",void 0),ec([si()],tc.prototype,"t",void 0),tc.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";var ic=Object.freeze({__proto__:null,dyte_caption_toggle:tc});var sc=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const ac=class{constructor(e){o(this,e),this.channelChanged=W(this,"channelChanged",7),this.iconPack=Vt,this.t=Ht(),this.showRecentMessage=!1,this.isHidden=!1,this.searchQuery="",this.handleResize=e=>{this.isHidden=!e.matches},this.channelSelected=e=>{this.channelChanged.emit(e),this.onRevealClicked()},this.onSearchInput=e=>{this.searchQuery=e.target.value},this.onRevealClicked=()=>{this.matchMedia.matches||(this.isHidden=!this.isHidden)},this.renderChannelDisplayPic=e=>{const t=e.displayPictureUrl&&0!==e.displayPictureUrl.length;return e.isDirectMessage||t?z("div",{class:"channel-display"},z("dyte-avatar",{participant:{name:e.displayName,picture:e.displayPictureUrl}})):z("div",{class:"channel-display"},z("dyte-icon",{icon:this.iconPack.people,slot:"start"}))},this.renderRecentMessage=e=>{if(!e.latestMessage)return z("p",{class:"latest-msg new"},this.t("chat.start_conversation"));let t=e.isDirectMessage?"":`${e.latestMessage.displayName}: `;if("text"===e.latestMessage.type)return z("p",{class:"latest-msg"},t,z(eo,{message:e.latestMessage.message}));let i="";return"image"===e.latestMessage.type?i=this.t("image"):"file"===e.latestMessage.type&&(i=this.t("file")),z("p",{class:"latest-msg"},`${t}${i}`)}}connectedCallback(){this.matchMedia=window.matchMedia("(orientation: landscape) and (min-width: 400px)"),this.matchMedia.addEventListener("change",this.handleResize),this.isHidden=!this.matchMedia.matches}disconnectedCallback(){this.matchMedia.removeEventListener("change",this.handleResize)}componentDidRender(){this.$el.style.transform=this.isHidden?"translateX(-380px)":"translateX(0)"}getTimeLabel(e){const t=e.time,i=new Date,s=new Date(i);s.setDate(i.getDate()-1);const a=new Date(i);if(a.setDate(i.getDate()-i.getDay()-1),t.toDateString()===i.toDateString())return t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(t.toDateString()===s.toDateString())return this.t("date.yesteday");if(t>a){const e=["date.sunday","date.monday","date.tuesday","date.wednesday","date.thursday","date.friday","date.saturday"];return this.t(e[t.getDay()])}return Intl.DateTimeFormat([],{day:"2-digit",month:"2-digit",year:"2-digit"}).format(t)}render(){return z(G,{key:"27beb64372e71cdbb45b0bc42e834a063e266cab"},z("div",{key:"f3cb26446d420df375d787366b02d1013ecad4f0",class:"container",ref:e=>this.$el=e},this.isHidden&&z("dyte-button",{key:"be5dbd465d468c14be597c0ceda26f0cf9075fe5",kind:"icon",variant:"ghost",size:"md",onClick:this.onRevealClicked,class:"sidebar-btn"},z("dyte-icon",{key:"9e3d65b701a7741226c8f9acbda523c584f7c7b7",icon:this.isHidden?this.iconPack.chevron_left:this.iconPack.dismiss})),z("slot",{key:"8d358b9e23259c5ebf45898c0938d5cbfbcd7b56",name:"header"}),z("div",{key:"35f4e5036e536020337db098c7769d414215bf96",class:"search-wrapper"},z("div",{key:"d5663429fbf31cf231204c5cde31e1f9a0e9afe0",class:"search"},z("input",{key:"9c156d36dc6501de62f7ba622a20b7ce407a2ede",type:"search",autocomplete:"off",placeholder:this.t("chat.search_conversations"),onInput:this.onSearchInput}),z("dyte-icon",{key:"498ecabfbce5b0725618e1112dc1dcb7eca2dd58",icon:this.iconPack.search,class:"search-icon"}))),z("div",{key:"c33ba36c7e50fda20ef39ee12725e4d64f8cb520",class:"channel-container scrollbar",role:"list"},this.channels.filter(e=>""===this.searchQuery||e.displayName.includes(this.searchQuery)).map(e=>z("div",{class:{channel:!0,selected:e.id===this.selectedChannelId,highlight:!!e.unreadCount},role:"listitem",onClick:()=>{this.channelSelected(e.id)}},this.renderChannelDisplayPic(e),z("div",{class:"channel-card","is-direct-message":e.isDirectMessage},z("div",{class:"recent-message-row"},z("span",{class:"channel-name"},e.displayName),e.latestMessage&&z("span",{class:"latest-msg-time"},this.getTimeLabel(e.latestMessage))),z("div",{class:"recent-message-row"},this.renderRecentMessage(e),e.unreadCount>0&&e.id!==this.selectedChannelId?z("span",{class:"new-msgs-count"},e.unreadCount<99?e.unreadCount:"99+"):null)))))),!this.isHidden&&z("div",{key:"cc51252e87759bb0fa10de6bae2b3b9af783693f",class:"overlay-container"},z("dyte-button",{key:"5d66dc9ddbfa169f2c3c077d919d0fcaf4c6eeca",kind:"icon",variant:"ghost",size:"md",onClick:this.onRevealClicked,class:"sidebar-btn"},z("dyte-icon",{key:"d81b19a9e5af1a62df723cd32d27779c59dd3ded",icon:this.isHidden?this.iconPack.chevron_left:this.iconPack.dismiss}))))}};sc([si()],ac.prototype,"iconPack",void 0),sc([si()],ac.prototype,"t",void 0),ac.style=".scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{display:flex}.container{display:flex;height:100%;width:var(--dyte-space-96, 384px);flex-direction:column;position:absolute;--tw-translate-x:calc(var(--dyte-space-96, 384px) * -1);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));border-top-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-sm, 1px);border-left-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-right-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-border-opacity));transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}@keyframes fade{0%{opacity:0}100%{opacity:1}}.overlay-container{width:100vw;--tw-translate-x:var(--dyte-space-96, 384px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms;animation:fade 0.8s}.overlay-container .sidebar-btn{position:static;padding:var(--dyte-space-4, 16px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}.sidebar-btn{position:absolute;right:calc(var(--dyte-space-9, 36px) * -1);top:var(--dyte-space-4, 16px);height:var(--dyte-space-8, 32px);width:var(--dyte-space-7, 28px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));border-radius:var(--dyte-border-radius-sm, 4px)}@media (orientation: landscape) and (min-width: 400px){.container{position:static;--tw-translate-x:var(--dyte-space-0, 0px);transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.sidebar-btn,.overlay-container{display:none}}.search-wrapper{display:flex;align-items:center;gap:var(--dyte-space-2, 8px);padding:var(--dyte-space-2, 8px);border-left-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-sm, 1px);border-top-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-bottom-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-border-opacity))}.search{position:sticky;box-sizing:border-box;display:flex;align-items:center;border-radius:var(--dyte-border-radius-sm, 4px);margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0, 0px);height:var(--dyte-space-8, 32px);width:100%}.search .search-icon{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);padding:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52));border-top-right-radius:var(--dyte-border-radius-sm, 4px);border-bottom-right-radius:var(--dyte-border-radius-sm, 4px)}.search input{box-sizing:border-box;width:100%;padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);padding-left:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));border-width:var(--dyte-border-width-none, 0);border-style:none;outline:2px solid transparent;outline-offset:2px;font-size:14px;line-height:1.25rem}.search input::-moz-placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.search input::placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.search input{border-top-left-radius:var(--dyte-border-radius-sm, 4px);border-bottom-left-radius:var(--dyte-border-radius-sm, 4px)}.channel-container{box-sizing:border-box;display:flex;flex-direction:column;padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);overflow-y:scroll}.channel-container .channel{display:flex;align-items:center;justify-content:space-between;gap:var(--dyte-space-2, 8px);padding:var(--dyte-space-0, 0px);border-left-width:var(--dyte-border-width-none, 0);border-right-width:var(--dyte-border-width-none, 0);border-bottom-width:var(--dyte-border-width-sm, 1px);border-top-width:var(--dyte-border-width-none, 0);border-style:solid;--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-border-opacity))}.channel-container .channel:hover{cursor:pointer;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-900, var(--dyte-colors-text-900, 255 255 255 / 0.88)))}.channel-container .channel:hover .latest-msg-time,.channel-container .channel:hover .latest-msg,.channel-container .channel:hover .latest-msg.new{color:rgb(var(--dyte-colors-text-on-brand-700, var(--dyte-colors-text-700, 255 255 255 / 0.64)))}.channel-container .channel-display{display:flex;gap:var(--dyte-space-2, 8px);align-self:center;padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-0, 0px)}.channel-container .channel-display dyte-avatar{height:var(--dyte-space-9, 36px);width:var(--dyte-space-9, 36px);flex-shrink:0;font-size:12px}.channel-container .channel-display dyte-icon{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);flex-shrink:0;padding:var(--dyte-space-2, 8px);border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.channel-container .channel-card{width:100%;padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);padding-left:var(--dyte-space-1, 4px)}.channel-container .channel-card .channel-name{max-width:var(--dyte-space-60, 240px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:14px;font-weight:500}.channel-container .channel-card .latest-msg{margin:var(--dyte-space-0, 0px);max-width:var(--dyte-space-56, 224px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:14px}.channel-container .channel-card .latest-msg.new{font-weight:200;font-style:italic;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.channel-container .channel-card .latest-msg-time{font-size:12px;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.channel-container .channel-meta{width:var(--dyte-space-12, 48px);display:flex;flex-direction:column;align-items:flex-end;justify-content:space-between;gap:var(--dyte-space-1\\.5, 6px);font-size:12px;font-weight:600}.channel-container .new-msgs-count{height:var(--dyte-space-4, 16px);min-width:var(--dyte-space-4, 16px);padding-top:1px;padding-bottom:1px;padding-left:2px;padding-right:2px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));border-radius:var(--dyte-border-radius-sm, 4px);text-align:center;font-size:12px}.channel-container .selected{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-900, var(--dyte-colors-text-900, 255 255 255 / 0.88)))}.channel-container .selected .latest-msg-time,.channel-container .selected .latest-msg,.channel-container .selected .latest-msg.new{color:rgb(var(--dyte-colors-text-on-brand-700, var(--dyte-colors-text-700, 255 255 255 / 0.64)))}.channel-container .highlight .channel-title span{font-weight:700}.latest-msg p{margin:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-1, 4px);display:inline-block}.latest-msg blockquote{display:none}.recent-message-row{margin-bottom:var(--dyte-space-2, 8px);display:flex;width:100%;flex-direction:row;justify-content:space-between}";var rc=Object.freeze({__proto__:null,dyte_channel_selector_ui:ac});var nc=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const oc="@",dc=class{constructor(e){o(this,e),this.onNewMessage=W(this,"dyteNewMessage",7),this.onEditMessage=W(this,"dyteEditMessage",7),this.onEditCancelled=W(this,"dyteEditCancelled",7),this.canSendTextMessage=!1,this.canSendFiles=!1,this.iconPack=Vt,this.t=Ht(),this.disableEmojiPicker=!1,this.prefill={},this.members=[],this.emojiPickerActive=!1,this.mentionQuery="",this.focusedMemberIndex=0,this.filePreview=null,this.fileReader=new FileReader,this.fileToUpload=null,this.handleKeyDown=e=>{if(e.key===oc&&[void 0," "].includes(this.$textArea.value.at(-1))&&(this.mentionQuery=oc),"ArrowDown"===e.key&&(this.focusedMemberIndex=Math.min(this.focusedMemberIndex+1,this.getFilteredMembers().length-1)),"ArrowUp"===e.key&&(this.focusedMemberIndex=Math.max(0,this.focusedMemberIndex-1)),("Escape"===e.key||"Backspace"===e.key&&this.mentionQuery===oc)&&(this.mentionQuery=""),["Enter","Tab"," "].includes(e.key)&&""!==this.mentionQuery){const t=this.getFilteredMembers()[this.focusedMemberIndex];return this.onMemberSelect(t),void e.preventDefault()}if("Enter"===e.key&&e.shiftKey){this.$textArea.clientHeight<200&&(this.$textArea.style.height=this.$textArea.clientHeight+20+"px")}else"Enter"===e.key?(e.preventDefault(),this.prefill.editMessage?this.handleEditMessage():this.handleSendMessage()):"Backspace"===e.key&&(this.$textArea.value.endsWith("\n")?this.$textArea.style.height=this.$textArea.clientHeight-20+"px":""===this.$textArea.value&&(this.$textArea.style.height="auto"))},this.handleKeyUp=e=>{if(""!==this.mentionQuery){const e=Gi(this.$textArea.value.trim()),t=e.substring(0,e.indexOf(oc));this.mentionQuery=`${oc}${Gi(t)}`}},this.onPaste=e=>{const t=e.clipboardData||e.originalEvent.clipboardData;P(()=>{t&&t.items&&t.items.length>0&&(Ni(t.items,this.generateFilePreview),this.$textArea.value="")})},this.generateFilePreview=(e,t)=>{this.fileToUpload={type:e,image:t,file:t},"image"===e?this.fileReader.readAsDataURL(t):"file"===e&&(this.filePreview=t.name)},this.sendFile=()=>{this.canSendFiles&&("image"===this.fileToUpload.type?this.onNewMessage.emit({type:"image",file:this.fileToUpload.image,image:this.fileToUpload.image}):this.onNewMessage.emit({type:"file",file:this.fileToUpload.file}),this.cleanUpFileUpload())},this.handleSendMessage=()=>{if(!this.canSendTextMessage)return;if(null!==this.fileToUpload)return void this.sendFile();const e=this.$textArea.value.trim();e.length>0&&(this.prefill.replyMessage?this.onNewMessage.emit({type:"text",message:e,replyTo:this.prefill.replyMessage}):this.onNewMessage.emit({type:"text",message:e}),this.cleanup())},this.cleanup=()=>{this.mentionQuery="",this.focusedMemberIndex=0,this.$textArea.value="",this.$textArea.style.height="auto",Yt.setItem(this.storageKey,"")},this.handleEditMessage=()=>{var e;let t=this.$textArea.value.trim();if((null===(e=this.prefill.editMessage)||void 0===e?void 0:e.message)&&Yi.test(this.prefill.editMessage.message)){t=`${Wi(this.prefill.editMessage.message)}\n\n${t}`}this.onEditMessage.emit({id:this.prefill.editMessage.id,message:t,channelId:this.prefill.editMessage.channelId}),this.cleanup()},this.handleEditCancel=()=>{this.onEditCancelled.emit(),this.cleanup()},this.initializeTextField=e=>{this.$textArea=e;const t=Yt.getItem(this.storageKey)||"";this.$textArea.value=t},this.onMemberSelect=e=>{const t=Gi(this.mentionQuery),i=Gi(this.$textArea.value.trim()).replace(t,"");this.$textArea.value=Gi(i)+`${oc}${e.name} `,this.mentionQuery="",this.focusedMemberIndex=0,P(()=>this.$textArea.focus())},this.getFilteredMembers=()=>{const e=this.mentionQuery.replace(oc,"");return this.members.filter(t=>t.name.toLowerCase().includes(e.toLowerCase()))},this.cleanUpFileUpload=()=>{this.filePreview=null,this.fileToUpload=null},this.renderSuggestedReplies=()=>{if(this.prefill.suggestedReplies&&0!==this.prefill.suggestedReplies.length)return z("ul",{class:"suggested-replies scrollbar"},this.prefill.suggestedReplies.map(e=>z("dyte-tooltip",{label:this.t("chat.click_to_send")},z("li",{onClick:()=>this.onNewMessage.emit({type:"text",message:e})},e))))},this.renderMenu=()=>{if(0===this.mentionQuery.length)return;const e=this.getFilteredMembers();return 0!==e.length?z("ul",{class:"member-list scrollbar"},e.map((e,t)=>z("li",{class:{member:!0,selected:t===this.focusedMemberIndex},onClick:()=>this.onMemberSelect(e),ref:e=>{t===this.focusedMemberIndex&&P(()=>{e&&e.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})})}},z("dyte-avatar",{participant:{name:e.name,picture:e.picture},size:"sm"}),z("span",null,e.name)))):void 0}}connectedCallback(){this.fileReader.onload=e=>{"string"==typeof e.target.result&&(this.filePreview=e.target.result)}}onChannelChanged(){this.mentionQuery="",this.focusedMemberIndex=0;const e=Yt.getItem(this.storageKey)||"";this.$textArea.value=e,this.emojiPickerActive=!1}componentDidRender(){(this.prefill.editMessage||this.prefill.replyMessage)&&P(()=>this.$textArea.focus())}get storageKey(){return this.channelId?`dyte-text-message-${this.channelId}`:"dyte-text-message"}uploadFile(e){const t=document.createElement("input");t.type="file","image"===e&&(t.accept="image/*"),t.onchange=t=>{const{validity:i,files:[s]}=t.target;i.valid&&this.generateFilePreview(e,s)},t.click()}renderFilePreview(){if("string"==typeof this.filePreview)return z("div",{class:"preview-overlay"},z("div",{class:"file-preview"},z("dyte-tooltip",{label:this.t("chat.cancel_upload")},z("dyte-button",{variant:"secondary",kind:"icon",onClick:this.cleanUpFileUpload},z("dyte-icon",{icon:this.iconPack.dismiss}))),"image"===this.fileToUpload.type?z("img",{class:"preview-image",src:this.filePreview}):z("div",{class:"preview-file"},z("span",null,this.filePreview))))}render(){var e;let t="";return(null===(e=this.prefill.editMessage)||void 0===e?void 0:e.message)&&(t=Zi(this.prefill.editMessage.message)),z(G,{key:"bd9e183a8595fdf13f53dfe74243fc58b889b490"},this.canSendTextMessage&&this.emojiPickerActive&&z("dyte-emoji-picker",{key:"63cbab4694b7640574190ced33fc146742dabd16",part:"emoji-picker",onPickerClose:()=>{this.emojiPickerActive=!1},onDyteEmojiClicked:e=>{this.$textArea.value+=e.detail,this.$textArea.focus()},t:this.t}),this.renderSuggestedReplies(),z("slot",{key:"3c12d633831662382c5ee01830b6a1dccffa1c36",name:"chat-addon"}),z("slot",{key:"e94a874a6afd03896c905af9974c8cc8de662d7a",name:"quote-block"}),z("div",{key:"5a9c021aa2501c6da3d25e75b72338aea15a635c",class:"chat-input",part:"chat-input"},this.renderMenu(),this.canSendTextMessage&&z("textarea",{key:"bc8057712688cdb12f40fa62d1dca57797785b75",class:"scrollbar",part:"textarea",ref:this.initializeTextField,autoFocus:!0,placeholder:this.fileToUpload?"":this.t("chat.message_placeholder"),value:t,onPaste:this.onPaste,maxLength:Qi,onKeyDown:this.handleKeyDown,onKeyUp:this.handleKeyUp,onInput:e=>{Yt.setItem(this.storageKey,e.target.value)},disabled:!!this.filePreview}),z("div",{key:"6df2b595eed0375f53bed5d56bdcc6c0493a8247",class:"chat-buttons",part:"chat-buttons"},z("div",{key:"021c7d3b3901080792144bf5f76eab855c11b4e4",class:"left",part:"chat-buttons-left"},!this.prefill.editMessage&&this.canSendFiles&&[z("dyte-tooltip",{key:"c11d06e54dcfde7fd035a4c3037046f0364a92ba",label:this.t("chat.send_file")},z("dyte-button",{key:"2124e7ca46e80b74fc10a6698471671360285bc0",variant:"ghost",kind:"icon",onClick:()=>this.uploadFile("file"),title:this.t("chat.send_file")},z("dyte-icon",{key:"511036aad6e7b7098a281ef7e365ad1ba1a6e25f",icon:this.iconPack.attach}))),z("dyte-tooltip",{key:"77777a43eae025a8b1e40d1945f8cec0445992be",label:this.t("chat.send_img")},z("dyte-button",{key:"51bbef7f90a068397eab5affeec9877f8d9be929",variant:"ghost",kind:"icon",onClick:()=>this.uploadFile("image"),title:this.t("chat.send_img")},z("dyte-icon",{key:"98a2c7f941afe3bcb06cc18984978311f9c0e501",icon:this.iconPack.image})))],!this.prefill.editMessage&&this.canSendTextMessage&&!this.disableEmojiPicker&&z("dyte-tooltip",{key:"a614a1ca853e2e2e7390cf74321f70881cde38a9",label:this.t("chat.send_emoji")},z("dyte-button",{key:"ae859f19d1e8372723409dc0530ed5bcfc01c619",variant:"ghost",kind:"icon",class:{active:this.emojiPickerActive},title:this.t("chat.send_emoji"),onClick:()=>{this.emojiPickerActive=!this.emojiPickerActive}},z("dyte-icon",{key:"92e8add087597deca28e864fffad34f521203f01",icon:this.iconPack.emoji_multiple})))),!!this.filePreview&&this.renderFilePreview(),this.canSendTextMessage&&z("div",{key:"3a1dd50dd4f77dfdce4ecef6cbeeb7cd7330044c",class:"right",part:"chat-buttons-right"},!this.prefill.editMessage&&z("dyte-tooltip",{key:"47afdb3c09f71c39e0f059f6f19f367aa3c0164b",variant:"primary",label:this.t("chat.send_msg"),delay:2e3},z("dyte-button",{key:"1a7646cee202fa4be64de7bb0afc8b58dd750919",kind:"icon",onClick:()=>this.handleSendMessage(),title:this.t("chat.send_msg")},z("dyte-icon",{key:"ebc857dc0e41c20f8bc73d3123f9b3cf8c752aa6",icon:this.iconPack.send}))),this.prefill.editMessage&&z("div",{key:"20ed1557de83b2bbc3167ee58a2535f9d53dd5d2",class:"edit-buttons"},z("dyte-tooltip",{key:"542bc4c98d2411579913c50dae2fe3ddf26858c0",variant:"secondary",label:this.t("cancel"),delay:2e3},z("dyte-button",{key:"ff5bcf87c4cf6a13385f7314744f9dc39ead0b3d",kind:"icon",variant:"secondary",onClick:()=>this.handleEditCancel(),title:this.t("cancel")},z("dyte-icon",{key:"5f514ddf6986d2fe4bfe9641c0aa0c8a834cfae8",icon:this.iconPack.dismiss}))),z("dyte-tooltip",{key:"f0ebc5ea3f5801377ded5745a7bf83cd369a7fe4",variant:"primary",label:this.t("chat.update_msg"),delay:2e3},z("dyte-button",{key:"34e8521c0a11747adddedf555dcceba8b7db2a27",kind:"icon",onClick:()=>this.handleEditMessage(),title:this.t("chat.send_msg")},z("dyte-icon",{key:"8082c8dcb7a670889bf07a2811baa432c85ebf53",icon:this.iconPack.checkmark}))))))))}static get watchers(){return{channelId:["onChannelChanged"]}}};nc([si()],dc.prototype,"size",void 0),nc([si()],dc.prototype,"iconPack",void 0),nc([si()],dc.prototype,"t",void 0),dc.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.chat-input{position:relative;margin:var(--dyte-space-2, 8px);z-index:10;box-sizing:border-box;display:flex;flex-direction:column;border-radius:var(--dyte-border-radius-md, 8px);border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60))}textarea{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));box-sizing:border-box;padding:var(--dyte-space-3, 12px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}textarea::-moz-placeholder{color:rgb(var(--dyte-colors-text-1000, 255 255 255))}textarea::placeholder{color:rgb(var(--dyte-colors-text-1000, 255 255 255))}textarea{border-top-left-radius:var(--dyte-border-radius-md, 8px);border-top-right-radius:var(--dyte-border-radius-md, 8px);font-family:var(--dyte-font-family, sans-serif);outline:2px solid transparent;outline-offset:2px;resize:none;overflow-y:auto;border-width:var(--dyte-border-width-none, 0);border-style:none;min-height:60px;font-size:14px}.chat-buttons{border-bottom-right-radius:var(--dyte-border-radius-md, 8px);border-bottom-left-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));display:flex;height:var(--dyte-space-8, 32px);align-items:center;justify-content:space-between;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px)}.chat-buttons .left dyte-button{margin-right:var(--dyte-space-1, 4px)}.chat-buttons .left dyte-button dyte-icon{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}.chat-buttons .right{z-index:10}.chat-buttons .right .edit-buttons{display:flex;gap:var(--dyte-space-2, 8px)}.chat-buttons>div{display:flex;align-items:center}dyte-emoji-picker{z-index:0;position:absolute;bottom:var(--dyte-space-32, 128px);border-top:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60));animation:0.3s slide-up ease}@keyframes slide-up{from{transform:translateY(100%)}to{transform:translateY(0%)}}.member-list{margin:var(--dyte-space-0, 0px);margin-top:var(--dyte-space-1, 4px);max-height:var(--dyte-space-28, 112px);min-width:var(--dyte-space-40, 160px);max-width:var(--dyte-space-64, 256px);padding:var(--dyte-space-0, 0px);position:absolute;bottom:var(--dyte-space-28, 112px);list-style-type:none;overflow-y:auto;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));border-radius:var(--dyte-border-radius-sm, 4px);--tw-border-spacing-x:var(--dyte-space-2, 8px);--tw-border-spacing-y:var(--dyte-space-2, 8px);border-spacing:var(--tw-border-spacing-x) var(--tw-border-spacing-y);border-style:solid;border-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.5)}.member-list .member{display:flex;align-items:center;gap:var(--dyte-space-1, 4px);padding:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-4, 16px);cursor:pointer}.member-list .member dyte-avatar{flex-shrink:0;height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);font-size:14px;color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.member-list .member span{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.member-list .member:hover,.member-list .member.selected{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-700, 2 70 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.suggested-replies{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-3, 12px);display:flex;flex-wrap:nowrap;gap:var(--dyte-space-2, 8px);list-style-type:none;overflow-x:auto}.suggested-replies dyte-tooltip{flex-shrink:0}.suggested-replies li{padding:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-md, 8px);background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / 0.75);color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));cursor:pointer}.suggested-replies li:hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-bg-opacity))}.preview-overlay{position:absolute;top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));border-radius:var(--dyte-border-radius-md, 8px)}.file-preview{position:absolute;top:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);max-width:-moz-fit-content;max-width:fit-content;max-height:var(--dyte-space-20, 80px)}.file-preview:hover dyte-tooltip{display:block}.file-preview dyte-tooltip{position:absolute;top:calc(var(--dyte-space-1, 4px) * -1);left:calc(var(--dyte-space-1, 4px) * -1);display:none;margin-left:calc(var(--dyte-space-1, 4px) * -1);margin-top:calc(var(--dyte-space-1, 4px) * -1)}.file-preview dyte-button{display:flex;height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);align-items:center;justify-content:center;border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));border:1px solid rgb(var(--dyte-colors-text-1000, 255 255 255))}.file-preview dyte-icon{height:var(--dyte-space-3, 12px);width:var(--dyte-space-3, 12px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.preview-image{height:var(--dyte-space-16, 64px);width:var(--dyte-space-16, 64px);-o-object-fit:cover;object-fit:cover;max-height:100%;max-width:100%;overflow:clip;border-radius:var(--dyte-border-radius-md, 8px)}.preview-file{padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));overflow:hidden;text-overflow:ellipsis;white-space:nowrap;border-radius:var(--dyte-border-radius-md, 8px);max-width:200px}@keyframes scroll-text{0%{transform:translateX(0%)}70%{transform:translateX(-100%)}80%{transform:translateX(0%)}100%{transform:translateX(0%)}}";var lc=Object.freeze({__proto__:null,dyte_chat_composer_ui:dc});var cc=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const hc=class{constructor(e){o(this,e),this.groupChanged=W(this,"dyteChatGroupChanged",7),this.unreadCounts={},this.groups=[],this.iconPack=Vt,this.t=Ht(),this.showParticipantsPanel=!1,this.query="",this.onScopeClick=e=>{this.showParticipantsPanel=!1,this.groupChanged.emit(e)}}toggleParticipants(){this.showParticipantsPanel=!this.showParticipantsPanel}getGroups(){return this.groups.filter(e=>e.name.toLowerCase().includes(this.query.toLowerCase()))}getName(){if(!this.selectedGroupId||"everyone"===this.selectedGroupId)return this.t("everyone");const e=this.groups.find(e=>e.userId===this.selectedGroupId);return e?e.name:this.t("everyone")}render(){const e=Object.keys(this.unreadCounts).reduce((e,t)=>e+this.unreadCounts[t],0);return z(G,null,z("div",{class:"chat-scope-selector"},this.showParticipantsPanel&&z("div",{class:"participants-container"},z("div",{class:"search",part:"search"},z("dyte-icon",{icon:this.iconPack.search,part:"search-icon"}),z("input",{type:"search",autocomplete:"off",placeholder:this.t("search"),value:this.query,onInput:e=>{this.query=e.target.value},part:"search-input"})),z("ul",{class:"scope-list scrollbar"},""===this.query&&z("li",{class:"scope scope-special",onClick:()=>this.onScopeClick("everyone")},z("div",{class:"everyone-icon"},z("dyte-icon",{icon:this.iconPack.participants})),this.t("everyone"),this.unreadCounts.everyone>0&&z("div",{class:"unread-count",part:"unread-count"},z("span",null,this.unreadCounts.everyone))),this.getGroups().map(e=>{const t=this.unreadCounts[Fi([this.selfUserId,e.userId])];return z("li",{class:"scope",onClick:()=>this.onScopeClick(e),key:e.userId},e.name,t>0&&z("div",{class:"unread-count",part:"unread-count"},z("span",null,t)))}))),z("button",{onClick:()=>this.toggleParticipants()},z("span",null,`${this.t("to")} ${this.getName()}`,"  ",e>0&&z("div",{class:"unread-count selector"},z("span",null,e))),z("dyte-icon",{icon:this.showParticipantsPanel?this.iconPack.chevron_up:this.iconPack.chevron_down}))))}};cc([si()],hc.prototype,"iconPack",void 0),cc([si()],hc.prototype,"t",void 0),hc.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{display:flex;flex-direction:column}.chat-scope-selector{position:relative;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));z-index:10}.chat-scope-selector button{width:100%;border-width:var(--dyte-border-width-none, 0);border-style:none;padding:var(--dyte-space-4, 16px);display:flex;align-items:center;justify-content:space-between;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));font-size:14px;cursor:pointer;height:var(--dyte-space-12, 48px)}.chat-scope-selector button span{display:flex;align-items:center;justify-content:flex-start}.chat-scope-selector button dyte-icon{height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}.chat-scope-selector .search{position:sticky;box-sizing:border-box;display:flex;align-items:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));margin-left:var(--dyte-space-3, 12px);margin-right:var(--dyte-space-3, 12px);margin-top:var(--dyte-space-3, 12px);margin-bottom:var(--dyte-space-0, 0px)}.chat-scope-selector .search dyte-icon{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}.chat-scope-selector .search input{box-sizing:border-box;height:var(--dyte-space-9, 36px);width:100%;padding-right:var(--dyte-space-2, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));outline:2px solid transparent;outline-offset:2px;border-radius:var(--dyte-border-radius-sm, 4px);font-size:14px}.chat-scope-selector .search input::-moz-placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.chat-scope-selector .search input::placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.chat-scope-selector .participants-container{position:absolute;width:100%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));top:var(--dyte-space-12, 48px);animation:0.3s slide-down ease}@keyframes slide-down{from{transform:translateY(-50px)}to{transform:translateY(0%)}}.chat-scope-selector .scope-list{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0, 0px);list-style-type:none;padding-left:var(--dyte-space-0, 0px);padding-right:var(--dyte-space-0, 0px);overflow:auto;max-height:375px}.chat-scope-selector .scope-list .scope{position:relative;display:flex;flex-direction:row;align-items:center;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px)}.chat-scope-selector .scope-list .scope:hover{cursor:pointer;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}.chat-scope-selector .scope-list .scope-special{margin-top:var(--dyte-space-4, 16px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}.chat-scope-selector .scope-list .everyone-icon>dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px);color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.chat-scope-selector .scope-list .everyone-icon{display:flex;height:100%;width:100%;align-items:center;justify-content:center;margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));font-size:12px}.unread-count.selector{position:unset;margin-left:var(--dyte-space-2, 8px)}.unread-count{position:absolute;right:var(--dyte-space-3, 12px);box-sizing:border-box;padding:var(--dyte-space-0\\.5, 2px);-webkit-user-select:none;-moz-user-select:none;user-select:none;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));font-size:12px;color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));display:flex;height:var(--dyte-space-5, 20px);min-width:var(--dyte-space-5, 20px);align-items:center;justify-content:center;border-radius:9999px;z-index:1}dyte-avatar{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px)}";var pc=Object.freeze({__proto__:null,dyte_chat_selector_ui:hc});const uc=e=>{if(e&&!e.chat)return!1;const{chatPublic:t,chatPrivate:i}=e.self.permissions;return t.canSend||t.canReceive||t.text||t.files||i.canSend||i.canReceive||i.files||i.text},gc=e=>{if(e&&!e.polls)return!1;const{polls:t}=e.self.permissions;return t.canCreate||t.canView||t.canVote},fc=e=>{var t;if(!(null===(t=e.self.permissions)||void 0===t?void 0:t.showParticipantList))return!1;if(e&&!e.participants)return!1;const i=null==e?void 0:e.self.config;return!(i&&!i.controlBar.elements.participants)},mc=e=>{if(tt(e))return!1;if(e&&!e.plugins)return!1;if("LIVESTREAM"===e.meta.viewType)return"ON_STAGE"===e.stage.status;const{plugins:t}=e.self.permissions;return t.canClose||t.canStart};var vc=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const yc=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.unreadMessageCount=0,this.variant="button",this.iconPack=Vt,this.t=Ht(),this.chatActive=!1,this.canViewChat=!1,this.hasNewMessages=!1,this.onChatUpdate=({action:e,message:t})=>{var i;this.chatActive||"add"===e&&t.userId!==(null===(i=this.meeting)||void 0===i?void 0:i.self.userId)&&(this.hasNewMessages=!0,this.unreadMessageCount+=1)},this.toggleChat=()=>{const e=this.states;this.chatActive=!((null==e?void 0:e.activeSidebar)&&"chat"===(null==e?void 0:e.sidebar)),this.chatActive&&(this.unreadMessageCount=0,this.hasNewMessages=!1),this.stateUpdate.emit({activeSidebar:this.chatActive,sidebar:this.chatActive?"chat":void 0,activeMoreMenu:!1,activeAI:!1})},this.updateCanView=()=>{this.canViewChat=uc(this.meeting)}}connectedCallback(){this.meetingChanged(this.meeting),this.statesChanged(this.states)}disconnectedCallback(){var e,t,i,s,a,r;null===(t=null===(e=this.meeting)||void 0===e?void 0:e.chat)||void 0===t||t.removeListener("chatUpdate",this.onChatUpdate),null===(s=null===(i=this.meeting)||void 0===i?void 0:i.stage)||void 0===s||s.removeListener("stageStatusUpdate",this.updateCanView),null===(r=null===(a=this.meeting)||void 0===a?void 0:a.self)||void 0===r||r.permissions.removeListener("chatUpdate",this.updateCanView)}meetingChanged(e){var t,i,s,a,r,n,o;if(null==e)return;pt(e)&&(null===(t=e.chat)||void 0===t||t.getMessages((new Date).getTime(),1,!0).then(e=>{var t;(null===(t=null==e?void 0:e.messages)||void 0===t?void 0:t.length)&&(this.hasNewMessages=!0)}));const d=null!==(s=null===(i=e.meta)||void 0===i?void 0:i.meetingStartedTimestamp.getTime())&&void 0!==s?s:0,l=null===(a=e.chat)||void 0===a?void 0:a.messages.filter(e=>e.timeMs>d);this.unreadMessageCount=l.length||0,null===(r=e.chat)||void 0===r||r.addListener("chatUpdate",this.onChatUpdate),this.canViewChat=uc(e),null===(n=null==e?void 0:e.stage)||void 0===n||n.on("stageStatusUpdate",this.updateCanView),null===(o=null==e?void 0:e.self)||void 0===o||o.permissions.on("chatUpdate",this.updateCanView)}statesChanged(e){null!=e&&(this.chatActive=!0===e.activeSidebar&&"chat"===e.sidebar)}render(){return this.canViewChat?z(G,{title:this.t("chat")},pt(this.meeting)?this.hasNewMessages&&z("div",{class:"unread-count-dot",part:"unread-count-dot"}):0!==this.unreadMessageCount&&!this.chatActive&&z("div",{class:"unread-count",part:"unread-count"},z("span",null,this.unreadMessageCount<=100?this.unreadMessageCount:"99+")),z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,class:{active:this.chatActive},onClick:this.toggleChat,icon:this.iconPack.chat,label:this.t("chat"),variant:this.variant})):z(G,{"data-hidden":!0})}static get watchers(){return{meeting:["meetingChanged"],states:["statesChanged"]}}};vc([si()],yc.prototype,"meeting",void 0),vc([si()],yc.prototype,"states",void 0),vc([si()],yc.prototype,"size",void 0),vc([si()],yc.prototype,"iconPack",void 0),vc([si()],yc.prototype,"t",void 0),yc.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:block}:host([data-hidden]){display:none}.unread-count{position:absolute;right:var(--dyte-space-3, 12px);box-sizing:border-box;padding:var(--dyte-space-0\\.5, 2px);-webkit-user-select:none;-moz-user-select:none;user-select:none;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));font-size:12px;color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));display:flex;height:var(--dyte-space-5, 20px);min-width:var(--dyte-space-5, 20px);align-items:center;justify-content:center;border-radius:9999px;z-index:1}.unread-count-dot{position:absolute;right:var(--dyte-space-3, 12px);z-index:10;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));border-radius:50%;display:flex;height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);align-items:center;justify-content:center}:host([variant='horizontal']) .unread-count{right:var(--dyte-space-4, 16px);top:auto}";var bc=Object.freeze({__proto__:null,dyte_chat_toggle:yc});var wc=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const xc=e=>Math.trunc(e).toString().padStart(2,"0"),kc=class{constructor(e){o(this,e),this.iconPack=Vt,this.disconnectMeeting=()=>{var e,t;this.timeout&&clearTimeout(this.timeout),"number"==typeof this.request&&cancelAnimationFrame(this.request),null===(t=null===(e=this.meeting)||void 0===e?void 0:e.meta)||void 0===t||t.removeListener("meetingStartTimeUpdate",this.startedTimeUpdateListener)},this.startedTimeUpdateListener=()=>{var e,t,i;this.startedTime=null===(i=null===(t=null===(e=this.meeting)||void 0===e?void 0:e.meta)||void 0===t?void 0:t.meetingStartedTimestamp)||void 0===i?void 0:i.toISOString()}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.disconnectMeeting()}meetingChanged(e){var t,i,s;this.disconnectMeeting(),null!=e&&(this.startedTime=null===(i=null===(t=e.meta)||void 0===t?void 0:t.meetingStartedTimestamp)||void 0===i?void 0:i.toISOString(),null===(s=e.meta)||void 0===s||s.addListener("meetingStartTimeUpdate",this.startedTimeUpdateListener))}startedTimeChanged(e){if(void 0!==e){const e=()=>{this.timeDiff=(Date.now()-new Date(this.startedTime).getTime())/1e3,this.timeout=setTimeout(()=>{null!=this.request&&(this.request=requestAnimationFrame(e))},500)};this.request=requestAnimationFrame(e)}}getFormattedTime(){if(null==this.timeDiff)return null;const e=this.timeDiff;let t="";return e>=3600&&(t=`${xc(e/3600)}:`),t+=`${xc(e%3600/60)}:${xc(e%60)}`,t}render(){return z(G,{key:"3ce9caf85c506b3c200601d492cd281c3e4c630b",tabIndex:0,role:"timer","aria-live":"off"},void 0!==this.startedTime&&[z("dyte-icon",{key:"bb4e24a529ee378389b9371bd3b42136da8f2046",icon:this.iconPack.clock,"aria-hidden":!0,tabIndex:-1,part:"icon"}),z("span",{key:"66b6b43d99f1bc8a27ecf8e3320bbc6a1c26c64c",part:"text"},this.getFormattedTime())])}static get watchers(){return{meeting:["meetingChanged"],startedTime:["startedTimeChanged"]}}};wc([si()],kc.prototype,"meeting",void 0),wc([si()],kc.prototype,"iconPack",void 0),kc.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:inline-flex;align-items:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;font-size:14px;color:rgb(var(--dyte-colors-text-1000, 255 255 255));font-variant-numeric:tabular-nums}:host([size='sm']){margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px);font-size:12px}dyte-icon{margin-right:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}:host([size='sm']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}";var Sc=Object.freeze({__proto__:null,dyte_clock:kc});var Ec=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Pc=class{constructor(e){o(this,e),this.variant="solid",this.disableRender=!1,this.config=Ft,this.iconPack=Vt,this.t=Ht()}render(){const e={meeting:this.meeting,config:this.config,states:this.states,t:this.t,iconPack:this.iconPack,size:this.size};return z(G,{key:"ef0ba36f97e1366fbeab0d7e5d0eeab4119e898c"},!this.disableRender&&z(ls,{key:"2f8951fb89ebb0d81bc53eb3eeebd8c3de074ed9",element:"dyte-controlbar",defaults:e,onlyChildren:!0}),z("slot",{key:"d9e094a525ccffdd485eb6de23920c05c36c6ed1"}))}};Ec([si()],Pc.prototype,"meeting",void 0),Ec([si()],Pc.prototype,"states",void 0),Ec([si()],Pc.prototype,"iconPack",void 0),Ec([si()],Pc.prototype,"t",void 0),Ec([si()],Pc.prototype,"size",void 0),Pc.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{box-sizing:border-box;display:flex;align-items:center;gap:var(--dyte-space-0\\.5, 2px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px);position:relative;z-index:10}@media only screen and (max-device-height: 480px) and (orientation: landscape){:host{padding-top:var(--dyte-space-0, 0px) !important}}";var Tc=Object.freeze({__proto__:null,dyte_controlbar:Pc});var Lc=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Cc=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.t=Ht(),this.iconPack=Vt}toggleDebugger(){var e;this.stateUpdate.emit({activeDebugger:!(null===(e=this.states)||void 0===e?void 0:e.activeDebugger),activeMoreMenu:!1})}render(){return z(G,{key:"e4f3441ebff39ea51b49aa9a015b6875b433b7dd",title:this.t("Troubleshooting")},z("dyte-controlbar-button",{key:"7441cd4adf6a3d1b7d2c4f2b957f1561ef0d4ae1",size:this.size,iconPack:this.iconPack,onClick:()=>this.toggleDebugger(),icon:this.iconPack.debug,label:this.t("Troubleshooting"),variant:this.variant}))}};Lc([si()],Cc.prototype,"meeting",void 0),Lc([si()],Cc.prototype,"states",void 0),Lc([si()],Cc.prototype,"t",void 0),Lc([si()],Cc.prototype,"iconPack",void 0),Lc([si()],Cc.prototype,"size",void 0),Cc.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";var _c=Object.freeze({__proto__:null,dyte_debugger_toggle:Cc});var Ac=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Rc=class{constructor(e){o(this,e),this.config=Ft,this.icon=Vt,this.t=Ht(),this.iconPack=Vt,this.message=""}connectedCallback(){this.statesChanged(this.states)}getBreakoutRoomsMessage(e){var t;let i;return"connected-meeting"===(null==e?void 0:e.roomLeftState)&&(i=(null===(t=this.states.activeBreakoutRoomsManager)||void 0===t?void 0:t.destinationMeetingId)===this.meeting.connectedMeetings.parentMeeting.id?"breakout_rooms.move_reason.switch_main_room":"breakout_rooms.move_reason.switch_room"),i}statesChanged(e){if(null!=e)switch(null==e?void 0:e.roomLeftState){case"left":this.message="ended.left";break;case"kicked":this.message="ended.kicked";break;case"disconnected":this.message="ended.disconnected";break;case"rejected":this.message="ended.rejected";break;case"connected-meeting":this.message=this.getBreakoutRoomsMessage(e);break;case"unauthorized":this.message="ended.unauthorized";break;default:this.message="ended"}}renderBreakoutRoomScreen(){return z(G,null,z("div",{class:"ctr",part:"container"},z("dyte-icon",{icon:this.iconPack.breakout_rooms}),z("p",{part:"message",class:"breakout"},this.t(this.message))))}render(){const e=this.states;return"connected-meeting"===e.roomLeftState?this.renderBreakoutRoomScreen():z(G,null,z("div",{class:"ctr",part:"container"},z("dyte-logo",{meeting:this.meeting,config:this.config,part:"logo",t:this.t}),z("p",{part:"message"},this.t(this.message)),"disconnected"===(null==e?void 0:e.roomLeftState)&&z("span",{part:"description"},this.t("ended.network"))))}static get watchers(){return{states:["statesChanged"]}}};Ac([si()],Rc.prototype,"size",void 0),Ac([si()],Rc.prototype,"states",void 0),Ac([si()],Rc.prototype,"t",void 0),Ac([si()],Rc.prototype,"iconPack",void 0),Ac([si()],Rc.prototype,"meeting",void 0),Rc.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{height:100%;width:100%;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:flex;flex-direction:column;align-items:center;justify-content:center}.ctr{display:flex;flex-direction:column;align-items:center;gap:var(--dyte-space-8, 32px)}dyte-logo.loaded{height:var(--dyte-space-12, 48px)}.rejoin-button{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-4, 16px);padding-top:var(--dyte-space-6, 24px);padding-bottom:var(--dyte-space-6, 24px);padding-left:var(--dyte-space-16, 64px);padding-right:var(--dyte-space-16, 64px)}.rejoin-icon{margin-right:var(--dyte-space-2, 8px)}p{font-size:16px;border-radius:var(--dyte-border-radius-lg, 12px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));padding-left:var(--dyte-space-8, 32px);padding-right:var(--dyte-space-8, 32px);padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}p.breakout{font-size:20px;display:flex;flex-direction:column;align-items:center}p.breakout span{margin-top:var(--dyte-space-1, 4px);margin-bottom:var(--dyte-space-0, 0px);color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}span{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-4, 16px);font-size:14px}";var Ic=Object.freeze({__proto__:null,dyte_ended_screen:Rc});var Dc=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Mc=class{constructor(e){o(this,e),this.onDropCallback=W(this,"dropCallback",7),this.iconPack=Vt,this.t=Ht(),this.dropzoneActivated=!1}connectedCallback(){if(!this.hostEl)throw new Error("hostEl prop is required");this.hostEl.addEventListener("dragover",e=>{e.preventDefault(),this.dropzoneActivated=!0}),this.hostEl.addEventListener("dragleave",()=>{this.dropzoneActivated=!1}),this.hostEl.addEventListener("drop",e=>{e.preventDefault(),this.dropzoneActivated=!1,this.onDropCallback.emit(e)})}render(){return z(G,{key:"2c1ba91175328eb8d81c9de9b54a4ed5ff0d78e0"},z("div",{key:"9a6d873ac4fbf439c0aade2313f13cad4c1168d2",id:"dropzone",class:{active:this.dropzoneActivated},part:"dropzone"},z("dyte-icon",{key:"7ea8fd7f990fe3a6353a631efa13895a46465692",icon:this.iconPack.attach}),z("p",{key:"fa222c2ad9ec8874cb4bac0425ceb04cd396bb43"},this.t("chat.send_attachment"))))}};Dc([si()],Mc.prototype,"iconPack",void 0),Dc([si()],Mc.prototype,"t",void 0),Mc.style="#dropzone{position:absolute;top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);z-index:10;display:none;flex-direction:column;align-items:center;justify-content:center;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}#dropzone.active{display:flex;animation:0.2s slide-up ease-in}";var Oc=Object.freeze({__proto__:null,dyte_file_dropzone:Mc}),Uc="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var $c=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Fc="object"==typeof Uc&&Uc&&Uc.Object===Object&&Uc,Nc="object"==typeof self&&self&&self.Object===Object&&self,jc=Fc||Nc||Function("return this")(),zc=jc,Bc=function(){return zc.Date.now()},Gc=/\s/;var Hc=function(e){for(var t=e.length;t--&&Gc.test(e.charAt(t)););return t},Vc=Hc,qc=/^\s+/;var Kc=function(e){return e?e.slice(0,Vc(e)+1).replace(qc,""):e},Yc=jc.Symbol,Wc=Yc,Zc=Object.prototype,Qc=Zc.hasOwnProperty,Xc=Zc.toString,Jc=Wc?Wc.toStringTag:void 0;var eh=function(e){var t=Qc.call(e,Jc),i=e[Jc];try{e[Jc]=void 0;var s=!0}catch(e){}var a=Xc.call(e);return s&&(t?e[Jc]=i:delete e[Jc]),a},th=Object.prototype.toString;var ih=eh,sh=function(e){return th.call(e)},ah=Yc?Yc.toStringTag:void 0;var rh=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ah&&ah in Object(e)?ih(e):sh(e)},nh=function(e){return null!=e&&"object"==typeof e};var oh=Kc,dh=$c,lh=function(e){return"symbol"==typeof e||nh(e)&&"[object Symbol]"==rh(e)},ch=/^[-+]0x[0-9a-f]+$/i,hh=/^0b[01]+$/i,ph=/^0o[0-7]+$/i,uh=parseInt;var gh=$c,fh=Bc,mh=function(e){if("number"==typeof e)return e;if(lh(e))return NaN;if(dh(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=dh(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=oh(e);var i=hh.test(e);return i||ph.test(e)?uh(e.slice(2),i?2:8):ch.test(e)?NaN:+e},vh=Math.max,yh=Math.min;var bh=function(e,t,i){var s,a,r,n,o,d,l=0,c=!1,h=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function u(t){var i=s,r=a;return s=a=void 0,l=t,n=e.apply(r,i)}function g(e){var i=e-d;return void 0===d||i>=t||i<0||h&&e-l>=r}function f(){var e=fh();if(g(e))return m(e);o=setTimeout(f,function(e){var i=t-(e-d);return h?yh(i,r-(e-l)):i}(e))}function m(e){return o=void 0,p&&s?u(e):(s=a=void 0,n)}function v(){var e=fh(),i=g(e);if(s=arguments,a=this,d=e,i){if(void 0===o)return function(e){return l=e,o=setTimeout(f,t),c?u(e):n}(d);if(h)return clearTimeout(o),o=setTimeout(f,t),u(d)}return void 0===o&&(o=setTimeout(f,t)),n}return t=mh(t)||0,gh(i)&&(c=!!i.leading,r=(h="maxWait"in i)?vh(mh(i.maxWait)||0,t):r,p="trailing"in i?!!i.trailing:p),v.cancel=function(){void 0!==o&&clearTimeout(o),l=0,s=d=a=o=void 0},v.flush=function(){return void 0===o?n:m(fh())},v};function wh(e,t){const i=Math.pow(10,t);return Math.floor(e*i)/i}function xh({dimensions:e,count:t,aspectRatio:i,gap:s}){const{width:a,height:r,rows:n,cols:o}=function({count:e,dimensions:t,aspectRatio:i,gap:s}){let{width:a,height:r}=t;if(0===a||0===r)return{width:0,height:0,rows:1,cols:1};a-=2*s,r-=2*s;const n=s,o=e,d=kh(i);let l=0,c=0,h=1,p=1;const u=[];for(let e=1;e<=o;e++)u.push((a-n*(e-1))/e),u.push((r-n*(e-1))/(e*d));u.sort((e,t)=>t-e);for(const e of u)if(l=wh(e,4),c=wh(l*d,4),h=Math.floor((a+n)/(l+n)),p=Math.floor((r+n)/(c+n)),h*p>=o){p=Math.ceil(o/h);break}return{width:l,height:c,rows:p,cols:h}}({dimensions:e,count:t,aspectRatio:i,gap:s}),d=function({parentDimensions:e,dimensions:t,rows:i,cols:s,count:a,gap:r}){const{width:n,height:o}=e,{width:d,height:l}=t,c=(o-(l*i+(i-1)*r))/2;let h=(n-(d*s+(s-1)*r))/2;const p=l+r,u=d+r;let g=0,f=0;const m=a%s;function v(e){const t=a-e;t===m&&(h=(n-(d*t+(t-1)*r))/2);const i=c+f*p,o=h+g*u;return g++,(e+1)%s===0&&(f++,g=0),{top:i,left:o}}return v}({parentDimensions:e,dimensions:{width:a,height:r},rows:n,cols:o,count:t,gap:s});return{width:a,height:r,getPosition:d}}const kh=e=>{const[t,i]=e.split(":");return Number.parseInt(i)/Number.parseInt(t)},Sh={spotlight:"sm",mixed:"sm"};var Eh=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Ph=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.hideSelf=!1,this.participants=[],this.pinnedParticipants=[],this.screenShareParticipants=[],this.plugins=[],this.emptyStage=!1,this.showLiveStreamPlayer=!1,this.canCurrentPeerHost=!1,this.pipSupported=!1,this.pipEnabled=!1,this.hidden=!1,this.layout="row",this.aspectRatio="16:9",this.gap=8,this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.gridSize=Sh,this.overrides={},this.invalidRoomStates=["init","waitlisted","ended","kicked","rejected"],this.filterParticipants=e=>{var t;if(this.overrides&&(null===(t=this.overrides)||void 0===t?void 0:t.videoUnsubscribed)){const t=this.overrides.videoUnsubscribed.preset;t.length>0&&(e=e.filter(e=>!t.some(t=>void 0!==e.presetName&&e.presetName.match(t))))}return e},this.onViewModeChanged=()=>{null!=this.meeting&&this.updateActiveParticipants()},this.onParticipantJoined=bh(()=>{this.updateActiveParticipants()},50),this.onParticipantLeft=bh(()=>{this.updateActiveParticipants()},50),this.stageStatusListener=()=>{this.updateActiveParticipants(),this.showLiveStreamPlayer=tt(this.meeting),"ON_STAGE"!==this.meeting.stage.status&&this.removeScreenShare(this.meeting.self)},this.peerStageStatusListener=e=>{this.updateActiveParticipants(),"ON_STAGE"!==this.meeting.stage.status&&(this.removePinned(e),this.removeScreenShare(e))},this.onScreenShareUpdate=e=>{e.screenShareEnabled?this.addScreenShare(e):this.removeScreenShare(e)},this.onSelfScreenShareUpdate=({screenShareEnabled:e})=>{e?this.addScreenShare(this.meeting.self):this.removeScreenShare(this.meeting.self)},this.toggleTileListener=({hidden:e})=>{this.hidden=e,this.updateActiveParticipants()},this.onPluginStateUpdate=(e,{active:t})=>{t?this.plugins.some(t=>t.id===e.id)||(this.plugins=[...this.plugins,e]):this.plugins=this.plugins.filter(t=>t.id!==e.id)},this.onParticipantPinned=()=>{this.updateActiveParticipants()},this.onParticipantUnpinned=()=>{this.updateActiveParticipants()},this.updateRoomStateListener=()=>{this.roomState=this.meeting.self.roomState}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.disconnectMeeting(this.meeting)}disconnectMeeting(e){var t;if(null==e)return;this.participants=[],this.plugins=[];const{self:i,participants:s,plugins:a}=e;i.removeListener("pinned",this.onParticipantPinned),i.removeListener("unpinned",this.onParticipantUnpinned),i.removeListener("roomLeft",this.updateRoomStateListener),i.removeListener("roomJoined",this.updateRoomStateListener),i.removeListener("screenShareUpdate",this.onSelfScreenShareUpdate),i.removeListener("toggleTile",this.toggleTileListener),null==a||a.all.removeListener("stateUpdate",this.onPluginStateUpdate),null===(t=e.stage)||void 0===t||t.removeListener("stageStatusUpdate",this.stageStatusListener),s.removeListener("viewModeChanged",this.onViewModeChanged),s.active.removeListener("participantLeft",this.onParticipantLeft),s.active.removeListener("participantJoined",this.onParticipantJoined),s.pinned.removeListener("participantJoined",this.onParticipantPinned),s.pinned.removeListener("participantLeft",this.onParticipantUnpinned),s.joined.removeListener("screenShareUpdate",this.onScreenShareUpdate),s.joined.removeListener("stageStatusUpdate",this.peerStageStatusListener)}meetingChanged(e,t){var i,s,a,r;if(null!==t&&this.disconnectMeeting(t),null!=e){const{self:t,participants:n,plugins:o,stage:d}=e;this.pipSupported=(null===(i=this.meeting.participants.pip)||void 0===i?void 0:i.isSupported())&&(null===(s=e.self.config)||void 0===s?void 0:s.pipMode),this.pipSupported&&this.meeting.participants.pip.init();const{permissions:l}=t;this.roomState=t.roomState;const c="ON_STAGE"!==this.meeting.stage.status,h=null==l?void 0:l.isRecorder;this.hideSelf=c||h||l.hiddenParticipant,this.participants=this.filterParticipants([...n.active.toArray(),...t.isPinned||this.hideSelf?[]:[t]]),this.pinnedParticipants=[...n.pinned.toArray(),...t.isPinned&&!this.hideSelf?[t]:[]],this.screenShareParticipants=n.joined.toArray().filter(e=>e.screenShareEnabled),this.plugins=(null==o?void 0:o.active.toArray())||[],(null==l?void 0:l.stageEnabled)&&(this.canCurrentPeerHost=l.acceptStageRequests||l.canPresent,this.updateStage()),this.hidden=e.self.hidden,t.addListener("roomLeft",this.updateRoomStateListener),t.addListener("roomJoined",this.updateRoomStateListener),t.addListener("screenShareUpdate",this.onSelfScreenShareUpdate),t.addListener("pinned",this.onParticipantPinned),t.addListener("unpinned",this.onParticipantUnpinned),t.addListener("toggleTile",this.toggleTileListener),null==d||d.addListener("stageStatusUpdate",this.stageStatusListener),null==o||o.all.addListener("stateUpdate",this.onPluginStateUpdate),n.addListener("viewModeChanged",this.onViewModeChanged),n.active.addListener("participantLeft",this.onParticipantLeft),null===(a=null==n?void 0:n.joined)||void 0===a||a.on("stageStatusUpdate",this.peerStageStatusListener),n.joined.addListener("screenShareUpdate",this.onScreenShareUpdate),n.active.addListener("participantJoined",this.onParticipantJoined),n.pinned.addListener("participantJoined",this.onParticipantPinned),n.pinned.addListener("participantLeft",this.onParticipantUnpinned),(null===(r=e.stage)||void 0===r?void 0:r.status)&&this.stageStatusListener()}}overridesChanged(e){this.updateActiveParticipants()}screenShareParticipantsChanged(e){const t=e.length>0;!!ii.states.activeScreenShare!==t&&(this.stateUpdate.emit({activeScreenShare:t}),ii.states.activeScreenShare=t)}pluginsChanged(e){const t=e.length>0;!!ii.states.activePlugin!==t&&(this.stateUpdate.emit({activePlugin:t}),ii.states.activePlugin=t)}pinnedParticipantsChanged(e){const t=e.length>0;!!ii.states.activeSpotlight!==t&&(this.stateUpdate.emit({activeSpotlight:t}),ii.states.activeSpotlight=t)}updateActiveParticipants(){var e;const{self:t,participants:i,stage:s}=this.meeting;this.hideSelf=this.hidden||"ON_STAGE"!==s.status||(null===(e=t.permissions)||void 0===e?void 0:e.isRecorder)||t.permissions.hiddenParticipant,this.participants=this.filterParticipants([...i.active.toArray().filter(e=>e.id!==t.id),..."ACTIVE_GRID"!==i.viewMode||t.isPinned||this.hideSelf?[]:[t]]),this.pinnedParticipants=[...i.pinned.toArray().filter(e=>e.id!==t.id),...t.isPinned&&!this.hideSelf?[t]:[]],this.screenShareParticipants=i.joined.toArray().filter(e=>e.screenShareEnabled),t.screenShareEnabled&&(this.screenShareParticipants=this.screenShareParticipants.concat([t])),this.updateStage()}updateStage(){var e;const{self:t}=this.meeting;this.meeting&&((null===(e=null==t?void 0:t.permissions)||void 0===e?void 0:e.stageEnabled)?this.emptyStage=0===this.participants.length&&0===this.pinnedParticipants.length:this.emptyStage=!1)}addScreenShare(e){this.screenShareParticipants.some(t=>t.id===e.id)||(this.screenShareParticipants=[...this.screenShareParticipants,e])}removeScreenShare(e){this.screenShareParticipants=this.screenShareParticipants.filter(t=>t.id!==e.id)}removePinned(e){this.pinnedParticipants=this.pinnedParticipants.filter(t=>t.id!==e.id)}render(){const e={meeting:this.meeting,size:this.size,states:this.states,config:this.config,iconPack:this.iconPack,t:this.t};return this.invalidRoomStates.includes(this.roomState)?z(G,null,z("div",{class:"offline-grid"},z("dyte-icon",{icon:this.iconPack.join_stage,size:"xl"}),z("h3",null,this.t("disconnected")),z("p",null,this.t("disconnected.description")))):"disconnected"===this.roomState?z(G,null,z("div",{class:"offline-grid"},z("dyte-icon",{icon:this.iconPack.disconnected,size:"xl"}),z("h3",null,this.t("offline")),z("p",null,this.t("offline.description")))):"failed"===this.roomState?z(G,null,z("div",{class:"offline-grid"},z("dyte-icon",{icon:this.iconPack.disconnected,size:"xl"}),z("h3",null,this.t("failed")),z("p",null,this.t("failed.description")))):this.showLiveStreamPlayer?z(G,null,z("dyte-livestream-player",{meeting:this.meeting,size:this.size}),z("dyte-livestream-indicator",{meeting:this.meeting,size:"sm",t:this.t}),z("dyte-viewer-count",{meeting:this.meeting,variant:"embedded",t:this.t})):this.emptyStage?z(G,null,z("div",{class:"webinar-stage"},z("div",{class:"center"},this.canCurrentPeerHost&&z("div",{class:"ctr",part:"container"},z("p",{class:"message",part:"message"},this.t("stage.empty_host")),z("span",{class:"description",part:"description"},this.t("stage.empty_host_summary"))),!this.canCurrentPeerHost&&z("div",{class:"ctr",part:"container"},z("p",{class:"message",part:"message"},this.t("stage.empty_viewer")))))):z(G,null,z(ls,{element:"dyte-grid",defaults:e,childProps:{participants:this.participants,screenShareParticipants:this.screenShareParticipants,plugins:this.plugins,pinnedParticipants:this.pinnedParticipants,aspectRatio:this.aspectRatio,gap:this.gap,layout:this.layout,gridSize:this.gridSize},onlyChildren:!0}),z("dyte-livestream-indicator",{meeting:this.meeting,size:"sm",t:this.t}),z("dyte-viewer-count",{meeting:this.meeting,variant:"embedded"}))}static get watchers(){return{meeting:["meetingChanged"],overrides:["overridesChanged"],screenShareParticipants:["screenShareParticipantsChanged"],plugins:["pluginsChanged"],pinnedParticipants:["pinnedParticipantsChanged"]}}};Eh([si()],Ph.prototype,"meeting",void 0),Eh([si()],Ph.prototype,"size",void 0),Eh([si()],Ph.prototype,"states",void 0),Eh([si()],Ph.prototype,"iconPack",void 0),Eh([si()],Ph.prototype,"t",void 0),Ph.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block;height:100%;width:100%}.offline-grid{display:flex;height:100%;width:100%;flex-direction:column;align-items:center;justify-content:center}.offline-grid h3{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);margin-left:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-0, 0px);font-size:20px;font-weight:500;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.offline-grid p{margin-top:var(--dyte-space-1, 4px);margin-bottom:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-0, 0px);text-align:center;font-size:16px;font-weight:400;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.offline-grid dyte-icon{margin-bottom:var(--dyte-space-2, 8px)}.webinar-stage{box-sizing:border-box;height:100%;display:flex;align-content:center;align-items:center;justify-content:center;text-align:center}.webinar-stage h2{margin:var(--dyte-space-0, 0px);font-weight:normal}dyte-viewer-count{display:none}.ctr{display:flex;flex-direction:column;align-items:center}.message{font-size:16px;border-radius:var(--dyte-border-radius-lg, 12px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));padding-left:var(--dyte-space-8, 32px);padding-right:var(--dyte-space-8, 32px);padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.description{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-4, 16px);font-size:14px}dyte-livestream-indicator{display:none}@media only screen and (max-device-height: 480px) and (orientation: landscape){dyte-viewer-count[variant='embedded']{position:absolute;top:var(--dyte-space-0, 0px);right:var(--dyte-space-2, 8px);z-index:20;margin-top:var(--dyte-space-0, 0px);margin-left:var(--dyte-space-0, 0px);display:flex}dyte-livestream-indicator{position:absolute;top:var(--dyte-space-0, 0px);left:var(--dyte-space-2, 8px);z-index:20;margin-top:var(--dyte-space-0, 0px);margin-left:var(--dyte-space-0, 0px);display:flex}}";var Th=Object.freeze({__proto__:null,dyte_grid:Ph});var Lh=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Ch=class{constructor(e){o(this,e),this.variant="rounded",this.iconPack=Vt,this.t=Ht(),this.page=1,this.pageCount=0,this.activeCount=0,this.activeComputedCount=0,this.showPagination=!1,this.onPageChanged=({currentPage:e,pageCount:t})=>{this.pageCount=t,this.page=e},this.toggleGridPagination=bh(()=>{var e;const{self:t,participants:i}=this.meeting,{mobile:s,desktop:a}=null===(e=t.config)||void 0===e?void 0:e.maxVideoStreams,r="sm"===this.size?s:a,n=i.joined.toArray().filter(e=>"ON_STAGE"===e.stageStatus).length;this.showPagination=!(n<r)},50),this.onParticipantJoin=bh(()=>{this.pageCount=this.meeting.participants.pageCount,this.toggleGridPagination()},50),this.onParticipantLeave=bh(()=>{this.pageCount=this.meeting.participants.pageCount,this.toggleGridPagination()},50),this.onStateStatusUpdate=bh(()=>{this.pageCount=this.meeting.participants.pageCount,this.toggleGridPagination()},50),this.prevPage=()=>{if(null==this.meeting)return;const{participants:e}=this.meeting;this.page>1?e.setPage(this.page-=1):"PAGINATED"===e.viewMode&&e.setViewMode("ACTIVE_GRID")},this.nextPage=()=>{if(null==this.meeting)return;const{participants:e}=this.meeting;this.page>0&&this.page<this.pageCount?e.setPage(this.page+=1):e.count>0&&0===this.pageCount&&e.setViewMode("PAGINATED")}}connectedCallback(){this.meetingChanged(this.meeting),this.sizeChanged()}disconnectedCallback(){if(null==this.meeting)return;const{participants:e,stage:t}=this.meeting;e.removeListener("pageChanged",this.onPageChanged),e.removeListener("viewModeChanged",this.onPageChanged),e.joined.removeListener("participantJoined",this.onParticipantJoin),e.joined.removeListener("participantLeft",this.onParticipantLeave),e.joined.removeListener("stageStatusUpdate",this.onStateStatusUpdate),t.removeListener("stageStatusUpdate",this.onStateStatusUpdate)}meetingChanged(e){if(null!=e){const{stage:t,participants:i}=e;this.page=i.currentPage,this.pageCount=i.pageCount,i.addListener("viewModeChanged",this.onPageChanged),i.addListener("pageChanged",this.onPageChanged),i.joined.addListener("participantJoined",this.onParticipantJoin),i.joined.addListener("participantLeft",this.onParticipantLeave),i.joined.addListener("stageStatusUpdate",this.onStateStatusUpdate),t.addListener("stageStatusUpdate",this.onStateStatusUpdate),this.activeCount=this.meeting.participants.joined.size,this.activeComputedCount=this.meeting.participants.joined.size,this.toggleGridPagination()}}sizeChanged(){this.toggleGridPagination()}render(){const{meta:e}=this.meeting;if(!("AUDIO_ROOM"===(null==e?void 0:e.viewType))&&this.showPagination)return z(G,null,z("dyte-button",{class:"prev",variant:"secondary",kind:"icon",disabled:0===this.pageCount,onClick:this.prevPage,"aria-label":this.t("page.prev")},z("dyte-icon",{icon:this.iconPack.chevron_left})),"grid"!==this.variant&&z("div",{class:"center"},z("span",{class:"page"},0===this.pageCount?z("dyte-tooltip",{label:this.t("layout.auto")},z("dyte-button",{kind:"icon",class:"auto"},z("dyte-icon",{icon:this.iconPack.wand}))):this.page),0!==this.pageCount&&[z("span",{class:"slash"},"/"),z("span",{class:"pages"},this.pageCount)]),"grid"===this.variant&&this.pageCount>0&&z("div",{class:"dots"},[...Array(this.pageCount)].map((e,t)=>z("div",{key:`dot-${t}`,class:{dot:!0,active:t+1===this.page}}))),z("dyte-button",{class:"next",variant:"secondary",kind:"icon",disabled:0!==this.page&&this.page===this.pageCount,onClick:this.nextPage,"aria-label":this.t("page.next")},z("dyte-icon",{icon:this.iconPack.chevron_right,tabIndex:-1,"aria-hidden":!0})))}static get watchers(){return{meeting:["meetingChanged"],size:["sizeChanged"]}}};Lh([si()],Ch.prototype,"meeting",void 0),Lh([si()],Ch.prototype,"states",void 0),Lh([si()],Ch.prototype,"size",void 0),Lh([si()],Ch.prototype,"iconPack",void 0),Lh([si()],Ch.prototype,"t",void 0),Ch.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:flex;-webkit-user-select:none;-moz-user-select:none;user-select:none;align-items:center;font-size:16px}:host([size='sm']){margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px);font-size:12px}:host([size='sm']) .center{margin-left:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-0, 0px)}:host([size='sm']) dyte-button{height:var(--dyte-space-7, 28px);width:var(--dyte-space-7, 28px)}:host([size='sm']) dyte-button dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}dyte-button{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.center{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.center .page{color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}.center .slash{margin-left:var(--dyte-space-0\\.5, 2px);margin-right:var(--dyte-space-0\\.5, 2px)}.center .pages{align-self:flex-end;font-size:12px}:host([variant='rounded']){overflow:hidden;border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}:host([variant='rounded']) dyte-button{border-radius:9999px;border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}:host([variant='rounded']) dyte-button:not([disabled]):hover{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}:host([variant='rounded']) dyte-button:not([disabled]):focus{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}:host([variant='grid']){margin-left:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-0, 0px)}:host([variant='grid']) dyte-button{position:absolute;top:50%;height:var(--dyte-space-20, 80px);width:var(--dyte-space-20, 80px);opacity:0.2;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}:host([variant='grid']) dyte-button:hover{opacity:1}:host([variant='grid']) dyte-button{transform:translateY(-50%)}:host([variant='grid']) dyte-button.prev{left:var(--dyte-space-0, 0px);border-top-right-radius:9999px;border-bottom-right-radius:9999px}:host([variant='grid']) dyte-button.next{right:var(--dyte-space-0, 0px);border-top-left-radius:9999px;border-bottom-left-radius:9999px}:host([variant='grid']) dyte-button.auto{left:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);border-top-right-radius:9999px;border-bottom-right-radius:9999px}:host([variant='grid']) .dots{position:absolute;left:50%;bottom:var(--dyte-space-3, 12px);display:flex;align-items:center;transform:translateX(-50%)}:host([variant='grid']) .dots .dot{margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-2, 8px);width:var(--dyte-space-2, 8px);cursor:pointer;border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}:host([variant='grid']) .dots .dot:last-child{margin-right:var(--dyte-space-0, 0px)}:host([variant='grid']) .dots .dot.active{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity))}:host([variant='grid'][size='sm']) dyte-button{height:var(--dyte-space-14, 56px);width:var(--dyte-space-14, 56px);opacity:0.1}";var _h=Object.freeze({__proto__:null,dyte_grid_pagination:Ch});var Ah=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Rh=class{constructor(e){o(this,e),this.variant="solid",this.disableRender=!1,this.config=Ft,this.iconPack=Vt,this.t=Ht()}render(){const e={meeting:this.meeting,config:this.config,states:this.states,t:this.t,iconPack:this.iconPack,size:this.size};return z(G,{key:"8c6d62fc6a63020885d9e367b281d584e4f86580"},!this.disableRender&&z(ls,{key:"9e0ce3f2e2eb8bebe322591cedbb243b588636ce",element:"dyte-header",defaults:e,onlyChildren:!0}),z("slot",{key:"7eef46d4d0c1bae48b3fe852cd8347aa33aa60dc"}))}};Ah([si()],Rh.prototype,"meeting",void 0),Ah([si()],Rh.prototype,"states",void 0),Ah([si()],Rh.prototype,"iconPack",void 0),Ah([si()],Rh.prototype,"t",void 0),Ah([si()],Rh.prototype,"size",void 0),Rh.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:var(--dyte-space-12, 48px);align-items:center;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px)}@media only screen and (max-device-height: 480px) and (orientation: landscape){:host{display:none !important}}@media only screen and (max-height: 480px) and (orientation: landscape){:host{display:none !important}}";var Ih=Object.freeze({__proto__:null,dyte_header:Rh});var Dh=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Mh=class{constructor(e){o(this,e),this.config=Ft,this.iconPack=Vt,this.t=Ht()}render(){return z(G,{key:"12d044e448e70b95bbaadb456a59ae322cbec4cb"},z("slot",{key:"befccedc79773180014dbd0fc9b944055f888e3d"},z("div",{key:"98c261026b266fbb8b8bdbc143aefc390f3adeb0",class:"ctr",part:"container"},z("dyte-logo",{key:"900a6cc8979009204f29b31908591319e00952ad",meeting:this.meeting,config:this.config,t:this.t,part:"logo"}),z("dyte-spinner",{key:"a9575923df832e8af9b130eee2dbd0e8fc42e181","aria-label":"Idle, waiting for meeting data",part:"spinner",iconPack:this.iconPack}))))}};Dh([si()],Mh.prototype,"meeting",void 0),Dh([si()],Mh.prototype,"iconPack",void 0),Dh([si()],Mh.prototype,"t",void 0),Mh.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{height:100%;width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.ctr{display:flex;flex-direction:column;align-items:center;gap:var(--dyte-space-8, 32px)}dyte-logo.loaded{height:var(--dyte-space-12, 48px)}dyte-spinner{height:var(--dyte-space-12, 48px);width:var(--dyte-space-12, 48px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}";var Oh=Object.freeze({__proto__:null,dyte_idle_screen:Mh});const Uh=class{constructor(e){o(this,e),this.iconPack=Vt}render(){return z(G,{key:"1822149a5a3207123a195788c5bd496a308cb5f0"},z("div",{key:"75b5ae46629ab8950e071eb3b040530ae590a687",class:"tooltip-container"},z("dyte-icon",{key:"88335152fe1f6c73e324873fb652a759017c36a1",icon:this.iconPack.info,size:"sm"}),z("div",{key:"310bb9aa766c63e64d6719bd1df11cdc1a4aa079",class:"tooltip"},z("slot",{key:"da533663227141d5a6d172b5f1e75698d3f037be",name:"tootlip-text"}))))}};!function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);r>3&&n&&Object.defineProperty(t,i,n)}([si()],Uh.prototype,"iconPack",void 0),Uh.style=":host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);cursor:pointer}.tooltip-container{position:relative;display:flex;flex-direction:row;align-items:center}.tooltip-container dyte-icon{cursor:pointer;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}.tooltip-container dyte-icon:hover+.tooltip{display:flex !important}.tooltip{position:absolute;margin-left:var(--dyte-space-2, 8px);display:none !important;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding:var(--dyte-space-2, 8px);font-weight:400;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52));z-index:50;display:flex;min-width:var(--dyte-space-60, 240px);flex-direction:column;--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);left:14px}";var $h=Object.freeze({__proto__:null,dyte_information_tooltip:Uh});var Fh=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Nh=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.iconPack=Vt,this.t=Ht(),this.leave=()=>{this.stateUpdate.emit({activeLeaveConfirmation:!0})}}render(){const e=this.t("leave");return z(G,{key:"03c911ea8de75bef21b720f64b270c06193fb35c",label:e},z("dyte-controlbar-button",{key:"9e0909fe191a3fd257d818054656fb65a318ad44",size:this.size,iconPack:this.iconPack,class:"leave red-icon",onClick:this.leave,icon:this.iconPack.call_end,label:e,variant:this.variant,part:"controlbar-button"}))}};Fh([si()],Nh.prototype,"size",void 0),Fh([si()],Nh.prototype,"iconPack",void 0),Fh([si()],Nh.prototype,"t",void 0),Nh.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";var jh=Object.freeze({__proto__:null,dyte_leave_button:Nh});var zh=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Bh=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.dyteAPIError=W(this,"dyteAPIError",7),this.variant="button",this.iconPack=Vt,this.t=Ht(),this.livestreamState="IDLE",this.livestreamStateListener=e=>{this.livestreamState=e,"LIVESTREAMING"!==e&&"IDLE"!==e||this.stateUpdate.emit({activeMoreMenu:!1})},this.isLoading=()=>null==this.meeting||"STARTING"===this.livestreamState||"STOPPING"===this.livestreamState}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.clearListeners()}meetingChanged(e){var t,i;null!=e&&(this.livestreamState=null===(t=this.meeting.livestream)||void 0===t?void 0:t.state,null===(i=this.meeting.livestream)||void 0===i||i.on("livestreamUpdate",this.livestreamStateListener))}async toggleLivestream(){var e,t;if("LIVESTREAMING"===this.livestreamState)try{await(null===(e=this.meeting.livestream)||void 0===e?void 0:e.stop())}catch(e){this.dyteAPIError.emit({trace:this.t("livestream.stop"),message:this.t("livestream.error.stop")})}else try{await(null===(t=this.meeting.livestream)||void 0===t?void 0:t.start())}catch(e){this.dyteAPIError.emit({trace:this.t("livestream.start"),message:this.t("livestream.error.start")})}}clearListeners(){var e;null===(e=this.meeting.livestream)||void 0===e||e.removeListener("livestreamUpdate",this.livestreamStateListener)}getLivestreamLabel(){switch(this.livestreamState){case"IDLE":return this.t("livestream.go_live");case"LIVESTREAMING":return this.t("livestream.end_live");case"WAITING_ON_MANUAL_INGESTION":return this.t("livestream.waiting_on_manual_ingestion");case"STARTING":return this.t("livestream.starting");case"STOPPING":return this.t("livestream.stopping");default:return this.t("livestream.error")}}getLivestreamIcon(){switch(this.livestreamState){case"IDLE":case"WAITING_ON_MANUAL_INGESTION":return this.iconPack.start_livestream;default:return this.iconPack.stop_livestream}}render(){return it(this.meeting)?z(G,null,z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,isLoading:this.isLoading(),class:{"active-livestream":"LIVESTREAMING"===this.livestreamState},onClick:()=>this.toggleLivestream(),icon:this.getLivestreamIcon(),disabled:this.isLoading(),label:this.t(this.getLivestreamLabel()),variant:this.variant})):z(G,{"data-hidden":!0})}static get watchers(){return{meeting:["meetingChanged"]}}};zh([si()],Bh.prototype,"meeting",void 0),zh([si()],Bh.prototype,"size",void 0),zh([si()],Bh.prototype,"iconPack",void 0),zh([si()],Bh.prototype,"t",void 0),Bh.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}:host([data-hidden]){display:none}";var Gh=Object.freeze({__proto__:null,dyte_livestream_toggle:Bh});var Hh=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Vh=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht()}render(){var e;const t=null===(e=this.meeting)||void 0===e?void 0:e.meta.meetingTitle;return null==t?null:z(G,{tabIndex:0,role:"banner","aria-label":t},z("dyte-tooltip",{label:t,part:"tooltip"},z("div",{class:"title",part:"title"},t)))}};Hh([si()],Vh.prototype,"meeting",void 0),Hh([si()],Vh.prototype,"iconPack",void 0),Hh([si()],Vh.prototype,"t",void 0),Vh.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-3, 12px);margin-right:var(--dyte-space-3, 12px);-webkit-user-select:none;-moz-user-select:none;user-select:none;font-size:16px;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.title{text-align:center;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}:host([size='sm']){font-size:12px}";var qh=Object.freeze({__proto__:null,dyte_meeting_title:Vh});const Kh=class{constructor(e){o(this,e),this.visibleItemsCount=20,this.estimateItemSize=100,this.iconPack=Vt,this.isFetching=!1,this.autoScroll=!0,this.totalHeight=0,this.sizes=new Map,this.lastScrollTop=0,this.scrollToBottomRetries=0,this.elementObserver=(()=>{let e=null;const t=()=>e||("undefined"!=typeof ResizeObserver?e=new ResizeObserver(e=>{e.forEach(e=>{this.measureElement(e.target,e)})}):null);return{disconnect:()=>{var e;return null===(e=t())||void 0===e?void 0:e.disconnect()},observe:e=>{var i;return null===(i=t())||void 0===i?void 0:i.observe(e,{box:"border-box"})},unobserve:e=>{var i;return null===(i=t())||void 0===i?void 0:i.unobserve(e)}}})(),this.measureElement=(e,t)=>{if(!e)return;const i=e.dataset.id;if(this.sizes.has(i))return void this.elementObserver.unobserve(e);if(t){const s=t.borderBoxSize[0];if(s&&s.blockSize>0)return this.saveItemSize(i,s.blockSize),void this.elementObserver.unobserve(e)}const s=e.getBoundingClientRect();s.height>0&&this.saveItemSize(i,s.height)},this.getVisibleItems=()=>this.messages.slice(this.range.start,this.range.end+1),this.updateVisibleItems=(e,t)=>{const i=this.messages.length;let s=e,a=t;i<=this.visibleItemsCount?(s=0,a=i-1):t-e<this.visibleItemsCount-1&&(s=this.range.end-this.visibleItemsCount+1),this.range.start!==s&&(this.range={start:s,end:a},this.totalHeight=this.getRangeSize(0,i))},this.getEstimatedItemSize=()=>this.estimateItemSize,this.getRangeSize=(e,t)=>{let i=0,s=0;for(let a=e;a<t;a++)s=this.sizes.get(this.messages[a].id),i+=s||this.getEstimatedItemSize();return i},this.getScrollTop=()=>this.$listRef?Math.ceil(this.$listRef.scrollTop):0,this.getClientHeight=()=>this.$listRef?Math.ceil(this.$listRef.clientHeight):0,this.getScrollHeight=()=>this.$listRef?Math.ceil(this.$listRef.scrollHeight):0,this.getItemsScrolled=()=>{const e=this.lastScrollTop;if(e<=0)return 0;let t=0,i=0,s=0,a=this.messages.length;for(;t<=a;){if(i=t+a>>>1,s=this.getRangeSize(0,i),s===e)return i;s<e?t=i+1:s>e&&(a=i-1)}return t>0?--t:0},this.getEndByStart=e=>Math.min(e+this.visibleItemsCount,this.messages.length-1),this.scrollToOffset=e=>{this.$listRef&&(this.$listRef.scrollTop=e)},this.scrollToIndex=e=>{if(e>=this.messages.length-1)this.scrollToBottom();else{const t=e<1?0:this.getRangeSize(0,e);this.scrollToOffset(t)}},this.scrollToBottom=()=>{this.$listEndRef&&P(()=>{this.$listEndRef.scrollIntoView(),this.getScrollHeight()-(this.getScrollTop()+this.getClientHeight())>0&&this.scrollToBottomRetries<10?setTimeout(()=>{this.scrollToBottom()},1e3/60):(this.scrollToBottomRetries=0,this.autoScroll=!0)})},this.handleScroll=async()=>{if(this.isFetching)return;const e=this.getScrollTop(),t=e<this.lastScrollTop||0===e?"UP":"DOWN";if(this.lastScrollTop=e,this.loadMore&&0===e&&"UP"===t&&!1===this.isFetching){this.isFetching=!0;const e=await this.loadMore(this.messages[0]);e&&e.length&&(this.messages=[...e,...this.messages]),this.isFetching=!1}"UP"===t?this.handleTop():"DOWN"===t&&this.handleBottom()},this.handleTop=()=>{const e=this.getItemsScrolled();if(e<=this.range.end-5&&(this.autoScroll=!1),e>this.range.start+5)return;const t=Math.max(this.range.start-5,0);this.updateVisibleItems(t,this.getEndByStart(t))},this.handleBottom=()=>{if(this.getItemsScrolled()<this.range.start+5)return;const e=this.range.start+5,t=this.getEndByStart(e);t===this.messages.length-1?this.updateVisibleItems(t-this.visibleItemsCount,t):this.updateVisibleItems(e,t)},this.updateTotalHeight=Oi(()=>{this.totalHeight=this.getRangeSize(0,this.messages.length)},1e3/30,{leading:!0}),this.rendererInternal=(e,t,i)=>{if(!e)return;if(e.dataset.id===t.id)return;const s=this.renderer(t,i);e.hasChildNodes&&(e.innerHTML=""),this.elementObserver.observe(e),e.dataset.id=t.id,e.appendChild(s)}}connectedCallback(){const e=this.messages.length-1;this.range={start:e-this.visibleItemsCount,end:e},this.updateVisibleItems(this.range.start,this.range.end),this.totalHeight=this.getRangeSize(0,e)}componentDidLoad(){this.autoScroll&&this.scrollToBottom()}messagesUpdated(e,t){if(e.length>t.length){const i=e.length-t.length;this.updateVisibleItems(i,this.getEndByStart(i)),this.scrollToIndex(this.range.start)}}saveItemSize(e,t){this.sizes.set(e,Math.round(t)),this.updateTotalHeight()}render(){return z("div",{key:"02660589d69e1290972669e40d032341aef9265f",class:"scrollbar content-wrapper",ref:e=>this.$listRef=e,onScroll:this.handleScroll},z("div",{key:"7e0741ead290cf3050001dd3990a87fa41bd00db",class:"scroller"},z("div",{key:"18a4d58c6ff888d1e11757eb4f4dd94d7f36ad42",style:{height:`${this.totalHeight}px`}}),z("div",{key:"44db5507f72fdd916e27dd1100dd34997b2c9e18",class:"smallest-dom-element",id:"list-end",ref:e=>this.$listEndRef=e})),z("div",{key:"64cb94699d06d72bf1559fa0d2c7dfff517d3c36",class:"content",style:{transform:`translateY(${this.getRangeSize(0,this.range.start)}px)`}},this.isFetching&&z("div",{key:"f55148d694e0e323882d9e2521cd9b5ef6779d3a",class:"loader"},z("dyte-spinner",{key:"84978cbf9a49e1552bdf39a5969ccf7bb152c475",size:"md"})),this.getVisibleItems().map((e,t)=>z("div",{key:e.id,ref:i=>this.rendererInternal(i,e,t)}))))}static get watchers(){return{messages:["messagesUpdated"]}}};!function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);r>3&&n&&Object.defineProperty(t,i,n)}([si()],Kh.prototype,"iconPack",void 0),Kh.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}.loading{cursor:wait}.content-wrapper{height:100%;overflow-y:auto;position:relative;contain:strict}.scroller{width:1px;opacity:0}.content{position:absolute;top:0;width:100%}.smallest-dom-element{width:100%;height:2px;background:red}.loader{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);display:flex;justify-content:center}";var Yh=Object.freeze({__proto__:null,dyte_message_list_view:Kh});var Wh=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Zh=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.audioUpdateListener=({audioEnabled:e})=>{this.audioEnabled=e},this.stageStatusListener=()=>{this.stageStatus=this.meeting.stage.status,this.canProduceAudio="ALLOWED"===this.meeting.self.permissions.canProduceAudio},this.mediaPermissionUpdateListener=({kind:e,message:t})=>{"audio"===e&&(this.micPermission=t)},this.meetingPermissionsUpdateListener=e=>{var t;(null===(t=null==e?void 0:e.media)||void 0===t?void 0:t.audio)&&(this.canProduceAudio="ALLOWED"===this.meeting.self.permissions.canProduceAudio)},this.variant="button",this.iconPack=Vt,this.t=Ht(),this.audioEnabled=!1,this.canProduceAudio=!1,this.micPermission="NOT_REQUESTED",this.stageStatus="OFF_STAGE",this.toggleMic=()=>{var e,t,i,s,a,r,n,o,d,l,c,h;if(null===(e=this.meeting)||void 0===e||e.__internals__.logger.info("dyteMicToggle::toggleMic",{media:{audio:{enabled:Boolean(null===(i=null===(t=this.meeting)||void 0===t?void 0:t.self)||void 0===i?void 0:i.audioEnabled),permission:this.micPermission,canProduce:null===(r=null===(a=null===(s=this.meeting)||void 0===s?void 0:s.self)||void 0===a?void 0:a.permissions)||void 0===r?void 0:r.canProduceAudio}},webinar:{stageStatus:null===(o=null===(n=this.meeting)||void 0===n?void 0:n.stage)||void 0===o?void 0:o.status},livestream:{stageStatus:null===(l=null===(d=this.meeting)||void 0===d?void 0:d.stage)||void 0===l?void 0:l.status},moduleExists:{self:Boolean(null===(c=this.meeting)||void 0===c?void 0:c.self)}}),this.hasPermissionError()){const e={enabled:!0,kind:"audio"};return this.stateUpdate.emit({activePermissionsMessage:e}),!1}const p=null===(h=this.meeting)||void 0===h?void 0:h.self;null!=p&&this.canProduceAudio&&(p.audioEnabled?p.disableAudio():p.enableAudio())}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e,t,i,s,a,r,n;null===(e=this.meeting)||void 0===e||e.self.removeListener("audioUpdate",this.audioUpdateListener),null===(t=this.meeting)||void 0===t||t.self.removeListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),null===(s=null===(i=this.meeting)||void 0===i?void 0:i.stage)||void 0===s||s.removeListener("stageStatusUpdate",this.stageStatusListener),null===(n=null===(r=null===(a=this.meeting)||void 0===a?void 0:a.self)||void 0===r?void 0:r.permissions)||void 0===n||n.removeListener("permissionsUpdate",this.meetingPermissionsUpdateListener)}meetingChanged(e){var t,i;if(null!=e){const{self:s,stage:a}=e;this.canProduceAudio="ALLOWED"===this.meeting.self.permissions.canProduceAudio,this.micPermission=e.self.mediaPermissions.audio||"NOT_REQUESTED",this.audioEnabled=s.audioEnabled,this.stageStatus=e.stage.status,s.addListener("audioUpdate",this.audioUpdateListener),s.addListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),null==a||a.addListener("stageStatusUpdate",this.stageStatusListener),null===(i=null===(t=e.self)||void 0===t?void 0:t.permissions)||void 0===i||i.addListener("permissionsUpdate",this.meetingPermissionsUpdateListener)}}hasPermissionError(){return"DENIED"===this.micPermission||"SYSTEM_DENIED"===this.micPermission}getState(){let e="",t="",i="",s={},a=this.hasPermissionError(),r="COULD_NOT_START"===this.micPermission;return this.audioEnabled&&!a?(t=this.t("mic_on"),i=this.iconPack.mic_on):(t=this.t("mic_off"),i=this.iconPack.mic_off,s["red-icon"]=!0),e=r?this.t("perm_could_not_start.audio"):"SYSTEM_DENIED"===this.micPermission?this.t("perm_sys_denied.audio"):"DENIED"===this.micPermission?this.t("perm_denied.audio"):this.audioEnabled?this.t("disable_mic"):this.t("enable_mic"),{tooltipLabel:e,label:t,icon:i,classList:s,showWarning:a||r,disable:a}}render(){if(!this.canProduceAudio||["OFF_STAGE","REQUESTED_TO_JOIN_STAGE"].includes(this.stageStatus))return z(G,{"data-hidden":!0});const{tooltipLabel:e,label:t,icon:i,classList:s,showWarning:a,disable:r}=this.getState();return z(G,{title:t},z("dyte-tooltip",{kind:"block",label:e,part:"tooltip"},z("dyte-controlbar-button",{part:"controlbar-button",icon:i,label:t,size:this.size,iconPack:this.iconPack,variant:this.variant,class:s,onClick:this.toggleMic,showWarning:a,disabled:r})))}static get watchers(){return{meeting:["meetingChanged"]}}};Wh([si()],Zh.prototype,"meeting",void 0),Wh([si()],Zh.prototype,"size",void 0),Wh([si()],Zh.prototype,"iconPack",void 0),Wh([si()],Zh.prototype,"t",void 0),Zh.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}:host([data-hidden]){display:none}:host(.audioDisabled) :slotted(dyte-icon){--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}";var Qh=Object.freeze({__proto__:null,dyte_mic_toggle:Zh});var Xh=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Jh=class{constructor(e){o(this,e),this.layout="row",this.participants=[],this.pinnedParticipants=[],this.screenShareParticipants=[],this.plugins=[],this.aspectRatio="16:9",this.gap=8,this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.gridSize=Sh}componentWillLoad(){this.initialised=!1,this.screenShareParticipantsChanged(this.screenShareParticipants),this.pluginsChanged(this.plugins),this.initialised=!0}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e;null===(e=this.meeting.meta)||void 0===e||e.removeListener("activeTabUpdate",this.activeTabUpdateListener)}meetingChanged(e){var t,i,s,a;null!=e&&(null!=(null===(t=e.meta)||void 0===t?void 0:t.selfActiveTab)&&this.onActiveTabUpdate(null===(i=e.meta.selfActiveTab)||void 0===i?void 0:i.type,null===(s=e.meta.selfActiveTab)||void 0===s?void 0:s.id),this.activeTabUpdateListener=e=>{this.onActiveTabUpdate(null==e?void 0:e.type,null==e?void 0:e.id)},null===(a=e.meta)||void 0===a||a.addListener("activeTabUpdate",this.activeTabUpdateListener))}screenShareParticipantsChanged(e=[]){(this.initialised||null==this.activeTab)&&(null==this.activeTab&&e.length>0?this.setActiveTab({type:"screenshare",participant:e[0]}):this.revalidateActiveTab())}pluginsChanged(e){if(this.initialised||null==this.activeTab)if(e.length>0){const t=e.length-1;this.setActiveTab({type:"plugin",plugin:e[t]})}else this.revalidateActiveTab()}revalidateActiveTab(){if(null!=this.activeTab)if("screenshare"===this.activeTab.type){const{participant:e}=this.activeTab;this.screenShareParticipants.some(t=>t.id===e.id)||this.reassignActiveTab()}else{const{plugin:e}=this.activeTab;this.plugins.some(t=>t.id===e.id)||this.reassignActiveTab()}}setActiveTab(e,t=!0){var i;this.activeTab=e;const s="screenshare"===e.type?e.participant.id:e.plugin.id;t&&(null===(i=this.meeting.meta)||void 0===i||i.setSelfActiveTab({type:e.type,id:s},0))}reassignActiveTab(){if(this.screenShareParticipants.length>0)this.setActiveTab({type:"screenshare",participant:this.screenShareParticipants[0]});else if(this.plugins.length>0){const e=this.plugins.length-1;this.setActiveTab({type:"plugin",plugin:this.plugins[e]})}}onActiveTabUpdate(e,t){if(null!=e&&null!=t)switch(e){case"plugin":const e=this.plugins.find(e=>e.id===t);null!=e&&this.setActiveTab({type:"plugin",plugin:e},!1);break;case"screenshare":const i=this.screenShareParticipants.find(e=>e.id===t);null!=i&&this.setActiveTab({type:"screenshare",participant:i},!1)}}getTabs(){const e=this.screenShareParticipants.map(e=>({type:"screenshare",participant:e})),t=this.plugins.map(e=>({type:"plugin",plugin:e}));return e.concat(t)}render(){var e,t;const i={meeting:this.meeting,config:this.config,states:this.states,size:this.size,iconPack:this.iconPack,t:this.t};return z(G,{key:"cda320d567f39a7128b5bf6fac054cf5c504e26f"},z("main",{key:"9bdea21421ca72cca011f48c7fbaa8eee1745b8f",id:"main-view",part:"main-view"},(null===(e=this.getTabs())||void 0===e?void 0:e.length)>1&&z("dyte-tab-bar",Object.assign({key:"71eb59ca8cd9ad805c372b0d9b1deecc16bcd3fe",activeTab:this.activeTab,tabs:this.getTabs(),onTabChange:e=>this.setActiveTab(e.detail)},i)),z("div",{id:"tabs",key:"tabs"},this.screenShareParticipants.map(e=>{var t,s;return z(ls,{element:"dyte-screenshare-view",defaults:i,props:{participant:e,key:e.id,style:{display:"screenshare"===(null===(t=this.activeTab)||void 0===t?void 0:t.type)&&(null===(s=this.activeTab)||void 0===s?void 0:s.participant.id)===e.id?"flex":"none"}},childProps:{participant:e,isScreenShare:!0},deepProps:!0})}),this.plugins.map(e=>{var t,s;return z("dyte-plugin-main",Object.assign({},i,{plugin:e,key:e.id,style:{display:"plugin"===(null===(t=this.activeTab)||void 0===t?void 0:t.type)&&(null===(s=this.activeTab)||void 0===s?void 0:s.plugin.id)===e.id?"flex":"none"}}))}))),z(ls,{key:"f8b8c9e7dd41eeddf98b8165f212bea6d38e9e84",element:"dyte-mixed-grid",defaults:i,childProps:{part:"participants-grid",class:this.gridSize.mixed?`grid-width-${this.gridSize.mixed}`:"grid-width-lg",participants:this.participants,pinnedParticipants:this.pinnedParticipants,screenShareParticipants:this.screenShareParticipants,plugins:this.plugins,aspectRatio:this.aspectRatio,gap:this.gap,size:"AUDIO_ROOM"===(null===(t=this.meeting.meta)||void 0===t?void 0:t.viewType)?"md":"sm",layout:"row"},onlyChildren:!0}))}get host(){return Y(this)}static get watchers(){return{meeting:["meetingChanged"],screenShareParticipants:["screenShareParticipantsChanged"],plugins:["pluginsChanged"]}}};Xh([si()],Jh.prototype,"size",void 0),Xh([si()],Jh.prototype,"meeting",void 0),Xh([si()],Jh.prototype,"states",void 0),Xh([si()],Jh.prototype,"iconPack",void 0),Xh([si()],Jh.prototype,"t",void 0),Jh.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block;height:100%;width:100%;display:flex}main{display:flex;flex:1 1 0%;padding-left:var(--dyte-space-4, 16px)}:host([layout='column']) main{padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px)}main dyte-tab-bar{margin-right:var(--dyte-space-4, 16px);box-sizing:border-box;display:flex;height:100%;width:var(--dyte-space-16, 64px);flex-direction:column}main #tabs{height:100%;flex:1 1 0%}dyte-button{z-index:10}.grid-width-sm{width:25%}.grid-width-md{width:50%}.grid-width-lg{width:66.666667%}.col{display:flex;flex-direction:column;align-items:center}.tab{display:flex;height:var(--dyte-space-16, 64px);width:var(--dyte-space-16, 64px);align-items:center;justify-content:center;margin-bottom:var(--dyte-space-2, 8px);font-size:12px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}.tab.active{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity))}.tab img{height:var(--dyte-space-7, 28px);width:var(--dyte-space-7, 28px);border-radius:var(--dyte-border-radius-sm, 4px)}:host([size='sm']){flex-direction:column}:host([size='sm']) .grid-width-lg,:host([size='sm']) .grid-width-md{height:50%;width:100%;max-width:100%}:host([size='sm']) .grid-width-sm{height:33.333333%;width:100%;max-width:100%}:host([size='sm']) main{display:flex;flex:1 1 0%;flex-direction:column;padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px)}:host([size='sm']) dyte-tab-bar{height:var(--dyte-space-12, 48px);width:100%;flex-direction:row}:host([size='sm']) #tabs{flex:1 1 0%}:host([size='sm']) .tab{margin:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-2, 8px)}:host([layout='column']){flex-direction:column}:host([layout='column']) main{display:flex;flex:1 1 0%}:host([layout='column']) .grid-width-lg,:host([layout='column']) .grid-width-md{height:50%;max-width:100%;width:100%}:host([layout='column']) .grid-width-sm{height:33.333333%;max-width:100%;width:100%}@media (orientation: portrait){:host{flex-direction:column}:host .grid-width-lg{height:50%;width:100%;max-width:100%}:host .grid-width-md{height:33.333333%;width:100%;max-width:100%}:host .grid-width-sm{height:25%;width:100%;max-width:100%}:host main{flex:1 1 0%;flex-direction:column;padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px)}:host([size='md']) main{flex:1 1 0%;flex-direction:column;padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px)}:host dyte-tab-bar{height:var(--dyte-space-16, 64px);width:100%;flex-direction:row}:host #tabs{flex:1 1 0%}:host .tab{margin:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-2, 8px)}}@media (orientation: landscape){:host{flex-direction:row}:host([size='sm']){flex-direction:row}:host .grid-width-lg{height:50%;width:100%;max-width:100%}:host([size='sm']) .grid-width-sm{height:100%;max-height:100%;width:16.666667%}:host([size='sm']) main{flex:1 1 0%;flex-direction:row;padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px)}:host([size='md']) main{flex:1 1 0%;flex-direction:row;padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px)}:host([size='sm']) dyte-tab-bar{margin-right:var(--dyte-space-2, 8px);height:100%;width:var(--dyte-space-12, 48px);flex-direction:column}:host #tabs{flex:1 1 0%}:host .tab{margin:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-2, 8px)}}";var ep=Object.freeze({__proto__:null,dyte_mixed_grid:Jh});var tp=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const ip=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.iconPack=Vt,this.t=Ht(),this.handleKeyDown=({key:e})=>{"Escape"===e&&this.stateUpdate.emit({activeMoreMenu:!1})},this.handleOnClick=e=>{!e.composedPath().includes(this.host)&&this.states.activeMoreMenu&&this.stateUpdate.emit({activeMoreMenu:!1})},this.toggleMoreMenu=()=>{this.stateUpdate.emit({activeMoreMenu:!this.states.activeMoreMenu})}}connectedCallback(){window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("click",this.handleOnClick)}disconnectedCallback(){window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("click",this.handleOnClick)}render(){const e=this.t("more");return z(G,{key:"2a5e68510ccc967fdc1c02d57f9054a23eae6642",title:e},this.states.activeMoreMenu&&z("div",{key:"67553a9e4301365cb1816d9b369fdcb57e1e36bf",class:"more-menu"},z("slot",{key:"cf06267ba8545153f4e6dc53a28eb70c3e6d4ce3",name:"more-elements"})),z("dyte-controlbar-button",{key:"d5a3897239defe9674d48a65a06ec0c1ff74620a",size:this.size,iconPack:this.iconPack,onClick:e=>{e.stopPropagation(),this.toggleMoreMenu()},icon:this.iconPack.horizontal_dots,label:e,part:"controlbar-button"}),z("slot",{key:"a628508c21b23931936ae0fd764abb35e766f228",name:"expanded"}))}get host(){return Y(this)}};tp([si()],ip.prototype,"states",void 0),tp([si()],ip.prototype,"size",void 0),tp([si()],ip.prototype,"iconPack",void 0),tp([si()],ip.prototype,"t",void 0),ip.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;flex-direction:column;overflow:visible}.more-menu{position:absolute;right:calc(var(--dyte-space-24, 96px) * -1);bottom:var(--dyte-space-16, 64px);z-index:50;margin-bottom:var(--dyte-space-3, 12px);box-sizing:border-box;max-height:60vh;width:var(--dyte-space-64, 256px);overflow:auto;border-radius:var(--dyte-border-radius-md, 8px);border-width:var(--dyte-border-width-sm, 1px);border-style:solid;--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-border-opacity));--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));outline:2px solid transparent;outline-offset:2px;display:flex;flex-direction:column;align-items:stretch}:host([size='sm']) .more-menu{bottom:var(--dyte-space-10, 40px)}.more-menu::-webkit-scrollbar{height:var(--dyte-space-0, 0px);width:var(--dyte-space-1\\.5, 6px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}.more-menu::-webkit-scrollbar-thumb{border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity))}";var sp=Object.freeze({__proto__:null,dyte_more_toggle:ip});var ap=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const rp=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.iconPack=Vt,this.t=Ht(),this.canDisable=!1,this.permissionsUpdateListener=()=>{var e;this.canDisable=!!(null===(e=this.meeting)||void 0===e?void 0:e.self.permissions.canDisableParticipantAudio)},this.onMuteAll=()=>{this.stateUpdate.emit({activeMuteAllConfirmation:!0})}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e,t,i;null===(i=null===(t=null===(e=this.meeting)||void 0===e?void 0:e.self)||void 0===t?void 0:t.permissions)||void 0===i||i.removeListener("permissionsUpdate",this.permissionsUpdateListener)}meetingChanged(e){e&&(this.canDisable=!!(null==e?void 0:e.self.permissions.canDisableParticipantAudio),e.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener))}render(){if(!this.canDisable)return null;const e=this.t("mute_all");return z(G,{title:e},z("dyte-tooltip",{kind:"block",label:e,part:"tooltip"},z("dyte-controlbar-button",{part:"controlbar-button",icon:this.iconPack.speaker_off,label:e,size:this.size,iconPack:this.iconPack,variant:this.variant,onClick:this.onMuteAll})))}static get watchers(){return{meeting:["meetingChanged"]}}};ap([si()],rp.prototype,"meeting",void 0),ap([si()],rp.prototype,"size",void 0),ap([si()],rp.prototype,"iconPack",void 0),ap([si()],rp.prototype,"t",void 0),rp.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";var np=Object.freeze({__proto__:null,dyte_mute_all_button:rp});var op=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const dp=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht(),this.isScreenShare=!1,this.score=10,this.onMediaScoreUpdate=({kind:e,isScreenshare:t,score:i})=>{("video"===e||this.isScreenShare&&t)&&(this.score=i)}}connectedCallback(){this.participantChanged(this.participant)}participantChanged(e){e&&e.addListener("mediaScoreUpdate",this.onMediaScoreUpdate)}disconnectedCallback(){var e;null===(e=this.participant)||void 0===e||e.removeListener("mediaScoreUpdate",this.onMediaScoreUpdate)}render(){let e=Math.round(this.score/2),t="good";if(e>3)return null;switch(e<1&&(e=1),e){case 3:case 2:t="poor";break;case 1:t="poorest"}return z(G,null,z("dyte-icon",{icon:this.iconPack[`signal_${e}`],class:t}),z("dyte-icon",{icon:this.iconPack.signal_5,class:"bg-signal"}))}static get watchers(){return{participant:["participantChanged"]}}};op([si()],dp.prototype,"meeting",void 0),op([si()],dp.prototype,"iconPack",void 0),op([si()],dp.prototype,"t",void 0),dp.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:block;height:var(--dyte-space-7, 28px);width:var(--dyte-space-7, 28px)}dyte-icon{position:absolute;top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);z-index:10;height:100%;width:100%;--tw-text-opacity:1;color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-text-opacity))}dyte-icon.good{--tw-text-opacity:1;color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-text-opacity))}dyte-icon.poor{--tw-text-opacity:1;color:rgba(var(--dyte-colors-warning, 255 205 7) / var(--tw-text-opacity))}dyte-icon.poorest{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}:host([size='md']){height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}:host([size='sm']){height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}.bg-signal{position:absolute;top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);z-index:0;color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}";var lp=Object.freeze({__proto__:null,dyte_network_indicator:dp});var cp=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const hp=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht(),this.participantCount=0,this.isViewer=!1,this.disconnectMeeting=e=>{null!=e&&null!=this.countListener&&(e.participants.joined.removeListener("participantJoined",this.countListener),e.participants.joined.removeListener("participantLeft",this.countListener),(null==e?void 0:e.stage)&&this.stageUpdateListener&&e.stage.removeListener("stageStatusUpdate",this.stageUpdateListener),e.self.removeListener("roomJoined",this.countListener))}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.disconnectMeeting(this.meeting)}meetingChanged(e,t){this.disconnectMeeting(t),null!=e&&(this.countListener=()=>{this.participantCount=e.participants.joined.size+(e.self.roomJoined?1:0)},this.countListener(),this.isViewer=tt(this.meeting),e.participants.joined.addListener("participantJoined",this.countListener),e.participants.joined.addListener("participantLeft",this.countListener),(null==e?void 0:e.stage)&&(this.stageUpdateListener=()=>{this.isViewer=tt(this.meeting)},null==e||e.stage.addListener("stageStatusUpdate",this.stageUpdateListener)),e.self.addListener("roomJoined",this.countListener))}render(){return this.isViewer?null:z(G,{tabIndex:0,role:"log","aria-label":`${this.participantCount} ${this.t("participants")}`},z("dyte-icon",{icon:this.iconPack.people,tabIndex:-1,"aria-hidden":!0,part:"icon"}),this.participantCount)}static get watchers(){return{meeting:["meetingChanged"]}}};cp([si()],hp.prototype,"meeting",void 0),cp([si()],hp.prototype,"iconPack",void 0),cp([si()],hp.prototype,"t",void 0),cp([si()],hp.prototype,"size",void 0),hp.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:inline-flex;height:var(--dyte-space-10, 40px);-webkit-user-select:none;-moz-user-select:none;user-select:none;align-items:center}:host([size='sm']){margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px);font-size:12px}dyte-icon{margin-right:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}:host([size='sm']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}";var pp=Object.freeze({__proto__:null,dyte_participant_count:hp});var up=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const gp=class{constructor(e){o(this,e),this.isPinned=!1,this.nameTagPosition="bottom-left",this.isPreview=!1,this.config=Ft,this.variant="solid",this.iconPack=Vt,this.t=Ht(),this.onVideoUpdate=e=>{this.videoState=e}}connectedCallback(){this.participantsChanged(this.participant)}componentDidLoad(){this.videoStateChanged(this.videoState)}disconnectedCallback(){null!=this.participant&&this.participant.removeListener("videoUpdate",this.onVideoUpdate)}async participantsChanged(e){null!=e&&(this.videoState={videoEnabled:e.videoEnabled,videoTrack:e.videoTrack},this.isPinned=e.isPinned,e.addListener("videoUpdate",this.onVideoUpdate))}videoStateChanged(e){if(null!=e&&null!=this.videoEl)if(e.videoEnabled){const t=new MediaStream;t.addTrack(e.videoTrack),this.videoEl.srcObject=t}else this.videoEl.srcObject=void 0}isMirrored(){var e;if(null!=this.participant){if("preview"in this.participant||this.isPreview){const t=this.states,i=null===(e=null==t?void 0:t.prefs)||void 0===e?void 0:e.mirrorVideo;if("boolean"==typeof i)return i}}return!1}render(){var e,t,i,s;return z(G,{key:"e9aca0a99a67a4f2fd5c7f3bd006975db783a1e9"},z("video",{key:"9e291950e6ad07c8ed37d6da2987507d5fc657e4",ref:e=>this.videoEl=e,class:{visible:null===(e=this.videoState)||void 0===e?void 0:e.videoEnabled,mirror:this.isMirrored(),[null!==(s=null===(i=null===(t=this.config)||void 0===t?void 0:t.config)||void 0===i?void 0:i.videoFit)&&void 0!==s?s:"cover"]:!0},autoPlay:!0,playsInline:!0,muted:!0}),z("slot",{key:"915126d45b8bb08844d526408132e5c259eaa950"}))}static get watchers(){return{participant:["participantsChanged"],videoState:["videoStateChanged"]}}};up([si()],gp.prototype,"states",void 0),up([si()],gp.prototype,"size",void 0),up([si()],gp.prototype,"iconPack",void 0),up([si()],gp.prototype,"t",void 0),gp.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;align-items:center;justify-content:center;aspect-ratio:16 / 9;height:var(--dyte-space-56, 224px);overflow:hidden;border-radius:var(--dyte-border-radius-lg, 12px);-webkit-user-select:none;-moz-user-select:none;user-select:none;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-video-bg, 24 24 24) / var(--tw-bg-opacity));transition-property:var(--dyte-transition-property, all);transition-duration:150ms}@media (prefers-reduced-motion){:host{--dyte-transition-property:none}}:host([size='sm'][variant='solid']) ::slotted(dyte-name-tag){left:var(--dyte-space-2, 8px);bottom:var(--dyte-space-2, 8px);height:var(--dyte-space-4, 16px)}video{display:none;position:absolute;height:100%;width:100%;border-radius:var(--dyte-border-radius-lg, 12px)}video.contain{-o-object-fit:contain;object-fit:contain}video.cover{-o-object-fit:cover;object-fit:cover}video.visible{display:block}video::-webkit-media-controls{display:none !important}:host([variant='gradient']) ::slotted(dyte-audio-visualizer){position:absolute;top:var(--dyte-space-2, 8px);right:var(--dyte-space-2, 8px);border-radius:9999px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));padding:var(--dyte-space-2, 8px)}:host([variant='gradient']) ::slotted(dyte-name-tag){bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);display:flex;width:100%;align-items:center;justify-content:center;text-align:center;background-color:transparent;background-image:linear-gradient(to top, var(--tw-gradient-stops));--tw-gradient-from:rgb(var(--dyte-colors-background-1000, 8 8 8));--tw-gradient-to:rgba(var(--dyte-colors-background-1000, 8 8 8) / 0);--tw-gradient-stops:var(--tw-gradient-from), var(--tw-gradient-to);--tw-gradient-to:transparent}video.mirror{transform:scaleX(-1)}@media (orientation: portrait){:host{height:var(--dyte-space-44, 176px)}}";var fp=Object.freeze({__proto__:null,dyte_participant_setup:gp});var mp=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const vp=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.config=Ft,this.iconPack=Vt,this.defaultParticipantsTabId="stage-list",this.t=Ht(),this.currentParticipantsTabId=this.defaultParticipantsTabId,this.tabs=[],this.hasRequests=!1,this.search="",this.updateParticipantCountsInTabs=Oi(()=>{var e;let t=(null===(e=this.meeting.participants.waitlisted)||void 0===e?void 0:e.size)||0,i=0,s=0;this.meeting.participants.joined.toArray().forEach(e=>{"ON_STAGE"===e.stageStatus&&i++,"OFF_STAGE"===e.stageStatus&&s++,"REQUESTED_TO_JOIN_STAGE"===e.stageStatus&&(t++,s++),"ACCEPTED_TO_JOIN_STAGE"===e.stageStatus&&s++}),"ON_STAGE"===this.meeting.self.stageStatus&&i++,"OFF_STAGE"===this.meeting.self.stageStatus&&s++,"REQUESTED_TO_JOIN_STAGE"===this.meeting.self.stageStatus&&(t++,s++),"ACCEPTED_TO_JOIN_STAGE"===this.meeting.self.stageStatus&&s++;const a=[];this.shouldShowRequestsTab()&&a.push({id:"requests",name:z("span",null,this.t("requests"),"",z("span",{class:`tab-participant-count-badge ${t>0?"requests-pending":""} ${"requests"===this.currentParticipantsTabId?"selected-tab":""}`},t))}),a.push({id:"stage-list",name:z("span",null,this.t("participants"),"",z("span",{class:"tab-participant-count-badge "+("stage-list"===this.currentParticipantsTabId?"selected-tab":"")},i))}),this.shouldShowViewersTab()&&a.push({id:"viewer-list",name:z("span",null,this.t("viewers"),"",z("span",{class:"tab-participant-count-badge "+("viewer-list"===this.currentParticipantsTabId?"selected-tab":"")},s))}),this.tabs=a,this.hasRequests=t>0}),this.onSearchInput=e=>{this.search=e.target.value},this.shouldShowViewersTab=()=>{var e,t,i;return null===(i=null===(t=null===(e=this.meeting)||void 0===e?void 0:e.self)||void 0===t?void 0:t.permissions)||void 0===i?void 0:i.stageEnabled},this.shouldShowRequestsTab=()=>{var e;let t=!1;return t="LIVESTREAM"!==this.meeting.meta.viewType&&((null===(e=this.meeting.self.config.waitingRoom)||void 0===e?void 0:e.isEnabled)&&this.meeting.self.permissions.acceptWaitingRequests),this.meeting.self.permissions.stageEnabled&&this.meeting.self.permissions.acceptStageRequests||t},this.viewSection=e=>{this.currentParticipantsTabId=e}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){null!=this.meeting&&(this.meeting.participants.joined.off("participantJoined",this.updateParticipantCountsInTabs),this.meeting.participants.joined.off("participantsUpdate",this.updateParticipantCountsInTabs),this.meeting.participants.joined.off("participantLeft",this.updateParticipantCountsInTabs),this.meeting.participants.joined.off("stageStatusUpdate",this.updateParticipantCountsInTabs),this.meeting.stage.off("stageStatusUpdate",this.updateParticipantCountsInTabs),this.meeting.participants.waitlisted.off("participantJoined",this.updateParticipantCountsInTabs),this.meeting.participants.waitlisted.off("participantLeft",this.updateParticipantCountsInTabs),this.meeting.participants.waitlisted.off("stageStatusUpdate",this.updateParticipantCountsInTabs))}meetingChanged(e){null!=e&&(e.participants.joined.on("participantJoined",this.updateParticipantCountsInTabs),e.participants.joined.on("participantsUpdate",this.updateParticipantCountsInTabs),e.participants.joined.on("participantLeft",this.updateParticipantCountsInTabs),e.participants.joined.on("stageStatusUpdate",this.updateParticipantCountsInTabs),e.stage.on("stageStatusUpdate",this.updateParticipantCountsInTabs),e.participants.waitlisted.on("participantJoined",this.updateParticipantCountsInTabs),e.participants.waitlisted.on("participantLeft",this.updateParticipantCountsInTabs),e.participants.waitlisted.on("stageStatusUpdate",this.updateParticipantCountsInTabs),this.updateParticipantCountsInTabs())}currentParticipantsTabIdChanged(){this.stateUpdate.emit({participantsTabId:this.currentParticipantsTabId}),this.updateParticipantCountsInTabs()}render(){const e={meeting:this.meeting,states:this.states,config:this.config,size:this.size,iconPack:this.iconPack,t:this.t};return z(G,{key:"480aec3590cdf484f086f5120938d9e8ac348ca1"},z("div",{key:"29f7064560ac5a2ad90057aa30960fbbd6f8c7ee",class:"search",part:"search"},z("dyte-icon",{key:"4abbff7265591d8283d3d092fb070426797ab803",icon:this.iconPack.search,part:"search-icon"}),z("input",{key:"959e79448af2bf197dd1c531da484278eac2693e",type:"search",autocomplete:"off",placeholder:this.t("search"),onInput:this.onSearchInput,part:"search-input"})),z("slot",{key:"6fbfacc270b0e268660ea78dacbe90a516224c43",name:"start"}),z("div",{key:"e8b7472aee6ed129ceee97abbd89f77c01f7559c",class:"ctr scrollbar "+("requests"!==this.currentParticipantsTabId?"virtualised":""),part:"container"},z("dyte-sidebar-ui",{key:"96d95ef917399340c2ba1e6271726dc213aa3b4b",tabs:this.tabs,currentTab:this.currentParticipantsTabId,view:"full-screen",hideHeader:!0,hideCloseAction:!0,style:{position:"relative"},onTabChange:e=>{this.viewSection(e.detail),e.stopPropagation()}},(!this.currentParticipantsTabId||"stage-list"===this.currentParticipantsTabId)&&z("div",{key:"d8bcf02f0f6f1f91fcb91249cc6d367e0942c9a2",slot:"stage-list",style:{marginTop:"10px",height:"100%"}},z("dyte-participants-stage-list",Object.assign({key:"a17c62efa97440dd8da28aedb81f0bde6d494da0"},e,{search:this.search,hideHeader:!0}))),"requests"===this.currentParticipantsTabId&&z("div",{key:"9241d6d585ff4c868d568c2033d3ae8b01c53180",slot:"requests",style:{marginTop:"10px",height:"100%"}},!this.hasRequests&&z("div",{key:"e68d9238c16a4dc1c97c3dc40d4620ce048e5fe3",class:"no-pending-requests"},this.t("participants.no_pending_requests")),z("dyte-participants-stage-queue",Object.assign({key:"945ffdc7578dc98d5df3fdba0dcd95e7eef22613"},e)),z("dyte-participants-waiting-list",Object.assign({key:"c88bf2ff95796fe0c8859484cb30010f85ab74be"},e))),"viewer-list"===this.currentParticipantsTabId&&z("div",{key:"63913220bfdefeaee9f3f544cd22a1192e1f4e32",slot:"viewer-list",style:{marginTop:"10px",height:"100%"}},z("dyte-participants-viewer-list",Object.assign({key:"e37f9024b4dcbb3c809cc94551de13cabea297de"},e,{search:this.search,hideHeader:!0}))))),z("slot",{key:"d69d7d91f239f0f37200279065963ae3bf4054d1",name:"end"}))}static get watchers(){return{meeting:["meetingChanged"],currentParticipantsTabId:["currentParticipantsTabIdChanged"]}}};mp([si()],vp.prototype,"meeting",void 0),mp([si()],vp.prototype,"states",void 0),mp([si()],vp.prototype,"size",void 0),mp([si()],vp.prototype,"iconPack",void 0),mp([si()],vp.prototype,"t",void 0),vp.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{display:flex;height:100%;width:100%;flex-direction:column;font-size:14px}*{box-sizing:border-box}.ctr{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);box-sizing:border-box;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);padding-top:var(--dyte-space-0, 0px);padding-bottom:var(--dyte-space-0, 0px);overflow-y:auto;flex-grow:1;flex-basis:0}.ctr.virtualised{overflow-y:hidden}.search{position:sticky;box-sizing:border-box;display:flex;align-items:center;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));margin-left:var(--dyte-space-3, 12px);margin-right:var(--dyte-space-3, 12px);margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0, 0px)}.search dyte-icon{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}.search input{box-sizing:border-box;height:var(--dyte-space-9, 36px);width:100%;padding-right:var(--dyte-space-2, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));outline:2px solid transparent;outline-offset:2px;border-radius:var(--dyte-border-radius-sm, 4px);font-size:14px}.search input::-moz-placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.search input::placeholder{color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}:host([size='md']) .search{margin-top:var(--dyte-space-4, 16px) !important;margin-bottom:var(--dyte-space-4, 16px) !important}:host([size='sm']) .search{margin-top:var(--dyte-space-4, 16px) !important;margin-bottom:var(--dyte-space-4, 16px) !important}.no-pending-requests{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-4, 16px);text-align:center;font-size:12px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}";var yp=Object.freeze({__proto__:null,dyte_participants:vp});class bp{constructor(e,t){this.meeting=e,this.audio=null!=t?t:document.createElement("audio"),this.audio.autoplay=!0,this.audioStream=new MediaStream,this.audio.srcObject=this.audioStream,this.audioTracks=[]}addTrack(e,t){this.audioTracks.some(t=>t.id===e)||(this.audioTracks.push({id:e,track:t}),this.audioStream.addTrack(t),this.play())}removeTrack(e){const t=this.audioTracks.find(t=>t.id===e);null!=t&&(this.audioStream.removeTrack(t.track),this.audioTracks=this.audioTracks.filter(t=>t.id!==e))}async play(){var e;this.audio.srcObject=this.audioStream,await(null===(e=this.audio.play())||void 0===e?void 0:e.catch(e=>{"NotAllowedError"===e.name?null!=this._onError&&this._onError():"AbortError"!==e.name&&to.error("[dyte-audio] play() error\n",e)}))}async setDevice(e){var t,i,s;ut(this.meeting)||await(null===(s=null===(i=(t=this.audio).setSinkId)||void 0===i?void 0:i.call(t,e))||void 0===s?void 0:s.catch(e=>{to.error("[dyte-audio] setSinkId() error\n",e)}))}onError(e){this._onError=e}}var wp=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const xp=class{constructor(e){o(this,e),this.dialogClose=W(this,"dialogClose",7),this.iconPack=Vt,this.t=Ht(),this.preloadedAudioElem=void 0,this.showPlayDialog=!1,this.onDyteDialogClose=()=>{this.showPlayDialog=!1,this.dialogClose.emit()}}componentDidLoad(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e;null!=this.meeting&&(this.audioUpdateListener&&this.meeting.participants.joined.removeListener("audioUpdate",this.audioUpdateListener),this.screenShareUpdateListener&&this.meeting.participants.joined.removeListener("screenShareUpdate",this.screenShareUpdateListener),this.participantLeftListener&&this.meeting.participants.joined.removeListener("participantLeft",this.participantLeftListener),this.deviceUpdateListener&&this.meeting.self.removeListener("deviceUpdate",this.deviceUpdateListener),this.stageStatusUpdateListener&&(null===(e=this.meeting.stage)||void 0===e||e.removeListener("stageStatusUpdate",this.stageStatusUpdateListener)))}async setupAudio(){this.audio=new bp(this.meeting,this.preloadedAudioElem);const e=this.meeting.self.getCurrentDevices();null!=e.speaker&&await this.audio.setDevice(e.speaker.deviceId)}async handleAutoPlayError(){this.audio||await this.setupAudio(),this.audio.onError(()=>{this.showPlayDialog=!0}),this.audio.play()}async handleEvents(e){this.audioUpdateListener=({id:e,audioEnabled:t,audioTrack:i})=>{const s=`audio-${e}`;t&&null!=i?this.audio.addTrack(s,i):this.audio.removeTrack(s)};const t=e.participants.joined.toArray();for(const e of t)this.audioUpdateListener(e);this.participantLeftListener=({id:e})=>{this.audio.removeTrack(`audio-${e}`),this.audio.removeTrack(`screenshare-${e}`)},this.screenShareUpdateListener=({id:e,screenShareEnabled:t,screenShareTracks:i})=>{const s=`screenshare-${e}`;t&&null!=i.audio?this.audio.addTrack(s,i.audio):this.audio.removeTrack(s)},this.deviceUpdateListener=({device:e,preview:t})=>{t||"audiooutput"===e.kind&&this.audio.setDevice(e.deviceId)},e.participants.joined.addListener("audioUpdate",this.audioUpdateListener),e.participants.joined.addListener("screenShareUpdate",this.screenShareUpdateListener),e.participants.joined.addListener("participantLeft",this.participantLeftListener),e.self.addListener("deviceUpdate",this.deviceUpdateListener)}async meetingChanged(e){var t;null!=e&&(this.setupAudio(),tt(e)?(this.stageStatusUpdateListener=async e=>{"ON_STAGE"===e&&await this.handleAutoPlayError()},null===(t=e.stage)||void 0===t||t.on("stageStatusUpdate",this.stageStatusUpdateListener)):await this.handleAutoPlayError(),await this.handleEvents(e))}render(){return z(G,{key:"8f75e172807ecedd630de70b5cc3e8c73aad09de"},this.showPlayDialog&&z("dyte-dialog",{key:"4770efe5ed393e2033706e983996a2b7f822feac",open:!0,onDyteDialogClose:this.onDyteDialogClose,hideCloseButton:!0,disableEscapeKey:!0,iconPack:this.iconPack,t:this.t},z("div",{key:"5c1cb440b28b8a7a3e655056a3495f1d10c7168e",class:"modal"},z("h3",{key:"c3426d43cb93374db943952d7e21ecc7ed49c6ad"},this.t("audio_playback.title")),z("p",{key:"46e1b0443fec08430c1d08556a528e2de7419708"},this.t("audio_playback.description")),z("dyte-button",{key:"99173304cfa04af361162d78993c0ccb06de3400",kind:"wide",onClick:()=>{this.audio.play(),this.onDyteDialogClose()},title:this.t("audio_playback")},this.t("audio_playback")))))}static get watchers(){return{meeting:["meetingChanged"]}}};wp([si()],xp.prototype,"meeting",void 0),wp([si()],xp.prototype,"iconPack",void 0),wp([si()],xp.prototype,"t",void 0),xp.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block;overflow-wrap:break-word;color:rgb(var(--dyte-colors-text-1000, 255 255 255));word-wrap:break-word}.modal{box-sizing:border-box;width:100%;max-width:var(--dyte-space-96, 384px);padding:var(--dyte-space-4, 16px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity))}.modal h3{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px);font-size:24px;font-weight:500}.modal p{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-6, 24px)}.modal dyte-button{width:100%}";var kp=Object.freeze({__proto__:null,dyte_participants_audio:xp});var Sp=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Ep=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.iconPack=Vt,this.t=Ht(),this.participantsActive=!1,this.waitlistedParticipants=[],this.stageRequestedParticipants=[],this.badgeCount=0,this.canViewParticipants=!1,this.updateStageRequests=async e=>{var t,i,s;e||(e=null!==(s=null===(i=null===(t=this.meeting.stage)||void 0===t?void 0:t.getAccessRequests())||void 0===i?void 0:i.stageRequests)&&void 0!==s?s:[]),this.stageRequestedParticipants=e,this.stageRequestedParticipants="REQUESTED_TO_JOIN_STAGE"===this.meeting.stage.status?[this.meeting.self,...e]:e,this.updateBadgeCount()},this.updateBadgeCount=()=>{this.badgeCount=this.waitlistedParticipants.length+this.stageRequestedParticipants.length},this.updateCanView=()=>{this.canViewParticipants=fc(this.meeting)}}connectedCallback(){this.meetingChanged(this.meeting),this.statesChanged(this.states)}disconnectedCallback(){var e,t,i;null!=this.meeting&&(null===(t=null===(e=this.meeting)||void 0===e?void 0:e.stage)||void 0===t||t.removeListener("stageStatusUpdate",this.updateCanView),this.waitlistedParticipantJoinedListener&&this.meeting.participants.waitlisted.removeListener("participantJoined",this.waitlistedParticipantJoinedListener),this.waitlistedParticipantLeftListener&&this.meeting.participants.waitlisted.removeListener("participantLeft",this.waitlistedParticipantLeftListener),null===(i=this.meeting.stage)||void 0===i||i.removeListener("stageAccessRequestUpdate",this.updateStageRequests))}meetingChanged(e){var t;null!=e&&(this.canViewParticipants=fc(e),null===(t=null==e?void 0:e.stage)||void 0===t||t.on("stageStatusUpdate",this.updateCanView),e.self.permissions.acceptWaitingRequests&&(this.waitlistedParticipants=e.participants.waitlisted.toArray(),this.waitlistedParticipantJoinedListener=e=>{this.waitlistedParticipants.some(t=>t.id===e.id)||(this.waitlistedParticipants=[...this.waitlistedParticipants,e],this.updateBadgeCount())},this.waitlistedParticipantLeftListener=e=>{this.waitlistedParticipants=this.waitlistedParticipants.filter(t=>t.id!==e.id),this.updateBadgeCount()},e.participants.waitlisted.addListener("participantJoined",this.waitlistedParticipantJoinedListener),e.participants.waitlisted.addListener("participantLeft",this.waitlistedParticipantLeftListener)),this.meeting.self.permissions.stageEnabled&&this.meeting.self.permissions.acceptStageRequests&&(this.updateStageRequests(),null==e||e.stage.on("stageAccessRequestUpdate",this.updateStageRequests)),this.updateBadgeCount())}statesChanged(e){null!=e&&(this.participantsActive=!0===e.activeSidebar&&"participants"===e.sidebar)}toggleParticipantsTab(){const e=this.states;this.participantsActive=!((null==e?void 0:e.activeSidebar)&&"participants"===(null==e?void 0:e.sidebar)),this.stateUpdate.emit({activeSidebar:this.participantsActive,sidebar:this.participantsActive?"participants":void 0,activeMoreMenu:!1,activeAI:!1})}render(){if(!this.canViewParticipants)return z(G,{"data-hidden":!0});const e=this.t("participants");return z(G,{title:e},0!==this.badgeCount&&!this.participantsActive&&z("div",{class:"waiting-participants-count",part:"waiting-participants-count"},z("span",null,this.badgeCount<=100?this.badgeCount:"99+")),z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,class:{active:this.participantsActive},onClick:()=>this.toggleParticipantsTab(),icon:this.iconPack.participants,label:e,variant:this.variant}))}static get watchers(){return{meeting:["meetingChanged"],states:["statesChanged"]}}};Sp([si()],Ep.prototype,"meeting",void 0),Sp([si()],Ep.prototype,"states",void 0),Sp([si()],Ep.prototype,"size",void 0),Sp([si()],Ep.prototype,"iconPack",void 0),Sp([si()],Ep.prototype,"t",void 0),Ep.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:block}:host([data-hidden]){display:none}.waiting-participants-count{position:absolute;right:var(--dyte-space-3, 12px);box-sizing:border-box;padding:var(--dyte-space-0\\.5, 2px);-webkit-user-select:none;-moz-user-select:none;user-select:none;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));font-size:12px;display:flex;height:var(--dyte-space-5, 20px);min-width:var(--dyte-space-5, 20px);align-items:center;justify-content:center;border-radius:9999px;z-index:1}:host([variant='horizontal']) .waiting-participants-count{right:var(--dyte-space-4, 16px);top:auto}";var Pp=Object.freeze({__proto__:null,dyte_participants_toggle:Ep});var Tp=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Lp=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.pipSupported=!1}connectedCallback(){this.meetingChanged(this.meeting)}meetingChanged(e){var t,i,s;e&&(this.pipSupported=(null===(t=e.participants.pip)||void 0===t?void 0:t.isSupported())&&(null===(i=e.self.config)||void 0===i?void 0:i.pipMode)&&"LIVESTREAM"!==(null===(s=e.self.config)||void 0===s?void 0:s.viewType))}togglePip(){this.meeting.participants.pip&&(this.meeting.participants.pip.isActive?this.meeting.participants.pip.disable():this.meeting.participants.pip.enable(),this.stateUpdate.emit({activeMoreMenu:!1}))}render(){if(!this.pipSupported)return z(G,{"data-hidden":!0});const e=this.meeting.participants.pip.isActive;return z(G,{role:"log","aria-label":"Picture-in-Picture mode"},z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,onClick:()=>this.togglePip(),icon:e?this.iconPack.pip_on:this.iconPack.pip_off,label:e?this.t("pip_off"):this.t("pip_on"),variant:this.variant}))}static get watchers(){return{meeting:["meetingChanged"]}}};Tp([si()],Lp.prototype,"meeting",void 0),Tp([si()],Lp.prototype,"states",void 0),Tp([si()],Lp.prototype,"iconPack",void 0),Tp([si()],Lp.prototype,"size",void 0),Tp([si()],Lp.prototype,"t",void 0),Lp.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}:host([data-hidden]){display:none}";var Cp=Object.freeze({__proto__:null,dyte_pip_toggle:Lp});var _p=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Ap=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.iconPack=Vt,this.t=Ht(),this.pluginsActive=!1,this.canViewPlugins=!1,this.updateCanView=()=>{this.canViewPlugins=mc(this.meeting)}}disconnectedCallback(){var e,t,i,s;null===(t=null===(e=this.meeting)||void 0===e?void 0:e.stage)||void 0===t||t.removeListener("stageStatusUpdate",this.updateCanView),null===(s=null===(i=this.meeting)||void 0===i?void 0:i.self)||void 0===s||s.permissions.removeListener("pluginsUpdate",this.updateCanView)}connectedCallback(){this.statesChanged(this.states),this.meetingChanged(this.meeting)}meetingChanged(e){var t,i;null!=e&&(this.canViewPlugins=mc(e),null===(t=null==e?void 0:e.stage)||void 0===t||t.on("stageStatusUpdate",this.updateCanView),null===(i=null==e?void 0:e.self)||void 0===i||i.permissions.addListener("pluginsUpdate",this.updateCanView))}statesChanged(e){null!=e&&(this.pluginsActive=!0===e.activeSidebar&&"plugins"===e.sidebar)}togglePlugins(){const e=this.states;this.pluginsActive=!((null==e?void 0:e.activeSidebar)&&"plugins"===(null==e?void 0:e.sidebar)),this.stateUpdate.emit({activeSidebar:this.pluginsActive,sidebar:this.pluginsActive?"plugins":void 0,activeMoreMenu:!1,activeAI:!1})}render(){if(!this.canViewPlugins)return z(G,{"data-hidden":!0});const e=this.t("plugins");return z(G,{title:e},z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,class:{active:this.pluginsActive},onClick:()=>this.togglePlugins(),icon:this.iconPack.rocket,label:e,variant:this.variant}))}static get watchers(){return{meeting:["meetingChanged"],states:["statesChanged"]}}};_p([si()],Ap.prototype,"meeting",void 0),_p([si()],Ap.prototype,"states",void 0),_p([si()],Ap.prototype,"size",void 0),_p([si()],Ap.prototype,"iconPack",void 0),_p([si()],Ap.prototype,"t",void 0),Ap.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}:host([data-hidden]){display:none}";var Rp=Object.freeze({__proto__:null,dyte_plugins_toggle:Ap});var Ip=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Dp=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.iconPack=Vt,this.t=Ht(),this.pollsActive=!1,this.unreadPollsCount=0,this.canViewPolls=!1,this.onPollsUpdate=({newPoll:e})=>{!0===e&&(this.unreadPollsCount+=1)},this.updateCanView=()=>{this.canViewPolls=gc(this.meeting)}}connectedCallback(){this.meetingChanged(this.meeting),this.statesChanged(this.states)}disconnectedCallback(){var e,t,i,s,a,r;null===(t=null===(e=this.meeting)||void 0===e?void 0:e.polls)||void 0===t||t.removeListener("pollsUpdate",this.onPollsUpdate),null===(s=null===(i=this.meeting)||void 0===i?void 0:i.self)||void 0===s||s.permissions.removeListener("pollsUpdate",this.updateCanView),null===(r=null===(a=this.meeting)||void 0===a?void 0:a.stage)||void 0===r||r.removeListener("stageStatusUpdate",this.updateCanView)}meetingChanged(e){var t,i;e&&e.polls&&(this.unreadPollsCount=e.polls.items.length,this.meeting.polls.addListener("pollsUpdate",this.onPollsUpdate),null===(t=null==e?void 0:e.self)||void 0===t||t.permissions.addListener("pollsUpdate",this.updateCanView),this.canViewPolls=gc(e),null===(i=null==e?void 0:e.stage)||void 0===i||i.on("stageStatusUpdate",this.updateCanView))}statesChanged(e){null!=e&&(this.pollsActive=!0===e.activeSidebar&&"polls"===e.sidebar)}togglePollsTab(){const e=this.states;this.unreadPollsCount=0,this.pollsActive=!((null==e?void 0:e.activeSidebar)&&"polls"===(null==e?void 0:e.sidebar)),this.stateUpdate.emit({activeSidebar:this.pollsActive,sidebar:this.pollsActive?"polls":void 0,activeMoreMenu:!1,activeAI:!1})}render(){if(!this.canViewPolls)return z(G,{"data-hidden":!0});const e=this.t("polls");return z(G,{title:e},0!==this.unreadPollsCount&&!this.pollsActive&&z("div",{class:"unread-count",part:"unread-count"},z("span",null,this.unreadPollsCount<=100?this.unreadPollsCount:"99+")),z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,class:{active:this.pollsActive},onClick:()=>this.togglePollsTab(),icon:this.iconPack.poll,label:e,variant:this.variant}))}static get watchers(){return{meeting:["meetingChanged"],states:["statesChanged"]}}};Ip([si()],Dp.prototype,"meeting",void 0),Ip([si()],Dp.prototype,"states",void 0),Ip([si()],Dp.prototype,"size",void 0),Ip([si()],Dp.prototype,"iconPack",void 0),Ip([si()],Dp.prototype,"t",void 0),Dp.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:block}:host([data-hidden]){display:none}.unread-count{position:absolute;right:var(--dyte-space-3, 12px);box-sizing:border-box;padding:var(--dyte-space-0\\.5, 2px);-webkit-user-select:none;-moz-user-select:none;user-select:none;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));font-size:12px;color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));display:flex;height:var(--dyte-space-5, 20px);min-width:var(--dyte-space-5, 20px);align-items:center;justify-content:center;border-radius:9999px;z-index:1}:host([variant='horizontal']) .unread-count{right:var(--dyte-space-4, 16px);top:auto}";var Mp=Object.freeze({__proto__:null,dyte_polls_toggle:Dp});var Op=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Up=class{constructor(e){o(this,e),this.t=Ht(),this.iconPack=Vt,this.setIsRecording=e=>{this.isRecording="RECORDING"===e}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e;null===(e=this.meeting)||void 0===e||e.recording.removeListener("recordingUpdate",this.updateRecordingStatus)}meetingChanged(e){null!=e&&(this.setIsRecording(e.recording.recordingState),this.updateRecordingStatus=e=>{this.setIsRecording(e)},e.recording.addListener("recordingUpdate",this.updateRecordingStatus))}render(){return z(G,{key:"b08cb38ca93d2db33679ac266e18063c4a2756cf"},this.isRecording&&z("div",{key:"5ba29ae19d2b338f32ec07ec2ef2662c61a7b5f9",class:"indicator","aria-label":this.t("recording.indicator"),part:"indicator"},z("dyte-icon",{key:"d2309f97e7e6f8d3f6cb62e4766b69993e32d803",icon:this.iconPack.recording,"aria-hidden":!0,tabIndex:-1,part:"icon"}),z("span",{key:"e8ddc6b7188df3f44ae0e6f3be0cdf0176cc8ebd"},this.t("recording.label"))))}static get watchers(){return{meeting:["meetingChanged"]}}};Op([si()],Up.prototype,"meeting",void 0),Op([si()],Up.prototype,"size",void 0),Op([si()],Up.prototype,"t",void 0),Op([si()],Up.prototype,"iconPack",void 0),Up.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:block}:host[size='sm']{margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px)}.indicator{display:flex;flex-direction:row;align-items:center;font-size:14px;--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}dyte-icon{margin-right:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);animation:blink 4s linear infinite}:host([size='sm']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}:host([size='sm']) .indicator span{display:none}@keyframes blink{0%,10%{opacity:0}11%,100%{opacity:1}}";var $p=Object.freeze({__proto__:null,dyte_recording_indicator:Up});var Fp=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Np=class{constructor(e){o(this,e),this.dyteAPIError=W(this,"dyteAPIError",7),this.variant="button",this.t=Ht(),this.iconPack=Vt,this.disabled=!1,this.canRecord=!1,this.permissionsUpdateListener=()=>{this.canRecord=!0===this.meeting.self.permissions.canRecord},this.toggleRecording=async()=>{var e,t,i;if(!this.isLoading()&&!this.disabled)switch(this.recordingState){case"IDLE":try{return void await(null===(e=this.meeting)||void 0===e?void 0:e.recording.start())}catch(e){this.dyteAPIError.emit({trace:this.t("recording.start"),message:this.t("recording.error.start")})}return;case"RECORDING":try{return void await(null===(t=this.meeting)||void 0===t?void 0:t.recording.stop())}catch(e){this.dyteAPIError.emit({trace:this.t("recording.stop"),message:this.t("recording.error.stop")})}return;case"PAUSED":try{return void await(null===(i=this.meeting)||void 0===i?void 0:i.recording.resume())}catch(e){this.dyteAPIError.emit({trace:this.t("recording.resume"),message:this.t("recording.error.resume")})}return;default:return}},this.isLoading=()=>null==this.meeting||"STARTING"===this.recordingState||"STOPPING"===this.recordingState}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e,t;this.recordingStateUpdateListener&&(null===(e=this.meeting)||void 0===e||e.recording.removeListener("recordingUpdate",this.recordingStateUpdateListener)),null===(t=this.meeting)||void 0===t||t.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener)}meetingChanged(e){null!=e&&(this.recordingState=e.recording.recordingState,this.permissionsUpdateListener(),this.recordingStateUpdateListener=e=>{this.recordingState=e},e.recording.addListener("recordingUpdate",this.recordingStateUpdateListener),e.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener))}getLabel(){switch(this.recordingState){case"IDLE":return"recording.idle";case"RECORDING":return"recording.stop";case"STARTING":return"recording.starting";case"STOPPING":return"recording.stopping";case"PAUSED":return"recording.resume";default:return"recording.loading"}}getIcon(){switch(this.recordingState){case"IDLE":case"STARTING":case"STOPPING":default:return this.iconPack.recording;case"RECORDING":return this.iconPack.stop_recording}}render(){if(this.canRecord)return z(G,{title:this.t("RECORDING"===this.recordingState?"recording.stop":"recording.idle")},z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,onClick:this.toggleRecording,icon:this.getIcon(),isLoading:this.isLoading(),label:this.t(this.getLabel()),variant:this.variant,disabled:this.disabled}))}static get watchers(){return{meeting:["meetingChanged"]}}};Fp([si()],Np.prototype,"meeting",void 0),Fp([si()],Np.prototype,"t",void 0),Fp([si()],Np.prototype,"iconPack",void 0),Fp([si()],Np.prototype,"size",void 0),Np.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";var jp=Object.freeze({__proto__:null,dyte_recording_toggle:Np});var zp=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Bp=()=>"undefined"!=typeof navigator&&void 0!==navigator.mediaDevices&&"getDisplayMedia"in navigator.mediaDevices,Gp=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.dyteAPIError=W(this,"dyteAPIError",7),this.variant="button",this.iconPack=Vt,this.t=Ht(),this.maxScreenShareCount=-1,this.screenShareCount=0,this.screenShareEnabled=!1,this.canScreenShare=!1,this.shareScreenPermission="NOT_REQUESTED",this.screenShareState={tooltipLabel:this.t("screenshare.start"),label:this.t("screenshare.start"),icon:this.iconPack.share_screen_start,classList:{},showWarning:!1,disable:!1},this.stageStatus="OFF_STAGE",this.screenShareListener=()=>{const e=this.meeting.participants.active.toArray().filter(e=>e.screenShareEnabled).length,t=this.meeting.self.screenShareEnabled?1:0;this.screenShareCount=e+t,this.screenShareEnabled=this.meeting.self.screenShareEnabled,this.getState(),this.meeting.__internals__.logger.info("dyteScreenShare::screenShareUpdate",{media:{screenshare:{enabled:this.screenShareEnabled,count:this.screenShareCount}}})},this.participantLeftListener=({screenShareEnabled:e})=>{e&&(this.screenShareCount=Math.max(this.screenShareCount-1,0),this.getState(),this.meeting.__internals__.logger.info("dyteScreenShare::screenShareUpdate",{media:{screenshare:{enabled:this.screenShareEnabled,count:this.screenShareCount}}}))},this.stageStatusListener=()=>{this.stageStatus=this.meeting.stage.status,this.canScreenShare="ALLOWED"===this.meeting.self.permissions.canProduceScreenshare},this.mediaPermissionUpdateListener=({kind:e,message:t})=>{if("screenshare"===e&&(this.shareScreenPermission=t,this.getState(),"COULD_NOT_START"===t&&this.dyteAPIError.emit({trace:this.t("screenshare.permissions"),message:this.t("screenshare.error.unknown")}),this.hasPermissionError())){const e={enabled:!0,kind:"screenshare"};this.stateUpdate.emit({activePermissionsMessage:e})}},this.reachedMaxScreenShares=()=>this.maxScreenShareCount>0&&this.screenShareCount>=this.maxScreenShareCount,this.toggleScreenShare=async()=>{var e;if(this.screenShareState.disable)return;if(this.hasPermissionError()){const e={enabled:!0,kind:"screenshare"};return this.stateUpdate.emit({activePermissionsMessage:e}),!1}const t=null===(e=this.meeting)||void 0===e?void 0:e.self;this.screenShareEnabled?t.disableScreenShare():null==t||!this.canScreenShare||this.reachedMaxScreenShares()||this.hasPermissionError()||(this.screenShareState=Object.assign(Object.assign({},this.screenShareState),{disable:!0}),await t.enableScreenShare(),this.screenShareState=Object.assign(Object.assign({},this.screenShareState),{disable:!1}),this.stateUpdate.emit({activeMoreMenu:!1}))}}connectedCallback(){Bp()?this.meetingChanged(this.meeting):to.error("[dyte-screenshare-toggle] Device does not support screensharing.")}disconnectedCallback(){var e,t,i,s,a,r;null===(e=this.meeting)||void 0===e||e.participants.joined.removeListener("screenShareUpdate",this.screenShareListener),null===(t=this.meeting)||void 0===t||t.participants.joined.removeListener("participantLeft",this.participantLeftListener),null===(i=this.meeting)||void 0===i||i.self.removeListener("screenShareUpdate",this.screenShareListener),null===(s=this.meeting)||void 0===s||s.self.removeListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),null===(r=null===(a=this.meeting)||void 0===a?void 0:a.stage)||void 0===r||r.removeListener("stageStatusUpdate",this.stageStatusListener)}meetingChanged(e){if(null!=e){const{self:t,stage:i}=e;this.canScreenShare="ALLOWED"===this.meeting.self.permissions.canProduceScreenshare,this.maxScreenShareCount=t.config.maxScreenShareCount,this.screenShareEnabled=t.screenShareEnabled;let s=0;for(const t of e.participants.joined.toArray())t.screenShareEnabled&&s++;this.screenShareCount=s,this.getState(),e.__internals__.logger.info("dyteScreenShare::initialise",{media:{screenshare:{enabled:this.screenShareEnabled,count:this.screenShareCount,maxAllowedCount:this.maxScreenShareCount}}}),this.stageStatus=e.stage.status,e.participants.joined.addListener("screenShareUpdate",this.screenShareListener),e.participants.joined.addListener("participantLeft",this.participantLeftListener),t.addListener("screenShareUpdate",this.screenShareListener),t.addListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),null==i||i.addListener("stageStatusUpdate",this.stageStatusListener)}}hasPermissionError(){return"SYSTEM_DENIED"===this.shareScreenPermission||"DENIED"===this.shareScreenPermission}getState(){let e="",t="",i="",s={};const a=this.hasPermissionError()&&!this.screenShareEnabled,r=this.reachedMaxScreenShares()&&!this.screenShareEnabled,n="COULD_NOT_START"===this.shareScreenPermission;this.screenShareEnabled&&!a?(t=this.t("screenshare.stop"),i=this.iconPack.share_screen_stop,s["red-icon"]=!0):(t=this.t("screenshare.start"),i=this.iconPack.share_screen_start),"SYSTEM_DENIED"===this.shareScreenPermission?(e=this.t("perm_sys_denied.screenshare"),s["red-icon"]=!0):"DENIED"===this.shareScreenPermission?(e=this.t("perm_denied.screenshare"),s["red-icon"]=!0):e=t,r&&(e=this.t("screenshare.error.max_count")),n&&(e=this.t("screenshare.error.unknown")),this.screenShareState={tooltipLabel:e,label:t,icon:i,classList:s,disable:a||r,showWarning:a||r||n}}render(){return Bp()&&this.canScreenShare&&!["OFF_STAGE","REQUESTED_TO_JOIN_STAGE"].includes(this.stageStatus)?z(G,{title:this.screenShareState.label},z("dyte-tooltip",{placement:"top",kind:"block",label:this.screenShareState.tooltipLabel,delay:600,part:"tooltip"},z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,variant:this.variant,label:this.screenShareState.label,icon:this.screenShareState.icon,class:this.screenShareState.classList,onClick:this.toggleScreenShare,disabled:this.screenShareState.disable,showWarning:this.screenShareState.showWarning}))):z(G,{"data-hidden":!0})}static get watchers(){return{meeting:["meetingChanged"]}}};zp([si()],Gp.prototype,"states",void 0),zp([si()],Gp.prototype,"meeting",void 0),zp([si()],Gp.prototype,"size",void 0),zp([si()],Gp.prototype,"iconPack",void 0),zp([si()],Gp.prototype,"t",void 0),Gp.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}:host([data-hidden]){display:none}";var Hp=Object.freeze({__proto__:null,dyte_screen_share_toggle:Gp});const Vp=e=>{null!=e&&(null!=e.requestFullscreen?e.requestFullscreen():null!=e.mozRequestFullScreen?e.mozRequestFullScreen():null!=e.webkitRequestFullscreen?e.webkitRequestFullscreen():null!=e.msRequestFullscreen&&e.msRequestFullscreen())},qp=()=>{null!=document.exitFullscreen?document.exitFullscreen():null!=document.mozExitFullScreen?document.mozExitFullScreen():null!=document.webkitExitFullscreen?document.webkitExitFullscreen():null!=document.msExitFullscreen&&document.msExitFullscreen()},Kp=()=>null!=document.fullscreenElement||null!=document.webkitCurrentFullScreenElement,Yp=()=>"undefined"!=typeof document&&(document.fullscreenEnabled||document.mozFullscreenEnabled||document.webkitFullscreenEnabled||document.msFullscreenEnabled);var Wp=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Zp=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.play=W(this,"screensharePlay",7),this.fullScreenListener=()=>{this.isFullScreen=Kp()},this.participantScreenshareUpdate=e=>{e.id===this.participant.id&&this.screenShareListener(e)},this.hideFullScreenButton=!1,this.nameTagPosition="bottom-left",this.variant="solid",this.iconPack=Vt,this.t=Ht(),this.videoExpanded=!1,this.screenShareEnabled=!1,this.isFullScreen=!1,this.toggleFullScreen=()=>{this.isFullScreen?(qp(),this.isFullScreen=!1):(Vp(this.host),this.isFullScreen=!0)}}connectedCallback(){null===window||void 0===window||window.addEventListener("fullscreenchange",this.fullScreenListener),null===window||void 0===window||window.addEventListener("webkitfullscreenchange",this.fullScreenListener)}componentDidLoad(){this.participantChanged(this.participant)}disconnectedCallback(){if(!this.meeting)return;const{self:e}=this.meeting;this.participant.id===e.id&&this.screenShareListener?this.participant.removeListener("screenShareUpdate",this.screenShareListener):this.meeting.participants.joined.removeListener("screenShareUpdate",this.participantScreenshareUpdate),null===window||void 0===window||window.removeEventListener("fullscreenchange",this.fullScreenListener),null===window||void 0===window||window.removeEventListener("webkitfullscreenchange",this.fullScreenListener)}participantChanged(e){if(null!=e&&this.meeting){const{self:t}=this.meeting;this.screenShareListener=({screenShareEnabled:e,screenShareTracks:t})=>{const i=e&&null!=t.video;if(P(()=>{this.screenShareEnabled=i}),i){const e=new MediaStream;e.addTrack(t.video),null!=this.videoEl&&(this.videoEl.srcObject=e,this.videoEl.play())}else null!=this.videoEl&&(this.videoEl.srcObject=void 0)},this.screenShareListener(e),e.id===t.id?e.addListener("screenShareUpdate",this.screenShareListener):this.meeting.participants.joined.addListener("screenShareUpdate",this.participantScreenshareUpdate)}}render(){var e,t;const i=(null===(e=this.participant)||void 0===e?void 0:e.id)===(null===(t=this.meeting)||void 0===t?void 0:t.self.id),s=this.isFullScreen?this.t("full_screen.exit"):this.t("full_screen"),a=this.isFullScreen?this.iconPack.full_screen_minimize:this.iconPack.full_screen_maximize;return z(G,{key:"1210e9acb51881828eafe0c8edcc5db51cfe67e5",class:{isSelf:i}},z("div",{key:"video-container",id:"video-container",class:{expand:this.videoExpanded}},z("video",{key:"edc1140a680fedb720626725ba33dee2c60a450f",ref:e=>this.videoEl=e,class:{visible:this.screenShareEnabled,"fit-in-container":this.participant.supportsRemoteControl},playsInline:!0,onPlay:()=>{this.play.emit({screenshareParticipant:this.participant,participant:this.meeting.self})},autoPlay:!0,muted:!0,id:`screen-share-video-${this.participant.id}`})),z("div",{id:"controls",key:"controls"},!this.hideFullScreenButton&&!i&&Yp()&&z("dyte-tooltip",{key:"5de7a66022531afd334d32119fe26c44d47871c0",label:s},z("dyte-button",{key:"1e2287ca95bf8bce3ebcd6fdfc9e601fabb8759b",id:"full-screen-btn",kind:"icon",onClick:this.toggleFullScreen,title:s},z("dyte-icon",{key:"4605f1c6eaa61d400b514da1553a3142ff377c20",icon:a,"aria-hidden":!0,tabIndex:-1})))),i&&z("div",{id:"self-message",key:"self-message"},z("h3",{key:"2e7cf4252fd106d9a86c4ecbb34d38c1b70004c8"},this.t("screenshare.shared")),z("div",{key:"56f069b3022daec515ff8b44875e7b046e075125",class:"actions"},null!=this.meeting&&z("dyte-button",{key:"b54f30fb5b44cec31f1708581220753189d9c2b5",variant:"danger",onClick:()=>{this.meeting.self.disableScreenShare()}},z("dyte-icon",{key:"cebfb5a509801fb74d1855fa0b6526f55c6e601e",icon:this.iconPack.share_screen_stop,slot:"start"}),this.t("screenshare.stop")),z("dyte-button",{key:"058c0ce2362e38b4829b31b894251d87212108c3",variant:"secondary",id:"expand-btn",onClick:()=>{this.videoExpanded=!this.videoExpanded}},z("dyte-icon",{key:"71e4ffe64eb29dcdc7963eb3131234abfecf1792",icon:this.videoExpanded?this.iconPack.full_screen_minimize:this.iconPack.full_screen_maximize,slot:"start"}),this.videoExpanded?this.t("screenshare.min_preview"):this.t("screenshare.max_preview")))),z("slot",{key:"a12bec813c857700cf57ba36968526c308be5494"}))}get host(){return Y(this)}static get watchers(){return{participant:["participantChanged"]}}};Wp([si()],Zp.prototype,"meeting",void 0),Wp([si()],Zp.prototype,"size",void 0),Wp([si()],Zp.prototype,"iconPack",void 0),Wp([si()],Zp.prototype,"t",void 0),Zp.style=":host {\n  line-height: initial;\n  font-family: var(--dyte-font-family, sans-serif);\n\n  font-feature-settings: normal;\n  font-variation-settings: normal;\n}\n\np {\n  margin: var(--dyte-space-0, 0px);\n  padding: var(--dyte-space-0, 0px);\n}\n\n\n:host {\n  height: 100%;\n  width: 100%;\n  position: relative;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  overflow: hidden;\n  border-radius: var(--dyte-border-radius-lg, 12px);\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-video-bg, 24 24 24) / var(--tw-bg-opacity));\n  container-type: inline-size;\n  container-name: screentile;\n}\n\n::slotted(dyte-name-tag) {\n  position: absolute;\n  left: var(--dyte-space-3, 12px);\n  bottom: var(--dyte-space-3, 12px);\n  opacity: 0.8;\n}\n\n#video-container {\n  position: absolute;\n  display: block;\n  height: 100%;\n  width: 100%;\n}\n\n#video-container .fit-in-container {\n  -o-object-fit: fill;\n     object-fit: fill;\n}\n\nvideo {\n  height: 100%;\n  width: 100%;\n  -o-object-fit: contain;\n     object-fit: contain;\n}\n\n:host([variant='gradient']) ::slotted(dyte-audio-visualizer) {\n  position: absolute;\n  top: var(--dyte-space-2, 8px);\n  right: var(--dyte-space-2, 8px);\n  border-radius: 9999px;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n  padding: var(--dyte-space-2, 8px);\n}\n\n:host([variant='gradient']) ::slotted(dyte-name-tag) {\n  bottom: var(--dyte-space-0, 0px);\n  left: var(--dyte-space-0, 0px);\n  display: flex;\n  width: 100%;\n  align-items: center;\n  justify-content: center;\n  text-align: center;\n  background-color: transparent;\n  background-image: linear-gradient(to top, var(--tw-gradient-stops));\n  --tw-gradient-from: rgb(var(--dyte-colors-background-1000, 8 8 8));\n  --tw-gradient-to: rgba(var(--dyte-colors-background-1000, 8 8 8) / 0);\n  --tw-gradient-stops: var(--tw-gradient-from), var(--tw-gradient-to);\n  --tw-gradient-to: transparent;\n}\n\n:host([size='sm'][variant='gradient']) ::slotted(dyte-audio-visualizer) {\n  height: var(--dyte-space-5, 20px);\n  width: var(--dyte-space-5, 20px);\n}\n\nvideo.visible {\n  animation: video-fadein 0.4s ease;\n}\n\n#controls {\n  display: none;\n  position: absolute;\n  top: var(--dyte-space-3, 12px);\n  right: var(--dyte-space-3, 12px);\n  align-items: center;\n  justify-content: flex-end;\n  gap: var(--dyte-space-2, 8px);\n}\n\n:host(:hover) #controls, \n:host(:active) #controls, \n:host(:focus-visible) #controls {\n  display: flex;\n}\n\n#full-screen-btn {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));\n}\n\n/** For self view */\n\nh3 {\n  margin-top: var(--dyte-space-10, 40px);\n  margin-bottom: var(--dyte-space-6, 24px);\n  text-align: center;\n  font-size: 20px;\n  font-weight: 500;\n}\n\n:host([size='sm']) h3 {\n  font-size: 16px;\n}\n\n#self-message {\n  padding-left: var(--dyte-space-4, 16px);\n  padding-right: var(--dyte-space-4, 16px);\n}\n\n:host(.isSelf) #self-view {\n  flex: 1 1 0%;\n}\n\n:host(.isSelf) #video-container {\n  position: static;\n  aspect-ratio: auto;\n  height: auto;\n  width: 50%;\n  max-width: var(--dyte-space-96, 384px);\n  border-radius: var(--dyte-border-radius-md, 8px);\n  transition: 0.6s ease;\n}\n\n:host(.isSelf) #video-container.expand {\n  width: 60%;\n  max-width: 100%;\n}\n\n.actions {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  gap: var(--dyte-space-2, 8px);\n}\n\n:host([size='sm'].isSelf) #video-container,\n:host([size='md'].isSelf) #video-container,\n:host([size='sm'].isSelf) #expand-btn,\n:host([size='md'].isSelf) #expand-btn {\n  /** Hide video, fullscreen buttons in sm and md breakpoints */\n  display: none;\n}\n\n/** Remote control */\n\np {\n  margin: var(--dyte-space-0, 0px);\n  padding: var(--dyte-space-0, 0px);\n}\n\n.remote-control {\n  z-index: 10;\n  height: 100%;\n  max-height: 100%;\n  flex: 0 1 auto;\n}\n\n#remote-control-self {\n  position: absolute;\n  top: var(--dyte-space-0, 0px);\n  left: 50%;\n  z-index: 10;\n  width: -moz-max-content;\n  width: max-content;\n  max-width: 100%;\n  box-sizing: border-box;\n  display: flex;\n  height: var(--dyte-space-8, 32px);\n  align-items: center;\n  overflow: hidden;\n  border-radius: var(--dyte-border-radius-sm, 4px);\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-warning, 255 205 7) / var(--tw-bg-opacity));\n  font-size: 12px;\n  color: rgb(var(--dyte-colors-text-1000, 255 255 255));\n  transform: translateX(-50%);\n}\n\n#remote-control-self p {\n  padding-left: var(--dyte-space-3, 12px);\n  padding-right: var(--dyte-space-3, 12px);\n  padding-top: var(--dyte-space-2, 8px);\n  padding-bottom: var(--dyte-space-2, 8px);\n}\n\n#remote-control-self dyte-button {\n  height: 100%;\n  border-radius: var(--dyte-border-radius-none, 0);\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-bg-opacity));\n  font-size: 12px;\n}\n\n:host([size='sm']) #remote-control-self {\n  height: auto;\n  flex-direction: column;\n}\n\n:host([size='sm']) #remote-control-self dyte-button {\n  width: 100%;\n  padding-top: var(--dyte-space-1, 4px);\n  padding-bottom: var(--dyte-space-1, 4px);\n}\n\n/** Name tag positions */\n\n:host([name-tag-position='bottom-right']) ::slotted(dyte-name-tag) {\n  left: auto;\n  right: var(--dyte-space-3, 12px);\n}\n\n:host([name-tag-position='bottom-center']) ::slotted(dyte-name-tag) {\n  left: auto;\n  right: auto;\n}\n\n:host([name-tag-position='top-left']) ::slotted(dyte-name-tag) {\n  top: var(--dyte-space-3, 12px);\n  bottom: auto;\n}\n\n:host([name-tag-position='top-right']) ::slotted(dyte-name-tag) {\n  top: var(--dyte-space-3, 12px);\n  right: var(--dyte-space-3, 12px);\n  left: auto;\n  bottom: auto;\n}\n\n:host([name-tag-position='top-center']) ::slotted(dyte-name-tag) {\n  left: auto;\n  right: auto;\n  bottom: auto;\n  top: var(--dyte-space-3, 12px);\n}\n\n/** Keyframes */\n\n@keyframes video-fadein {\n  0% {\n    opacity: 0;\n    transform: scale(1.4) translateY(20px);\n  }\n\n  100% {\n    opacity: 1;\n    transform: scale(1) translateY(0);\n  }\n}\n\n::slotted(dyte-network-indicator) {\n  position: absolute;\n  right: var(--dyte-space-3, 12px);\n  bottom: var(--dyte-space-3, 12px);\n}\n\n@media only screen and (max-height: 480px) and (orientation: landscape) {\n    :host([size='sm'][variant='solid']) ::slotted(dyte-name-tag), \n    :host([size='sm'][variant='solid']) dyte-name-tag {\n    left: var(--dyte-space-0, 0px);\n    bottom: var(--dyte-space-0, 0px);\n    border-radius: var(--dyte-border-radius-none, 0);\n      transform-origin: 0% 110%;\n      transform: scale(0.6);\n  }\n}\n\n@container screentile (max-width: 400px) {\n  ::slotted(dyte-name-tag) {\n    transform-origin: 0 130%;\n    transform: scale(0.7);\n  }\n}\n";var Qp=Object.freeze({__proto__:null,dyte_screenshare_view:Zp});var Xp=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Jp=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.iconPack=Vt,this.t=Ht()}toggleSettings(){const e={activeSettings:!0,activeMoreMenu:!1};this.states=Object.assign(Object.assign({},this.states),e),this.stateUpdate.emit(e)}render(){const e=this.t("settings");return z(G,{key:"ff76a80039b161c084cc7c81ecfc9dd35d027c6f",title:e},z("dyte-controlbar-button",{key:"893015d704381d3da5d95065b1fbed512c955614",part:"controlbar-button",size:this.size,iconPack:this.iconPack,onClick:()=>this.toggleSettings(),icon:this.iconPack.settings,label:e,variant:this.variant}))}};Xp([si()],Jp.prototype,"states",void 0),Xp([si()],Jp.prototype,"size",void 0),Xp([si()],Jp.prototype,"iconPack",void 0),Xp([si()],Jp.prototype,"t",void 0),Jp.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}";var eu=Object.freeze({__proto__:null,dyte_settings_toggle:Jp});var tu=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const iu=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.isJoining=!1,this.canEditName=!0,this.canProduceAudio=!0,this.socketStateUpdate=({state:e})=>{this.connectionState=e,"failed"===e&&(this.isJoining=!1)},this.join=async()=>{var e,t,i;if(""!==(null===(e=this.displayName)||void 0===e?void 0:e.trim())&&!this.isJoining){this.isJoining=!0,null===(t=this.meeting)||void 0===t||t.self.setName(this.displayName),Yt.setItem("dyte-display-name",this.displayName);try{await(null===(i=this.meeting)||void 0===i?void 0:i.joinRoom())}catch(e){this.isJoining=!1}}}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.meeting.meta.removeListener("socketConnectionUpdate",this.socketStateUpdate)}componentDidLoad(){var e;null===(e=this.inputEl)||void 0===e||e.focus()}meetingChanged(e){var t,i,s;e&&(this.connectionState=null===(t=e.meta.socketState)||void 0===t?void 0:t.state,this.canEditName=null===(i=e.self.permissions.canEditDisplayName)||void 0===i||i,this.displayName=(null===(s=e.self.name)||void 0===s?void 0:s.trim())||(this.canEditName?"":"Participant"),e.meta.addListener("socketConnectionUpdate",this.socketStateUpdate))}render(){var e,t,i;const s=""===(null===(e=this.displayName)||void 0===e?void 0:e.trim())||"connected"!==this.connectionState||this.isJoining,a={meeting:this.meeting,config:this.config,states:this.states,size:this.size,iconPack:this.iconPack,t:this.t};return z(G,{key:"f805e4673d4958991da4f94cac5baed927b4948d"},z("div",{key:"a024b32ac5ac3f97704d84cae68fe51fed119d11",class:"container"},z("div",{key:"548e4bd9a722ea0bb455edbbd058a88ee9ecd0bc",class:"container-tile"},z(ls,{key:"0b3d3fe938925e43b745ed63ac1ce39e96bbce2e",element:"dyte-participant-tile",defaults:a,props:{participant:null===(t=this.meeting)||void 0===t?void 0:t.self,size:"md",isPreview:!0},childProps:{participant:null===(i=this.meeting)||void 0===i?void 0:i.self,size:"md"},deepProps:!0}),z("div",{key:"eb4f5f3ed6f92930987672db94a1fe277d210680",class:"media-selectors"},z("dyte-microphone-selector",Object.assign({key:"33cb89903fa15a10cfccc9183ec1093971ce6046"},a,{variant:"inline"})),z("dyte-camera-selector",Object.assign({key:"837cc0f33046324273d01937f1db6bbd24c424c3"},a,{variant:"inline"})),z("dyte-speaker-selector",Object.assign({key:"242e5749467be68efd7e4be112e65b5cacd0d958"},a,{variant:"inline"})))),z("div",{key:"e1de333221602a950e4a44c80850b4b8cad4bc99",class:"metadata"},z("div",{key:"a0a89d93d1a64ff43b6d9a13989c14a9d42740d0",class:"name"},this.t("setup_screen.join_in_as")),z("div",{key:"4bf580ad239615e26ac13de446c9117d3398b864",class:"label"},z("div",{key:"7bcaea2d3a269b6f2f1ecd323fad3b97f94657cc",class:"name"},!this.canEditName&&ai(this.displayName,20))),this.canEditName&&z("input",{key:"dc99505703b036a9fdde33ff5ebe2da4ac68b1ff",placeholder:this.t("setup_screen.your_name"),value:this.displayName,spellcheck:!1,autoFocus:!0,ref:e=>{this.inputEl=e},onInput:e=>{this.displayName=e.target.value},onKeyDown:e=>{"Enter"===e.key&&this.join()}}),z("dyte-button",{key:"ace3c4221055be90c22576b26ac036b188712583",size:"lg",kind:"wide",onClick:this.join,disabled:s},this.isJoining?z("dyte-spinner",{iconPack:this.iconPack}):this.t("join")),"connected"!==this.connectionState&&z("div",{key:"6210c8592a6bb39479c38baa6afdb65457456eaa",class:"no-network-badge"},z("dyte-icon",{key:"bc903acf0707943acb581eb4d76c85d2b55bdd74",size:"md",variant:"danger",icon:this.iconPack.disconnected}),"failed"===this.connectionState?this.t("network.lost_extended"):this.t("network.lost")))))}static get watchers(){return{meeting:["meetingChanged"]}}};tu([si()],iu.prototype,"meeting",void 0),tu([si()],iu.prototype,"states",void 0),tu([si()],iu.prototype,"size",void 0),tu([si()],iu.prototype,"iconPack",void 0),tu([si()],iu.prototype,"t",void 0),iu.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{box-sizing:border-box;padding:var(--dyte-space-4, 16px);height:100%;min-height:100%;width:100%;display:flex;place-items:center;justify-content:center;--dyte-controlbar-button-background-color:rgb(var(--dyte-colors-background-700, 44 44 44))}.container{width:100%;max-width:1080px;display:flex;align-items:center;justify-content:space-evenly;gap:var(--dyte-space-4, 16px)}.metadata{width:100%;max-width:var(--dyte-space-80, 320px)}.label{display:flex;flex-direction:column;align-items:center;font-size:14px}.label p{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-2, 8px);display:inline-block;font-size:16px}.container-tile{display:flex;height:100%;width:100%;max-width:584px;flex-direction:column;gap:var(--dyte-space-2, 8px)}.name{margin:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-6, 24px);text-align:center;font-size:28px;font-weight:500;letter-spacing:-0.025em;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}input{margin-bottom:var(--dyte-space-6, 24px);display:block;height:var(--dyte-space-10, 40px);width:100%;max-width:var(--dyte-space-80, 320px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);color:rgb(var(--dyte-colors-text-1000, 255 255 255));box-sizing:border-box;font-size:16px;outline:2px solid transparent;outline-offset:2px;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}input::-moz-placeholder{color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}input::placeholder{color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}input{border:var(--dyte-border-width-sm, 1px) solid rgb(var(--dyte-colors-background-600, 60 60 60))}input:focus{--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-border-opacity))}dyte-spinner{color:rgb(var(--dyte-colors-text-1000, 255 255 255));--icon-size:var(--dyte-space-8, 32px)}:host([size='sm']) .container,:host([size='md']) .container{height:100%;flex-direction:column;justify-content:space-evenly}:host([size='sm']) .container-tile,:host([size='md']) .container-tile{height:-moz-min-content;height:min-content;flex-direction:column;justify-content:center}dyte-participant-tile{height:auto;width:100%;max-width:584px}.media-selectors{display:flex;flex-direction:column;justify-content:space-between}.media-selectors .row{display:grid;grid-template-columns:repeat(2, minmax(0, 1fr))}.no-network-badge{margin-top:var(--dyte-space-2, 8px);display:flex;width:100%;flex-direction:row;align-items:center;justify-content:flex-start;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));background-color:rgba(var(--dyte-colors-danger, 255 45 45) / 0.1);padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);font-size:12px;color:rgba(var(--dyte-colors-danger, 255 45 45) / 0.75)}.no-network-badge dyte-icon{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px)}";var su=Object.freeze({__proto__:null,dyte_setup_screen:iu});var au=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const ru=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.enabledSections=[],this.defaultSection="chat",this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.view="sidebar",this.currentTab=this.defaultSection,this.isFloating=!1,this.enablePinning=!0,this.getTabs=()=>this.meeting.self.config?this.enabledSections.filter(e=>this.meeting.self.config.controlBar.elements[e.id]):this.enabledSections,this.close=()=>{this.stateUpdate.emit({activeSidebar:!1,sidebar:this.defaultSection})},this.toggleFloating=()=>{this.isFloating=!this.isFloating}}connectedCallback(){var e;this.viewChanged(this.view),this.statesChanged(this.states),this.meetingChanged(this.meeting),this.isFloating=(null===(e=this.states)||void 0===e?void 0:e.sidebarFloating)||!1}disconnectedCallback(){var e,t;document.removeEventListener("keydown",this.keydownListener),null===(t=null===(e=this.meeting)||void 0===e?void 0:e.stage)||void 0===t||t.removeListener("stageStatusUpdate",this.onStageStatusUpdate),this.onStageStatusUpdate=null}meetingChanged(e){var t,i;this.updateEnabledSections(e),this.onStageStatusUpdate=e=>{this.updateEnabledSections(this.meeting)},null===(i=null===(t=this.meeting)||void 0===t?void 0:t.stage)||void 0===i||i.on("stageStatusUpdate",this.onStageStatusUpdate)}statesChanged(e){const t=e;(null==t?void 0:t.sidebar)&&(this.currentTab=t.sidebar)}viewChanged(e){"full-screen"===e?(this.enablePinning=!1,this.keydownListener=e=>{"Escape"===e.key&&this.close()},document.addEventListener("keydown",this.keydownListener)):this.enablePinning=!0}viewSection(e){this.currentTab=e,this.stateUpdate.emit({activeSidebar:!0,sidebar:this.currentTab})}updateEnabledSections(e=this.meeting){const t=[];uc(e)&&t.push({id:"chat",name:this.t("chat")}),gc(e)&&t.push({id:"polls",name:this.t("polls")}),fc(e)&&t.push({id:"participants",name:this.t("participants")}),mc(e)&&t.push({id:"plugins",name:this.t("plugins")}),this.enabledSections=t}render(){var e;const t={meeting:this.meeting,config:this.config,states:this.states,size:this.size,t:this.t,iconPack:this.iconPack};return!1!==(null===(e=t.states)||void 0===e?void 0:e.activeSidebar)&&this.currentTab?z(G,{class:this.enablePinning?this.isFloating?"floating":"":"floating"},z("dyte-sidebar-ui",{tabs:this.getTabs(),currentTab:this.currentTab,view:this.view,onTabChange:e=>{this.viewSection(e.detail)},onSidebarClose:this.close},this.enablePinning&&z("div",{class:"pinned-state",slot:"pinned-state"},z("dyte-button",{variant:"ghost",kind:"icon",onClick:this.toggleFloating,"aria-label":this.isFloating?this.t("pin"):this.t("unpin")},z("dyte-icon",{icon:this.isFloating?this.iconPack.pin:this.iconPack.pin_off}))),"chat"===t.states.sidebar&&z(ls,{element:"dyte-chat",defaults:t,props:{slot:"chat"}}),"polls"===t.states.sidebar&&z("dyte-polls",Object.assign({},t,{slot:"polls"})),"participants"===t.states.sidebar&&z(ls,{element:"dyte-participants",defaults:t,props:{slot:"participants"}}),"plugins"===t.states.sidebar&&z("dyte-plugins",Object.assign({},t,{slot:"plugins"})))):null}static get watchers(){return{meeting:["meetingChanged"],states:["statesChanged"],view:["viewChanged"]}}};au([si()],ru.prototype,"meeting",void 0),au([si()],ru.prototype,"states",void 0),au([si()],ru.prototype,"iconPack",void 0),au([si()],ru.prototype,"t",void 0),au([si()],ru.prototype,"size",void 0),ru.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{height:100%;width:100%;max-width:var(--dyte-space-96, 384px);box-sizing:border-box;display:flex;flex-direction:column;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));border-width:var(--dyte-border-width-sm, 1px);border-style:solid;--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-border-opacity))}:host([view='sidebar']){right:var(--dyte-space-2, 8px);overflow:clip;border-radius:var(--dyte-border-radius-lg, 12px);--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);--tw-shadow-color:rgb(var(--dyte-colors-background-900, 26 26 26));--tw-shadow:var(--tw-shadow-colored)}:host([view='full-screen']){top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);max-width:100%}:host(.floating){position:absolute !important;top:var(--dyte-space-0, 0px);right:var(--dyte-space-0, 0px);bottom:var(--dyte-space-0, 0px);left:var(--dyte-space-0, 0px);left:auto;z-index:50}.pinned-state{position:absolute;right:var(--dyte-space-1, 4px);display:inline-flex;width:var(--dyte-space-2, 8px);justify-content:flex-end}";var nu=Object.freeze({__proto__:null,dyte_sidebar:ru});var ou=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const du=class{constructor(e){o(this,e),this.participants=[],this.aspectRatio="16:9",this.gap=8,this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.dimensions={width:0,height:0},this.setHostDimensions=()=>{const{clientWidth:e,clientHeight:t}=this.host;this.dimensions={width:e,height:t}}}connectedCallback(){this.resizeObserver=new $r(this.setHostDimensions),this.resizeObserver.observe(this.host),this.meetingChanged(this.meeting)}meetingChanged(e){const t=null==e?void 0:e.meta;t&&(this.mediaConnection=Object.assign({},t.mediaState))}disconnectedCallback(){var e;null===(e=this.resizeObserver)||void 0===e||e.disconnect()}render(){const e={meeting:this.meeting,config:this.config,states:this.states,size:this.size,iconPack:this.iconPack,t:this.t},{width:t,height:i,getPosition:s}=xh({dimensions:this.dimensions,count:this.participants.length,aspectRatio:this.aspectRatio,gap:this.gap});return z(G,{key:"966acd8e36eb46608d9dc7aa026497b86b062be5"},z("slot",{key:"b67280589e7b5ecd630da8584ea34755400c9a33"},this.participants.map((a,r)=>{const{top:n,left:o}=s(r);return z(ls,{element:"dyte-participant-tile",defaults:e,props:{participant:a,style:{position:"absolute",top:`${n}px`,left:`${o}px`,width:`${t}px`,height:`${i}px`},key:a.id,"data-participant":a.id,mediaConnection:this.mediaConnection},childProps:{participant:a},deepProps:!0})})))}get host(){return Y(this)}static get watchers(){return{meeting:["meetingChanged"]}}};ou([si()],du.prototype,"size",void 0),ou([si()],du.prototype,"meeting",void 0),ou([si()],du.prototype,"states",void 0),ou([si()],du.prototype,"iconPack",void 0),ou([si()],du.prototype,"t",void 0),du.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:block;height:100%;width:100%}";var lu=Object.freeze({__proto__:null,dyte_simple_grid:du});var cu=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const hu=class{constructor(e){o(this,e),this.layout="row",this.participants=[],this.pinnedParticipants=[],this.aspectRatio="16:9",this.gap=8,this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.gridSize=Sh,this.getAdaptiveSize=e=>"sm"===this.size||e>3||"md"===this.size?"sm":"md"}render(){const e={meeting:this.meeting,config:this.config,states:this.states,size:this.size,iconPack:this.iconPack,t:this.t},t=this.participants.filter(e=>this.pinnedParticipants.some(t=>t.id!=e.id));return z(G,{key:"dbae02de6986b50f91073c0d3e397b0bba1b8dae"},z("main",{key:"3aab79ea8fb10a418c7e128b7825baf6ef9b9ccf",part:"main"},z(ls,{key:"a416ee3b0eef6fc99cf04bce32d88a26ee3b50c9",element:"dyte-simple-grid",defaults:e,props:{part:"main-grid",participants:this.pinnedParticipants,aspectRatio:this.aspectRatio,gap:this.gap,size:this.getAdaptiveSize(this.pinnedParticipants.length)}})),t.length>0&&z("aside",{key:"266b02b5d0737b31c573028fef1d11b820ac7e39",part:"aside",class:this.gridSize.spotlight?`grid-width-${this.gridSize.spotlight}`:"grid-width-md"},z(ls,{key:"283f6a3f085291b1b450f21f39459953a3423915",element:"dyte-simple-grid",defaults:e,props:{part:"aside-grid",participants:t,aspectRatio:this.aspectRatio,gap:this.gap,size:this.getAdaptiveSize(t.length)}})))}get host(){return Y(this)}};cu([si()],hu.prototype,"size",void 0),cu([si()],hu.prototype,"meeting",void 0),cu([si()],hu.prototype,"states",void 0),cu([si()],hu.prototype,"iconPack",void 0),cu([si()],hu.prototype,"t",void 0),hu.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:100%;width:100%}main{flex:1 1 0%}.grid-width-sm{width:25%}.grid-width-md{width:50%}.grid-width-lg{width:66.666667%}:host([size='sm']),:host([size='md']){flex-direction:column}:host([size='md']) aside{max-height:var(--dyte-space-96, 384px);width:100%;max-width:100%}:host([size='md']) .grid-width-sm{height:25%}:host([size='md']) .grid-width-md{height:50%}:host([size='md']) .grid-width-lg{height:66.666667%}:host([size='sm']) aside{max-height:var(--dyte-space-96, 384px);width:100%;max-width:100%}:host([size='sm']) .grid-width-sm,:host([size='sm']) .grid-width-md,:host([size='sm']) .grid-width-lg{height:50%}:host([size='xl']) .grid-width-sm,:host([size='xl']) .grid-width-md,:host([size='xl']) .grid-width-lg{width:400px}:host([layout='column']){flex-direction:column}:host([layout='column']) main{flex:4}:host([layout='column']) aside{flex:2;max-width:100%;width:100%}";var pu=Object.freeze({__proto__:null,dyte_spotlight_grid:hu});var uu=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const gu=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.iconPack=Vt,this.t=Ht()}render(){return z(G,{key:"4d2ff05bef43b31e74d221c715bf6e53e32b641e"},z("slot",{key:"55a21b831c9571a773707488398e113d135b6b1d"}))}};uu([si()],gu.prototype,"iconPack",void 0),uu([si()],gu.prototype,"t",void 0),gu.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block;position:relative;overflow:hidden}";var fu=Object.freeze({__proto__:null,dyte_stage:gu});var mu=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const vu=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.iconPack=Vt,this.t=Ht(),this.stageStatus="OFF_STAGE",this.state={label:"",disabled:!1,icon:""},this.stageCallback=async()=>{var e,t,i,s,a,r,n;const o=null===(e=this.meeting.stage)||void 0===e?void 0:e.status;"ON_STAGE"===o&&await(null===(i=null===(t=null==this?void 0:this.meeting)||void 0===t?void 0:t.stage)||void 0===i?void 0:i.leave()),"OFF_STAGE"===o&&(null===(a=null===(s=null==this?void 0:this.meeting)||void 0===s?void 0:s.stage)||void 0===a||a.requestAccess(),(e=>{var t,i;return(null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions.stageEnabled)&&"ALLOWED"===(null===(i=null==e?void 0:e.self)||void 0===i?void 0:i.permissions.stageAccess)})(this.meeting)&&(ii.states.activeJoinStage=!0,this.stateUpdate.emit({activeJoinStage:!0}))),"REQUESTED_TO_JOIN_STAGE"===o&&(null===(n=null===(r=null==this?void 0:this.meeting)||void 0===r?void 0:r.stage)||void 0===n||n.cancelRequestAccess())}}connectedCallback(){this.meetingChanged(this.meeting)}stageStatusHandler(e,t){this.stageStatus=t,"ACCEPTED_TO_JOIN_STAGE"===t&&(e.self.setupTracks({audio:!1,video:!1}),this.stateUpdate.emit({activeJoinStage:!0})),this.state=this.getState()}disconnectedCallback(){var e,t;null===(t=null===(e=this.meeting)||void 0===e?void 0:e.stage)||void 0===t||t.removeListener("stageStatusUpdate",e=>this.stageStatusHandler(this.meeting,e))}meetingChanged(e){var t,i,s,a;null!=e&&(this.stageStatus=null===(t=e.stage)||void 0===t?void 0:t.status,this.stageStatusHandler(e,null===(i=e.stage)||void 0===i?void 0:i.status),null===(a=null===(s=this.meeting)||void 0===s?void 0:s.stage)||void 0===a||a.on("stageStatusUpdate",t=>this.stageStatusHandler(e,t)))}getState(){let e="",t="",i=!1;switch(this.stageStatus){case"ON_STAGE":t=this.iconPack.leave_stage,e=this.t("stage_request.leave_stage"),i=!1;break;case"ACCEPTED_TO_JOIN_STAGE":t=this.iconPack.join_stage,e=this.t("stage_request.request"),i=!0;break;case"REQUESTED_TO_JOIN_STAGE":t=this.iconPack.join_stage,e=this.t("stage_request.requested"),i=!1;break;default:t=this.iconPack.join_stage,e=this.t("stage_request.request"),i=!1}return{label:e,disabled:i,icon:t}}render(){return e=this.meeting,(null===(t=null==e?void 0:e.self)||void 0===t?void 0:t.permissions.stageEnabled)&&"NOT_ALLOWED"!==(null===(i=null==e?void 0:e.self)||void 0===i?void 0:i.permissions.stageAccess)?z(G,{title:this.state.label},z("dyte-tooltip",{placement:"top",kind:"block",label:this.state.label,delay:600,part:"tooltip"},z("dyte-controlbar-button",{part:"controlbar-button",size:this.size,iconPack:this.iconPack,variant:this.variant,label:this.state.label,icon:this.state.icon,onClick:this.stageCallback,disabled:this.state.disabled,showWarning:!1}))):z(G,{"data-hidden":!0});var e,t,i}static get watchers(){return{meeting:["meetingChanged"]}}};mu([si()],vu.prototype,"meeting",void 0),mu([si()],vu.prototype,"size",void 0),mu([si()],vu.prototype,"iconPack",void 0),mu([si()],vu.prototype,"states",void 0),mu([si()],vu.prototype,"t",void 0),vu.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}:host([data-hidden]){display:none}";var yu=Object.freeze({__proto__:null,dyte_stage_toggle:vu});const bu=Ls(ui,"WeakMap");const wu=Ws(Object.keys,Object);var xu=Object.prototype.hasOwnProperty;function ku(e){return da(e)?Ta(e):function(e){if(!Xs(e))return wu(e);var t=[];for(var i in Object(e))xu.call(e,i)&&"constructor"!=i&&t.push(i);return t}(e)}var Su=Object.prototype.propertyIsEnumerable,Eu=Object.getOwnPropertySymbols,Pu=Eu?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var i=-1,s=null==e?0:e.length,a=0,r=[];++i<s;){var n=e[i];t(n,i,e)&&(r[a++]=n)}return r}(Eu(e),function(t){return Su.call(e,t)}))}:function(){return[]};const Tu=Pu;function Lu(e){return function(e,t,i){var s=t(e);return na(e)?s:function(e,t){for(var i=-1,s=t.length,a=e.length;++i<s;)e[a+i]=t[i];return e}(s,i(e))}(e,ku,Tu)}const Cu=Ls(ui,"DataView");const _u=Ls(ui,"Promise");const Au=Ls(ui,"Set");var Ru="[object Map]",Iu="[object Promise]",Du="[object Set]",Mu="[object WeakMap]",Ou="[object DataView]",Uu=bs(Cu),$u=bs(Cs),Fu=bs(_u),Nu=bs(Au),ju=bs(bu),zu=xi;(Cu&&zu(new Cu(new ArrayBuffer(1)))!=Ou||Cs&&zu(new Cs)!=Ru||_u&&zu(_u.resolve())!=Iu||Au&&zu(new Au)!=Du||bu&&zu(new bu)!=Mu)&&(zu=function(e){var t=xi(e),i="[object Object]"==t?e.constructor:void 0,s=i?bs(i):"";if(s)switch(s){case Uu:return Ou;case $u:return Ru;case Fu:return Iu;case Nu:return Du;case ju:return Mu}return t});const Bu=zu;var Gu=Object.prototype.hasOwnProperty;var Hu=/\w*$/;var Vu=gi?gi.prototype:void 0,qu=Vu?Vu.valueOf:void 0;function Ku(e,t,i){var s,a,r,n,o,d=e.constructor;switch(t){case"[object ArrayBuffer]":return Vs(e);case"[object Boolean]":case"[object Date]":return new d(+e);case"[object DataView]":return o=Vs((n=e).buffer),new n.constructor(o,n.byteOffset,n.byteLength);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return qs(e,i);case"[object Map]":case"[object Set]":return new d;case"[object Number]":case"[object String]":return new d(e);case"[object RegExp]":return(r=new(a=e).constructor(a.source,Hu.exec(a))).lastIndex=a.lastIndex,r;case"[object Symbol]":return s=e,qu?Object(qu.call(s)):{}}}var Yu=ya&&ya.isMap;const Wu=Yu?ga(Yu):function(e){return Si(e)&&"[object Map]"==Bu(e)};var Zu=ya&&ya.isSet;const Qu=Zu?ga(Zu):function(e){return Si(e)&&"[object Set]"==Bu(e)};var Xu="[object Arguments]",Ju="[object Function]",eg="[object Object]",tg={};function ig(e,t,i,s,a,r){var n,o=1&t;if(void 0!==n)return n;if(!ki(e))return e;var d=na(e);if(d)n=function(e){var t=e.length,i=new e.constructor(t);return t&&"string"==typeof e[0]&&Gu.call(e,"index")&&(i.index=e.index,i.input=e.input),i}(e);else{var l=Bu(e),c=l==Ju||"[object GeneratorFunction]"==l;if(pa(e))return Gs(e,o);if(l==eg||l==Xu||c&&!a)n=c?{}:Js(e);else{if(!tg[l])return a?e:{};n=Ku(e,l,o)}}r||(r=new Os);var h=r.get(e);if(h)return h;r.set(e,n),Qu(e)?e.forEach(function(s){n.add(ig(s,t,i,s,e,r))}):Wu(e)&&e.forEach(function(s,a){n.set(a,ig(s,t,i,a,e,r))});var p=d?void 0:Lu(e);return function(e,t){for(var i=-1,s=null==e?0:e.length;++i<s&&!1!==t(e[i],i,e););}(p||e,function(s,a){p&&(s=e[a=s]),ka(n,a,ig(s,t,i,a,e,r))}),n}tg[Xu]=tg["[object Array]"]=tg["[object ArrayBuffer]"]=tg["[object DataView]"]=tg["[object Boolean]"]=tg["[object Date]"]=tg["[object Float32Array]"]=tg["[object Float64Array]"]=tg["[object Int8Array]"]=tg["[object Int16Array]"]=tg["[object Int32Array]"]=tg["[object Map]"]=tg["[object Number]"]=tg[eg]=tg["[object RegExp]"]=tg["[object Set]"]=tg["[object String]"]=tg["[object Symbol]"]=tg["[object Uint8Array]"]=tg["[object Uint8ClampedArray]"]=tg["[object Uint16Array]"]=tg["[object Uint32Array]"]=!0,tg["[object Error]"]=tg[Ju]=tg["[object WeakMap]"]=!1;function sg(e){return structuredClone?structuredClone(e):ig(e,5)}var ag=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const rg=class{constructor(e){o(this,e),this.config=Ft,this.t=Ht(),this.transcripts=[],this.listenerAttached=!1,this.onTranscript=e=>{e.transcript&&this.add(e)}}connectedCallback(){this.meetingChanged(this.meeting)}addListener(e){var t;null===(t=null==e?void 0:e.ai)||void 0===t||t.addListener("transcript",this.onTranscript),this.listenerAttached=!0}clearListeners(e){var t;this.onTranscript&&(null===(t=null==e?void 0:e.ai)||void 0===t||t.removeListener("transcript",this.onTranscript)),this.listenerAttached=!1,clearTimeout(this.disconnectTimeout),this.transcripts=[]}disconnectedCallback(){null!=this.meeting&&this.clearListeners(this.meeting)}meetingChanged(e,t){clearTimeout(this.disconnectTimeout),void 0!==t&&this.clearListeners(t),null!=e&&this.states.activeCaptions&&this.addListener(e)}statesChanged(e){e&&(e.activeCaptions&&!this.listenerAttached&&this.addListener(this.meeting),!e.activeCaptions&&this.listenerAttached&&this.clearListeners(this.meeting))}transcriptionsReducer(e,t){if(!e.length)return[t];let i=e[e.length-1];return i.peerId!==t.peerId?e.concat(t):i.id===t.id?(i.transcript=t.transcript,e.pop(),e.concat(sg(i))):e.concat(t)}add(e){this.transcripts=this.transcriptionsReducer(this.transcripts,e)}remove(e){this.transcripts=this.transcripts.filter(t=>t.renderedId!==e)}handleDismiss(e){e.stopPropagation();const{id:t,renderedId:i}=e.detail,s=this.host.shadowRoot.querySelector(`[data-id="${t}"]`);null==s||s.classList.add("exit"),setTimeout(()=>{P(()=>{this.remove(i)})},400)}renderTranscripts(){const e=[];return this.transcripts.forEach(t=>{const i={name:t.name,date:t.date,peerId:t.peerId,transcript:t.transcript,id:t.id,renderedId:t.id};if(!e.length)return t.renderedId=i.renderedId,void e.push(i);const s=e[e.length-1];if(s.transcript.length+i.transcript.length>400||s.peerId!==t.peerId)return t.renderedId=i.renderedId,void e.push(i);s.transcript+=" "+t.transcript,t.renderedId=s.renderedId}),e.splice(0,e.length-2),null==e?void 0:e.map(e=>z("dyte-transcript",{key:e.id,"data-id":e.id,transcript:e,onDyteTranscriptDismiss:e=>this.handleDismiss(e),t:this.t}))}render(){if(this.states.activeCaptions)return z(G,null,this.renderTranscripts())}get host(){return Y(this)}static get watchers(){return{meeting:["meetingChanged"],states:["statesChanged"]}}};ag([si()],rg.prototype,"meeting",void 0),ag([si()],rg.prototype,"states",void 0),ag([si()],rg.prototype,"t",void 0),rg.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:absolute;top:var(--dyte-space-4, 16px);right:var(--dyte-space-4, 16px);bottom:var(--dyte-space-4, 16px);left:var(--dyte-space-4, 16px);top:auto;display:flex;flex-direction:column;pointer-events:none;justify-content:center;width:100%;z-index:5}dyte-transcript{margin-top:var(--dyte-space-2, 8px)}";var ng=Object.freeze({__proto__:null,dyte_transcripts:rg});const og=class{constructor(e){o(this,e),this.statesUpdate=W(this,"dyteStatesUpdate",7),this.config=Ft,this.showSetupScreen=!1,this.noRenderUntilMeeting=!1,this.handleResize=()=>{this.size=fr(this.host.clientWidth)},this.loadTheme=()=>{var e;if(this.config===Ft){const{config:e}=pr(this.meeting.self.config,this.meeting);this.config=e}(null===(e=this.config)||void 0===e?void 0:e.designTokens)&&Na(document.documentElement,this.config.designTokens)},this.roomJoinedListener=()=>{this.updateStates({meeting:"joined"})},this.waitlistedListener=()=>{this.updateStates({meeting:"waiting"})},this.roomLeftListener=({state:e})=>{"disconnected"!==e&&"failed"!==e&&this.updateStates({meeting:"ended",roomLeftState:e})},this.mediaPermissionUpdateListener=({kind:e,message:t})=>{if(["audio","video"].includes(e)&&("DENIED"===t||"SYSTEM_DENIED"===t)&&!0!==ii.states.activeDebugger){const t={enabled:!0,kind:e};this.updateStates({activePermissionsMessage:t})}},this.socketConnectionUpdateListener=({state:e})=>{"failed"===e&&setTimeout(()=>{this.meeting.leave("disconnected")},1e4)},this.handleChangingMeeting=e=>{this.updateStates({activeBreakoutRoomsManager:Object.assign(Object.assign({},ii.states.activeBreakoutRoomsManager),{destinationMeetingId:e})})}}listenState(e){this.updateStates(e.detail)}updateStates(e){const t=Object.assign({},ii.states);ii.states=hr(t,e),this.statesUpdate.emit(ii.states)}connectedCallback(){"undefined"!=typeof window&&(this.authErrorListener=e=>{e.detail.message.includes("401")&&this.updateStates({meeting:"ended",roomLeftState:"unauthorized"})},window.addEventListener("dyteError",this.authErrorListener)),this.onMeetingChange(this.meeting),this.onIconPackChange(this.iconPack),this.onTChange(this.t),this.onConfigChange(this.config),this.onSizeChange(this.size),this.resizeObserver=new ResizeObserver(()=>this.handleResize()),this.resizeObserver.observe(this.host)}disconnectedCallback(){this.resizeObserver.disconnect(),window.removeEventListener("dyteError",this.authErrorListener),this.meeting&&(this.meeting.self.removeListener("roomLeft",this.roomLeftListener),this.meeting.self.removeListener("roomJoined",this.roomJoinedListener),this.meeting.self.removeListener("waitlisted",this.waitlistedListener),this.meeting.self.removeListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),this.meeting.meta.removeListener("socketConnectionUpdate",this.socketConnectionUpdateListener))}onMeetingChange(e){ei.state.meeting=e,e&&(this.updateStates({viewType:e.meta.viewType}),this.loadTheme(),e.self.addListener("roomJoined",this.roomJoinedListener),e.self.addListener("waitlisted",this.waitlistedListener),e.self.addListener("roomLeft",this.roomLeftListener),e.self.addListener("mediaPermissionUpdate",this.mediaPermissionUpdateListener),e.meta.addListener("socketConnectionUpdate",this.socketConnectionUpdateListener),e.connectedMeetings.supportsConnectedMeetings&&e.connectedMeetings.once("changingMeeting",this.handleChangingMeeting),e.self.roomJoined?this.updateStates({meeting:"joined"}):this.showSetupScreen?this.updateStates({meeting:"setup"}):e.joinRoom(),window.removeEventListener("dyteError",this.authErrorListener))}onIconPackChange(e){ei.state.iconPack=e}onTChange(e){ei.state.t=e}onConfigChange(e){ei.state.config=e}onSizeChange(e){ei.state.size=e}render(){return z(G,{key:"aa4172c4b0395a5262697346a2731c1829edb369"},this.noRenderUntilMeeting&&!this.meeting?null:z("slot",null))}get host(){return Y(this)}static get watchers(){return{meeting:["onMeetingChange"],iconPack:["onIconPackChange"],t:["onTChange"],config:["onConfigChange"],size:["onSizeChange"]}}};og.style="dyte-ui-provider{display:block;width:100%;height:100%}";var dg=Object.freeze({__proto__:null,dyte_ui_provider:og});var lg=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const cg=class{constructor(e){o(this,e),this.config=Ft,this.iconPack=Vt,this.t=Ht()}render(){return z(G,{key:"7e6180f1f8736c28f6c8d0f759842074fc416728"},z("slot",{key:"8ebb3469c20b95313774ff0b1c06f9d02d37362d"},z("div",{key:"e560017916361b842850493abfbf5967b4e61b4b",class:"centered",part:"content"},z("dyte-logo",{key:"39005a67f41efa0d1a345c6208154877afd4d177",meeting:this.meeting,config:this.config,part:"logo",t:this.t}),z("p",{key:"144ae6b75e5f856759ca6aa35b30af1de75d398d"},this.t("waitlist.body_text")))))}};lg([si()],cg.prototype,"meeting",void 0),lg([si()],cg.prototype,"iconPack",void 0),lg([si()],cg.prototype,"t",void 0),cg.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{height:100%;width:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.centered{display:flex;flex-direction:column;align-items:center}dyte-logo{margin-bottom:var(--dyte-space-8, 32px);height:var(--dyte-space-12, 48px)}p{font-size:16px;border-radius:var(--dyte-border-radius-lg, 12px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));padding-left:var(--dyte-space-8, 32px);padding-right:var(--dyte-space-8, 32px);padding-top:var(--dyte-space-4, 16px);padding-bottom:var(--dyte-space-4, 16px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}";var hg=Object.freeze({__proto__:null,dyte_waiting_screen:cg});var pg=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const ug=class{constructor(e){o(this,e),this.participantQuery="",this.isProcessing=!1,this.t=Ht(),this.transcriptions=[],this.autoScrollEnabled=!0,this.onScroll=e=>{const{scrollTop:t,clientHeight:i,scrollHeight:s}=e.target,a=t+i;this.autoScrollEnabled=a+10>=s},this.onTranscriptHandler=e=>{this.transcriptions=this.transcriptionsReducer(this.transcriptions,e)}}transcriptionsReducer(e,t){if(!e.length||e[e.length-1].peerId!==t.peerId)return e.concat(t);const i=e[e.length-1];return i.id===t.id?(i.transcript=t.transcript,e.pop(),e.concat(i)):e.concat(t)}connectedCallback(){this.meeting&&this.meetingChanged(this.meeting)}componentDidLoad(){var e;null===(e=this.contentContainer)||void 0===e||e.addEventListener("scroll",this.onScroll)}disconnectedCallback(){var e,t,i;null===(t=null===(e=this.meeting)||void 0===e?void 0:e.ai)||void 0===t||t.off("transcript",this.onTranscriptHandler),null===(i=this.contentContainer)||void 0===i||i.removeEventListener("scroll",this.onScroll)}meetingChanged(e){var t,i;this.transcriptions=sg(null===(t=null==e?void 0:e.ai)||void 0===t?void 0:t.transcripts),this.transcriptions=this.transcriptions.reduce(this.transcriptionsReducer,[]),null===(i=null==e?void 0:e.ai)||void 0===i||i.on("transcript",this.onTranscriptHandler)}transcriptionsChanged(){this.autoScrollEnabled&&setTimeout(()=>{rs(this.contentContainer,!1)},100)}renderTranscripts(){const e=this.transcriptions.filter(e=>!this.participantQuery||e.name.toLowerCase().includes(this.participantQuery.toLowerCase())),t=[];return e.forEach(e=>{const i={name:e.name,date:e.date,peerId:e.peerId,transcript:e.transcript};if(!t.length)return void t.push(i);const s=t[t.length-1];e.peerId===s.peerId?s.transcript+=" "+e.transcript:t.push(i)}),t.map(e=>z("div",{class:"message"},z(as,{name:e.name,time:new Date(e.date),now:new Date}),z("div",{class:"body"},e.transcript)))}render(){return z(G,{key:"cfdc1cc64c5abbb817dc1455d99dcab905648ad9"},z("div",{key:"0cc69fc4b5d19aefb7f551663fcc2adcc867fc33",class:"search-bar"},z("input",{key:"80d42ae1c70f018ea9fc7b73e12db671ba25c986",type:"text",placeholder:"Search Participant",value:this.participantQuery,onInput:e=>this.participantQuery=e.target.value})),this.isProcessing&&z("div",{key:"23d4caa5f29c711769345215bb31581ca31fec97",class:"processing"},z("p",{key:"a9d6646edb1a0bb7cf584c0274603da6bdbb2186"},"Processing audio....")),!this.isProcessing&&z("div",{key:"a94804092f6633dd1718b1c05520613fcf95e86c",class:"content scrollbar",ref:e=>this.contentContainer=e},z("div",{key:"2e59a195f936f787ba9a54c7433b83b12b17c4b6",class:"started-message"},"Transcription started"),this.renderTranscripts()))}static get watchers(){return{meeting:["meetingChanged"],transcriptions:["transcriptionsChanged"]}}};pg([si()],ug.prototype,"t",void 0),pg([si()],ug.prototype,"meeting",void 0),ug.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.head{display:flex;align-items:center}.head .name{margin-right:var(--dyte-space-4, 16px);font-size:12px;font-weight:700}.head .time{font-size:12px;color:rgb(var(--dyte-colors-text-800, 255 255 255 / 0.76))}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}*{box-sizing:border-box;border-width:0;border-style:solid}:host{width:100%;display:flex;flex-direction:column}.processing{display:flex;flex:1 1 0%;flex-direction:column;align-items:center;justify-content:center}.content{box-sizing:border-box;display:flex;flex-direction:column;padding:var(--dyte-space-3, 12px);flex:1 0 0px;overflow-y:scroll}.started-message{margin-top:var(--dyte-space-5, 20px);margin-bottom:var(--dyte-space-5, 20px);text-align:center;font-size:12px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.search-bar{height:var(--dyte-space-14, 56px);width:100%;border-bottom-width:var(--dyte-border-width-sm, 1px);--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-border-opacity));padding:var(--dyte-space-3, 12px)}input{height:100%;width:100%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);font-size:14px;border-radius:var(--dyte-border-radius-sm, 4px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.caption-view{height:var(--dyte-space-12, 48px);width:100%;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);padding-top:var(--dyte-space-3, 12px);padding-bottom:var(--dyte-space-3, 12px);border-bottom-width:var(--dyte-border-width-sm, 1px);border-style:solid;--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-border-opacity));display:flex;align-items:center;justify-content:space-between;font-size:14px}.message .body{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);font-size:14px;word-break:break-word}.message{margin-bottom:var(--dyte-space-3, 12px)}.message:last-child{margin-bottom:var(--dyte-space-0, 0px)}";var gg=Object.freeze({__proto__:null,dyte_ai_transcriptions:ug});var fg=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const mg=class{constructor(e){o(this,e),this.t=Ht(),this.iconPack=Vt,this.setIsLivestreaming=e=>{this.isLivestreaming="LIVESTREAMING"===e}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e,t;null===(t=null===(e=this.meeting)||void 0===e?void 0:e.livestream)||void 0===t||t.removeListener("livestreamUpdate",this.setIsLivestreaming)}meetingChanged(e){var t,i;null!=e&&(this.setIsLivestreaming(null===(t=this.meeting.livestream)||void 0===t?void 0:t.state),null===(i=this.meeting.livestream)||void 0===i||i.on("livestreamUpdate",this.setIsLivestreaming))}render(){if(st(this.meeting)&&this.isLivestreaming)return z(G,null,z("div",{class:"indicator","aria-label":this.t("livestream.indicator"),part:"indicator"},z("dyte-icon",{icon:this.iconPack.start_livestream,size:this.size}),z("span",null,this.t("LIVE"))))}static get watchers(){return{meeting:["meetingChanged"]}}};fg([si()],mg.prototype,"meeting",void 0),fg([si()],mg.prototype,"size",void 0),fg([si()],mg.prototype,"t",void 0),fg([si()],mg.prototype,"iconPack",void 0),mg.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:flex}:host[size='sm']{margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px)}.indicator{display:flex;flex-direction:row;align-items:center;font-size:14px;--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}dyte-icon{margin-right:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);animation:blink 4s linear infinite}:host([size='sm']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}:host([size='sm']) .indicator span{display:none}@keyframes blink{0%,10%{opacity:0}11%,100%{opacity:1}}";const vg=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},yg=Number.isSafeInteger||function(e){return"number"==typeof e&&Math.abs(e)<=bg},bg=Number.MAX_SAFE_INTEGER||9007199254740991;let wg=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),xg=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",e.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",e.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.ASSET_LIST_LOAD_ERROR="assetListLoadError",e.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",e.ASSET_LIST_PARSING_ERROR="assetListParsingError",e.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.ATTACH_MEDIA_ERROR="attachMediaError",e.UNKNOWN="unknown",e}({}),kg=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.MEDIA_ENDED="hlsMediaEnded",e.STALL_RESOLVED="hlsStallResolved",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFERED_TO_END="hlsBufferedToEnd",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",e.ASSET_LIST_LOADING="hlsAssetListLoading",e.ASSET_LIST_LOADED="hlsAssetListLoaded",e.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",e.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",e.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",e.INTERSTITIAL_STARTED="hlsInterstitialStarted",e.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",e.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",e.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",e.INTERSTITIAL_ENDED="hlsInterstitialEnded",e.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",e.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",e.EVENT_CUE_ENTER="hlsEventCueEnter",e}({});var Sg="manifest",Eg="level",Pg="audioTrack",Tg="subtitleTrack",Lg="main",Cg="audio",_g="subtitle";class Ag{constructor(e,t=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}sample(e,t){const i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){const e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class Rg{constructor(e,t,i,s=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new Ag(e),this.fast_=new Ag(t),this.defaultTTFB_=s,this.ttfb_=new Ag(e)}update(e,t){const{slow_:i,fast_:s,ttfb_:a}=this;i.halfLife!==e&&(this.slow_=new Ag(e,i.getEstimate(),i.getTotalWeight())),s.halfLife!==t&&(this.fast_=new Ag(t,s.getEstimate(),s.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new Ag(e,a.getEstimate(),a.getTotalWeight()))}sample(e,t){const i=(e=Math.max(e,this.minDelayMs_))/1e3,s=8*t/i;this.fast_.sample(i,s),this.slow_.sample(i,s)}sampleTTFB(e){const t=e/1e3,i=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(i,Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function Ig(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var s=i.call(e,t);if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Dg(){return Dg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Dg.apply(null,arguments)}function Mg(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,s)}return i}function Og(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Mg(Object(i),!0).forEach(function(t){Ig(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Mg(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}class Ug{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;const i=`[${e}]:`;this.trace=$g,this.debug=t.debug.bind(null,i),this.log=t.log.bind(null,i),this.warn=t.warn.bind(null,i),this.info=t.info.bind(null,i),this.error=t.error.bind(null,i)}}const $g=function(){},Fg={trace:$g,debug:$g,log:$g,warn:$g,info:$g,error:$g};function Ng(){return Dg({},Fg)}function jg(e,t,i){return t[e]?t[e].bind(t):function(e,t){const i=self.console[e];return i?i.bind(self.console,`${t?"["+t+"] ":""}[${e}] >`):$g}(e,i)}const zg=Ng();const Bg=zg;function Gg(e=!0){if("undefined"==typeof self)return;return(e||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function Hg(e,t){const i=Object.keys(e),s=Object.keys(t),a=i.length,r=s.length;return!a||!r||a===r&&!i.some(e=>-1===s.indexOf(e))}function Vg(e,t=!1){if("undefined"!=typeof TextDecoder){const i=new TextDecoder("utf-8").decode(e);if(t){const e=i.indexOf("\0");return-1!==e?i.substring(0,e):i}return i.replace(/\0/g,"")}const i=e.length;let s,a,r,n="",o=0;for(;o<i;){if(s=e[o++],0===s&&t)return n;if(0!==s&&3!==s)switch(s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n+=String.fromCharCode(s);break;case 12:case 13:a=e[o++],n+=String.fromCharCode((31&s)<<6|63&a);break;case 14:a=e[o++],r=e[o++],n+=String.fromCharCode((15&s)<<12|(63&a)<<6|63&r)}}return n}const qg=function(e){let t="";for(let i=0;i<e.length;i++){let s=e[i].toString(16);s.length<2&&(s="0"+s),t+=s}return t};function Kg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Yg,Wg={exports:{}};var Zg=(Yg||(Yg=1,function(e){var t,i,s,a,r;t=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,i=/^(?=([^\/?#]*))\1([^]*)$/,s=/(?:\/|^)\.(?=\/)/g,a=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,r={buildAbsoluteURL:function(e,t,s){if(s=s||{},e=e.trim(),!(t=t.trim())){if(!s.alwaysNormalize)return e;var a=r.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");return a.path=r.normalizePath(a.path),r.buildURLFromParts(a)}var n=r.parseURL(t);if(!n)throw new Error("Error trying to parse relative URL.");if(n.scheme)return s.alwaysNormalize?(n.path=r.normalizePath(n.path),r.buildURLFromParts(n)):t;var o=r.parseURL(e);if(!o)throw new Error("Error trying to parse base URL.");if(!o.netLoc&&o.path&&"/"!==o.path[0]){var d=i.exec(o.path);o.netLoc=d[1],o.path=d[2]}o.netLoc&&!o.path&&(o.path="/");var l={scheme:o.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};if(!n.netLoc&&(l.netLoc=o.netLoc,"/"!==n.path[0]))if(n.path){var c=o.path,h=c.substring(0,c.lastIndexOf("/")+1)+n.path;l.path=r.normalizePath(h)}else l.path=o.path,n.params||(l.params=o.params,n.query||(l.query=o.query));return null===l.path&&(l.path=s.alwaysNormalize?r.normalizePath(n.path):n.path),r.buildURLFromParts(l)},parseURL:function(e){var i=t.exec(e);return i?{scheme:i[1]||"",netLoc:i[2]||"",path:i[3]||"",params:i[4]||"",query:i[5]||"",fragment:i[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(s,"");e.length!==(e=e.replace(a,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},e.exports=r}(Wg)),Wg.exports);class Qg{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var Xg="audio",Jg="video",ef="audiovideo";class tf{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"==typeof e&&(e={url:e}),this.base=e,function(e,t){const i=nf(e,t);i&&(i.enumerable=!0,Object.defineProperty(e,t,i))}(this,"stats")}setByteRange(e,t){const i=e.split("@",2);let s;s=1===i.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(i[1]),this._byteRange=[s,parseInt(i[0])+s]}get baseurl(){return this.base.url}get byteRange(){return null===this._byteRange?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return null===this._streams&&(this._streams={[Xg]:null,[Jg]:null,[ef]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return null!==this._stats}get hasStreams(){return null!==this._streams}get stats(){return null===this._stats&&(this._stats=new Qg),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Zg.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){const{elementaryStreams:e}=this;e[Xg]=null,e[Jg]=null,e[ef]=null}}function sf(e){return"initSegment"!==e.sn}class af extends tf{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){const e=this.stats.total;if(e)return e}if(this.byteRange){const e=this.byteRange[0],t=this.byteRange[1];if(vg(e)&&vg(t))return t-e}return null}get bitrate(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){const{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){const e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{const e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime)return null;const e=vg(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){const e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}get programDateTime(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){vg(e)?this._programDateTime=e:this._programDateTime=this.rawProgramDateTime=null}get ref(){return sf(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){const t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,i,s,a,r=!1){const{elementaryStreams:n}=this,o=n[e];o?(o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,i),o.startDTS=Math.min(o.startDTS,s),o.endDTS=Math.max(o.endDTS,a)):n[e]={startPTS:t,endPTS:i,startDTS:s,endDTS:a,partial:r}}}class rf extends tf{constructor(e,t,i,s,a){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=s;const r=e.enumeratedString("BYTERANGE");r&&this.setByteRange(r,a),a&&(this.fragOffset=a.fragOffset+a.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){const{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}function nf(e,t){const i=Object.getPrototypeOf(e);if(i){const e=Object.getOwnPropertyDescriptor(i,t);return e||nf(i,t)}}const of=Math.pow(2,32)-1,df=[].push,lf={video:1,audio:2,id3:3,text:4};function cf(e){return String.fromCharCode.apply(null,e)}function hf(e,t){const i=e[t]<<8|e[t+1];return i<0?65536+i:i}function pf(e,t){const i=gf(e,t);return i<0?4294967296+i:i}function uf(e,t){let i=pf(e,t);return i*=Math.pow(2,32),i+=pf(e,t+4),i}function gf(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function ff(e,t,i){e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i}function mf(e,t){const i=[];if(!t.length)return i;const s=e.byteLength;for(let a=0;a<s;){const r=pf(e,a),n=r>1?a+r:s;if(cf(e.subarray(a+4,a+8))===t[0])if(1===t.length)i.push(e.subarray(a+8,n));else{const s=mf(e.subarray(a+8,n),t.slice(1));s.length&&df.apply(i,s)}a=n}return i}function vf(e){const t=[],i=e[0];let s=8;const a=pf(e,s);s+=4;let r=0,n=0;0===i?(r=pf(e,s),n=pf(e,s+4),s+=8):(r=uf(e,s),n=uf(e,s+8),s+=16),s+=2;let o=e.length+n;const d=hf(e,s);s+=2;for(let i=0;i<d;i++){let i=s;const r=pf(e,i);i+=4;const n=2147483647&r;if(1===(2147483648&r)>>>31)return Bg.warn("SIDX has hierarchical references (not supported)"),null;const d=pf(e,i);i+=4,t.push({referenceSize:n,subsegmentDuration:d,info:{duration:d/a,start:o,end:o+n-1}}),o+=n,i+=4,s=i}return{earliestPresentationTime:r,timescale:a,version:i,referencesCount:d,references:t}}function yf(e){const t=[],i=mf(e,["moov","trak"]);for(let e=0;e<i.length;e++){const s=i[e],a=mf(s,["tkhd"])[0];if(a){let e=a[0];const i=pf(a,0===e?12:20),r=mf(s,["mdia","mdhd"])[0];if(r){e=r[0];const a=pf(r,0===e?12:20),n=mf(s,["mdia","hdlr"])[0];if(n){const e=cf(n.subarray(8,12)),r={soun:Xg,vide:Jg}[e],o=bf(mf(s,["mdia","minf","stbl","stsd"])[0]);r?(t[i]={timescale:a,type:r,stsd:o},t[r]=Og({timescale:a,id:i},o)):t[i]={timescale:a,type:e,stsd:o}}}}}return mf(e,["moov","mvex","trex"]).forEach(e=>{const i=pf(e,4),s=t[i];s&&(s.default={duration:pf(e,12),flags:pf(e,20)})}),t}function bf(e){const t=e.subarray(8),i=t.subarray(86),s=cf(t.subarray(4,8));let a,r=s;const n="enca"===s||"encv"===s;if(n){const e=mf(t,[s])[0];mf(e.subarray("enca"===s?28:78),["sinf"]).forEach(e=>{const t=mf(e,["schm"])[0];if(t){const i=cf(t.subarray(4,8));if("cbcs"===i||"cenc"===i){const t=mf(e,["frma"])[0];t&&(r=cf(t))}}})}const o=r;switch(r){case"avc1":case"avc2":case"avc3":case"avc4":{const e=mf(i,["avcC"])[0];e&&e.length>3&&(r+="."+kf(e[1])+kf(e[2])+kf(e[3]),a=wf("avc1"===o?"dva1":"dvav",i));break}case"mp4a":{const e=mf(t,[s])[0],i=mf(e.subarray(28),["esds"])[0];if(i&&i.length>7){let e=4;if(3!==i[e++])break;e=xf(i,e),e+=2;const t=i[e++];if(128&t&&(e+=2),64&t&&(e+=i[e++]),4!==i[e++])break;e=xf(i,e);const s=i[e++];if(64!==s)break;if(r+="."+kf(s),e+=12,5!==i[e++])break;e=xf(i,e);const a=i[e++];let n=(248&a)>>3;31===n&&(n+=1+((7&a)<<3)+((224&i[e])>>5)),r+="."+n}break}case"hvc1":case"hev1":{const e=mf(i,["hvcC"])[0];if(e&&e.length>12){const t=e[1],i=["","A","B","C"][t>>6],s=31&t,a=pf(e,2),n=(32&t)>>5?"H":"L",o=e[12],d=e.subarray(6,12);r+="."+i+s,r+="."+function(e){let t=0;for(let i=0;i<32;i++)t|=(e>>i&1)<<31-i;return t>>>0}(a).toString(16).toUpperCase(),r+="."+n+o;let l="";for(let e=d.length;e--;){const t=d[e];if(t||l){l="."+t.toString(16).toUpperCase()+l}}r+=l}a=wf("hev1"==o?"dvhe":"dvh1",i);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":r=wf(r,i)||r;break;case"vp09":{const e=mf(i,["vpcC"])[0];if(e&&e.length>6){const t=e[4],i=e[5],s=e[6]>>4&15;r+="."+Sf(t)+"."+Sf(i)+"."+Sf(s)}break}case"av01":{const e=mf(i,["av1C"])[0];if(e&&e.length>2){const t=e[1]>>>5,s=31&e[1],n=e[2]>>>7?"H":"M",o=(64&e[2])>>6,d=(32&e[2])>>5,l=2===t&&o?d?12:10:o?10:8,c=(16&e[2])>>4,h=(8&e[2])>>3,p=(4&e[2])>>2,u=3&e[2],g=1,f=1,m=1,v=0;r+="."+t+"."+Sf(s)+n+"."+Sf(l)+"."+c+"."+h+p+u+"."+Sf(g)+"."+Sf(f)+"."+Sf(m)+"."+v,a=wf("dav1",i)}break}}return{codec:r,encrypted:n,supplemental:a}}function wf(e,t){const i=mf(t,["dvvC"]),s=i.length?i[0]:mf(t,["dvcC"])[0];if(s){const t=s[2]>>1&127,i=s[2]<<5&32|s[3]>>3&31;return e+"."+Sf(t)+"."+Sf(i)}}function xf(e,t){const i=t+5;for(;128&e[t++]&&t<i;);return t}function kf(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function Sf(e){return(e<10?"0":"")+e}function Ef(e){const t=mf(e,["schm"])[0];if(t){const i=cf(t.subarray(4,8));if("cbcs"===i||"cenc"===i)return mf(e,["schi","tenc"])[0]}return null}function Pf(e,t){const i=new Uint8Array(e.length+t.length);return i.set(e),i.set(t,e.length),i}function Tf(e,t){const i=[],s=t.samples,a=t.timescale,r=t.id;let n=!1;return mf(s,["moof"]).map(o=>{const d=o.byteOffset-8;mf(o,["traf"]).map(o=>{const l=mf(o,["tfdt"]).map(e=>{const t=e[0];let i=pf(e,4);return 1===t&&(i*=Math.pow(2,32),i+=pf(e,8)),i/a})[0];return void 0!==l&&(e=l),mf(o,["tfhd"]).map(l=>{const c=pf(l,4),h=16777215&pf(l,0);let p=0;const u=!!(16&h);let g=0;const f=!!(32&h);let m=8;c===r&&(!!(1&h)&&(m+=8),!!(2&h)&&(m+=4),!!(8&h)&&(p=pf(l,m),m+=4),u&&(g=pf(l,m),m+=4),f&&(m+=4),"video"===t.type&&(n=Lf(t.codec)),mf(o,["trun"]).map(r=>{const o=r[0],l=16777215&pf(r,0),c=!!(1&l);let h=0;const u=!!(4&l),f=!!(256&l);let m=0;const v=!!(512&l);let y=0;const b=!!(1024&l),w=!!(2048&l);let x=0;const k=pf(r,4);let S=8;c&&(h=pf(r,S),S+=4),u&&(S+=4);let E=h+d;for(let d=0;d<k;d++){if(f?(m=pf(r,S),S+=4):m=p,v?(y=pf(r,S),S+=4):y=g,b&&(S+=4),w&&(x=0===o?pf(r,S):gf(r,S),S+=4),t.type===Jg){let t=0;for(;t<y;){const r=pf(s,E);if(E+=4,Cf(n,s[E])){_f(s.subarray(E,E+r),n?2:1,e+x/a,i)}E+=r,t+=r+4}}e+=m/a}}))})})}),i}function Lf(e){if(!e)return!1;const t=e.substring(0,4);return"hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}function Cf(e,t){if(e){const e=t>>1&63;return 39===e||40===e}return 6===(31&t)}function _f(e,t,i,s){const a=Af(e);let r=0;r+=t;let n=0,o=0,d=0;for(;r<a.length;){n=0;do{if(r>=a.length)break;d=a[r++],n+=d}while(255===d);o=0;do{if(r>=a.length)break;d=a[r++],o+=d}while(255===d);const e=a.length-r;let t=r;if(o<e)r+=o;else if(o>e){Bg.error(`Malformed SEI payload. ${o} is too small, only ${e} bytes left to parse.`);break}if(4===n){if(181===a[t++]){const e=hf(a,t);if(t+=2,49===e){const e=pf(a,t);if(t+=4,1195456820===e){const e=a[t++];if(3===e){const r=a[t++],o=64&r,d=o?2+3*(31&r):0,l=new Uint8Array(d);if(o){l[0]=r;for(let e=1;e<d;e++)l[e]=a[t++]}s.push({type:e,payloadType:n,pts:i,bytes:l})}}}}}else if(5===n&&o>16){const e=[];for(let i=0;i<16;i++){const s=a[t++].toString(16);e.push(1==s.length?"0"+s:s),3!==i&&5!==i&&7!==i&&9!==i||e.push("-")}const r=o-16,d=new Uint8Array(r);for(let e=0;e<r;e++)d[e]=a[t++];s.push({payloadType:n,pts:i,uuid:e.join(""),userData:Vg(d),userDataBytes:d})}}}function Af(e){const t=e.byteLength,i=[];let s=1;for(;s<t-2;)0===e[s]&&0===e[s+1]&&3===e[s+2]?(i.push(s+2),s+=2):s++;if(0===i.length)return e;const a=t-i.length,r=new Uint8Array(a);let n=0;for(s=0;s<a;n++,s++)n===i[0]&&(n++,i.shift()),r[s]=e[n];return r}function Rf(e,t,i){if(16!==e.byteLength)throw new RangeError("Invalid system id");let s,a,r;s=0,a=new Uint8Array,r=new Uint8Array;const n=new Uint8Array(4);return i&&i.byteLength>0&&new DataView(n.buffer).setUint32(0,i.byteLength,!1),function(e,...t){const i=t.length;let s=8,a=i;for(;a--;)s+=t[a].byteLength;const r=new Uint8Array(s);for(r[0]=s>>24&255,r[1]=s>>16&255,r[2]=s>>8&255,r[3]=255&s,r.set(e,4),a=0,s=8;a<i;a++)r.set(t[a],s),s+=t[a].byteLength;return r}([112,115,115,104],new Uint8Array([0,0,0,0]),e,r,a,n,i||new Uint8Array)}function If(e){const t=e.getUint32(0),i=e.byteOffset,s=e.byteLength;if(s<t)return{offset:i,size:s};if(1886614376!==e.getUint32(4))return{offset:i,size:t};const a=e.getUint32(8)>>>24;if(0!==a&&1!==a)return{offset:i,size:t};const r=e.buffer,n=qg(new Uint8Array(r,i+12,16)),o=e.getUint32(28);let d=null,l=null;if(0===a){if(t-32<o||o<22)return{offset:i,size:t};l=new Uint8Array(r,i+32,o)}else if(1===a){if(!o||s<i+32+16*o+16)return{offset:i,size:t};d=[];for(let e=0;e<o;e++)d.push(new Uint8Array(r,i+32+16*e,16))}return{version:a,systemId:n,kids:d,data:l,offset:i,size:t}}const Df=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),Mf={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function Of(e,t){const i=Mf[t];return!!i&&!!i[e.slice(0,4)]}function Uf(e,t,i=!0){return!e.split(",").some(e=>!$f(e,t,i))}function $f(e,t,i=!0){var s;const a=Gg(i);return null!=(s=null==a?void 0:a.isTypeSupported(Ff(e,t)))&&s}function Ff(e,t){return`${t}/mp4;codecs=${e}`}function Nf(e){if(e){const t=e.substring(0,4);return Mf.video[t]}return 2}function jf(e){const t=Df();return e.split(",").reduce((e,i)=>{const s=t&&Lf(i)?9:Mf.video[i];return s?(2*s+e)/(e?3:2):(Mf.audio[i]+e)/(e?2:1)},0)}const zf={};const Bf=/flac|opus|mp4a\.40\.34/i;function Gf(e,t=!0){return e.replace(Bf,e=>function(e,t=!0){if(zf[e])return zf[e];const i={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[e];for(let a=0;a<i.length;a++){var s;if($f(i[a],"audio",t))return zf[e]=i[a],i[a];if("mp3"===i[a]&&null!=(s=Gg(t))&&s.isTypeSupported("audio/mpeg"))return""}return e}(e.toLowerCase(),t))}function Hf(e,t){if(e&&(e.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(e)))return e;if(t){const i=t.split(",");if(i.length>1){if(e)for(let t=i.length;t--;)if(i[t].substring(0,4)===e.substring(0,4))return i[t];return i[0]}}return t||e}function Vf(e){if(e.startsWith("av01.")){const t=e.split("."),i=["0","111","01","01","01","0"];for(let e=t.length;e>4&&e<10;e++)t[e]=i[e-4];return t.join(".")}return e}function qf(e){const t=Gg(e)||{isTypeSupported:()=>!1};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Kf(e){return e.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}const Yf={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function Wf(e,t){return{supported:!1,configurations:t,decodingInfoResults:[{supported:!1,smooth:!1,powerEfficient:!1}],error:e}}const Zf={};function Qf(e,t,i,s,a,r){const n=e.audioCodec?e.audioGroups:null,o=null==r?void 0:r.audioCodec,d=null==r?void 0:r.channels,l=d?parseInt(d):o?1/0:2;let c=null;if(null!=n&&n.length)try{c=1===n.length&&n[0]?t.groups[n[0]].channels:n.reduce((e,i)=>{if(i){const s=t.groups[i];if(!s)throw new Error(`Audio track group ${i} not found`);Object.keys(s.channels).forEach(t=>{e[t]=(e[t]||0)+s.channels[t]})}return e},{2:0})}catch(e){return!0}return void 0!==e.videoCodec&&(e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(s,30)||"SDR"!==e.videoRange&&e.videoRange!==i||e.bitrate>Math.max(a,8e6))||!!c&&vg(l)&&Object.keys(c).some(e=>parseInt(e)>l)}function Xf(e,t,i){const s=e.videoCodec,a=e.audioCodec;if(!s&&!a||!i)return Promise.resolve(Yf);const r=[];if(s){const t={width:e.width,height:e.height,bitrate:Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)),framerate:e.frameRate||30},i=e.videoRange;"SDR"!==i&&(t.transferFunction=i.toLowerCase());const a=s.split(","),n=navigator.userAgent;if(a.some(e=>Lf(e))&&Df())return Promise.resolve(Wf(new Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent sting: (${n})`),r));r.push.apply(r,a.map(e=>({type:"media-source",video:Og(Og({},t),{},{contentType:Ff(Vf(e),"video")})})))}return a&&e.audioGroups&&e.audioGroups.forEach(e=>{var i;e&&(null==(i=t.groups[e])||i.tracks.forEach(t=>{if(t.groupId===e){const e=t.channels||"",i=parseFloat(e);vg(i)&&i>2&&r.push.apply(r,a.split(",").map(e=>({type:"media-source",audio:{contentType:Ff(e,"audio"),channels:""+i}})))}}))}),Promise.all(r.map(e=>{const t=function(e){const{audio:t,video:i}=e,s=i||t;if(s){const e=Kf(s.contentType);if(i)return`r${i.height}x${i.width}f${Math.ceil(i.framerate)}${i.transferFunction||"sd"}_${e}_${Math.ceil(i.bitrate/1e5)}`;if(t)return`c${t.channels}${t.spatialRendering?"s":"n"}_${e}`}return""}(e);return Zf[t]||(Zf[t]=i.decodingInfo(e))})).then(e=>({supported:!e.some(e=>!e.supported),configurations:r,decodingInfoResults:e})).catch(e=>({supported:!1,configurations:r,decodingInfoResults:[],error:e}))}const Jf=["NONE","TYPE-0","TYPE-1",null];const em=["SDR","PQ","HLG"];var tm="",im="YES",sm="v2";function am(e){const{canSkipUntil:t,canSkipDateRanges:i,age:s}=e;return t&&s<t/2?i?sm:im:tm}class rm{constructor(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}addDirectives(e){const t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class nm{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(e=>!!e).map(e=>e.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;const i=null==(t=e.supplemental)?void 0:t.videoCodec;i&&i!==e.videoCodec&&(this.codecSet+=`,${i.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return om(this._audioGroups,e)}hasSubtitleGroup(e){return om(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t)if("audio"===e){let e=this._audioGroups;e||(e=this._audioGroups=[]),-1===e.indexOf(t)&&e.push(t)}else if("text"===e){let e=this._subtitleGroups;e||(e=this._subtitleGroups=[]),-1===e.indexOf(t)&&e.push(t)}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return null==(e=this.audioGroups)?void 0:e[0]}get textGroupId(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}addFallback(){}}function om(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}function dm(e,t){let i=!1,s=[];if(e&&(i="SDR"!==e,s=[e]),t){s=t.allowedVideoRanges||em.slice(0);const e="SDR"!==s.join("")&&!t.videoCodec;i=void 0!==t.preferHDR?t.preferHDR:e&&function(){if("function"==typeof matchMedia){const e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}(),i||(s=["SDR"])}return{preferHDR:i,allowedVideoRanges:s}}const lm=(e,t)=>JSON.stringify(e,(e=>{const t=new WeakSet;return(i,s)=>{if(e&&(s=e(i,s)),"object"==typeof s&&null!==s){if(t.has(s))return;t.add(s)}return s}})(t));function cm(e,t){Bg.log(`[abr] start candidates with "${e}" ignored because ${t}`)}function hm(e){return e.reduce((e,t)=>{let i=e.groups[t.groupId];i||(i=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),i.tracks.push(t);const s=t.channels||"2";return i.channels[s]=(i.channels[s]||0)+1,i.hasDefault=i.hasDefault||t.default,i.hasAutoSelect=i.hasAutoSelect||t.autoselect,i.hasDefault&&(e.hasDefaultAudio=!0),i.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function pm(e){if(!e)return e;const{lang:t,assocLang:i,characteristics:s,channels:a,audioCodec:r}=e;return{lang:t,assocLang:i,characteristics:s,channels:a,audioCodec:r}}function um(e,t,i){if("attrs"in e){const i=t.indexOf(e);if(-1!==i)return i}for(let s=0;s<t.length;s++){if(gm(e,t[s],i))return s}return-1}function gm(e,t,i){const{groupId:s,name:a,lang:r,assocLang:n,default:o}=e,d=e.forced;return(void 0===s||t.groupId===s)&&(void 0===a||t.name===a)&&(void 0===r||function(e,t="--"){if(e.length===t.length)return e===t;return e.startsWith(t)||t.startsWith(e)}(r,t.lang))&&(void 0===r||t.assocLang===n)&&(void 0===o||t.default===o)&&(void 0===d||t.forced===d)&&(!("characteristics"in e)||function(e,t=""){const i=e.split(","),s=t.split(",");return i.length===s.length&&!i.some(e=>-1===s.indexOf(e))}(e.characteristics||"",t.characteristics))&&(void 0===i||i(e,t))}function fm(e,t){const{audioCodec:i,channels:s}=e;return!(void 0!==i&&(t.audioCodec||"").substring(0,4)!==i.substring(0,4)||void 0!==s&&s!==(t.channels||"2"))}function mm(e,t,i){for(let s=t;s>-1;s--)if(i(e[s]))return s;for(let s=t+1;s<e.length;s++)if(i(e[s]))return s;return-1}function vm(e,t){var i;return!!e&&e!==(null==(i=t.loadLevelObj)?void 0:i.uri)}const ym=function(e,t){let i=0,s=e.length-1,a=null,r=null;for(;i<=s;){a=(i+s)/2|0,r=e[a];const n=t(r);if(n>0)i=a+1;else{if(!(n<0))return r;s=a-1}}return null};function bm(e,t,i=0,s=0,a=.005){let r=null;if(e){r=t[1+e.sn-t[0].sn]||null;const s=e.endDTS-i;s>0&&s<15e-7&&(i+=15e-7),r&&e.level!==r.level&&r.end<=e.end&&(r=t[2+e.sn-t[0].sn]||null)}else 0===i&&0===t[0].start&&(r=t[0]);if(r&&((!e||e.level===r.level)&&0===wm(i,s,r)||function(e,t,i){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){const s=t.tagList.reduce((e,t)=>("INF"===t[0]&&(e+=parseFloat(t[1])),e),i);return e.start<=s}return!1}(r,e,Math.min(a,s))))return r;const n=ym(t,wm.bind(null,i,s));return!n||n===e&&r?r:n}function wm(e=0,t=0,i){if(i.start<=e&&i.start+i.duration>e)return 0;const s=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-s<=e?1:i.start-s>e&&i.start?-1:0}function xm(e,t,i){const s=1e3*Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return(i.endProgramDateTime||0)-s>e}function km(e,t,i){if(e&&e.startCC<=t&&e.endCC>=t){let s=e.fragments;const{fragmentHint:a}=e;let r;return a&&(s=s.concat(a)),ym(s,e=>e.cc<t?1:e.cc>t?-1:(r=e,e.end<=i?1:e.start>i?-1:0)),r||null}return null}function Sm(e){switch(e.details){case xg.FRAG_LOAD_TIMEOUT:case xg.KEY_LOAD_TIMEOUT:case xg.LEVEL_LOAD_TIMEOUT:case xg.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Em(e,t){const i=Sm(t);return e.default[(i?"timeout":"error")+"Retry"]}function Pm(e,t){const i="linear"===e.backoff?1:Math.pow(2,t);return Math.min(i*e.retryDelayMs,e.maxRetryDelayMs)}function Tm(e){return Og(Og({},e),{errorRetry:null,timeoutRetry:null})}function Lm(e,t,i,s){if(!e)return!1;const a=null==s?void 0:s.code,r=t<e.maxNumRetry&&(function(e){return 0===e&&!1===navigator.onLine||!!e&&(e<400||e>499)}(a)||!!i);return e.shouldRetry?e.shouldRetry(e,t,i,s,r):r}var Cm=0,_m=2,Am=3,Rm=5,Im=0,Dm=1,Mm=2;function Om(e){const t={action:Cm,flags:Im};return e&&(t.resolved=!0),t}var Um="NOT_LOADED",$m="APPENDING",Fm="PARTIAL",Nm="OK";class jm{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.BUFFER_APPENDED,this.onBufferAppended,this),e.on(kg.FRAG_BUFFERED,this.onFragBuffered,this),e.on(kg.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){const{hls:e}=this;e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.BUFFER_APPENDED,this.onBufferAppended,this),e.off(kg.FRAG_BUFFERED,this.onFragBuffered,this),e.off(kg.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){const i=this.activePartLists[t];if(i)for(let t=i.length;t--;){const s=i[t];if(!s)break;const a=s.end;if(s.start<=e&&null!==a&&e<=a)return s}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,i){const{fragments:s}=this,a=Object.keys(s);for(let r=a.length;r--;){const n=s[a[r]];if((null==n?void 0:n.body.type)===t&&(!i||n.buffered)){const t=n.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,i,s,a){this.timeRanges&&(this.timeRanges[e]=t);const r=(null==s?void 0:s.fragment.sn)||-1;Object.keys(this.fragments).forEach(s=>{const n=this.fragments[s];if(!n)return;if(r>=n.body.sn)return;if(!n.buffered&&(!n.loaded||a))return void(n.body.type===i&&this.removeFragment(n.body));const o=n.range[e];o&&(0!==o.time.length?o.time.some(e=>{const i=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return i&&this.removeFragment(n.body),i}):this.removeFragment(n.body))})}detectPartialFragments(e){const t=this.timeRanges;if(!t||"initSegment"===e.frag.sn)return;const i=e.frag,s=Bm(i),a=this.fragments[s];if(!a||a.buffered&&i.gap)return;const r=!i.relurl;if(Object.keys(t).forEach(s=>{const n=i.elementaryStreams[s];if(!n)return;const o=t[s],d=r||!0===n.partial;a.range[s]=this.getBufferedTimes(i,e.part,d,o)}),a.loaded=null,Object.keys(a.range).length){a.buffered=!0;(a.body.endList=i.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),zm(a)||this.removeParts(i.sn-1,i.type)}else this.removeFragment(a.body)}removeParts(e,t){const i=this.activePartLists[t];i&&(this.activePartLists[t]=Gm(i,t=>t.fragment.sn>=e))}fragBuffered(e,t){const i=Bm(e);let s=this.fragments[i];!s&&t&&(s=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),s&&(s.loaded=null,s.buffered=!0)}getBufferedTimes(e,t,i,s){const a={time:[],partial:i},r=e.start,n=e.end,o=e.minEndPTS||n,d=e.maxStartPTS||r;for(let e=0;e<s.length;e++){const t=s.start(e)-this.bufferPadding,i=s.end(e)+this.bufferPadding;if(d>=t&&o<=i){a.time.push({startPTS:Math.max(r,s.start(e)),endPTS:Math.min(n,s.end(e))});break}if(r<i&&n>t){const t=Math.max(r,s.start(e)),i=Math.min(n,s.end(e));i>t&&(a.partial=!0,a.time.push({startPTS:t,endPTS:i}))}else if(n<=t)break}return a}getPartialFragment(e){let t,i,s,a=null,r=0;const{bufferPadding:n,fragments:o}=this;return Object.keys(o).forEach(d=>{const l=o[d];l&&zm(l)&&(i=l.body.start-n,s=l.body.end+n,e>=i&&e<=s&&(t=Math.min(e-i,s-e),r<=t&&(a=l.body,r=t)))}),a}isEndListAppended(e){const t=this.endListFragments[e];return void 0!==t&&(t.buffered||zm(t))}getState(e){const t=Bm(e),i=this.fragments[t];return i?i.buffered?zm(i)?Fm:Nm:$m:Um}isTimeBuffered(e,t,i){let s,a;for(let r=0;r<i.length;r++){if(s=i.start(r)-this.bufferPadding,a=i.end(r)+this.bufferPadding,e>=s&&t<=a)return!0;if(t<=s)return!1}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if("initSegment"===t.frag.sn||t.frag.bitrateTest)return;const i=t.frag,s=t.part?null:t,a=Bm(i);this.fragments[a]={body:i,appendedPTS:null,loaded:s,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){const{frag:i,part:s,timeRanges:a,type:r}=t;if("initSegment"===i.sn)return;const n=i.type;if(s){let e=this.activePartLists[n];e||(this.activePartLists[n]=e=[]),e.push(s)}this.timeRanges=a;const o=a[r];this.detectEvictedFragments(r,o,n,s)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){const t=Bm(e);return!!this.fragments[t]}hasFragments(e){const{fragments:t}=this,i=Object.keys(t);if(!e)return i.length>0;for(let s=i.length;s--;){const a=t[i[s]];if((null==a?void 0:a.body.type)===e)return!0}return!1}hasParts(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}removeFragmentsInRange(e,t,i,s,a){s&&!this.hasGaps||Object.keys(this.fragments).forEach(r=>{const n=this.fragments[r];if(!n)return;const o=n.body;o.type!==i||s&&!o.gap||o.start<t&&o.end>e&&(n.buffered||a)&&this.removeFragment(o)})}removeFragment(e){const t=Bm(e);e.clearElementaryStreamInfo();const i=this.activePartLists[e.type];if(i){const t=e.sn;this.activePartLists[e.type]=Gm(i,e=>e.fragment.sn!==t)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e,t;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;const i=null==(e=this.hls)||null==(t=e.latestLevelDetails)?void 0:t.partList;i&&i.forEach(e=>e.clearElementaryStreamInfo())}}function zm(e){var t,i,s;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(i=e.range.audio)?void 0:i.partial)||(null==(s=e.range.audiovideo)?void 0:s.partial))}function Bm(e){return`${e.type}_${e.level}_${e.sn}`}function Gm(e,t){return e.filter(e=>{const i=t(e);return i||e.clearElementaryStreamInfo(),i})}var Hm=0,Vm=1;class qm{constructor(e,t,i){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=i}decrypt(e,t){switch(this.aesMode){case Hm:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Vm:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}class Km{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){const t=new DataView(e),i=new Uint32Array(4);for(let e=0;e<4;e++)i[e]=t.getUint32(4*e);return i}initTable(){const e=this.sBox,t=this.invSBox,i=this.subMix,s=i[0],a=i[1],r=i[2],n=i[3],o=this.invSubMix,d=o[0],l=o[1],c=o[2],h=o[3],p=new Uint32Array(256);let u=0,g=0,f=0;for(f=0;f<256;f++)p[f]=f<128?f<<1:f<<1^283;for(f=0;f<256;f++){let i=g^g<<1^g<<2^g<<3^g<<4;i=i>>>8^255&i^99,e[u]=i,t[i]=u;const o=p[u],f=p[o],m=p[f];let v=257*p[i]^16843008*i;s[u]=v<<24|v>>>8,a[u]=v<<16|v>>>16,r[u]=v<<8|v>>>24,n[u]=v,v=16843009*m^65537*f^257*o^16843008*u,d[i]=v<<24|v>>>8,l[i]=v<<16|v>>>16,c[i]=v<<8|v>>>24,h[i]=v,u?(u=o^p[p[p[m^o]]],g^=p[p[g]]):u=g=1}}expandKey(e){const t=this.uint8ArrayToUint32Array_(e);let i=!0,s=0;for(;s<t.length&&i;)i=t[s]===this.key[s],s++;if(i)return;this.key=t;const a=this.keySize=t.length;if(4!==a&&6!==a&&8!==a)throw new Error("Invalid aes key size="+a);const r=this.ksRows=4*(a+6+1);let n,o;const d=this.keySchedule=new Uint32Array(r),l=this.invKeySchedule=new Uint32Array(r),c=this.sBox,h=this.rcon,p=this.invSubMix,u=p[0],g=p[1],f=p[2],m=p[3];let v,y;for(n=0;n<r;n++)n<a?v=d[n]=t[n]:(y=v,n%a===0?(y=y<<8|y>>>24,y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y],y^=h[n/a|0]<<24):a>6&&n%a===4&&(y=c[y>>>24]<<24|c[y>>>16&255]<<16|c[y>>>8&255]<<8|c[255&y]),d[n]=v=(d[n-a]^y)>>>0);for(o=0;o<r;o++)n=r-o,y=3&o?d[n]:d[n-4],l[o]=o<4||n<=4?y:u[c[y>>>24]]^g[c[y>>>16&255]]^f[c[y>>>8&255]]^m[c[255&y]],l[o]=l[o]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,i){const s=this.keySize+6,a=this.invKeySchedule,r=this.invSBox,n=this.invSubMix,o=n[0],d=n[1],l=n[2],c=n[3],h=this.uint8ArrayToUint32Array_(i);let p=h[0],u=h[1],g=h[2],f=h[3];const m=new Int32Array(e),v=new Int32Array(m.length);let y,b,w,x,k,S,E,P,T,L,C,_,A,R;const I=this.networkToHostOrderSwap;for(;t<m.length;){for(T=I(m[t]),L=I(m[t+1]),C=I(m[t+2]),_=I(m[t+3]),k=T^a[0],S=_^a[1],E=C^a[2],P=L^a[3],A=4,R=1;R<s;R++)y=o[k>>>24]^d[S>>16&255]^l[E>>8&255]^c[255&P]^a[A],b=o[S>>>24]^d[E>>16&255]^l[P>>8&255]^c[255&k]^a[A+1],w=o[E>>>24]^d[P>>16&255]^l[k>>8&255]^c[255&S]^a[A+2],x=o[P>>>24]^d[k>>16&255]^l[S>>8&255]^c[255&E]^a[A+3],k=y,S=b,E=w,P=x,A+=4;y=r[k>>>24]<<24^r[S>>16&255]<<16^r[E>>8&255]<<8^r[255&P]^a[A],b=r[S>>>24]<<24^r[E>>16&255]<<16^r[P>>8&255]<<8^r[255&k]^a[A+1],w=r[E>>>24]<<24^r[P>>16&255]<<16^r[k>>8&255]<<8^r[255&S]^a[A+2],x=r[P>>>24]<<24^r[k>>16&255]<<16^r[S>>8&255]<<8^r[255&E]^a[A+3],v[t]=I(y^p),v[t+1]=I(x^u),v[t+2]=I(w^g),v[t+3]=I(b^f),p=T,u=L,g=C,f=_,t+=4}return v.buffer}}class Ym{constructor(e,t,i){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=i}expandKey(){const e=function(e){switch(e){case Hm:return"AES-CBC";case Vm:return"AES-CTR";default:throw new Error(`[FastAESKey] invalid aes mode ${e}`)}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}class Wm{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{const e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(e){}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){const{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;const i=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(e){const t=e.byteLength,i=t&&new DataView(e.buffer).getUint8(t-1);return i?e.slice(0,t-i):e}(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,i,s){return this.useSoftware?new Promise((a,r)=>{const n=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(n,t,i,s);const o=this.flush();o?a(o.buffer):r(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,i,s)}softwareDecrypt(e,t,i,s){const{currentIV:a,currentResult:r,remainderData:n}=this;if(s!==Hm||16!==t.byteLength)return Bg.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),n&&(e=Pf(n,e),this.remainderData=null);const o=this.getValidChunk(e);if(!o.length)return null;a&&(i=a);let d=this.softwareDecrypter;d||(d=this.softwareDecrypter=new Km),d.expandKey(t);const l=r;return this.currentResult=d.decrypt(o.buffer,0,i),this.currentIV=o.slice(-16).buffer,l||null}webCryptoDecrypt(e,t,i,s){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,i,s));this.key=t,this.fastAesKey=new Ym(this.subtle,t,s)}return this.fastAesKey.expandKey().then(t=>{if(!this.subtle)return Promise.reject(new Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");return new qm(this.subtle,new Uint8Array(i),s).decrypt(e.buffer,t)}).catch(a=>(Bg.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(e,t,i,s)))}onWebCryptoError(e,t,i,s){const a=this.enableSoftwareAES;if(a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,i,s);const a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(a?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e;const i=e.length-e.length%16;return i!==e.length&&(t=e.slice(0,i),this.remainderData=e.slice(i)),t}logOnce(e){this.logEnabled&&(Bg.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}const Zm=Math.pow(2,17);class Qm{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){const i=e.url;if(!i)return Promise.reject(new ev({type:wg.NETWORK_ERROR,details:xg.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a "+(i?"part list":"url")),networkDetails:null}));this.abort();const s=this.config,a=s.fLoader,r=s.loader;return new Promise((n,o)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some(e=>"GAP"===e[0]))return void o(Jm(e));e.gap=!1}const d=this.loader=a?new a(s):new r(s),l=Xm(e);e.loader=d;const c=Tm(s.fragLoadPolicy.default),h={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:Zm};e.stats=d.stats;const p={onSuccess:(t,i,s,a)=>{this.resetLoader(e,d);let r=t.data;s.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(r.slice(0,16)),r=r.slice(16)),n({frag:e,part:null,payload:r,networkDetails:a})},onError:(t,s,a,r)=>{this.resetLoader(e,d),o(new ev({type:wg.NETWORK_ERROR,details:xg.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:Og({url:i,data:void 0},t),error:new Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:a,stats:r}))},onAbort:(t,i,s)=>{this.resetLoader(e,d),o(new ev({type:wg.NETWORK_ERROR,details:xg.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:s,stats:t}))},onTimeout:(t,i,s)=>{this.resetLoader(e,d),o(new ev({type:wg.NETWORK_ERROR,details:xg.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:s,stats:t}))}};t&&(p.onProgress=(i,s,a,r)=>t({frag:e,part:null,payload:a,networkDetails:r})),d.load(l,h,p)})}loadPart(e,t,i){this.abort();const s=this.config,a=s.fLoader,r=s.loader;return new Promise((n,o)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap)return void o(Jm(e,t));const d=this.loader=a?new a(s):new r(s),l=Xm(e,t);e.loader=d;const c=Tm(s.fragLoadPolicy.default),h={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Zm};t.stats=d.stats,d.load(l,h,{onSuccess:(s,a,r,o)=>{this.resetLoader(e,d),this.updateStatsFromPart(e,t);const l={frag:e,part:t,payload:s.data,networkDetails:o};i(l),n(l)},onError:(i,s,a,r)=>{this.resetLoader(e,d),o(new ev({type:wg.NETWORK_ERROR,details:xg.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:Og({url:l.url,data:void 0},i),error:new Error(`HTTP Error ${i.code} ${i.text}`),networkDetails:a,stats:r}))},onAbort:(i,s,a)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,d),o(new ev({type:wg.NETWORK_ERROR,details:xg.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:a,stats:i}))},onTimeout:(i,s,a)=>{this.resetLoader(e,d),o(new ev({type:wg.NETWORK_ERROR,details:xg.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error(`Timeout after ${h.timeout}ms`),networkDetails:a,stats:i}))}})})}updateStatsFromPart(e,t){const i=e.stats,s=t.stats,a=s.total;if(i.loaded+=s.loaded,a){const s=Math.round(e.duration/t.duration),r=Math.min(Math.round(i.loaded/a),s),n=(s-r)*Math.round(i.loaded/r);i.total=i.loaded+n}else i.total=Math.max(i.loaded,i.total);const r=i.loading,n=s.loading;r.start?r.first+=n.first-n.start:(r.start=n.start,r.first=n.first),r.end=n.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function Xm(e,t=null){const i=t||e,s={frag:e,part:t,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},a=i.byteRangeStartOffset,r=i.byteRangeEndOffset;if(vg(a)&&vg(r)){var n;let t=a,i=r;if("initSegment"===e.sn&&("AES-128"===(o=null==(n=e.decryptdata)?void 0:n.method)||"AES-256"===o)){const e=r-a;e%16&&(i=r+(16-e%16)),0!==a&&(s.resetIV=!0,t=a-16)}s.rangeStart=t,s.rangeEnd=i}var o;return s}function Jm(e,t){const i=new Error(`GAP ${e.gap?"tag":"attribute"} found`),s={type:wg.MEDIA_ERROR,details:xg.FRAG_GAP,fatal:!1,frag:e,error:i,networkDetails:null};return t&&(s.part=t),(t||e).stats.aborted=!0,new ev(s)}class ev extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class tv extends Ug{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}class iv{constructor(e,t,i,s=0,a=-1,r=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=e,this.sn=t,this.id=i,this.size=s,this.part=a,this.partial=r}}const sv={length:0,start:()=>0,end:()=>0};class av{static isBuffered(e,t){if(e){const i=av.getBuffered(e);for(let e=i.length;e--;)if(t>=i.start(e)&&t<=i.end(e))return!0}return!1}static bufferedRanges(e){if(e){const t=av.getBuffered(e);return av.timeRangesToArray(t)}return[]}static timeRangesToArray(e){const t=[];for(let i=0;i<e.length;i++)t.push({start:e.start(i),end:e.end(i)});return t}static bufferInfo(e,t,i){if(e){const s=av.bufferedRanges(e);if(s.length)return av.bufferedInfo(s,t,i)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,i){t=Math.max(0,t),e.length>1&&e.sort((e,t)=>e.start-t.start||t.end-e.end);let s=-1,a=[];if(i)for(let r=0;r<e.length;r++){t>=e[r].start&&t<=e[r].end&&(s=r);const n=a.length;if(n){const t=a[n-1].end;e[r].start-t<i?e[r].end>t&&(a[n-1].end=e[r].end):a.push(e[r])}else a.push(e[r])}else a=e;let r,n=0,o=t,d=t;for(let e=0;e<a.length;e++){const l=a[e].start,c=a[e].end;if(-1===s&&t>=l&&t<=c&&(s=e),t+i>=l&&t<c)o=l,d=c,n=d-t;else if(t+i<l){r=l;break}}return{len:n,start:o||0,end:d||0,nextStart:r,buffered:e,bufferedIndex:s}}static getBuffered(e){try{return e.buffered||sv}catch(e){return Bg.log("failed to get media.buffered",e),sv}}}const rv=/\{\$([a-zA-Z0-9-_]+)\}/g;function nv(e){return rv.test(e)}function ov(e,t){if(null!==e.variableList||e.hasVariableRefs){const i=e.variableList;return t.replace(rv,t=>{const s=t.substring(2,t.length-1),a=null==i?void 0:i[s];return void 0===a?(e.playlistParsingError||(e.playlistParsingError=new Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${s}"`)),t):a})}return t}function dv(e,t,i){let s,a,r=e.variableList;if(r||(e.variableList=r={}),"QUERYPARAM"in t){s=t.QUERYPARAM;try{const e=new self.URL(i).searchParams;if(!e.has(s))throw new Error(`"${s}" does not match any query parameter in URI: "${i}"`);a=e.get(s)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE QUERYPARAM: ${t.message}`))}}else s=t.NAME,a=t.VALUE;s in r?e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${s}"`)):r[s]=a||""}function lv(e,t,i){const s=t.IMPORT;if(i&&s in i){let t=e.variableList;t||(e.variableList=t={}),t[s]=i[s]}else e.playlistParsingError||(e.playlistParsingError=new Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${s}"`))}const cv=/^(\d+)x(\d+)$/,hv=/(.+?)=(".*?"|.*?)(?:,|$)/g;class pv{constructor(e,t){"string"==typeof e&&(e=pv.parseAttrList(e,t)),Dg(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>"X-"===e.substring(0,2))}decimalInteger(e){const t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;const i=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)i[e]=parseInt(t.slice(2*e,2*e+2),16);return i}return null}hexadecimalIntegerAsNumber(e){const t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){const i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){const i=this[e];return(i?i.split(/[ ,]+/):[]).reduce((e,t)=>(e[t.toLowerCase()]=!0,e),t)}bool(e){return"YES"===this[e]}decimalResolution(e){const t=cv.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let i;const s={};for(hv.lastIndex=0;null!==(i=hv.exec(e));){const a=i[1].trim();let r=i[2];const n=0===r.indexOf('"')&&r.lastIndexOf('"')===r.length-1;let o=!1;if(n)r=r.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":o=!0}if(t&&(n||o))r=ov(t,r);else if(!o&&!n)switch(a){case"CLOSED-CAPTIONS":if("NONE"===r)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Bg.warn(`${e}: attribute ${a} is missing quotes`)}s[a]=r}return s}}function uv(e){return"ID"!==e&&"CLASS"!==e&&"CUE"!==e&&"START-DATE"!==e&&"DURATION"!==e&&"END-DATE"!==e&&"END-ON-NEXT"!==e}function gv(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e||"SCTE35-CMD"===e}class fv{constructor(e,t,i=0){var s;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==t?void 0:t.tagAnchor)||null,this.tagOrder=null!=(s=null==t?void 0:t.tagOrder)?s:i,t){const i=t.attr;for(const t in i)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==i[t]){Bg.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=Dg(new pv({}),i,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){const e=(null==t?void 0:t.endDate)||new Date(this.attr["END-DATE"]);vg(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){const e=this._cue;return void 0===e?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){const{tagAnchor:e}=this;return null===e||null===e.programDateTime?(Bg.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){const e=this._endDate||this._dateAtEnd;if(e)return e;const t=this.duration;return null!==t?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*t):null}get duration(){if("DURATION"in this.attr){const e=this.attr.decimalFloatingPoint("DURATION");if(vg(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return"com.apple.hls.interstitial"===this.class}get isValid(){return!!this.id&&!this._badValueForSameId&&vg(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}class mv{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&i>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1}get hasProgramDateTime(){return!!this.fragments.length&&vg(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){const e=this.driftEndTime-this.driftStartTime;if(e>0){return 1e3*(this.driftEnd-this.driftStart)/e}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){const e=this.partList;if(e){const t=this.lastPartIndex;if(-1!==t){for(let i=e.length;i--;)if(e[i].index>t)return e[i].index;return t}}return 0}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){const e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function vv(e){return"AES-128"===e||"AES-256"===e||"AES-256-CTR"===e}function yv(e){switch(e){case"AES-128":case"AES-256":return Hm;case"AES-256-CTR":return Vm;default:throw new Error(`invalid full segment method ${e}`)}}function bv(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function wv(e){return Uint8Array.from(unescape(encodeURIComponent(e)),e=>e.charCodeAt(0))}function xv(e){const t=e.split(":");let i=null;if("data"===t[0]&&2===t.length){const e=t[1].split(";"),s=e[e.length-1].split(",");if(2===s.length){const t="base64"===s[0],a=s[1];t?(e.splice(-1,1),i=bv(a)):i=function(e){const t=wv(e).subarray(0,16),i=new Uint8Array(16);return i.set(t,16-t.length),i}(a)}}return i}const kv="undefined"!=typeof self?self:void 0;var Sv={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Ev="org.w3.clearkey",Pv="com.apple.streamingkeydelivery",Tv="com.microsoft.playready",Lv="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function Cv(e){switch(e){case Pv:return Sv.FAIRPLAY;case Tv:return Sv.PLAYREADY;case Lv:return Sv.WIDEVINE;case Ev:return Sv.CLEARKEY}}var _v="1077efecc0b24d02ace33c1e52e2fb4b",Av="e2719d58a985b3c9781ab030af78d30e",Rv="9a04f07998404286ab92e65be0885f95",Iv="edef8ba979d64acea3c827dcd51d21ed";function Dv(e){return e===Iv?Sv.WIDEVINE:e===Rv?Sv.PLAYREADY:e===_v||e===Av?Sv.CLEARKEY:void 0}function Mv(e){switch(e){case Sv.FAIRPLAY:return Pv;case Sv.PLAYREADY:return Tv;case Sv.WIDEVINE:return Lv;case Sv.CLEARKEY:return Ev}}function Ov(e){const{drmSystems:t,widevineLicenseUrl:i}=e,s=t?[Sv.FAIRPLAY,Sv.WIDEVINE,Sv.PLAYREADY,Sv.CLEARKEY].filter(e=>!!t[e]):[];return!s[Sv.WIDEVINE]&&i&&s.push(Sv.WIDEVINE),s}const Uv=null!=kv&&null!=($v=kv.navigator)&&$v.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;var $v;function Fv(e){const t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),i=String.fromCharCode.apply(null,Array.from(t)),s=i.substring(i.indexOf("<"),i.length),a=(new DOMParser).parseFromString(s,"text/xml").getElementsByTagName("KID")[0];if(a){const e=a.childNodes[0]?a.childNodes[0].nodeValue:a.getAttribute("VALUE");if(e){const t=bv(e).subarray(0,16);return function(e){const t=function(e,t,i){const s=e[t];e[t]=e[i],e[i]=s};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}(t),t}}return null}let Nv={};class jv{static clearKeyUriToKeyIdMap(){Nv={}}constructor(e,t,i,s=[1],a=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=i,this.keyFormatVersions=s,this.iv=a,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&!vv(e)}isSupported(){if(this.method){if(vv(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case Pv:case Lv:case Tv:case Ev:return-1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(vv(this.method)&&this.uri&&!this.iv){"number"!=typeof e&&(Bg.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);const t=function(e){const t=new Uint8Array(16);for(let i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t}(e);return new jv(this.method,this.uri,"identity",this.keyFormatVersions,t)}const t=xv(this.uri);if(t)switch(this.keyFormat){case Lv:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case Tv:{const e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=Rf(e,0,t),this.keyId=Fv(t);break}default:{let e=t.subarray(0,16);if(16!==e.length){const t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e;break}}if(!this.keyId||16!==this.keyId.byteLength){let e=Nv[this.uri];if(!e){const t=Object.keys(Nv).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16);new DataView(e.buffer,12,4).setUint32(0,t),Nv[this.uri]=e}this.keyId=e}return this}}const zv=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Bv=/#EXT-X-MEDIA:(.*)/g,Gv=/^#EXT(?:INF|-X-TARGETDURATION):/m,Hv=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),Vv=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class qv{static findGroup(e,t){for(let i=0;i<e.length;i++){const s=e[i];if(s.id===t)return s}}static resolve(e,t){return Zg.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return Gv.test(e)}static parseMasterPlaylist(e,t){const i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:nv(e)},s=[];let a;for(zv.lastIndex=0;null!=(a=zv.exec(e));)if(a[1]){var r;const e=new pv(a[1],i),n=ov(i,a[2]),o={attrs:e,bitrate:e.decimalInteger("BANDWIDTH")||e.decimalInteger("AVERAGE-BANDWIDTH"),name:e.NAME,url:qv.resolve(n,t)},d=e.decimalResolution("RESOLUTION");d&&(o.width=d.width,o.height=d.height),Qv(e.CODECS,o);const l=e["SUPPLEMENTAL-CODECS"];l&&(o.supplemental={},Qv(l,o.supplemental)),null!=(r=o.unknownCodecs)&&r.length||s.push(o),i.levels.push(o)}else if(a[3]){const e=a[3],s=a[4];switch(e){case"SESSION-DATA":{const e=new pv(s,i),t=e["DATA-ID"];t&&(null===i.sessionData&&(i.sessionData={}),i.sessionData[t]=e);break}case"SESSION-KEY":{const e=Wv(s,t,i);e.encrypted&&e.isSupported()?(null===i.sessionKeys&&(i.sessionKeys=[]),i.sessionKeys.push(e)):Bg.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${s}"`);break}case"DEFINE":dv(i,new pv(s,i),t);break;case"CONTENT-STEERING":{const e=new pv(s,i);i.contentSteering={uri:qv.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":i.startTimeOffset=Zv(s)}}const n=s.length>0&&s.length<i.levels.length;return i.levels=n?s:i.levels,0===i.levels.length&&(i.playlistParsingError=new Error("no levels found in manifest")),i}static parseMasterPlaylistMedia(e,t,i){let s;const a={},r=i.levels,n={AUDIO:r.map(e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec})),SUBTITLES:r.map(e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec})),"CLOSED-CAPTIONS":[]};let o=0;for(Bv.lastIndex=0;null!==(s=Bv.exec(e));){const e=new pv(s[1],i),r=e.TYPE;if(r){const i=n[r],s=a[r]||[];a[r]=s;const d=e.LANGUAGE,l=e["ASSOC-LANGUAGE"],c=e.CHANNELS,h=e.CHARACTERISTICS,p=e["INSTREAM-ID"],u={attrs:e,bitrate:0,id:o++,groupId:e["GROUP-ID"]||"",name:e.NAME||d||"",type:r,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:d,url:e.URI?qv.resolve(e.URI,t):""};if(l&&(u.assocLang=l),c&&(u.channels=c),h&&(u.characteristics=h),p&&(u.instreamId=p),null!=i&&i.length){const e=qv.findGroup(i,u.groupId)||i[0];Xv(u,e,"audioCodec"),Xv(u,e,"textCodec")}s.push(u)}}return a}static parseLevelPlaylist(e,t,i,s,a,r){var n;const o={url:t},d=new mv(t),l=d.fragments,c=[];let h,p,u,g,f=null,m=0,v=0,y=0,b=0,w=0,x=null,k=new af(s,o),S=-1,E=!1,P=null;if(Hv.lastIndex=0,d.m3u8=e,d.hasVariableRefs=nv(e),"#EXTM3U"!==(null==(n=Hv.exec(e))?void 0:n[0]))return d.playlistParsingError=new Error("Missing format identifier #EXTM3U"),d;for(;null!==(h=Hv.exec(e));){E&&(E=!1,k=new af(s,o),k.playlistOffset=y,k.start=y,k.sn=m,k.cc=b,w&&(k.bitrate=w),k.level=i,f&&(k.initSegment=f,f.rawProgramDateTime&&(k.rawProgramDateTime=f.rawProgramDateTime,f.rawProgramDateTime=null),P&&(k.setByteRange(P),P=null)));const e=h[1];if(e){k.duration=parseFloat(e);const t=(" "+h[2]).slice(1);k.title=t||null,k.tagList.push(t?["INF",e,t]:["INF",e])}else if(h[3]){if(vg(k.duration)){k.playlistOffset=y,k.start=y,u&&ty(k,u,d),k.sn=m,k.level=i,k.cc=b,l.push(k);const e=(" "+h[3]).slice(1);k.relurl=ov(d,e),Jv(k,x,c),x=k,y+=k.duration,m++,v=0,E=!0}}else{if(h=h[0].match(Vv),!h){Bg.warn("No matches on slow regex match for level playlist!");continue}for(p=1;p<h.length&&void 0===h[p];p++);const e=(" "+h[p]).slice(1),a=(" "+h[p+1]).slice(1),n=h[p+2]?(" "+h[p+2]).slice(1):null;switch(e){case"BYTERANGE":x?k.setByteRange(a,x):k.setByteRange(a);break;case"PROGRAM-DATE-TIME":k.rawProgramDateTime=a,k.tagList.push(["PROGRAM-DATE-TIME",a]),-1===S&&(S=l.length);break;case"PLAYLIST-TYPE":d.type&&iy(d,e,h),d.type=a.toUpperCase();break;case"MEDIA-SEQUENCE":0!==d.startSN?iy(d,e,h):l.length>0&&sy(d,e,h),m=d.startSN=parseInt(a);break;case"SKIP":{d.skippedSegments&&iy(d,e,h);const t=new pv(a,d),i=t.decimalInteger("SKIPPED-SEGMENTS");if(vg(i)){d.skippedSegments+=i;for(let e=i;e--;)l.push(null);m+=i}const s=t.enumeratedString("RECENTLY-REMOVED-DATERANGES");s&&(d.recentlyRemovedDateranges=(d.recentlyRemovedDateranges||[]).concat(s.split("\t")));break}case"TARGETDURATION":0!==d.targetduration&&iy(d,e,h),d.targetduration=Math.max(parseInt(a),1);break;case"VERSION":null!==d.version&&iy(d,e,h),d.version=parseInt(a);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":d.live||iy(d,e,h),d.live=!1;break;case"#":(a||n)&&k.tagList.push(n?[a,n]:[a]);break;case"DISCONTINUITY":b++,k.tagList.push(["DIS"]);break;case"GAP":k.gap=!0,k.tagList.push([e]);break;case"BITRATE":k.tagList.push([e,a]),w=1e3*parseInt(a),vg(w)?k.bitrate=w:w=0;break;case"DATERANGE":{const e=new pv(a,d),t=new fv(e,d.dateRanges[e.ID],d.dateRangeTagCount);d.dateRangeTagCount++,t.isValid||d.skippedSegments?d.dateRanges[t.id]=t:Bg.warn(`Ignoring invalid DATERANGE tag: "${a}"`),k.tagList.push(["EXT-X-DATERANGE",a]);break}case"DEFINE":{const e=new pv(a,d);"IMPORT"in e?lv(d,e,r):dv(d,e,t)}break;case"DISCONTINUITY-SEQUENCE":0!==d.startCC?iy(d,e,h):l.length>0&&sy(d,e,h),d.startCC=b=parseInt(a);break;case"KEY":{const e=Wv(a,t,d);if(e.isSupported()){if("NONE"===e.method){u=void 0;break}u||(u={}),u[e.keyFormat]&&(u=Dg({},u)),u[e.keyFormat]=e}else Bg.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${a}"`);break}case"START":d.startTimeOffset=Zv(a);break;case"MAP":{const e=new pv(a,d);if(k.duration){const t=new af(s,o);ey(t,e,i,u),f=t,k.initSegment=f,f.rawProgramDateTime&&!k.rawProgramDateTime&&(k.rawProgramDateTime=f.rawProgramDateTime)}else{const t=k.byteRangeEndOffset;if(t){const e=k.byteRangeStartOffset;P=`${t-e}@${e}`}else P=null;ey(k,e,i,u),f=k,E=!0}f.cc=b;break}case"SERVER-CONTROL":g&&iy(d,e,h),g=new pv(a),d.canBlockReload=g.bool("CAN-BLOCK-RELOAD"),d.canSkipUntil=g.optionalFloat("CAN-SKIP-UNTIL",0),d.canSkipDateRanges=d.canSkipUntil>0&&g.bool("CAN-SKIP-DATERANGES"),d.partHoldBack=g.optionalFloat("PART-HOLD-BACK",0),d.holdBack=g.optionalFloat("HOLD-BACK",0);break;case"PART-INF":{d.partTarget&&iy(d,e,h);const t=new pv(a);d.partTarget=t.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=d.partList;e||(e=d.partList=[]);const t=v>0?e[e.length-1]:void 0,i=v++,s=new pv(a,d),r=new rf(s,k,o,i,t);e.push(r),k.duration+=r.duration;break}case"PRELOAD-HINT":{const e=new pv(a,d);d.preloadHint=e;break}case"RENDITION-REPORT":{const e=new pv(a,d);d.renditionReports=d.renditionReports||[],d.renditionReports.push(e);break}default:Bg.warn(`line parsed but not handled: ${h}`)}}}x&&!x.relurl?(l.pop(),y-=x.duration,d.partList&&(d.fragmentHint=x)):d.partList&&(Jv(k,x,c),k.cc=b,d.fragmentHint=k,u&&ty(k,u,d)),d.targetduration||(d.playlistParsingError=new Error("#EXT-X-TARGETDURATION is required"));const T=l.length,L=l[0],C=l[T-1];if(y+=d.skippedSegments*d.targetduration,y>0&&T&&C){d.averagetargetduration=y/T;const e=C.sn;d.endSN="initSegment"!==e?e:0,d.live||(C.endList=!0),L&&void 0===d.startCC&&(d.startCC=L.cc),S>0&&(!function(e,t){let i=e[t];for(let s=t;s--;){const t=e[s];if(!t)return;t.programDateTime=i.programDateTime-1e3*t.duration,i=t}}(l,S),L&&c.unshift(L))}else d.endSN=0,d.startCC=0;return d.fragmentHint&&(y+=d.fragmentHint.duration),d.totalduration=y,c.length&&d.dateRangeTagCount&&L&&Kv(c,d),d.endCC=b,d}}function Kv(e,t){const i=e.length;if(!i)return;const s=e[i-1],a=t.live?1/0:t.totalduration,r=Object.keys(t.dateRanges);for(let n=r.length;n--;){const o=t.dateRanges[r[n]],d=o.startDate.getTime();o.tagAnchor=s.ref;for(let s=i;s--;){const i=Yv(t,d,e,s,a);if(-1!==i){o.tagAnchor=t.fragments[i].ref;break}}}}function Yv(e,t,i,s,a){const r=i[s];if(r){const o=r.programDateTime;if(t>=o||0===s){var n;if(t<=o+1e3*(((null==(n=i[s+1])?void 0:n.start)||a)-r.start)){const a=i[s].sn-e.startSN,r=e.fragments;if(r.length>i.length){for(let n=(i[s+1]||r[r.length-1]).sn-e.startSN;n>a;n--){const e=r[n].programDateTime;if(t>=e&&t<e+1e3*r[n].duration)return n}}return a}}}return-1}function Wv(e,t,i){var s,a;const r=new pv(e,i),n=null!=(s=r.METHOD)?s:"",o=r.URI,d=r.hexadecimalInteger("IV"),l=r.KEYFORMATVERSIONS,c=null!=(a=r.KEYFORMAT)?a:"identity";o&&r.IV&&!d&&Bg.error(`Invalid IV: ${r.IV}`);const h=o?qv.resolve(o,t):"",p=(l||"1").split("/").map(Number).filter(Number.isFinite);return new jv(n,h,c,p,d)}function Zv(e){const t=new pv(e).decimalFloatingPoint("TIME-OFFSET");return vg(t)?t:null}function Qv(e,t){let i=(e||"").split(/[ ,]+/).filter(e=>e);["video","audio","text"].forEach(e=>{const s=i.filter(t=>Of(t,e));s.length&&(t[`${e}Codec`]=s.map(e=>e.split("/")[0]).join(","),i=i.filter(e=>-1===s.indexOf(e)))}),t.unknownCodecs=i}function Xv(e,t,i){const s=t[i];s&&(e[i]=s)}function Jv(e,t,i){e.rawProgramDateTime?i.push(e):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime)}function ey(e,t,i,s){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=i,e.sn="initSegment",s&&(e.levelkeys=s),e.initSegment=null}function ty(e,t,i){e.levelkeys=t;const{encryptedFragments:s}=i;s.length&&s[s.length-1].levelkeys===t||!Object.keys(t).some(e=>t[e].isCommonEncryption)||s.push(e)}function iy(e,t,i){e.playlistParsingError=new Error(`#EXT-X-${t} must not appear more than once (${i[0]})`)}function sy(e,t,i){e.playlistParsingError=new Error(`#EXT-X-${t} must appear before the first Media Segment (${i[0]})`)}function ay(e,t){const i=t.startPTS;if(vg(i)){let s,a=0;t.sn>e.sn?(a=i-e.start,s=e):(a=e.start-i,s=t),s.duration!==a&&s.setDuration(a)}else if(t.sn>e.sn){e.cc===t.cc&&e.minEndPTS?t.setStart(e.start+(e.minEndPTS-e.start)):t.setStart(e.start+e.duration)}else t.setStart(Math.max(e.start-t.duration,0))}function ry(e,t,i,s,a,r){s-i<=0&&(Bg.warn("Fragment should have a positive duration",t),s=i+t.duration,r=a+t.duration);let n=i,o=s;const d=t.startPTS,l=t.endPTS;if(vg(d)){const e=Math.abs(d-i);vg(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,n=Math.max(i,d),i=Math.min(i,d),a=Math.min(a,t.startDTS),o=Math.min(s,l),s=Math.max(s,l),r=Math.max(r,t.endDTS)}const c=i-t.start;0!==t.start&&t.setStart(i),t.setDuration(s-t.start),t.startPTS=i,t.maxStartPTS=n,t.startDTS=a,t.endPTS=s,t.minEndPTS=o,t.endDTS=r;const h=t.sn;if(!e||h<e.startSN||h>e.endSN)return 0;let p;const u=h-e.startSN,g=e.fragments;for(g[u]=t,p=u;p>0;p--)ay(g[p],g[p-1]);for(p=u;p<g.length-1;p++)ay(g[p],g[p+1]);return e.fragmentHint&&ay(g[g.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,c}function ny(e,t){if(e===t)return;let i=null;const s=e.fragments;for(let e=s.length-1;e>=0;e--){const t=s[e].initSegment;if(t){i=t;break}}let a;e.fragmentHint&&delete e.fragmentHint.endPTS,function(e,t,i){const s=t.skippedSegments,a=Math.max(e.startSN,t.startSN)-t.startSN,r=(e.fragmentHint?1:0)+(s?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,n=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,d=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let l=a;l<=r;l++){const a=d[n+l];let r=o[l];if(s&&!r&&a&&(r=t.fragments[l]=a),a&&r){if(i(a,r,l,o),a.url&&a.url!==r.url)return void(t.playlistParsingError=oy(`media sequence mismatch ${r.sn}:`,e,t,a,r));if(a.cc!==r.cc)return void(t.playlistParsingError=oy(`discontinuity sequence mismatch (${a.cc}!=${r.cc})`,e,t,a,r))}}}(e,t,(e,s,r,n)=>{if((!t.startCC||t.skippedSegments)&&s.cc!==e.cc){const i=e.cc-s.cc;for(let e=r;e<n.length;e++)n[e].cc+=i;t.endCC=n[n.length-1].cc}vg(e.startPTS)&&vg(e.endPTS)&&(s.setStart(s.startPTS=e.startPTS),s.startDTS=e.startDTS,s.maxStartPTS=e.maxStartPTS,s.endPTS=e.endPTS,s.endDTS=e.endDTS,s.minEndPTS=e.minEndPTS,s.setDuration(e.endPTS-e.startPTS),s.duration&&(a=s),t.PTSKnown=t.alignedSliding=!0),e.hasStreams&&(s.elementaryStreams=e.elementaryStreams),s.loader=e.loader,e.hasStats&&(s.stats=e.stats),e.initSegment&&(s.initSegment=e.initSegment,i=e.initSegment)});const r=t.fragments,n=t.fragmentHint?r.concat(t.fragmentHint):r;if(i&&n.forEach(e=>{var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=i)?void 0:t.relurl)||(e.initSegment=i)}),t.skippedSegments){if(t.deltaUpdateFailed=r.some(e=>!e),t.deltaUpdateFailed){Bg.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)r.shift();t.startSN=r[0].sn}else{t.canSkipDateRanges&&(t.dateRanges=function(e,t){const{dateRanges:i,recentlyRemovedDateranges:s}=t,a=Dg({},e);s&&s.forEach(e=>{delete a[e]});const r=Object.keys(a).length;r&&Object.keys(i).forEach(e=>{const t=a[e],s=new fv(i[e].attr,t);s.isValid?(a[e]=s,t||(s.tagOrder+=r)):Bg.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${lm(i[e].attr)}"`)});return a}(e.dateRanges,t));const i=e.fragments.filter(e=>e.rawProgramDateTime);if(e.hasProgramDateTime&&!t.hasProgramDateTime)for(let e=1;e<n.length;e++)null===n[e].programDateTime&&Jv(n[e],n[e-1],i);Kv(i,t)}t.endCC=r[r.length-1].cc}if(!t.startCC){var o;const i=hy(e,t.startSN-1);t.startCC=null!=(o=null==i?void 0:i.cc)?o:r[0].cc}!function(e,t,i){if(e&&t){let s=0;for(let a=0,r=e.length;a<=r;a++){const r=e[a],n=t[a+s];r&&n&&r.index===n.index&&r.fragment.sn===n.fragment.sn?i(r,n):s--}}}(e.partList,t.partList,(e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats}),a?ry(t,a,a.startPTS,a.endPTS,a.startDTS,a.endDTS):dy(e,t),r.length&&(t.totalduration=t.edge-r[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;const d=t.advancedDateTime;if(t.advanced&&d){const e=t.edge;t.driftStart||(t.driftStartTime=d,t.driftStart=e),t.driftEndTime=d,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime;-1===t.requestScheduled&&(t.requestScheduled=e.requestScheduled)}function oy(e,t,i,s,a){return new Error(`${e} ${a.url}\nPlaylist starting @${t.startSN}\n${t.m3u8}\n\nPlaylist starting @${i.startSN}\n${i.m3u8}`)}function dy(e,t,i=!0){const s=t.startSN+t.skippedSegments-e.startSN,a=e.fragments,r=s>=0;let n=0;if(r&&s<a.length)n=a[s].start;else if(r&&t.startSN===e.endSN+1)n=e.fragmentEnd;else if(r&&i)n=e.fragmentStart+s*t.levelTargetDuration;else{if(t.skippedSegments||0!==t.fragmentStart)return;n=e.fragmentStart}ly(t,n)}function ly(e,t){if(t){const i=e.fragments;for(let s=e.skippedSegments;s<i.length;s++)i[s].addStart(t);e.fragmentHint&&e.fragmentHint.addStart(t)}}function cy(e,t=1/0){let i=1e3*e.targetduration;if(e.updated){const s=e.fragments,a=4;if(s.length&&i*a>t){const e=1e3*s[s.length-1].duration;e<i&&(i=e)}}else i/=2;return Math.round(i)}function hy(e,t,i){if(!e)return null;let s=e.fragments[t-e.startSN];return s||(s=e.fragmentHint,s&&s.sn===t?s:t<e.startSN&&i&&i.sn===t?i:null)}function py(e,t,i){return e?uy(e.partList,t,i):null}function uy(e,t,i){if(e)for(let s=e.length;s--;){const a=e[s];if(a.index===i&&a.fragment.sn===t)return a}return null}function gy(e){e.forEach((e,t)=>{var i;null==(i=e.details)||i.fragments.forEach(e=>{e.level=t,e.initSegment&&(e.initSegment.level=t)})})}function fy(e,t){for(let s=0,a=e.length;s<a;s++){var i;if((null==(i=e[s])?void 0:i.cc)===t)return e[s]}return null}function my(e,t){if(e){const i=e.start+t;e.start=e.startPTS=i,e.endPTS=i+e.duration}}function vy(e,t){const i=t.fragments;for(let t=0,s=i.length;t<s;t++)my(i[t],e);t.fragmentHint&&my(t.fragmentHint,e),t.alignedSliding=!0}function yy(e,t){if(!function(e,t){return!!(e&&t.startCC<e.endCC&&t.endCC>e.startCC)}(t,e))return;const i=Math.min(t.endCC,e.endCC),s=fy(t.fragments,i),a=fy(e.fragments,i);if(!s||!a)return;Bg.log(`Aligning playlist at start of dicontinuity sequence ${i}`);vy(s.start-a.start,e)}function by(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;const i=e.fragments,s=t.fragments;if(!i.length||!s.length)return;let a,r;const n=Math.min(t.endCC,e.endCC);t.startCC<n&&e.startCC<n&&(a=fy(s,n),r=fy(i,n)),a&&r||(a=s[Math.floor(s.length/2)],r=fy(i,a.cc)||i[Math.floor(i.length/2)]);const o=a.programDateTime,d=r.programDateTime;if(!o||!d)return;vy((d-o)/1e3-(r.start-a.start),e)}const wy=function(e){let t="";const i=e.length;for(let s=0;s<i;s++)t+=`[${e.start(s).toFixed(3)}-${e.end(s).toFixed(3)}]`;return t},xy="STOPPED",ky="IDLE",Sy="KEY_LOADING",Ey="FRAG_LOADING",Py="FRAG_LOADING_WAITING_RETRY",Ty="WAITING_TRACK",Ly="PARSING",Cy="PARSED",_y="ENDED",Ay="ERROR",Ry="WAITING_INIT_PTS",Iy="WAITING_LEVEL";class Dy extends tv{constructor(e,t,i,s,a){super(s,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=xy,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{const{config:e,fragCurrent:t,media:i,mediaBuffer:s,state:a}=this,r=i?i.currentTime:0,n=av.bufferInfo(s||i,r,e.maxBufferHole);if(this.log(`media seeking to ${vg(r)?r.toFixed(3):r}, state: ${a}`),this.state===_y)this.resetLoadingState();else if(t){const i=e.maxFragLookUpTolerance,s=t.start-i,a=t.start+t.duration+i;if(!n.len||a<n.start||s>n.end){const e=r>a;(r<s||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(i){this.fragmentTracker.removeFragmentsInRange(r,1/0,this.playlistType,!0);if(r>this.lastCurrentTime&&(this.lastCurrentTime=r),!this.loadingParts){const e=Math.max(n.end,r),t=this.shouldLoadParts(this.getLevelDetails(),e);t&&(this.log(`LL-Part loading ON after seeking to ${r.toFixed(2)} with buffer @${e.toFixed(2)}`),this.loadingParts=t)}}this.hls.hasEnoughToStart||n.len||(this.log(`setting startPosition to ${r} because of seek before start`),this.nextLoadPosition=this.startPosition=r),this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=a,this.hls=e,this.fragmentLoader=new Qm(e.config),this.keyLoader=i,this.fragmentTracker=t,this.config=e.config,this.decrypter=new Wm(e.config)}registerListeners(){const{hls:e}=this;e.on(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(kg.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(kg.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===xy)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);const e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=xy}get startPositionValue(){const{nextLoadPosition:e,startPosition:t}=this;return-1===t&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;const i=e.end||0,s=this.config.timelineOffset||0;if(i<=s)return!1;const a=e.buffered;this.config.maxBufferHole&&a&&a.length>1&&(e=av.bufferedInfo(a,e.start,0));const r=e.nextStart;if(r&&r>s&&r<t.edge)return!1;if(this.media.currentTime<e.start)return!1;const n=t.partList;if(null!=n&&n.length){const e=n[n.length-1];return av.isBuffered(this.media,e.start+e.duration/2)}const o=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(o)}getLevelDetails(){var e;if(this.levels&&null!==this.levelLastLoaded)return null==(e=this.levelLastLoaded)?void 0:e.details}get timelineOffset(){const e=this.config.timelineOffset;var t;return e?(null==(t=this.getLevelDetails())?void 0:t.appliedTimelineOffset)||e:0}onMediaAttached(e,t){const i=this.media=this.mediaBuffer=t.media;i.removeEventListener("seeking",this.onMediaSeeking),i.removeEventListener("ended",this.onMediaEnded),i.addEventListener("seeking",this.onMediaSeeking),i.addEventListener("ended",this.onMediaEnded);const s=this.config;this.levels&&s.autoStartLoad&&this.state===xy&&this.startLoad(s.startPosition)}onMediaDetaching(e,t){const i=!!t.transferMedia,s=this.media;if(null!==s){if(s.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),s.removeEventListener("seeking",this.onMediaSeeking),s.removeEventListener("ended",this.onMediaEnded),this.keyLoader&&!i&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,i)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=xy,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,i){this.startFragRequested=!0,this._loadFragForPlayback(e,t,i)}_loadFragForPlayback(e,t,i){this._doFragLoad(e,t,i,e=>{const t=e.frag;if(this.fragContextChanged(t))return this.warn(`${t.type} sn: ${t.sn}${e.part?" part: "+e.part.index:""} of ${this.fragInfo(t,!1,e.part)}) was dropped during download.`),void this.fragmentTracker.removeFragment(t);t.stats.chunkCount++,this._handleFragmentLoadProgress(e)}).then(e=>{if(!e)return;const t=this.state,i=e.frag;this.fragContextChanged(i)?(t===Ey||!this.fragCurrent&&t===Ly)&&(this.fragmentTracker.removeFragment(i),this.state=ky):("payload"in e&&(this.log(`Loaded ${i.type} sn: ${i.sn} of ${this.playlistLabel()} ${i.level}`),this.hls.trigger(kg.FRAG_LOADED,e)),this._handleFragmentLoadComplete(e))}).catch(t=>{this.state!==xy&&this.state!==Ay&&(this.warn(`Frag error: ${(null==t?void 0:t.message)||t}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;const{fragmentTracker:i}=this;if(i.getState(e)===$m){const t=e.type,s=this.getFwdBufferInfo(this.mediaBuffer,t),a=Math.max(e.duration,s?s.len:this.config.maxBufferLength),r=this.backtrackFragment;(1===(r?e.sn-r.sn:0)||this.reduceMaxBufferLength(a,e.duration))&&i.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),i.getState(e)===Fm&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){const t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){const t=e.details;return(null==t?void 0:t.live)&&"EVENT"!==t.type&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,i=null){if(!(e-t))return;const s={startOffset:e,endOffset:t,type:i};this.hls.trigger(kg.BUFFER_FLUSHING,s)}_loadInitSegment(e,t){this._doFragLoad(e,t).then(e=>{const t=null==e?void 0:e.frag;if(!t||this.fragContextChanged(t)||!this.levels)throw new Error("init load aborted");return e}).then(e=>{const{hls:t}=this,{frag:i,payload:s}=e,a=i.decryptdata;if(s&&s.byteLength>0&&null!=a&&a.key&&a.iv&&vv(a.method)){const r=self.performance.now();return this.decrypter.decrypt(new Uint8Array(s),a.key.buffer,a.iv.buffer,yv(a.method)).catch(e=>{throw t.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:i}),e}).then(s=>{const a=self.performance.now();return t.trigger(kg.FRAG_DECRYPTED,{frag:i,payload:s,stats:{tstart:r,tdecrypt:a}}),e.payload=s,this.completeInitSegmentLoad(e)})}return this.completeInitSegmentLoad(e)}).catch(t=>{this.state!==xy&&this.state!==Ay&&(this.warn(t),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){const{levels:t}=this;if(!t)throw new Error("init load aborted, missing levels");const i=e.frag.stats;this.state!==xy&&(this.state=ky),e.frag.data=new Uint8Array(e.payload),i.parsing.start=i.buffering.start=self.performance.now(),i.parsing.end=i.buffering.end=self.performance.now(),this.tick()}fragContextChanged(e){const{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){const i=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${i?wy(av.getBuffered(i)):"(detached)"})`),sf(e)){var s;if(e.type!==_g){const t=e.elementaryStreams;if(!Object.keys(t).some(e=>!!t[e]))return void(this.state=ky)}const t=null==(s=this.levels)?void 0:s[e.level];null!=t&&t.fragmentError&&(this.log(`Resetting level fragment error count of ${t.fragmentError} on frag buffered`),t.fragmentError=0)}this.state=ky}_handleFragmentLoadComplete(e){const{transmuxer:t}=this;if(!t)return;const{frag:i,part:s,partsLoaded:a}=e,r=!a||0===a.length||a.some(e=>!e),n=new iv(i.level,i.sn,i.stats.chunkCount+1,0,s?s.index:-1,!r);t.flush(n)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,i=null,s){var a;this.fragCurrent=e;const r=null==t?void 0:t.details;if(!this.levels||!r)throw new Error(`frag load aborted, missing level${r?"":" detail"}s`);let n=null;!e.encrypted||null!=(a=e.decryptdata)&&a.key?e.encrypted||(n=this.keyLoader.loadClear(e,r.encryptedFragments),n&&this.log("[eme] blocking frag load until media-keys acquired")):(this.log(`Loading key for ${e.sn} of [${r.startSN}-${r.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=Sy,this.fragCurrent=e,n=this.keyLoader.load(e).then(e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(kg.KEY_LOADED,e),this.state===Sy&&(this.state=ky),e}),this.hls.trigger(kg.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(n=Promise.reject(new Error("frag load aborted, context changed in KEY_LOADING"))));const o=this.fragPrevious;if(sf(e)&&(!o||e.sn!==o.sn)){const i=this.shouldLoadParts(t.details,e.end);i!==this.loadingParts&&(this.log(`LL-Part loading ${i?"ON":"OFF"} loading sn ${null==o?void 0:o.sn}->${e.sn}`),this.loadingParts=i)}if(i=Math.max(e.start,i||0),this.loadingParts&&sf(e)){const a=r.partList;if(a&&s){i>e.end&&r.fragmentHint&&(e=r.fragmentHint);const o=this.getNextPart(a,e,i);if(o>-1){const d=a[o];let l;return e=this.fragCurrent=d.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${d.index} (${o}/${a.length-1}) of ${this.fragInfo(e,!1,d)}) cc: ${e.cc} [${r.startSN}-${r.endSN}], target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=d.start+d.duration,this.state=Ey,l=n?n.then(i=>!i||this.fragContextChanged(i.frag)?null:this.doFragPartsLoad(e,d,t,s)).catch(e=>this.handleFragLoadError(e)):this.doFragPartsLoad(e,d,t,s).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(kg.FRAG_LOADING,{frag:e,part:d,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):l}if(!e.url||this.loadedEndOfParts(a,i))return Promise.resolve(null)}}if(sf(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${i.toFixed(2)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${r?"["+r.startSN+"-"+r.endSN+"]":""}, target: ${parseFloat(i.toFixed(3))}`),vg(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Ey;const d=this.config.progressive;let l;return l=d&&n?n.then(t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,s)).catch(e=>this.handleFragLoadError(e)):Promise.all([this.fragmentLoader.load(e,d?s:void 0),n]).then(([e])=>(!d&&e&&s&&s(e),e)).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(kg.FRAG_LOADING,{frag:e,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(e,t,i,s){return new Promise((a,r)=>{var n;const o=[],d=null==(n=i.details)?void 0:n.partList,l=t=>{this.fragmentLoader.loadPart(e,t,s).then(s=>{o[t.index]=s;const r=s.part;this.hls.trigger(kg.FRAG_LOADED,s);const n=py(i.details,e.sn,t.index+1)||uy(d,e.sn,t.index+1);if(!n)return a({frag:e,part:r,partsLoaded:o});l(n)}).catch(r)};l(t)})}handleFragLoadError(e){if("data"in e){const t=e.data;e.data&&t.details===xg.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(kg.ERROR,t)}else this.hls.trigger(kg.ERROR,{type:wg.OTHER_ERROR,details:xg.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){const t=this.getCurrentContext(e);if(!t||this.state!==Ly)return void(this.fragCurrent||this.state===xy||this.state===Ay||(this.state=ky));const{frag:i,part:s,level:a}=t,r=self.performance.now();i.stats.parsing.end=r,s&&(s.stats.parsing.end=r);const n=this.getLevelDetails(),o=n&&i.sn>n.endSN||this.shouldLoadParts(n,i.end);o!==this.loadingParts&&(this.log(`LL-Part loading ${o?"ON":"OFF"} after parsing segment ending @${i.end.toFixed(2)}`),this.loadingParts=o),this.updateLevelTiming(i,s,a,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(null!=e&&e.partList){var i;const a=e.partList[0];if(t>=a.end+((null==(i=e.fragmentHint)?void 0:i.duration)||0)){var s;if((this.hls.hasEnoughToStart?(null==(s=this.media)?void 0:s.currentTime)||this.lastCurrentTime:this.getLoadPosition())>a.start-a.fragment.duration)return!0}}}return!1}getCurrentContext(e){const{levels:t,fragCurrent:i}=this,{level:s,sn:a,part:r}=e;if(null==t||!t[s])return this.warn(`Levels object was unset while buffering fragment ${a} of ${this.playlistLabel()} ${s}. The current chunk will not be buffered.`),null;const n=t[s],o=n.details,d=r>-1?py(o,a,r):null,l=d?d.fragment:hy(o,a,i);return l?(i&&i!==l&&(l.stats=i.stats),{frag:l,part:d,level:n}):null}bufferFragmentData(e,t,i,s,a){var r;if(!e||this.state!==Ly)return;const{data1:n,data2:o}=e;let d=n;if(n&&o&&(d=Pf(n,o)),null==(r=d)||!r.length)return;const l={type:e.type,frag:t,part:i,chunkMeta:s,parent:t.type,data:d};if(this.hls.trigger(kg.BUFFER_APPENDING,l),e.dropped&&e.independent&&!i){if(a)return;this.flushBufferGap(t)}}flushBufferGap(e){const t=this.media;if(!t)return;if(!av.isBuffered(t,t.currentTime))return void this.flushMainBuffer(0,e.start);const i=t.currentTime,s=av.bufferInfo(t,i,0),a=e.duration,r=Math.min(2*this.config.maxFragLookUpTolerance,.25*a),n=Math.max(Math.min(e.start-r,s.end-r),i+r);e.start-n>r&&this.flushMainBuffer(n,e.start)}getFwdBufferInfo(e,t){var i;const s=this.getLoadPosition();if(!vg(s))return null;const a=this.lastCurrentTime>s||null!=(i=this.media)&&i.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,s,t,a)}getFwdBufferInfoAtPos(e,t,i,s){const a=av.bufferInfo(e,t,s);if(0===a.len&&void 0!==a.nextStart){const r=this.fragmentTracker.getBufferedFrag(t,i);if(r&&(a.nextStart<=r.end||r.gap)){const i=Math.max(Math.min(a.nextStart,r.end)-t,s);return av.bufferInfo(e,t,i)}}return a}getMaxBufferLength(e){const{config:t}=this;let i;return i=e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,Math.min(i,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){const i=this.config,s=Math.max(Math.min(e-t,i.maxBufferLength),t),a=Math.max(e-3*t,i.maxMaxBufferLength/2,s);return a>=s&&(i.maxMaxBufferLength=a,this.warn(`Reduce max buffer length to ${a}s`),!0)}getAppendedFrag(e,t=Lg){var i;const s=null==(i=this.fragmentTracker)?void 0:i.getAppendedFrag(e,t);return s&&"fragment"in s?s.fragment:s}getNextFragment(e,t){const i=t.fragments,s=i.length;if(!s)return null;const{config:a}=this,r=i[0].start,n=a.lowLatencyMode&&!!t.partList;let o=null;if(t.live){const i=a.initialLiveManifestSize;if(s<i)return this.warn(`Not enough fragments to start playback (have: ${s}, need: ${i})`),null;if(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<r){var d;n&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),o=this.getInitialLiveFragment(t);const i=this.hls.startPosition,s=this.hls.liveSyncPosition,a=o?(-1!==i&&i>=r?i:s)||o.start:e;this.log(`Setting startPosition to ${a} to match start frag at live edge. mainStart: ${i} liveSyncPosition: ${s} frag.start: ${null==(d=o)?void 0:d.start}`),this.startPosition=this.nextLoadPosition=a}}else e<=r&&(o=i[0]);if(!o){const i=this.loadingParts?t.partEnd:t.fragmentEnd;o=this.getFragmentAtPosition(e,i,t)}let l=this.filterReplacedPrimary(o,t);if(!l&&o){const e=o.sn-t.startSN;l=this.filterReplacedPrimary(i[e+1]||null,t)}return this.mapToInitFragWhenRequired(l)}isLoopLoading(e,t){const i=this.fragmentTracker.getState(e);return(i===Nm||i===Fm&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,i,s,a){let r=null;if(e.gap&&(r=this.getNextFragment(this.nextLoadPosition,t),r&&!r.gap&&i.nextStart)){const e=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,s,0);if(null!==e&&i.len+e.len>=a){const e=r.sn;return this.loopSn!==e&&(this.log(`buffer full after gaps in "${s}" playlist starting at sn: ${e}`),this.loopSn=e),null}}return this.loopSn=void 0,r}get primaryPrefetch(){if(My(this.hls.config)){var e,t;if(null==(e=this.hls.interstitialsManager)||null==(t=e.playingItem)?void 0:t.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if(My(this.hls.config)&&e.type!==_g){const i=this.hls.interstitialsManager,s=null==i?void 0:i.bufferingItem;if(s){const i=s.event;if(i){if(i.appendInPlace||Math.abs(e.start-s.start)>1||0===s.start)return null}else{if(e.end<=s.start&&!1===(null==t?void 0:t.live))return null;if(e.start>s.end&&s.nextEvent&&(s.nextEvent.appendInPlace||e.start-s.end>1))return null}}const a=null==i?void 0:i.playerQueue;if(a)for(let t=a.length;t--;){const i=a[t].interstitial;if(i.appendInPlace&&e.start>=i.startTime&&e.end<=i.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,i){let s=-1,a=!1,r=!0;for(let n=0,o=e.length;n<o;n++){const o=e[n];if(r=r&&!o.independent,s>-1&&i<o.start)break;const d=o.loaded;d?s=-1:(a||o.independent||r)&&o.fragment===t&&(s=n),a=d}return s}loadedEndOfParts(e,t){const i=e[e.length-1];return i&&t>i.start&&i.loaded}getInitialLiveFragment(e){const t=e.fragments,i=this.fragPrevious;let s=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),s=function(e,t,i){if(null===t||!Array.isArray(e)||!e.length||!vg(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;for(let s=0;s<e.length;++s){const a=e[s];if(xm(t,i,a))return a}return null}(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!s){const a=i.sn+1;if(a>=e.startSN&&a<=e.endSN){const r=t[a-e.startSN];i.cc===r.cc&&(s=r,this.log(`Live playlist, switching playlist, load frag with next SN: ${s.sn}`))}s||(s=km(e,i.cc,i.end),s&&this.log(`Live playlist, switching playlist, load frag with same CC: ${s.sn}`))}}else{const t=this.hls.liveSyncPosition;null!==t&&(s=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return s}getFragmentAtPosition(e,t,i){const{config:s}=this;let{fragPrevious:a}=this,{fragments:r,endSN:n}=i;const{fragmentHint:o}=i,{maxFragLookUpTolerance:d}=s,l=i.partList,c=!!(this.loadingParts&&null!=l&&l.length&&o);let h;if(c&&o&&!this.bitrateTest&&l[l.length-1].fragment.sn===o.sn&&(r=r.concat(o),n=o.sn),e<t){var p;h=bm(a,r,e,e<this.lastCurrentTime||e>t-d||null!=(p=this.media)&&p.paused||!this.startFragRequested?0:d)}else h=r[r.length-1];if(h){const e=h.sn-i.startSN,t=this.fragmentTracker.getState(h);if((t===Nm||t===Fm&&h.gap)&&(a=h),a&&h.sn===a.sn&&(!c||l[0].fragment.sn>h.sn||!i.live&&!c)){if(a&&h.level===a.level){const t=r[e+1];h=h.sn<n&&this.fragmentTracker.getState(t)!==Nm?t:null}}}return h}alignPlaylists(e,t,i){const s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;const a=e.fragmentStart,r=!t,n=e.alignedSliding&&vg(a);if(r||!n&&!a){!function(e,t){e&&(yy(t,e),!t.alignedSliding&&e&&by(t,e),t.alignedSliding||!e||t.skippedSegments||dy(e,t,!1))}(i,e);const a=e.fragmentStart;return this.log(`Live playlist sliding: ${a.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${s}`),a}return a}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let i=this.startPosition;i<t&&(i=-1);const s=this.timelineOffset;if(-1===i){const a=null!==this.startTimeOffset,r=a?this.startTimeOffset:e.startTimeOffset;null!==r&&vg(r)?(i=t+r,r<0&&(i+=e.edge),i=Math.min(Math.max(t,i),t+e.totalduration),this.log(`Setting startPosition to ${i} for start time offset ${r} found in ${a?"multivariant":"media"} playlist`),this.startPosition=i):e.live?(i=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${i}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=i=0),this.lastCurrentTime=i+s}this.nextLoadPosition=i+s}getLoadPosition(){var e;const{media:t}=this;let i=0;return null!=(e=this.hls)&&e.hasEnoughToStart&&t?i=t.currentTime:this.nextLoadPosition>=0&&(i=this.nextLoadPosition),i}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&sf(e)&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Py)||(this.state=ky)}onFragmentOrKeyLoadError(e,t){if(t.chunkMeta&&!t.frag){const e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}const i=t.frag;if(!i||i.type!==e||!this.levels)return;var s;if(this.fragContextChanged(i))return void this.warn(`Frag load error must match current frag to retry ${i.url} > ${null==(s=this.fragCurrent)?void 0:s.url}`);const a=t.details===xg.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(i,!0);const r=t.errorAction,{action:n,flags:o,retryCount:d=0,retryConfig:l}=r||{},c=!!r&&!!l,h=c&&n===Rm,p=c&&!r.resolved&&o===Dm;if(!h&&p&&sf(i)&&!i.endList)this.resetFragmentErrors(e),this.treatAsGap(i),r.resolved=!0;else if((h||p)&&d<l.maxNumRetry){this.resetStartWhenNotLoaded(this.levelLastLoaded);const s=Pm(l,d);this.warn(`Fragment ${i.sn} of ${e} ${i.level} errored with ${t.details}, retrying loading ${d+1}/${l.maxNumRetry} in ${s}ms`),r.resolved=!0,this.retryDate=self.performance.now()+s,this.state=Py}else if(l&&r){if(this.resetFragmentErrors(e),!(d<l.maxNumRetry))return void this.warn(`${t.details} reached or exceeded max retry (${d})`);a||n===Am||(r.resolved=!0)}else this.state=n===_m?Iy:Ay;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===Ly||this.state===Cy){const t=e.frag,i=e.parent,s=this.getFwdBufferInfo(this.mediaBuffer,i),a=s&&s.len>.5;a&&this.reduceMaxBufferLength(s.len,(null==t?void 0:t.duration)||10);const r=!a;return r&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${i} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),r}return!1}resetFragmentErrors(e){e===Cg&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==xy&&(this.state=ky)}afterBufferFlushed(e,t,i){if(!e)return;const s=av.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,s,i),this.state===_y&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==xy&&(this.state=ky)}resetStartWhenNotLoaded(e){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;const t=e?e.details:null;null!=t&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.warn(`The loading context changed while buffering fragment ${e.sn} of ${this.playlistLabel()} ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,i,s){const a=i.details;if(!a)return void this.warn("level.details undefined");var r;if(!Object.keys(e.elementaryStreams).reduce((t,r)=>{const n=e.elementaryStreams[r];if(n){const o=n.endPTS-n.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${e.sn} ${r} duration reliably (${o})`),t||!1;const d=s?0:ry(a,e,n.startPTS,n.endPTS,n.startDTS,n.endDTS);return this.hls.trigger(kg.LEVEL_PTS_UPDATED,{details:a,level:i,drift:d,type:r,frag:e,start:n.startPTS,end:n.endPTS}),!0}return t},!1)&&(0===i.fragmentError&&this.treatAsGap(e,i),null===(null==(r=this.transmuxer)?void 0:r.error))){const t=new Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(t.message),this.hls.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=Cy,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(kg.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===Lg?"level":"track"}fragInfo(e,t=!0,i){var s,a;return`${this.playlistLabel()} ${e.level} (${i?"part":"frag"}:[${(null!=(s=t&&!i?e.startPTS:(i||e).start)?s:NaN).toFixed(3)}-${(null!=(a=t&&!i?e.endPTS:(i||e).end)?a:NaN).toFixed(3)}]${i&&"main"===e.type?"INDEPENDENT="+(i.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;null==(e=this.transmuxer)||e.reset()}recoverWorkerError(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(this.levelLastLoaded),this.resetLoadingState())}set state(e){const t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function My(e){return!!e.interstitialsController&&!1!==e.enableInterstitialPlayback}class Oy{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){const{chunks:e,dataLength:t}=this;let i;return e.length?(i=1===e.length?e[0]:function(e,t){const i=new Uint8Array(t);let s=0;for(let t=0;t<e.length;t++){const a=e[t];i.set(a,s),s+=a.length}return i}(e,t),this.reset(),i):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}var Uy,$y={exports:{}};var Fy=(Uy||(Uy=1,function(e){var t=Object.prototype.hasOwnProperty,i="~";function s(){}function a(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function r(e,t,s,r,n){if("function"!=typeof s)throw new TypeError("The listener must be a function");var o=new a(s,r||e,n),d=i?i+t:t;return e._events[d]?e._events[d].fn?e._events[d]=[e._events[d],o]:e._events[d].push(o):(e._events[d]=o,e._eventsCount++),e}function n(e,t){0===--e._eventsCount?e._events=new s:delete e._events[t]}function o(){this._events=new s,this._eventsCount=0}Object.create&&(s.prototype=Object.create(null),(new s).__proto__||(i=!1)),o.prototype.eventNames=function(){var e,s,a=[];if(0===this._eventsCount)return a;for(s in e=this._events)t.call(e,s)&&a.push(i?s.slice(1):s);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},o.prototype.listeners=function(e){var t=i?i+e:e,s=this._events[t];if(!s)return[];if(s.fn)return[s.fn];for(var a=0,r=s.length,n=new Array(r);a<r;a++)n[a]=s[a].fn;return n},o.prototype.listenerCount=function(e){var t=i?i+e:e,s=this._events[t];return s?s.fn?1:s.length:0},o.prototype.emit=function(e,t,s,a,r,n){var o=i?i+e:e;if(!this._events[o])return!1;var d,l,c=this._events[o],h=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),h){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,s),!0;case 4:return c.fn.call(c.context,t,s,a),!0;case 5:return c.fn.call(c.context,t,s,a,r),!0;case 6:return c.fn.call(c.context,t,s,a,r,n),!0}for(l=1,d=new Array(h-1);l<h;l++)d[l-1]=arguments[l];c.fn.apply(c.context,d)}else{var p,u=c.length;for(l=0;l<u;l++)switch(c[l].once&&this.removeListener(e,c[l].fn,void 0,!0),h){case 1:c[l].fn.call(c[l].context);break;case 2:c[l].fn.call(c[l].context,t);break;case 3:c[l].fn.call(c[l].context,t,s);break;case 4:c[l].fn.call(c[l].context,t,s,a);break;default:if(!d)for(p=1,d=new Array(h-1);p<h;p++)d[p-1]=arguments[p];c[l].fn.apply(c[l].context,d)}}return!0},o.prototype.on=function(e,t,i){return r(this,e,t,i,!1)},o.prototype.once=function(e,t,i){return r(this,e,t,i,!0)},o.prototype.removeListener=function(e,t,s,a){var r=i?i+e:e;if(!this._events[r])return this;if(!t)return n(this,r),this;var o=this._events[r];if(o.fn)o.fn!==t||a&&!o.once||s&&o.context!==s||n(this,r);else{for(var d=0,l=[],c=o.length;d<c;d++)(o[d].fn!==t||a&&!o[d].once||s&&o[d].context!==s)&&l.push(o[d]);l.length?this._events[r]=1===l.length?l[0]:l:n(this,r)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&n(this,t)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,e.exports=o}($y)),$y.exports),Ny=Kg(Fy);const jy="1.6.5",zy={};function By(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function Gy(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function Hy(e,t){let i=0;return i=(127&e[t])<<21,i|=(127&e[t+1])<<14,i|=(127&e[t+2])<<7,i|=127&e[t+3],i}function Vy(e,t){const i=t;let s=0;for(;Gy(e,t);){s+=10;s+=Hy(e,t+6),By(e,t+10)&&(s+=10),t+=s}if(s>0)return e.subarray(i,i+s)}function qy(e,t){return 255===e[t]&&240==(246&e[t+1])}function Ky(e,t){return 1&e[t+1]?7:9}function Yy(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function Wy(e,t){return t+1<e.length&&qy(e,t)}function Zy(e,t){if(Wy(e,t)){const i=Ky(e,t);if(t+i>=e.length)return!1;const s=Yy(e,t);if(s<=i)return!1;const a=t+s;return a===e.length||Wy(e,a)}return!1}function Qy(e,t,i,s,a){if(!e.samplerate){const r=function(e,t,i,s){const a=t[i+2],r=a>>2&15;if(r>12){const t=new Error(`invalid ADTS sampling index:${r}`);return void e.emit(kg.ERROR,kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.FRAG_PARSING_ERROR,fatal:!0,error:t,reason:t.message})}const n=1+(a>>6&3),o=t[i+3]>>6&3|(1&a)<<2,d="mp4a.40."+n,l=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][r];let c=r;5!==n&&29!==n||(c-=3);const h=[n<<3|(14&c)>>1,(1&c)<<7|o<<3];return Bg.log(`manifest codec:${s}, parsed codec:${d}, channels:${o}, rate:${l} (ADTS object type:${n} sampling index:${r})`),{config:h,samplerate:l,channelCount:o,codec:d,parsedCodec:d,manifestCodec:s}}(t,i,s,a);if(!r)return;Dg(e,r)}}function Xy(e){return 9216e4/e}function Jy(e,t,i,s,a){const r=s+a*Xy(e.samplerate),n=function(e,t){const i=Ky(e,t);if(t+i<=e.length){const s=Yy(e,t)-i;if(s>0)return{headerLength:i,frameLength:s}}}(t,i);let o;if(n){const{frameLength:s,headerLength:a}=n,d=a+s,l=Math.max(0,i+d-t.length);l?(o=new Uint8Array(d-a),o.set(t.subarray(i+a,t.length),0)):o=t.subarray(i+a,i+d);const c={unit:o,pts:r};return l||e.samples.push(c),{sample:c,length:d,missing:l}}const d=t.length-i;o=new Uint8Array(d),o.set(t.subarray(i,t.length),0);return{sample:{unit:o,pts:r},length:d,missing:-1}}function eb(e,t){return Gy(e,t)&&Hy(e,t+6)+10<=e.length-t}function tb(e,t=0,i=1/0){return function(e,t,i,s){const a=function(e){return e instanceof ArrayBuffer?e:e.buffer}(e);let r=1;"BYTES_PER_ELEMENT"in s&&(r=s.BYTES_PER_ELEMENT);const n=(h=e,h&&h.buffer instanceof ArrayBuffer&&void 0!==h.byteLength&&void 0!==h.byteOffset?e.byteOffset:0),o=(n+e.byteLength)/r,d=(n+t)/r,l=Math.floor(Math.max(0,Math.min(d,o))),c=Math.floor(Math.min(l+Math.max(i,0),o));var h;return new s(a,l,c-l)}(e,t,i,Uint8Array)}function ib(e){const t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if(e.size<2)return;if(3!==e.data[0])return void console.log("Ignore frame with unrecognized character encoding");const i=e.data.subarray(1).indexOf(0);if(-1===i)return;const s=Vg(tb(e.data,1,i)),a=e.data[2+i],r=e.data.subarray(3+i).indexOf(0);if(-1===r)return;const n=Vg(tb(e.data,3+i,r));let o;return o="--\x3e"===s?Vg(tb(e.data,4+i+r)):function(e){return e instanceof ArrayBuffer?e:0==e.byteOffset&&e.byteLength==e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer}(e.data.subarray(4+i+r)),t.mimeType=s,t.pictureType=a,t.description=n,t.data=o,t}function sb(e){return"PRIV"===e.type?function(e){if(e.size<2)return;const t=Vg(e.data,!0),i=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:i.buffer}}(e):"W"===e.type[0]?function(e){if("WXXX"===e.type){if(e.size<2)return;let t=1;const i=Vg(e.data.subarray(t),!0);t+=i.length+1;const s=Vg(e.data.subarray(t));return{key:e.type,info:i,data:s}}const t=Vg(e.data);return{key:e.type,info:"",data:t}}(e):"APIC"===e.type?ib(e):function(e){if(e.size<2)return;if("TXXX"===e.type){let t=1;const i=Vg(e.data.subarray(t),!0);t+=i.length+1;const s=Vg(e.data.subarray(t));return{key:e.type,info:i,data:s}}const t=Vg(e.data.subarray(1));return{key:e.type,info:"",data:t}}(e)}function ab(e){const t=String.fromCharCode(e[0],e[1],e[2],e[3]),i=Hy(e,4);return{type:t,size:i,data:e.subarray(10,10+i)}}function rb(e){let t=0;const i=[];for(;Gy(e,t);){const s=Hy(e,t+6);e[t+5]>>6&1&&(t+=10),t+=10;const a=t+s;for(;t+10<a;){const s=ab(e.subarray(t)),a=sb(s);a&&i.push(a),t+=s.size+10}By(e,t)&&(t+=10)}return i}function nb(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}function ob(e){if(8===e.data.byteLength){const t=new Uint8Array(e.data),i=1&t[3];let s=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return s/=45,i&&(s+=47721858.84),Math.round(s)}}function db(e){const t=rb(e);for(let e=0;e<t.length;e++){const i=t[e];if(nb(i))return ob(i)}}let lb=function(e){return e.audioId3="org.id3",e.dateRange="com.apple.quicktime.HLS",e.emsg="https://aomedia.org/emsg/ID3",e.misbklv="urn:misb:KLV:bin:1910.1",e}({});function cb(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class hb{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,i,s){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,i){}demux(e,t){this.cachedData&&(e=Pf(this.cachedData,e),this.cachedData=null);let i,s=Vy(e,0),a=s?s.length:0;const r=this._audioTrack,n=this._id3Track,o=s?db(s):void 0,d=e.length;for((null===this.basePTS||0===this.frameIndex&&vg(o))&&(this.basePTS=pb(o,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),s&&s.length>0&&n.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:lb.audioId3,duration:Number.POSITIVE_INFINITY});a<d;){if(this.canParse(e,a)){const t=this.appendFrame(r,e,a);t?(this.frameIndex++,this.lastPTS=t.sample.pts,a+=t.length,i=a):a=d}else eb(e,a)?(s=Vy(e,a),n.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:s,type:lb.audioId3,duration:Number.POSITIVE_INFINITY}),a+=s.length,i=a):a++;if(a===d&&i!==d){const t=e.slice(i);this.cachedData?this.cachedData=Pf(this.cachedData,t):this.cachedData=t}}return{audioTrack:r,videoTrack:cb(),id3Track:n,textTrack:cb()}}demuxSampleAes(e,t,i){return Promise.reject(new Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){const t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:cb(),id3Track:this._id3Track,textTrack:cb()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}const pb=(e,t,i)=>{if(vg(e))return 90*e;return 9e4*t+(i?9e4*i.baseTime/i.timescale:0)};let ub=null;const gb=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],fb=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],mb=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],vb=[0,1,1,4];function yb(e,t,i,s,a){if(i+24>t.length)return;const r=bb(t,i);if(r&&i+r.frameLength<=t.length){const n=s+a*(9e4*r.samplesPerFrame/r.sampleRate),o={unit:t.subarray(i,i+r.frameLength),pts:n,dts:n};return e.config=[],e.channelCount=r.channelCount,e.samplerate=r.sampleRate,e.samples.push(o),{sample:o,length:r.frameLength,missing:0}}}function bb(e,t){const i=e[t+1]>>3&3,s=e[t+1]>>1&3,a=e[t+2]>>4&15,r=e[t+2]>>2&3;if(1!==i&&0!==a&&15!==a&&3!==r){const n=e[t+2]>>1&1,o=e[t+3]>>6,d=1e3*gb[14*(3===i?3-s:3===s?3:4)+a-1],l=fb[3*(3===i?0:2===i?1:2)+r],c=3===o?1:2,h=mb[i][s],p=vb[s],u=8*h*p,g=Math.floor(h*d/l+n)*p;if(null===ub){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);ub=e?parseInt(e[1]):0}return!!ub&&ub<=87&&2===s&&d>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:l,channelCount:c,frameLength:g,samplesPerFrame:u}}}function wb(e,t){return!(255!==e[t]||224&~e[t+1]||!(6&e[t+1]))}function xb(e,t){return t+1<e.length&&wb(e,t)}function kb(e,t){if(t+1<e.length&&wb(e,t)){const i=4,s=bb(e,t);let a=i;null!=s&&s.frameLength&&(a=s.frameLength);const r=t+a;return r===e.length||xb(e,r)}return!1}const Sb=(e,t)=>{let i=0,s=5;t+=s;const a=new Uint32Array(1),r=new Uint32Array(1),n=new Uint8Array(1);for(;s>0;){n[0]=e[t];const o=Math.min(s,8),d=8-o;r[0]=4278190080>>>24+d<<d,a[0]=(n[0]&r[0])>>d,i=i?i<<o|a[0]:a[0],t+=1,s-=o}return i};class Eb extends hb{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,i,s){super.resetInitSegment(e,t,i,s),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,i){const s=Pb(e,t,i,this.basePTS,this.frameIndex);if(-1!==s){return{sample:e.samples[e.samples.length-1],length:s,missing:0}}}static probe(e){if(!e)return!1;const t=Vy(e,0);if(!t)return!1;const i=t.length;return 11===e[i]&&119===e[i+1]&&void 0!==db(t)&&Sb(e,i)<16}}function Pb(e,t,i,s,a){if(i+8>t.length)return-1;if(11!==t[i]||119!==t[i+1])return-1;const r=t[i+4]>>6;if(r>=3)return-1;const n=[48e3,44100,32e3][r],o=63&t[i+4],d=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*o+r];if(i+d>t.length)return-1;const l=t[i+6]>>5;let c=0;2===l?c+=2:(1&l&&1!==l&&(c+=2),4&l&&(c+=2));const h=(t[i+6]<<8|t[i+7])>>12-c&1,p=[2,1,2,3,3,4,4,5][l]+h,u=t[i+5]>>3,g=7&t[i+5],f=new Uint8Array([r<<6|u<<1|g>>2,(3&g)<<6|l<<3|h<<2|o>>4,o<<4&224]),m=s+a*(1536/n*9e4),v=t.subarray(i,i+d);return e.config=f,e.channelCount=p,e.samplerate=n,e.samples.push({unit:v,pts:m}),d}const Tb=/\/emsg[-/]ID3/i;function Lb(e,t){return vg(e.presentationTime)?e.presentationTime/e.timeScale:t+e.presentationTimeDelta/e.timeScale}class Cb{constructor(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new Wm(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Hm)}decryptAacSample(e,t,i){const s=e[t].unit;if(s.length<=16)return;const a=s.subarray(16,s.length-s.length%16),r=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(r).then(a=>{const r=new Uint8Array(a);s.set(r,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,i)})}decryptAacSamples(e,t,i){for(;;t++){if(t>=e.length)return void i();if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){const t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t);let s=0;for(let t=32;t<e.length-16;t+=160,s+=16)i.set(e.subarray(t,t+16),s);return i}getAvcDecryptedUnit(e,t){const i=new Uint8Array(t);let s=0;for(let t=32;t<e.length-16;t+=160,s+=16)e.set(i.subarray(s,s+16),t);return e}decryptAvcSample(e,t,i,s,a){const r=Af(a.data),n=this.getAvcEncryptedData(r);this.decryptBuffer(n.buffer).then(n=>{a.data=this.getAvcDecryptedUnit(r,n),this.decrypter.isSync()||this.decryptAvcSamples(e,t,i+1,s)})}decryptAvcSamples(e,t,i,s){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length)return void s();const a=e[t].units;for(;!(i>=a.length);i++){const r=a[i];if(!(r.data.length<=48||1!==r.type&&5!==r.type||(this.decryptAvcSample(e,t,i,s,r),this.decrypter.isSync())))return}}}}class _b{constructor(){this.VideoSample=null}createVideoSample(e,t,i){return{key:e,frame:!1,pts:t,dts:i,units:[],length:0}}getLastNalUnit(e){var t;let i,s=this.VideoSample;if(s&&0!==s.units.length||(s=e[e.length-1]),null!=(t=s)&&t.units){const e=s.units;i=e[e.length-1]}return i}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){const i=t.samples,s=i.length;if(!s)return void t.dropped++;{const t=i[s-1];e.pts=t.pts,e.dts=t.dts}}t.samples.push(e)}}parseNALu(e,t,i){const s=t.byteLength;let a=e.naluState||0;const r=a,n=[];let o,d,l,c=0,h=-1,p=0;for(-1===a&&(h=0,p=this.getNALuType(t,0),a=0,c=1);c<s;)if(o=t[c++],a)if(1!==a)if(o)if(1===o){if(d=c-a-1,h>=0){const e={data:t.subarray(h,d),type:p};n.push(e)}else{const i=this.getLastNalUnit(e.samples);i&&(r&&c<=4-r&&i.state&&(i.data=i.data.subarray(0,i.data.byteLength-r)),d>0&&(i.data=Pf(i.data,t.subarray(0,d)),i.state=0))}c<s?(l=this.getNALuType(t,c),h=c,p=l,a=0):a=-1}else a=0;else a=3;else a=o?0:2;else a=o?0:1;if(h>=0&&a>=0){const e={data:t.subarray(h,s),type:p,state:a};n.push(e)}if(0===n.length){const i=this.getLastNalUnit(e.samples);i&&(i.data=Pf(i.data,t))}return e.naluState=a,n}}class Ab{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){const e=this.data,t=this.bytesAvailable,i=e.byteLength-t,s=new Uint8Array(4),a=Math.min(4,t);if(0===a)throw new Error("no bytes available");s.set(e.subarray(i,i+a)),this.word=new DataView(s.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(t=(e-=this.bitsAvailable)>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}readBits(e){let t=Math.min(this.bitsAvailable,e);const i=this.word>>>32-t;if(e>32&&Bg.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return t=e-t,t>0&&this.bitsAvailable?i<<t|this.readBits(t):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if(this.word&2147483648>>>e)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){const e=this.skipLZ();return this.readBits(e+1)-1}readEG(){const e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class Rb extends _b{parsePES(e,t,i,s){const a=this.parseNALu(e,i.data,s);let r,n=this.VideoSample,o=!1;i.data=null,n&&a.length&&!e.audFound&&(this.pushAccessUnit(n,e),n=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(s=>{var a,d;switch(s.type){case 1:{let t=!1;r=!0;const a=s.data;if(o&&a.length>4){const e=this.readSliceType(a);2!==e&&4!==e&&7!==e&&9!==e||(t=!0)}var l;if(t)null!=(l=n)&&l.frame&&!n.key&&(this.pushAccessUnit(n,e),n=this.VideoSample=null);n||(n=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),n.frame=!0,n.key=t;break}case 5:r=!0,null!=(a=n)&&a.frame&&!n.key&&(this.pushAccessUnit(n,e),n=this.VideoSample=null),n||(n=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),n.key=!0,n.frame=!0;break;case 6:r=!0,_f(s.data,1,i.pts,t.samples);break;case 7:{var c,h;r=!0,o=!0;const t=s.data,i=this.readSPS(t);if(!e.sps||e.width!==i.width||e.height!==i.height||(null==(c=e.pixelRatio)?void 0:c[0])!==i.pixelRatio[0]||(null==(h=e.pixelRatio)?void 0:h[1])!==i.pixelRatio[1]){e.width=i.width,e.height=i.height,e.pixelRatio=i.pixelRatio,e.sps=[t];const s=t.subarray(1,4);let a="avc1.";for(let e=0;e<3;e++){let t=s[e].toString(16);t.length<2&&(t="0"+t),a+=t}e.codec=a}break}case 8:r=!0,e.pps=[s.data];break;case 9:r=!0,e.audFound=!0,null!=(d=n)&&d.frame&&(this.pushAccessUnit(n,e),n=null),n||(n=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;case 12:r=!0;break;default:r=!1}if(n&&r){n.units.push(s)}}),s&&n&&(this.pushAccessUnit(n,e),this.VideoSample=null)}getNALuType(e,t){return 31&e[t]}readSliceType(e){const t=new Ab(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let i,s=8,a=8;for(let r=0;r<e;r++)0!==a&&(i=t.readEG(),a=(s+i+256)%256),s=0===a?s:a}readSPS(e){const t=new Ab(e);let i,s,a,r=0,n=0,o=0,d=0;const l=t.readUByte.bind(t),c=t.readBits.bind(t),h=t.readUEG.bind(t),p=t.readBoolean.bind(t),u=t.skipBits.bind(t),g=t.skipEG.bind(t),f=t.skipUEG.bind(t),m=this.skipScalingList.bind(this);l();const v=l();if(c(5),u(3),l(),f(),100===v||110===v||122===v||244===v||44===v||83===v||86===v||118===v||128===v){const e=h();if(3===e&&u(1),f(),f(),u(1),p())for(s=3!==e?8:12,a=0;a<s;a++)p()&&m(a<6?16:64,t)}f();const y=h();if(0===y)h();else if(1===y)for(u(1),g(),g(),i=h(),a=0;a<i;a++)g();f(),u(1);const b=h(),w=h(),x=c(1);0===x&&u(1),u(1),p()&&(r=h(),n=h(),o=h(),d=h());let k=[1,1];if(p()&&p()){switch(l()){case 1:k=[1,1];break;case 2:k=[12,11];break;case 3:k=[10,11];break;case 4:k=[16,11];break;case 5:k=[40,33];break;case 6:k=[24,11];break;case 7:k=[20,11];break;case 8:k=[32,11];break;case 9:k=[80,33];break;case 10:k=[18,11];break;case 11:k=[15,11];break;case 12:k=[64,33];break;case 13:k=[160,99];break;case 14:k=[4,3];break;case 15:k=[3,2];break;case 16:k=[2,1];break;case 255:k=[l()<<8|l(),l()<<8|l()]}}return{width:Math.ceil(16*(b+1)-2*r-2*n),height:(2-x)*(w+1)*16-(x?2:4)*(o+d),pixelRatio:k}}}class Ib extends _b{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,i,s){const a=this.parseNALu(e,i.data,s);let r,n=this.VideoSample,o=!1;i.data=null,n&&a.length&&!e.audFound&&(this.pushAccessUnit(n,e),n=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),a.forEach(s=>{var a,d;switch(s.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:n||(n=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts)),n.frame=!0,r=!0;break;case 16:case 17:case 18:case 21:var l;if(r=!0,o)null!=(l=n)&&l.frame&&!n.key&&(this.pushAccessUnit(n,e),n=this.VideoSample=null);n||(n=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),n.key=!0,n.frame=!0;break;case 19:case 20:r=!0,null!=(a=n)&&a.frame&&!n.key&&(this.pushAccessUnit(n,e),n=this.VideoSample=null),n||(n=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),n.key=!0,n.frame=!0;break;case 39:r=!0,_f(s.data,2,i.pts,t.samples);break;case 32:r=!0,e.vps||("object"!=typeof e.params&&(e.params={}),e.params=Dg(e.params,this.readVPS(s.data)),this.initVPS=s.data),e.vps=[s.data];break;case 33:if(r=!0,o=!0,void 0===e.vps||e.vps[0]===this.initVPS||void 0===e.sps||this.matchSPS(e.sps[0],s.data)||(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){const t=this.readSPS(s.data);e.width=t.width,e.height=t.height,e.pixelRatio=t.pixelRatio,e.codec=t.codecString,e.sps=[],"object"!=typeof e.params&&(e.params={});for(const i in t.params)e.params[i]=t.params[i]}this.pushParameterSet(e.sps,s.data,e.vps),n||(n=this.VideoSample=this.createVideoSample(!0,i.pts,i.dts)),n.key=!0;break;case 34:if(r=!0,"object"==typeof e.params){if(!e.pps){e.pps=[];const t=this.readPPS(s.data);for(const i in t)e.params[i]=t[i]}this.pushParameterSet(e.pps,s.data,e.vps)}break;case 35:r=!0,e.audFound=!0,null!=(d=n)&&d.frame&&(this.pushAccessUnit(n,e),n=null),n||(n=this.VideoSample=this.createVideoSample(!1,i.pts,i.dts));break;default:r=!1}if(n&&r){n.units.push(s)}}),s&&n&&(this.pushAccessUnit(n,e),this.VideoSample=null)}pushParameterSet(e,t,i){(i&&i[0]===this.initVPS||!i&&!e.length)&&e.push(t)}getNALuType(e,t){return(126&e[t])>>>1}ebsp2rbsp(e){const t=new Uint8Array(e.byteLength);let i=0;for(let s=0;s<e.byteLength;s++)s>=2&&3===e[s]&&0===e[s-1]&&0===e[s-2]||(t[i]=e[s],i++);return new Uint8Array(t.buffer,0,i)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){const t=new Ab(e);t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6);return{numTemporalLayers:t.readBits(3)+1,temporalIdNested:t.readBoolean()}}readSPS(e){const t=new Ab(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);const i=t.readBits(3);t.readBoolean();const s=t.readBits(2),a=t.readBoolean(),r=t.readBits(5),n=t.readUByte(),o=t.readUByte(),d=t.readUByte(),l=t.readUByte(),c=t.readUByte(),h=t.readUByte(),p=t.readUByte(),u=t.readUByte(),g=t.readUByte(),f=t.readUByte(),m=t.readUByte(),v=[],y=[];for(let e=0;e<i;e++)v.push(t.readBoolean()),y.push(t.readBoolean());if(i>0)for(let e=i;e<8;e++)t.readBits(2);for(let e=0;e<i;e++)v[e]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),y[e]&&t.readUByte();t.readUEG();const b=t.readUEG();3==b&&t.skipBits(1);const w=t.readUEG(),x=t.readUEG(),k=t.readBoolean();let S=0,E=0,P=0,T=0;k&&(S+=t.readUEG(),E+=t.readUEG(),P+=t.readUEG(),T+=t.readUEG());const L=t.readUEG(),C=t.readUEG(),_=t.readUEG();for(let e=t.readBoolean()?0:i;e<=i;e++)t.skipUEG(),t.skipUEG(),t.skipUEG();t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.readBoolean()){if(t.readBoolean())for(let e=0;e<4;e++)for(let i=0;i<(3===e?2:6);i++){if(t.readBoolean()){const i=Math.min(64,1<<4+(e<<1));e>1&&t.readEG();for(let e=0;e<i;e++)t.readEG()}else t.readUEG()}}t.readBoolean(),t.readBoolean();t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());const A=t.readUEG();let R=0;for(let e=0;e<A;e++){let i=!1;if(0!==e&&(i=t.readBoolean()),i){e===A&&t.readUEG(),t.readBoolean(),t.readUEG();let i=0;for(let e=0;e<=R;e++){const e=t.readBoolean();let s=!1;e||(s=t.readBoolean()),(e||s)&&i++}R=i}else{const e=t.readUEG(),i=t.readUEG();R=e+i;for(let i=0;i<e;i++)t.readUEG(),t.readBoolean();for(let e=0;e<i;e++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){const e=t.readUEG();for(let i=0;i<e;i++){for(let e=0;e<_+4;e++)t.readBits(1);t.readBits(1)}}let I=0,D=1,M=1,O=!0,U=1,$=0;t.readBoolean(),t.readBoolean();let F=!1;if(t.readBoolean()){if(t.readBoolean()){const e=t.readUByte();e>0&&e<16?(D=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][e-1],M=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][e-1]):255===e&&(D=t.readBits(16),M=t.readBits(16))}t.readBoolean()&&t.readBoolean();if(t.readBoolean()){t.readBits(3),t.readBoolean();t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())}t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),F=t.readBoolean(),F&&(S+=t.readUEG(),E+=t.readUEG(),P+=t.readUEG(),T+=t.readUEG());if(t.readBoolean()){U=t.readBits(32),$=t.readBits(32);t.readBoolean()&&t.readUEG();if(t.readBoolean()){const e=t.readBoolean(),s=t.readBoolean();let a=!1;(e||s)&&(a=t.readBoolean(),a&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),a&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let r=0;r<=i;r++){O=t.readBoolean();let i=!1;O||t.readBoolean()?t.readEG():i=t.readBoolean();const r=i?1:t.readUEG()+1;if(e)for(let e=0;e<r;e++)t.readUEG(),t.readUEG(),a&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(s)for(let e=0;e<r;e++)t.readUEG(),t.readUEG(),a&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),I=t.readUEG())}let N=w,j=x;if(k||F){let e=1,t=1;1===b?e=t=2:2==b&&(e=2),N=w-e*E-e*S,j=x-t*T-t*P}const z=s?["A","B","C"][s]:"",B=n<<24|o<<16|d<<8|l;let G=0;for(let e=0;e<32;e++)G=(G|(B>>e&1)<<31-e)>>>0;let H=G.toString(16);1===r&&"2"===H&&(H="6");return{codecString:`hvc1.${z}${r}.${H}.${a?"H":"L"}${m}.B0`,params:{general_tier_flag:a,general_profile_idc:r,general_profile_space:s,general_profile_compatibility_flags:[n,o,d,l],general_constraint_indicator_flags:[c,h,p,u,g,f],general_level_idc:m,bit_depth:L+8,bit_depth_luma_minus8:L,bit_depth_chroma_minus8:C,min_spatial_segmentation_idc:I,chroma_format_idc:b,frame_rate:{fixed:O,fps:$/U}},width:N,height:j,pixelRatio:[D,M]}}readPPS(e){const t=new Ab(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2);t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);const i=t.readBoolean(),s=t.readBoolean();let a=1;return s&&i?a=0:s?a=3:i&&(a=2),{parallelismType:a}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}const Db=188;class Mb{constructor(e,t,i,s){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.logger=s,this.videoParser=null}static probe(e,t){const i=Mb.syncOffset(e);return i>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${i}`),-1!==i}static syncOffset(e){const t=e.length;let i=Math.min(940,t-Db)+1,s=0;for(;s<i;){let a=!1,r=-1,n=0;for(let o=s;o<t;o+=Db){if(71!==e[o]||t-o!==Db&&71!==e[o+Db]){if(n)return-1;break}if(n++,-1===r&&(r=o,0!==r&&(i=Math.min(r+18612,e.length-Db)+1)),a||(a=0===Ob(e,o)),a&&n>1&&(0===r&&n>2||o+Db>i))return r}s++}return-1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:lf[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,i,s){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Mb.createTrack("video"),this._videoTrack.duration=s,this._audioTrack=Mb.createTrack("audio",s),this._id3Track=Mb.createTrack("id3"),this._txtTrack=Mb.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=i}resetTimeStamp(){}resetContiguity(){const{_audioTrack:e,_videoTrack:t,_id3Track:i}=this;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,i=!1,s=!1){let a;i||(this.sampleAes=null);const r=this._videoTrack,n=this._audioTrack,o=this._id3Track,d=this._txtTrack;let l=r.pid,c=r.pesData,h=n.pid,p=o.pid,u=n.pesData,g=o.pesData,f=null,m=this.pmtParsed,v=this._pmtId,y=e.length;if(this.remainderData&&(y=(e=Pf(this.remainderData,e)).length,this.remainderData=null),y<Db&&!s)return this.remainderData=e,{audioTrack:n,videoTrack:r,id3Track:o,textTrack:d};const b=Math.max(0,Mb.syncOffset(e));y-=(y-b)%Db,y<e.byteLength&&!s&&(this.remainderData=new Uint8Array(e.buffer,y,e.buffer.byteLength-y));let w=0;for(let t=b;t<y;t+=Db)if(71===e[t]){const s=!!(64&e[t+1]),y=Ob(e,t);let w;if((48&e[t+3])>>4>1){if(w=t+5+e[t+4],w===t+Db)continue}else w=t+4;switch(y){case l:if(s){if(c&&(a=jb(c,this.logger))){if(null===this.videoParser)switch(r.segmentCodec){case"avc":this.videoParser=new Rb;break;case"hevc":this.videoParser=new Ib}null!==this.videoParser&&this.videoParser.parsePES(r,d,a,!1)}c={data:[],size:0}}c&&(c.data.push(e.subarray(w,t+Db)),c.size+=t+Db-w);break;case h:if(s){if(u&&(a=jb(u,this.logger)))switch(n.segmentCodec){case"aac":this.parseAACPES(n,a);break;case"mp3":this.parseMPEGPES(n,a);break;case"ac3":this.parseAC3PES(n,a)}u={data:[],size:0}}u&&(u.data.push(e.subarray(w,t+Db)),u.size+=t+Db-w);break;case p:s&&(g&&(a=jb(g,this.logger))&&this.parseID3PES(o,a),g={data:[],size:0}),g&&(g.data.push(e.subarray(w,t+Db)),g.size+=t+Db-w);break;case 0:s&&(w+=e[w]+1),v=this._pmtId=Ub(e,w);break;case v:{s&&(w+=e[w]+1);const a=$b(e,w,this.typeSupported,i,this.observer,this.logger);l=a.videoPid,l>0&&(r.pid=l,r.segmentCodec=a.segmentVideoCodec),h=a.audioPid,h>0&&(n.pid=h,n.segmentCodec=a.segmentAudioCodec),p=a.id3Pid,p>0&&(o.pid=p),null===f||m||(this.logger.warn(`MPEG-TS PMT found at ${t} after unknown PID '${f}'. Backtracking to sync byte @${b} to parse all TS packets.`),f=null,t=b-188),m=this.pmtParsed=!0;break}case 17:case 8191:break;default:f=y}}else w++;w>0&&Fb(this.observer,new Error(`Found ${w} TS packet/s that do not start with 0x47`),void 0,this.logger),r.pesData=c,n.pesData=u,o.pesData=g;const x={audioTrack:n,videoTrack:r,id3Track:o,textTrack:d};return s&&this.extractRemainingSamples(x),x}flush(){const{remainderData:e}=this;let t;return this.remainderData=null,t=e?this.demux(e,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(t),this.sampleAes?this.decrypt(t,this.sampleAes):t}extractRemainingSamples(e){const{audioTrack:t,videoTrack:i,id3Track:s,textTrack:a}=e,r=i.pesData,n=t.pesData,o=s.pesData;let d;if(r&&(d=jb(r,this.logger))){if(null===this.videoParser)switch(i.segmentCodec){case"avc":this.videoParser=new Rb;break;case"hevc":this.videoParser=new Ib}null!==this.videoParser&&(this.videoParser.parsePES(i,a,d,!0),i.pesData=null)}else i.pesData=r;if(n&&(d=jb(n,this.logger))){switch(t.segmentCodec){case"aac":this.parseAACPES(t,d);break;case"mp3":this.parseMPEGPES(t,d);break;case"ac3":this.parseAC3PES(t,d)}t.pesData=null}else null!=n&&n.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),t.pesData=n;o&&(d=jb(o,this.logger))?(this.parseID3PES(s,d),s.pesData=null):s.pesData=o}demuxSampleAes(e,t,i){const s=this.demux(e,i,!0,!this.config.progressive),a=this.sampleAes=new Cb(this.observer,this.config,t);return this.decrypt(s,a)}decrypt(e,t){return new Promise(i=>{const{audioTrack:s,videoTrack:a}=e;s.samples&&"aac"===s.segmentCodec?t.decryptAacSamples(s.samples,0,()=>{a.samples?t.decryptAvcSamples(a.samples,0,0,()=>{i(e)}):i(e)}):a.samples&&t.decryptAvcSamples(a.samples,0,0,()=>{i(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let i=0;const s=this.aacOverFlow;let a,r,n,o=t.data;if(s){this.aacOverFlow=null;const t=s.missing,a=s.sample.unit.byteLength;if(-1===t)o=Pf(s.sample.unit,o);else{const r=a-t;s.sample.unit.set(o.subarray(0,t),r),e.samples.push(s.sample),i=s.missing}}for(a=i,r=o.length;a<r-1&&!Wy(o,a);a++);if(a!==i){let e;const t=a<r-1;if(e=t?`AAC PES did not start with ADTS header,offset:${a}`:"No ADTS header found in AAC PES",Fb(this.observer,new Error(e),t,this.logger),!t)return}if(Qy(e,this.observer,o,a,this.audioCodec),void 0!==t.pts)n=t.pts;else{if(!s)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");{const t=Xy(e.samplerate);n=s.sample.pts+t}}let d,l=0;for(;a<r;){if(d=Jy(e,o,a,n,l),a+=d.length,d.missing){this.aacOverFlow=d;break}for(l++;a<r-1&&!Wy(o,a);a++);}}parseMPEGPES(e,t){const i=t.data,s=i.length;let a=0,r=0;const n=t.pts;if(void 0!==n)for(;r<s;)if(xb(i,r)){const t=yb(e,i,r,n,a);if(!t)break;r+=t.length,a++}else r++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}parseAC3PES(e,t){{const i=t.data,s=t.pts;if(void 0===s)return void this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");const a=i.length;let r,n=0,o=0;for(;o<a&&(r=Pb(e,i,o,s,n++))>0;)o+=r}}parseID3PES(e,t){if(void 0===t.pts)return void this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");const i=Dg({},t,{type:this._videoTrack?lb.emsg:lb.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(i)}}function Ob(e,t){return((31&e[t+1])<<8)+e[t+2]}function Ub(e,t){return(31&e[t+10])<<8|e[t+11]}function $b(e,t,i,s,a,r){const n={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},o=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<o;){const o=Ob(e,t),d=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!s){Nb("ADTS AAC",r);break}case 15:-1===n.audioPid&&(n.audioPid=o);break;case 21:-1===n.id3Pid&&(n.id3Pid=o);break;case 219:if(!s){Nb("H.264",r);break}case 27:-1===n.videoPid&&(n.videoPid=o);break;case 3:case 4:i.mpeg||i.mp3?-1===n.audioPid&&(n.audioPid=o,n.segmentAudioCodec="mp3"):r.log("MPEG audio found, not supported in this browser");break;case 193:if(!s){Nb("AC-3",r);break}case 129:i.ac3?-1===n.audioPid&&(n.audioPid=o,n.segmentAudioCodec="ac3"):r.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===n.audioPid&&d>0){let s=t+5,a=d;for(;a>2;){if(106===e[s])!0!==i.ac3?r.log("AC-3 audio found, not supported in this browser for now"):(n.audioPid=o,n.segmentAudioCodec="ac3");const t=e[s+1]+2;s+=t,a-=t}}break;case 194:case 135:return Fb(a,new Error("Unsupported EC-3 in M2TS found"),void 0,r),n;case 36:-1===n.videoPid&&(n.videoPid=o,n.segmentVideoCodec="hevc",r.log("HEVC in M2TS found"))}t+=d+5}return n}function Fb(e,t,i,s){s.warn(`parsing error: ${t.message}`),e.emit(kg.ERROR,kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.FRAG_PARSING_ERROR,fatal:!1,levelRetry:i,error:t,reason:t.message})}function Nb(e,t){t.log(`${e} with AES-128-CBC encryption found in unencrypted stream`)}function jb(e,t){let i,s,a,r,n,o=0;const d=e.data;if(!e||0===e.size)return null;for(;d[0].length<19&&d.length>1;)d[0]=Pf(d[0],d[1]),d.splice(1,1);i=d[0];if(1===(i[0]<<16)+(i[1]<<8)+i[2]){if(s=(i[4]<<8)+i[5],s&&s>e.size-6)return null;const l=i[7];192&l&&(r=536870912*(14&i[9])+4194304*(255&i[10])+16384*(254&i[11])+128*(255&i[12])+(254&i[13])/2,64&l?(n=536870912*(14&i[14])+4194304*(255&i[15])+16384*(254&i[16])+128*(255&i[17])+(254&i[18])/2,r-n>54e5&&(t.warn(`${Math.round((r-n)/9e4)}s delta between PTS and DTS, align them`),r=n)):n=r),a=i[8];let c=a+9;if(e.size<=c)return null;e.size-=c;const h=new Uint8Array(e.size);for(let e=0,t=d.length;e<t;e++){i=d[e];let t=i.byteLength;if(c){if(c>t){c-=t;continue}i=i.subarray(c),t-=c,c=0}h.set(i,o),o+=t}return s&&(s-=a+3),{data:h,pts:r,dts:n,len:s}}return null}class zb{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}const Bb=Math.pow(2,32)-1;class Gb{static init(){let e;for(e in Gb.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},Gb.types)Gb.types.hasOwnProperty(e)&&(Gb.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);const t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Gb.HDLR_TYPES={video:t,audio:i};const s=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);Gb.STTS=Gb.STSC=Gb.STCO=a,Gb.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Gb.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Gb.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Gb.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);const r=new Uint8Array([105,115,111,109]),n=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);Gb.FTYP=Gb.box(Gb.types.ftyp,r,o,r,n),Gb.DINF=Gb.box(Gb.types.dinf,Gb.box(Gb.types.dref,s))}static box(e,...t){let i=8,s=t.length;const a=s;for(;s--;)i+=t[s].byteLength;const r=new Uint8Array(i);for(r[0]=i>>24&255,r[1]=i>>16&255,r[2]=i>>8&255,r[3]=255&i,r.set(e,4),s=0,i=8;s<a;s++)r.set(t[s],i),i+=t[s].byteLength;return r}static hdlr(e){return Gb.box(Gb.types.hdlr,Gb.HDLR_TYPES[e])}static mdat(e){return Gb.box(Gb.types.mdat,e)}static mdhd(e,t){t*=e;const i=Math.floor(t/(Bb+1)),s=Math.floor(t%(Bb+1));return Gb.box(Gb.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,s>>24,s>>16&255,s>>8&255,255&s,85,196,0,0]))}static mdia(e){return Gb.box(Gb.types.mdia,Gb.mdhd(e.timescale||0,e.duration||0),Gb.hdlr(e.type),Gb.minf(e))}static mfhd(e){return Gb.box(Gb.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?Gb.box(Gb.types.minf,Gb.box(Gb.types.smhd,Gb.SMHD),Gb.DINF,Gb.stbl(e)):Gb.box(Gb.types.minf,Gb.box(Gb.types.vmhd,Gb.VMHD),Gb.DINF,Gb.stbl(e))}static moof(e,t,i){return Gb.box(Gb.types.moof,Gb.mfhd(e),Gb.traf(i,t))}static moov(e){let t=e.length;const i=[];for(;t--;)i[t]=Gb.trak(e[t]);return Gb.box.apply(null,[Gb.types.moov,Gb.mvhd(e[0].timescale||0,e[0].duration||0)].concat(i).concat(Gb.mvex(e)))}static mvex(e){let t=e.length;const i=[];for(;t--;)i[t]=Gb.trex(e[t]);return Gb.box.apply(null,[Gb.types.mvex,...i])}static mvhd(e,t){t*=e;const i=Math.floor(t/(Bb+1)),s=Math.floor(t%(Bb+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,s>>24,s>>16&255,s>>8&255,255&s,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Gb.box(Gb.types.mvhd,a)}static sdtp(e){const t=e.samples||[],i=new Uint8Array(4+t.length);let s,a;for(s=0;s<t.length;s++)a=t[s].flags,i[s+4]=a.dependsOn<<4|a.isDependedOn<<2|a.hasRedundancy;return Gb.box(Gb.types.sdtp,i)}static stbl(e){return Gb.box(Gb.types.stbl,Gb.stsd(e),Gb.box(Gb.types.stts,Gb.STTS),Gb.box(Gb.types.stsc,Gb.STSC),Gb.box(Gb.types.stsz,Gb.STSZ),Gb.box(Gb.types.stco,Gb.STCO))}static avc1(e){let t,i,s,a=[],r=[];for(t=0;t<e.sps.length;t++)i=e.sps[t],s=i.byteLength,a.push(s>>>8&255),a.push(255&s),a=a.concat(Array.prototype.slice.call(i));for(t=0;t<e.pps.length;t++)i=e.pps[t],s=i.byteLength,r.push(s>>>8&255),r.push(255&s),r=r.concat(Array.prototype.slice.call(i));const n=Gb.box(Gb.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|e.sps.length].concat(a).concat([e.pps.length]).concat(r))),o=e.width,d=e.height,l=e.pixelRatio[0],c=e.pixelRatio[1];return Gb.box(Gb.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,d>>8&255,255&d,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),n,Gb.box(Gb.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Gb.box(Gb.types.pasp,new Uint8Array([l>>24,l>>16&255,l>>8&255,255&l,c>>24,c>>16&255,c>>8&255,255&c])))}static esds(e){const t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...t,6,1,2])}static audioStsd(e){const t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,255&t,0,0])}static mp4a(e){return Gb.box(Gb.types.mp4a,Gb.audioStsd(e),Gb.box(Gb.types.esds,Gb.esds(e)))}static mp3(e){return Gb.box(Gb.types[".mp3"],Gb.audioStsd(e))}static ac3(e){return Gb.box(Gb.types["ac-3"],Gb.audioStsd(e),Gb.box(Gb.types.dac3,e.config))}static stsd(e){const{segmentCodec:t}=e;if("audio"===e.type){if("aac"===t)return Gb.box(Gb.types.stsd,Gb.STSD,Gb.mp4a(e));if("ac3"===t&&e.config)return Gb.box(Gb.types.stsd,Gb.STSD,Gb.ac3(e));if("mp3"===t&&"mp3"===e.codec)return Gb.box(Gb.types.stsd,Gb.STSD,Gb.mp3(e))}else{if(!e.pps||!e.sps)throw new Error("video track missing pps or sps");if("avc"===t)return Gb.box(Gb.types.stsd,Gb.STSD,Gb.avc1(e));if("hevc"===t&&e.vps)return Gb.box(Gb.types.stsd,Gb.STSD,Gb.hvc1(e))}throw new Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){const t=e.id,i=(e.duration||0)*(e.timescale||0),s=e.width||0,a=e.height||0,r=Math.floor(i/(Bb+1)),n=Math.floor(i%(Bb+1));return Gb.box(Gb.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,n>>24,n>>16&255,n>>8&255,255&n,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,s>>8&255,255&s,0,0,a>>8&255,255&a,0,0]))}static traf(e,t){const i=Gb.sdtp(e),s=e.id,a=Math.floor(t/(Bb+1)),r=Math.floor(t%(Bb+1));return Gb.box(Gb.types.traf,Gb.box(Gb.types.tfhd,new Uint8Array([0,0,0,0,s>>24,s>>16&255,s>>8&255,255&s])),Gb.box(Gb.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,r>>24,r>>16&255,r>>8&255,255&r])),Gb.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,Gb.box(Gb.types.trak,Gb.tkhd(e),Gb.mdia(e))}static trex(e){const t=e.id;return Gb.box(Gb.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){const i=e.samples||[],s=i.length,a=12+16*s,r=new Uint8Array(a);let n,o,d,l,c,h;for(t+=8+a,r.set(["video"===e.type?1:0,0,15,1,s>>>24&255,s>>>16&255,s>>>8&255,255&s,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),n=0;n<s;n++)o=i[n],d=o.duration,l=o.size,c=o.flags,h=o.cts,r.set([d>>>24&255,d>>>16&255,d>>>8&255,255&d,l>>>24&255,l>>>16&255,l>>>8&255,255&l,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.paddingValue<<1|c.isNonSync,61440&c.degradPrio,15&c.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*n);return Gb.box(Gb.types.trun,r)}static initSegment(e){Gb.types||Gb.init();const t=Gb.moov(e);return Pf(Gb.FTYP,t)}static hvc1(e){const t=e.params,i=[e.vps,e.sps,e.pps],s=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),3|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),i.length]);let a=s.length;for(let e=0;e<i.length;e+=1){a+=3;for(let t=0;t<i[e].length;t+=1)a+=2+i[e][t].length}const r=new Uint8Array(a);r.set(s,0),a=s.length;const n=i.length-1;for(let e=0;e<i.length;e+=1){r.set(new Uint8Array([32+e|(e===n?128:0),0,i[e].length]),a),a+=3;for(let t=0;t<i[e].length;t+=1)r.set(new Uint8Array([i[e][t].length>>8,255&i[e][t].length]),a),a+=2,r.set(i[e][t],a),a+=i[e][t].length}const o=Gb.box(Gb.types.hvcC,r),d=e.width,l=e.height,c=e.pixelRatio[0],h=e.pixelRatio[1];return Gb.box(Gb.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,255&d,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),o,Gb.box(Gb.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Gb.box(Gb.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,h>>24,h>>16&255,h>>8&255,255&h])))}}Gb.types=void 0,Gb.HDLR_TYPES=void 0,Gb.STTS=void 0,Gb.STSC=void 0,Gb.STCO=void 0,Gb.STSZ=void 0,Gb.VMHD=void 0,Gb.SMHD=void 0,Gb.STSD=void 0,Gb.FTYP=void 0,Gb.DINF=void 0;function Hb(e,t,i=1,s=!1){const a=e*t*i;return s?Math.round(a):a}function Vb(e,t=!1){return Hb(e,1e3,1/9e4,t)}let qb,Kb=null,Yb=null;function Wb(e,t,i,s){return{duration:t,size:i,cts:s,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}class Zb{constructor(e,t,i,s){if(this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=i,this.logger=s,this.ISGenerated=!1,null===Kb){const e=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Kb=e?parseInt(e[1]):0}if(null===Yb){const e=navigator.userAgent.match(/Safari\/(\d+)/i);Yb=e?parseInt(e[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1;const i=e[0].pts,s=e.reduce((e,s)=>{let a=s.pts,r=a-e;return r<-4294967296&&(t=!0,a=Qb(a,i),r=a-e),r>0?e:a},i);return t&&this.logger.debug("PTS rollover detected"),s}remux(e,t,i,s,a,r,n,o){let d,l,c,h,p,u,g=a,f=a;const m=e.pid>-1,v=t.pid>-1,y=t.samples.length,b=e.samples.length>0,w=n&&y>0||y>1;if((!m||b)&&(!v||w)||this.ISGenerated||n){if(this.ISGenerated){var x,k,S,E;const e=this.videoTrackConfig;(e&&(t.width!==e.width||t.height!==e.height||(null==(x=t.pixelRatio)?void 0:x[0])!==(null==(k=e.pixelRatio)?void 0:k[0])||(null==(S=t.pixelRatio)?void 0:S[1])!==(null==(E=e.pixelRatio)?void 0:E[1]))||!e&&w||null===this.nextAudioPts&&b)&&this.resetInitSegment()}this.ISGenerated||(c=this.generateIS(e,t,a,r));const i=this.isVideoContiguous;let s,n=-1;if(w&&(n=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!i&&this.config.forceKeyFrameOnDiscontinuity))if(u=!0,n>0){this.logger.warn(`[mp4-remuxer]: Dropped ${n} out of ${y} video samples due to a missing keyframe`);const e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(n),t.dropped+=n,f+=(t.samples[0].pts-e)/t.inputTimeScale,s=f}else-1===n&&(this.logger.warn(`[mp4-remuxer]: No keyframe found out of ${y} video samples`),u=!1);if(this.ISGenerated){if(b&&w){const i=this.getVideoStartPts(t.samples),s=(Qb(e.samples[0].pts,i)-i)/t.inputTimeScale;g+=Math.max(0,s),f+=Math.max(0,-s)}if(b){if(e.samplerate||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,a,r)),l=this.remuxAudio(e,g,this.isAudioContiguous,r,v||w||o===Cg?f:void 0),w){const s=l?l.endPTS-l.startPTS:0;t.inputTimeScale||(this.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,a,r)),d=this.remuxVideo(t,f,i,s)}}else w&&(d=this.remuxVideo(t,f,i,0));d&&(d.firstKeyFrame=n,d.independent=-1!==n,d.firstKeyFramePTS=s)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(p=Xb(i,a,this._initPTS,this._initDTS)),s.samples.length&&(h=Jb(s,a,this._initPTS))),{audio:l,video:d,initSegment:c,independent:u,text:h,id3:p}}generateIS(e,t,i,s){const a=e.samples,r=t.samples,n=this.typeSupported,o={},d=this._initPTS;let l,c,h,p,u=!d||s,g="audio/mp4";if(u&&(l=c=1/0),e.config&&a.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":n.mpeg?(g="audio/mpeg",e.codec=""):n.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3"}o.audio={id:"audio",container:g,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&n.mpeg?new Uint8Array(0):Gb.initSegment([e]),metadata:{channelCount:e.channelCount}},u&&(p=e.id,h=e.inputTimeScale,d&&h===d.timescale?u=!1:l=c=a[0].pts-Math.round(h*i))}if(t.sps&&t.pps&&r.length){if(t.timescale=t.inputTimeScale,o.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Gb.initSegment([t]),metadata:{width:t.width,height:t.height}},u)if(p=t.id,h=t.inputTimeScale,d&&h===d.timescale)u=!1;else{const e=this.getVideoStartPts(r),t=Math.round(h*i);c=Math.min(c,Qb(r[0].dts,e)-t),l=Math.min(l,e-t)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(o).length)return this.ISGenerated=!0,u?(this._initPTS={baseTime:l,timescale:h},this._initDTS={baseTime:c,timescale:h}):l=h=void 0,{tracks:o,initPTS:l,timescale:h,trackId:p}}remuxVideo(e,t,i,s){const a=e.inputTimeScale,r=e.samples,n=[],o=r.length,d=this._initPTS;let l,c,h=this.nextAvcDts,p=8,u=this.videoSampleDuration,g=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,m=!1;if(!i||null===h){const e=t*a,s=r[0].pts-Qb(r[0].dts,r[0].pts);Kb&&null!==h&&Math.abs(e-s-h)<15e3?i=!0:h=e-s}const v=d.baseTime*a/d.timescale;for(let e=0;e<o;e++){const t=r[e];t.pts=Qb(t.pts-v,h),t.dts=Qb(t.dts-v,h),t.dts<r[e>0?e-1:e].dts&&(m=!0)}m&&r.sort(function(e,t){const i=e.dts-t.dts,s=e.pts-t.pts;return i||s}),l=r[0].dts,c=r[r.length-1].dts;const y=c-l,b=y?Math.round(y/(o-1)):u||e.inputTimeScale/30;if(i){const i=l-h,s=i>b,a=i<-1;if((s||a)&&(s?this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Vb(i,!0)} ms (${i}dts) hole between fragments detected at ${t.toFixed(3)}`):this.logger.warn(`${(e.segmentCodec||"").toUpperCase()}: ${Vb(-i,!0)} ms (${i}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!a||h>=r[0].pts||Kb)){l=h;const e=r[0].pts-i;if(s)r[0].dts=l,r[0].pts=e;else{let t=!0;for(let s=0;s<r.length&&!(r[s].dts>e&&t);s++){const e=r[s].pts;if(r[s].dts-=i,r[s].pts-=i,s<r.length-1){const i=r[s+1].pts;t=i<=r[s].pts==i<=e}}}this.logger.log(`Video: Initial PTS/DTS adjusted: ${Vb(e,!0)}/${Vb(l,!0)}, delta: ${Vb(i,!0)} ms`)}}l=Math.max(0,l);let w=0,x=0,k=l;for(let e=0;e<o;e++){const t=r[e],i=t.units,s=i.length;let a=0;for(let e=0;e<s;e++)a+=i[e].data.length;x+=a,w+=s,t.length=a,t.dts<k?(t.dts=k,k+=b/4|0||1):k=t.dts,g=Math.min(t.pts,g),f=Math.max(t.pts,f)}c=r[o-1].dts;const S=x+4*w+8;let E;try{E=new Uint8Array(S)}catch(e){return void this.observer.emit(kg.ERROR,kg.ERROR,{type:wg.MUX_ERROR,details:xg.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:S,reason:`fail allocating video mdat ${S}`})}const P=new DataView(E.buffer);P.setUint32(0,S),E.set(Gb.types.mdat,4);let T=!1,L=Number.POSITIVE_INFINITY,C=Number.POSITIVE_INFINITY,_=Number.NEGATIVE_INFINITY,A=Number.NEGATIVE_INFINITY;for(let e=0;e<o;e++){const t=r[e],i=t.units;let d,l=0;for(let e=0,t=i.length;e<t;e++){const t=i[e],s=t.data,a=t.data.byteLength;P.setUint32(p,a),p+=4,E.set(s,p),p+=a,l+=4+a}if(e<o-1)u=r[e+1].dts-t.dts,d=r[e+1].pts-t.pts;else{const i=this.config,n=e>0?t.dts-r[e-1].dts:b;if(d=e>0?t.pts-r[e-1].pts:b,i.stretchShortVideoTrack&&null!==this.nextAudioPts){const e=Math.floor(i.maxBufferHole*a),r=(s?g+s*a:this.nextAudioPts)-t.pts;r>e?(u=r-n,u<0?u=n:T=!0,this.logger.log(`[mp4-remuxer]: It is approximately ${r/90} ms to the next segment; using duration ${u/90} ms for the last video frame.`)):u=n}else u=n}const c=Math.round(t.pts-t.dts);L=Math.min(L,u),_=Math.max(_,u),C=Math.min(C,d),A=Math.max(A,d),n.push(Wb(t.key,u,l,c))}if(n.length)if(Kb){if(Kb<70){const e=n[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(Yb&&A-C<_-L&&b/_<.025&&0===n[0].cts){this.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=l;for(let t=0,i=n.length;t<i;t++){const s=e+n[t].duration,a=e+n[t].cts;if(t<i-1){const e=s+n[t+1].cts;n[t].duration=e-a}else n[t].duration=t?n[t-1].duration:b;n[t].cts=0,e=s}}u=T||!u?b:u,this.nextAvcDts=h=c+u,this.videoSampleDuration=u,this.isVideoContiguous=!0;const R={data1:Gb.moof(e.sequenceNumber++,l,Dg(e,{samples:n})),data2:E,startPTS:g/a,endPTS:(f+u)/a,startDTS:l/a,endDTS:h/a,type:"video",hasAudio:!1,hasVideo:!0,nb:n.length,dropped:e.dropped};return e.samples=[],e.dropped=0,R}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(e,t,i,s,a){const r=e.inputTimeScale,n=r/(e.samplerate?e.samplerate:r),o=this.getSamplesPerFrame(e),d=o*n,l=this._initPTS,c="mp3"===e.segmentCodec&&this.typeSupported.mpeg,h=[],p=void 0!==a;let u=e.samples,g=c?0:8,f=this.nextAudioPts||-1;const m=t*r,v=l.baseTime*r/l.timescale;if(this.isAudioContiguous=i=i||u.length&&f>0&&(s&&Math.abs(m-f)<9e3||Math.abs(Qb(u[0].pts-v,m)-f)<20*d),u.forEach(function(e){e.pts=Qb(e.pts-v,m)}),!i||f<0){if(u=u.filter(e=>e.pts>=0),!u.length)return;f=0===a?0:s&&!p?Math.max(0,m):u[0].pts}if("aac"===e.segmentCodec){const t=this.config.maxAudioFramesDrift;for(let i=0,s=f;i<u.length;i++){const a=u[i],n=a.pts,o=n-s,l=Math.abs(1e3*o/r);if(o<=-t*d&&p)0===i&&(this.logger.warn(`Audio frame @ ${(n/r).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*o/r)} ms.`),this.nextAudioPts=f=s=n);else if(o>=t*d&&l<1e4&&p){let t=Math.round(o/d);s=n-t*d,s<0&&(t--,s+=d),0===i&&(this.nextAudioPts=f=s),this.logger.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(s/r).toFixed(3)}s due to ${Math.round(1e3*o/r)} ms gap.`);for(let r=0;r<t;r++){const t=Math.max(s,0);let r=zb.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);r||(this.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),r=a.unit.subarray()),u.splice(i,0,{unit:r,pts:t}),s+=d,i++}}a.pts=s,s+=d}}let y,b=null,w=null,x=0,k=u.length;for(;k--;)x+=u[k].unit.byteLength;for(let t=0,s=u.length;t<s;t++){const s=u[t],a=s.unit;let r=s.pts;if(null!==w){h[t-1].duration=Math.round((r-w)/n)}else{if(i&&"aac"===e.segmentCodec&&(r=f),b=r,!(x>0))return;x+=g;try{y=new Uint8Array(x)}catch(e){return void this.observer.emit(kg.ERROR,kg.ERROR,{type:wg.MUX_ERROR,details:xg.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:x,reason:`fail allocating audio mdat ${x}`})}if(!c){new DataView(y.buffer).setUint32(0,x),y.set(Gb.types.mdat,4)}}y.set(a,g);const d=a.byteLength;g+=d,h.push(Wb(!0,o,d,0)),w=r}const S=h.length;if(!S)return;const E=h[h.length-1];this.nextAudioPts=f=w+n*E.duration;const P=c?new Uint8Array(0):Gb.moof(e.sequenceNumber++,b/n,Dg({},e,{samples:h}));e.samples=[];const T=b/r,L=f/r,C={data1:P,data2:y,startPTS:T,endPTS:L,startDTS:T,endDTS:L,type:"audio",hasAudio:!0,hasVideo:!1,nb:S};return this.isAudioContiguous=!0,C}}function Qb(e,t){let i;if(null===t)return e;for(i=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=i;return e}function Xb(e,t,i,s){const a=e.samples.length;if(!a)return;const r=e.inputTimeScale;for(let n=0;n<a;n++){const a=e.samples[n];a.pts=Qb(a.pts-i.baseTime*r/i.timescale,t*r)/r,a.dts=Qb(a.dts-s.baseTime*r/s.timescale,t*r)/r}const n=e.samples;return e.samples=[],{samples:n}}function Jb(e,t,i){const s=e.samples.length;if(!s)return;const a=e.inputTimeScale;for(let r=0;r<s;r++){const s=e.samples[r];s.pts=Qb(s.pts-i.baseTime*a/i.timescale,t*a)/a}e.samples.sort((e,t)=>e.pts-t.pts);const r=e.samples;return e.samples=[],{samples:r}}function ew(e,t,i=!1){return void 0!==(null==e?void 0:e.start)?(e.start+(i?e.duration:0))/e.timescale:t}function tw(e,t,i){const s=null==e?void 0:e.codec;if(s&&s.length>4)return s;if(t===Xg){if("ec-3"===s||"ac-3"===s||"alac"===s)return s;if("fLaC"===s||"Opus"===s){return Gf(s,!1)}return i.warn(`Unhandled audio codec "${s}" in mp4 MAP`),s||"mp4a"}return i.warn(`Unhandled video codec "${s}" in mp4 MAP`),s||"avc1"}try{qb=self.performance.now.bind(self.performance)}catch(_){qb=Date.now}const iw=[{demux:class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,i,s){const a=this.videoTrack=cb("video",1),r=this.audioTrack=cb("audio",1),n=this.txtTrack=cb("text",1);if(this.id3Track=cb("id3",1),this.timeOffset=0,null==e||!e.byteLength)return;const o=yf(e);if(o.video){const{id:e,timescale:t,codec:i,supplemental:s}=o.video;a.id=e,a.timescale=n.timescale=t,a.codec=i,a.supplemental=s}if(o.audio){const{id:e,timescale:t,codec:i}=o.audio;r.id=e,r.timescale=t,r.codec=i}n.id=lf.text,a.sampleDuration=0,a.duration=r.duration=s}resetContiguity(){this.remainderData=null}static probe(e){return function(e){const t=e.byteLength;for(let i=0;i<t;){const s=pf(e,i);if(s>8&&109===e[i+4]&&111===e[i+5]&&111===e[i+6]&&102===e[i+7])return!0;i=s>1?i+s:t}return!1}(e)}demux(e,t){this.timeOffset=t;let i=e;const s=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=Pf(this.remainderData,e));const t=function(e){const t={valid:null,remainder:null},i=mf(e,["moof"]);if(i.length<2)return t.remainder=e,t;const s=i[i.length-1];return t.valid=e.slice(0,s.byteOffset-8),t.remainder=e.slice(s.byteOffset-8),t}(i);this.remainderData=t.remainder,s.samples=t.valid||new Uint8Array}else s.samples=i;const r=this.extractID3Track(s,t);return a.samples=Tf(t,s),{videoTrack:s,audioTrack:this.audioTrack,id3Track:r,textTrack:this.txtTrack}}flush(){const e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;const s=this.extractID3Track(t,this.timeOffset);return i.samples=Tf(e,t),{videoTrack:t,audioTrack:cb(),id3Track:s,textTrack:cb()}}extractID3Track(e,t){const i=this.id3Track;if(e.samples.length){const s=mf(e.samples,["emsg"]);s&&s.forEach(e=>{const s=function(e){const t=e[0];let i="",s="",a=0,r=0,n=0,o=0,d=0,l=0;if(0===t){for(;"\0"!==cf(e.subarray(l,l+1));)i+=cf(e.subarray(l,l+1)),l+=1;for(i+=cf(e.subarray(l,l+1)),l+=1;"\0"!==cf(e.subarray(l,l+1));)s+=cf(e.subarray(l,l+1)),l+=1;s+=cf(e.subarray(l,l+1)),l+=1,a=pf(e,12),r=pf(e,16),o=pf(e,20),d=pf(e,24),l=28}else if(1===t){l+=4,a=pf(e,l),l+=4;const t=pf(e,l);l+=4;const r=pf(e,l);for(l+=4,n=2**32*t+r,yg(n)||(n=Number.MAX_SAFE_INTEGER,Bg.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=pf(e,l),l+=4,d=pf(e,l),l+=4;"\0"!==cf(e.subarray(l,l+1));)i+=cf(e.subarray(l,l+1)),l+=1;for(i+=cf(e.subarray(l,l+1)),l+=1;"\0"!==cf(e.subarray(l,l+1));)s+=cf(e.subarray(l,l+1)),l+=1;s+=cf(e.subarray(l,l+1)),l+=1}return{schemeIdUri:i,value:s,timeScale:a,presentationTime:n,presentationTimeDelta:r,eventDuration:o,id:d,payload:e.subarray(l,e.byteLength)}}(e);if(Tb.test(s.schemeIdUri)){const e=Lb(s,t);let a=4294967295===s.eventDuration?Number.POSITIVE_INFINITY:s.eventDuration/s.timeScale;a<=.001&&(a=Number.POSITIVE_INFINITY);const r=s.payload;i.samples.push({data:r,len:r.byteLength,dts:e,pts:e,type:lb.emsg,duration:a})}else if(this.config.enableEmsgKLVMetadata&&s.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){const e=Lb(s,t);i.samples.push({data:s.payload,len:s.payload.byteLength,dts:e,pts:e,type:lb.misbklv,duration:Number.POSITIVE_INFINITY})}})}return i}demuxSampleAes(e,t,i){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}},remux:class{constructor(e,t,i,s){this.logger=void 0,this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1,this.logger=s}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,i,s){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(function(e,t){if(!e||!t)return e;const i=t.keyId;i&&t.isCommonEncryption&&mf(e,["moov","trak"]).forEach(e=>{const t=mf(e,["mdia","minf","stbl","stsd"])[0].subarray(8);let s=mf(t,["enca"]);const a=s.length>0;a||(s=mf(t,["encv"])),s.forEach(e=>{mf(a?e.subarray(28):e.subarray(78),["sinf"]).forEach(e=>{const t=Ef(e);if(t){const e=t.subarray(8,24);e.some(e=>0!==e)||(Bg.log(`[eme] Patching keyId in 'enc${a?"a":"v"}>sinf>>tenc' box: ${qg(e)} -> ${qg(i)}`),t.set(i,8))}})})});return e}(e,s)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:i}=this;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);const s=this.initData=yf(e);s.audio&&(t=tw(s.audio,Xg,this.logger)),s.video&&(i=tw(s.video,Jg,this.logger));const a={};s.audio&&s.video?a.audiovideo={container:"video/mp4",codec:t+","+i,supplemental:s.video.supplemental,initSegment:e,id:"main"}:s.audio?a.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:s.video?a.video={container:"video/mp4",codec:i,supplemental:s.video.supplemental,initSegment:e,id:"main"}:this.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=a}remux(e,t,i,s,a,r){var n,o;let{initPTS:d,lastEndTime:l}=this;const c={audio:void 0,video:void 0,text:s,id3:i,initSegment:void 0};vg(l)||(l=this.lastEndTime=a||0);const h=t.samples;if(null==h||!h.length)return c;const p={initPTS:void 0,timescale:void 0,trackId:void 0};let u=this.initData;if(null!=(n=u)&&n.length||(this.generateInitSegment(h),u=this.initData),null==(o=u)||!o.length)return this.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),c;this.emitInitSegment&&(p.tracks=this.initTracks,this.emitInitSegment=!1);const g=function(e,t,i){const s={},a=mf(e,["moof","traf"]);for(let e=0;e<a.length;e++){const r=a[e],n=mf(r,["tfhd"])[0],o=pf(n,4),d=t[o];if(!d)continue;const l=s[o]||(s[o]={start:NaN,duration:0,sampleCount:0,timescale:d.timescale,type:d.type}),c=mf(r,["tfdt"])[0];if(c){const e=c[0];let t=pf(c,4);1===e&&(t===of?i.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(t*=of+1,t+=pf(c,8))),vg(t)&&(!vg(l.start)||t<l.start)&&(l.start=t)}const h=d.default,p=pf(n,0)|(null==h?void 0:h.flags);let u=(null==h?void 0:h.duration)||0;8&p&&(u=pf(n,2&p?12:8));const g=mf(r,["trun"]);let f=l.start||0,m=0,v=u;for(let e=0;e<g.length;e++){const t=g[e],i=pf(t,4),s=l.sampleCount;l.sampleCount+=i;const a=1&t[3],r=4&t[3],n=1&t[2],o=2&t[2],d=4&t[2],c=8&t[2];let h=8,p=i;for(a&&(h+=4),r&&i&&(1&t[h+1]||void 0!==l.keyFrameIndex||(l.keyFrameIndex=s),h+=4,n?(v=pf(t,h),h+=4):v=u,o&&(h+=4),c&&(h+=4),f+=v,m+=v,p--);p--;)n?(v=pf(t,h),h+=4):v=u,o&&(h+=4),d&&(1&t[h+1]||void 0===l.keyFrameIndex&&(l.keyFrameIndex=l.sampleCount-(p+1),l.keyFrameStart=f),h+=4),c&&(h+=4),f+=v,m+=v;!m&&u&&(m+=u*i)}l.duration+=m}if(!Object.keys(s).some(e=>s[e].duration)){let t=0;const i=mf(e,["sidx"]);for(let e=0;e<i.length;e++){const s=vf(i[e]);if(null!=s&&s.references){const e=s.references.reduce((e,t)=>e+t.info.duration||0,0);t=Math.max(t,e+s.earliestPresentationTime/s.timescale)}}t&&vg(t)&&Object.keys(s).forEach(e=>{s[e].duration||(s[e].duration=t*s[e].timescale-s[e].start)})}return s}(h,u,this.logger),f=u.audio?g[u.audio.id]:null,m=u.video?g[u.video.id]:null,v=ew(m,1/0),y=ew(f,1/0),b=ew(m,0,!0),w=ew(f,0,!0);let x,k=a,S=0;if(f&&(!m||!d&&y<v||d&&d.trackId===u.audio.id)?(p.trackId=u.audio.id,x=f,S=w-y):m&&(p.trackId=u.video.id,x=m,S=b-v),x){const e=x.timescale;k=x.start/e,p.timescale=e,d||(p.initPTS=x.start-a*e,this.initPTS=d={baseTime:p.initPTS,timescale:e,trackId:p.trackId})}!r&&d||!function(e,t,i,s){if(null===e)return!0;const a=Math.max(s,1),r=t-e.baseTime/e.timescale;return Math.abs(r-i)>a}(d,k,a,S)&&p.timescale===d.timescale||(p.initPTS=k-a,d&&1===d.timescale&&this.logger.warn(`Adjusting initPTS @${a} from ${d.baseTime/d.timescale} to ${p.initPTS}`),this.initPTS=d={baseTime:p.initPTS,timescale:1});const E=e?k-d.baseTime/d.timescale:l;!function(e,t,i){mf(t,["moof","traf"]).forEach(t=>{mf(t,["tfhd"]).forEach(s=>{const a=pf(s,4),r=e[a];if(!r)return;const n=r.timescale||9e4;mf(t,["tfdt"]).forEach(e=>{const t=e[0],s=i*n;if(s){let i=pf(e,4);if(0===t)i-=s,i=Math.max(i,0),ff(e,4,i);else{i*=Math.pow(2,32),i+=pf(e,8),i-=s,i=Math.max(i,0);const t=Math.floor(i/(of+1)),a=Math.floor(i%(of+1));ff(e,4,t),ff(e,8,a)}}})})})}(u,h,d.baseTime/d.timescale);const P=E+S;S>0?this.lastEndTime=P:(this.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());const T=!!u.audio,L=!!u.video;let C="";T&&(C+="audio"),L&&(C+="video");const _={data1:h,startPTS:E,startDTS:E,endPTS:P,endDTS:P,type:C,hasAudio:T,hasVideo:L,nb:1,dropped:0};c.audio=T&&!L?_:void 0,c.video=L?_:void 0;const A=null==m?void 0:m.sampleCount;if(A){const e=m.keyFrameIndex,t=-1!==e;_.nb=A,_.dropped=0===e||this.isVideoContiguous?0:t?e:A,_.independent=t,_.firstKeyFrame=e,t&&m.keyFrameStart&&(_.firstKeyFramePTS=m.keyFrameStart-d.baseTime/d.timescale),this.isVideoContiguous||(c.independent=t),this.isVideoContiguous||(this.isVideoContiguous=t),_.dropped&&this.logger.warn(`fmp4 does not start with IDR: firstIDR ${e}/${A} dropped: ${_.dropped} pts: ${_.firstKeyFramePTS||"NA"}`)}return c.initSegment=p,c.id3=Xb(i,a,d,d),s.samples.length&&(c.text=Jb(s,a,d)),c}}},{demux:Mb,remux:Zb},{demux:class extends hb{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,i,s){super.resetInitSegment(e,t,i,s),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;const i=Vy(e,0);let s=(null==i?void 0:i.length)||0;if(kb(e,s))return!1;for(let i=e.length;s<i;s++)if(Zy(e,s))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&qy(e,t)&&Yy(e,t)<=e.length-t}(e,t)}appendFrame(e,t,i){Qy(e,this.observer,t,i,e.manifestCodec);const s=Jy(e,t,i,this.basePTS,this.frameIndex);if(s&&0===s.missing)return s}},remux:Zb},{demux:class extends hb{resetInitSegment(e,t,i,s){super.resetInitSegment(e,t,i,s),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:s,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;const t=Vy(e,0);let i=(null==t?void 0:t.length)||0;if(t&&11===e[i]&&119===e[i+1]&&void 0!==db(t)&&Sb(e,i)<=16)return!1;for(let t=e.length;i<t;i++)if(kb(e,i))return Bg.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return function(e,t){return wb(e,t)&&4<=e.length-t}(e,t)}appendFrame(e,t,i){if(null!==this.basePTS)return yb(e,t,i,this.basePTS,this.frameIndex)}},remux:Zb}];iw.splice(2,0,{demux:Eb,remux:Zb});class sw{constructor(e,t,i,s,a,r){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=i,this.id=a,this.logger=r}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,i,s){const a=i.transmuxing;a.executeStart=qb();let r=new Uint8Array(e);const{currentTransmuxState:n,transmuxConfig:o}=this;s&&(this.currentTransmuxState=s);const{contiguous:d,discontinuity:l,trackSwitch:c,accurateTimeOffset:h,timeOffset:p,initSegmentChange:u}=s||n,{audioCodec:g,videoCodec:f,defaultInitPts:m,duration:v,initSegmentData:y}=o,b=function(e,t){let i=null;e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(i=t);return i}(r,t);if(b&&vv(b.method)){const e=this.getDecrypter(),t=yv(b.method);if(!e.isSync())return this.asyncResult=!0,this.decryptionPromise=e.webCryptoDecrypt(r,b.key.buffer,b.iv.buffer,t).then(e=>{const t=this.push(e,null,i);return this.decryptionPromise=null,t}),this.decryptionPromise;{let s=e.softwareDecrypt(r,b.key.buffer,b.iv.buffer,t);if(i.part>-1){const t=e.flush();s=t?t.buffer:t}if(!s)return a.executeEnd=qb(),aw(i);r=new Uint8Array(s)}}const w=this.needsProbing(l,c);if(w){const e=this.configureTransmuxer(r);if(e)return this.logger.warn(`[transmuxer] ${e.message}`),this.observer.emit(kg.ERROR,kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),a.executeEnd=qb(),aw(i)}(l||c||u||w)&&this.resetInitSegment(y,g,f,v,t),(l||u||w)&&this.resetInitialTimestamp(m),d||this.resetContiguity();const x=this.transmux(r,b,p,h,i);this.asyncResult=rw(x);const k=this.currentTransmuxState;return k.contiguous=!0,k.discontinuity=!1,k.trackSwitch=!1,a.executeEnd=qb(),x}flush(e){const t=e.transmuxing;t.executeStart=qb();const{decrypter:i,currentTransmuxState:s,decryptionPromise:a}=this;if(a)return this.asyncResult=!0,a.then(()=>this.flush(e));const r=[],{timeOffset:n}=s;if(i){const t=i.flush();t&&r.push(this.push(t.buffer,null,e))}const{demuxer:o,remuxer:d}=this;if(!o||!d){t.executeEnd=qb();const i=[aw(e)];return this.asyncResult?Promise.resolve(i):i}const l=o.flush(n);return rw(l)?(this.asyncResult=!0,l.then(t=>(this.flushRemux(r,t,e),r))):(this.flushRemux(r,l,e),this.asyncResult?Promise.resolve(r):r)}flushRemux(e,t,i){const{audioTrack:s,videoTrack:a,id3Track:r,textTrack:n}=t,{accurateTimeOffset:o,timeOffset:d}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${i.sn}${i.part>-1?" part: "+i.part:""} of ${this.id===Lg?"level":"track"} ${i.level}`);const l=this.remuxer.remux(s,a,r,n,d,o,!0,this.id);e.push({remuxResult:l,chunkMeta:i}),i.transmuxing.executeEnd=qb()}resetInitialTimestamp(e){const{demuxer:t,remuxer:i}=this;t&&i&&(t.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){const{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,i,s,a){const{demuxer:r,remuxer:n}=this;r&&n&&(r.resetInitSegment(e,t,i,s),n.resetInitSegment(e,t,i,a))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,i,s,a){let r;return r=t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,i,s,a):this.transmuxUnencrypted(e,i,s,a),r}transmuxUnencrypted(e,t,i,s){const{audioTrack:a,videoTrack:r,id3Track:n,textTrack:o}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,r,n,o,t,i,!1,this.id),chunkMeta:s}}transmuxSampleAes(e,t,i,s,a){return this.demuxer.demuxSampleAes(e,t,i).then(e=>({remuxResult:this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,i,s,!1,this.id),chunkMeta:a}))}configureTransmuxer(e){const{config:t,observer:i,typeSupported:s}=this;let a;for(let t=0,i=iw.length;t<i;t++){var r;if(null!=(r=iw[t].demux)&&r.probe(e,this.logger)){a=iw[t];break}}if(!a)return new Error("Failed to find demuxer by probing fragment data");const n=this.demuxer,o=this.remuxer,d=a.remux,l=a.demux;o&&o instanceof d||(this.remuxer=new d(i,t,s,this.logger)),n&&n instanceof l||(this.demuxer=new l(i,t,s,this.logger),this.probe=l.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new Wm(this.config)),e}}const aw=e=>({remuxResult:{},chunkMeta:e});function rw(e){return"then"in e&&e.then instanceof Function}class nw{constructor(e,t,i,s,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=s,this.defaultInitPts=a||null}}class ow{constructor(e,t,i,s,a,r){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=s,this.timeOffset=a,this.initSegmentChange=r}}let dw=0;class lw{constructor(e,t,i,s){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=dw++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=e=>{const t=e.data,i=this.hls;if(i&&null!=t&&t.event&&t.instanceNo===this.instanceNo)switch(t.event){case"init":{var s;const e=null==(s=this.workerContext)?void 0:s.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":i.logger[t.data.logType]&&i.logger[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.part=this.part,t.data.id=this.id,i.trigger(t.event,t.data)}},this.onWorkerError=e=>{if(!this.hls)return;const t=new Error(`${e.message}  (${e.filename}:${e.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(kg.ERROR,{type:wg.OTHER_ERROR,details:xg.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t})};const a=e.config;this.hls=e,this.id=t,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=i,this.onFlush=s;const r=(e,t)=>{(t=t||{}).frag=this.frag||void 0,e===kg.ERROR&&(t.parent=this.id,t.part=this.part,this.error=t.error),this.hls.trigger(e,t)};this.observer=new Ny,this.observer.on(kg.FRAG_DECRYPTED,r),this.observer.on(kg.ERROR,r);const n=qf(a.preferManagedMediaSource);if(this.useWorker&&"undefined"!=typeof Worker){const i=this.hls.logger;if(a.workerPath||"function"==typeof __HLS_WORKER_BUNDLE__){try{a.workerPath?(i.log(`loading Web Worker ${a.workerPath} for "${t}"`),this.workerContext=function(e){const t=zy[e];if(t)return t.clientCount++,t;const i=new self.URL(e,self.location.href).href,s={worker:new self.Worker(i),scriptURL:i,clientCount:1};return zy[e]=s,s}(a.workerPath)):(i.log(`injecting Web Worker for "${t}"`),this.workerContext=function(){const e=zy[jy];if(e)return e.clientCount++,e;const t=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),i=self.URL.createObjectURL(t),s={worker:new self.Worker(i),objectURL:i,clientCount:1};return zy[jy]=s,s}());const{worker:e}=this.workerContext;e.addEventListener("message",this.onWorkerMessage),e.addEventListener("error",this.onWorkerError),e.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:n,id:t,config:lm(a)})}catch(s){i.warn(`Error setting up "${t}" Web Worker, fallback to inline`,s),this.terminateWorker(),this.error=null,this.transmuxer=new sw(this.observer,n,a,"",t,e.logger)}return}}this.transmuxer=new sw(this.observer,n,a,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){const e=this.instanceNo;this.instanceNo=dw++;const t=this.hls.config,i=qf(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:i,id:this.id,config:lm(t)})}}terminateWorker(){if(this.workerContext){const{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),function(e){const t=zy[e||jy];if(t&&1===t.clientCount--){const{worker:i,objectURL:s}=t;delete zy[e||jy],s&&self.URL.revokeObjectURL(s),i.terminate()}}(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{const e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}const e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,i,s,a,r,n,o,d,l){var c,h;d.transmuxing.start=self.performance.now();const{instanceNo:p,transmuxer:u}=this,g=r?r.start:a.start,f=a.decryptdata,m=this.frag,v=!(m&&a.cc===m.cc),y=!(m&&d.level===m.level),b=m?d.sn-m.sn:-1,w=this.part?d.part-this.part.index:-1,x=0===b&&d.id>1&&d.id===(null==m?void 0:m.stats.chunkCount),k=!y&&(1===b||0===b&&(1===w||x&&w<=0)),S=self.performance.now();(y||b||0===a.stats.parsing.start)&&(a.stats.parsing.start=S),!r||!w&&k||(r.stats.parsing.start=S);const E=!(m&&(null==(c=a.initSegment)?void 0:c.url)===(null==(h=m.initSegment)?void 0:h.url)),P=new ow(v,k,o,y,g,E);if(!k||v||E){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${a.type} sn: ${d.sn}${d.part>-1?" part: "+d.part:""} ${this.id===Lg?"level":"track"}: ${d.level} id: ${d.id}\n        discontinuity: ${v}\n        trackSwitch: ${y}\n        contiguous: ${k}\n        accurateTimeOffset: ${o}\n        timeOffset: ${g}\n        initSegmentChange: ${E}`);const e=new nw(i,s,t,n,l);this.configureTransmuxer(e)}if(this.frag=a,this.part=r,this.workerContext)this.workerContext.worker.postMessage({instanceNo:p,cmd:"demux",data:e,decryptdata:f,chunkMeta:d,state:P},e instanceof ArrayBuffer?[e]:[]);else if(u){const t=u.push(e,f,d,P);rw(t)?t.then(e=>{this.handleTransmuxComplete(e)}).catch(e=>{this.transmuxerError(e,d,"transmuxer-interface push error")}):this.handleTransmuxComplete(t)}}flush(e){e.transmuxing.start=self.performance.now();const{instanceNo:t,transmuxer:i}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(i){const t=i.flush(e);rw(t)?t.then(t=>{this.handleFlushResult(t,e)}).catch(t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")}):this.handleFlushResult(t,e)}}transmuxerError(e,t,i){this.hls&&(this.error=e,this.hls.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,t){e.forEach(e=>{this.handleTransmuxComplete(e)}),this.onFlush(t)}configureTransmuxer(e){const{instanceNo:t,transmuxer:i}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):i&&i.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}class cw extends Ug{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,i){const s=null==t?void 0:t.renditionReports;if(s){let a=-1;for(let i=0;i<s.length;i++){const r=s[i];let n;try{n=new self.URL(r.URI,t.url).href}catch(e){this.warn(`Could not construct new URL for Rendition Report: ${e}`),n=r.URI||""}if(n===e){a=i;break}n===e.substring(0,n.length)&&(a=i)}if(-1!==a){const e=s[a],r=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn);let n=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){const e=Math.min(t.age-t.partTarget,t.targetduration);n>=0&&e>t.partTarget&&(n+=1)}const o=i&&am(i);return new rm(r,n>=0?n:void 0,o)}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}return e}playlistLoaded(e,t,i){const{details:s,stats:a}=t,r=self.performance.now(),n=a.loading.first?Math.max(0,r-a.loading.first):0;s.advancedDateTime=Date.now()-n;const o=this.hls.config.timelineOffset;if(o!==s.appliedTimelineOffset){const e=Math.max(o||0,0);s.appliedTimelineOffset=e,s.fragments.forEach(t=>{t.start=t.playlistOffset+e})}if(s.live||null!=i&&i.live){const o="levelInfo"in t?t.levelInfo:t.track;if(s.reloaded(i),i&&s.fragments.length>0){ny(i,s);const e=s.playlistParsingError;if(e){this.warn(e);const i=this.hls;if(!i.config.ignorePlaylistParsingErrors){var d;const{networkDetails:r}=t;return void i.trigger(kg.ERROR,{type:wg.NETWORK_ERROR,details:xg.LEVEL_PARSING_ERROR,fatal:!1,url:s.url,error:e,reason:e.message,level:t.level||void 0,parent:null==(d=s.fragments[0])?void 0:d.type,networkDetails:r,stats:a})}s.playlistParsingError=null}}-1===s.requestScheduled&&(s.requestScheduled=a.loading.start);const l=this.hls.mainForwardBufferInfo,c=l?l.end-l.len:0,h=cy(s,1e3*(s.edge-c));if(s.requestScheduled+h<r?s.requestScheduled=r:s.requestScheduled+=h,this.log(`live playlist ${e} ${s.advanced?"REFRESHED "+s.lastPartSn+"-"+s.lastPartIndex:s.updated?"UPDATED":"MISSED"}`),!this.canLoad||!s.live)return;let p,u,g;if(s.canBlockReload&&s.endSN&&s.advanced){const e=this.hls.config.lowLatencyMode,a=s.lastPartSn,n=s.endSN,d=s.lastPartIndex,l=a===n;-1!==d?l?(u=n+1,g=e?0:d):(u=a,g=e?d+1:s.maxPartIndex):u=n+1;const c=s.age,h=c+s.ageHeader;let f=Math.min(h-s.partTarget,1.5*s.targetduration);if(f>0){if(h>3*s.targetduration)this.log(`Playlist last advanced ${c.toFixed(2)}s ago. Omitting segment and part directives.`),u=void 0,g=void 0;else if(null!=i&&i.tuneInGoal&&h-s.partTarget>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${f} with playlist age: ${s.age}`),f=0;else{const e=Math.floor(f/s.targetduration);if(u+=e,void 0!==g){g+=Math.round(f%s.targetduration/s.partTarget)}this.log(`CDN Tune-in age: ${s.ageHeader}s last advanced ${c.toFixed(2)}s goal: ${f} skip sn ${e} to part ${g}`)}s.tuneInGoal=f}if(p=this.getDeliveryDirectives(s,t.deliveryDirectives,u,g),e||!l)return s.requestScheduled=r,void this.loadingPlaylist(o,p)}else(s.canBlockReload||s.canSkipUntil)&&(p=this.getDeliveryDirectives(s,t.deliveryDirectives,u,g));p&&void 0!==u&&s.canBlockReload&&(s.requestScheduled=a.loading.first+Math.max(h-2*n,h/2)),this.scheduleLoading(o,p,s)}else this.clearTimer()}scheduleLoading(e,t,i){const s=i||e.details;if(!s)return void this.loadingPlaylist(e,t);const a=self.performance.now(),r=s.requestScheduled;if(a>=r)return void this.loadingPlaylist(e,t);const n=r-a;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(n)} ms`),this.clearTimer(),this.timer=self.setTimeout(()=>this.loadingPlaylist(e,t),n)}getDeliveryDirectives(e,t,i,s){let a=am(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,s=t.part,a=tm),new rm(i,s,a)}checkRetry(e){const t=e.details,i=Sm(e),s=e.errorAction,{action:a,retryCount:r=0,retryConfig:n}=s||{},o=!!s&&!!n&&(a===Rm||!s.resolved&&a===_m);if(o){var d;if(r>=n.maxNumRetry)return!1;if(i&&null!=(d=e.context)&&d.deliveryDirectives)this.warn(`Retrying playlist loading ${r+1}/${n.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{const e=Pm(n,r);this.clearTimer(),this.timer=self.setTimeout(()=>this.loadPlaylist(),e),this.warn(`Retrying playlist loading ${r+1}/${n.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,s.resolved=!0}return o}}function hw(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!pw(e[i].attrs,t[i].attrs))return!1;return!0}function pw(e,t,i){const s=e["STABLE-RENDITION-ID"];return s&&!i?s===t["STABLE-RENDITION-ID"]:!(i||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(i=>e[i]!==t[i])}function uw(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}class gw{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,i){if(null===this.queues||null===this.tracks)return;const s=this.queues[t];s.push(e),1!==s.length||i||this.executeNext(t)}appendBlocker(e){return new Promise(t=>{const i={label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.append(i,e)})}prependBlocker(e){return new Promise(t=>{if(this.queues){const i={label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};this.queues[e].unshift(i)}})}removeBlockers(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;const i=null==(t=e[0])?void 0:t.label;"async-blocker"!==i&&"async-blocker-prepend"!==i||(e[0].execute(),e.splice(0,1))})}unblockAudio(e){if(null===this.queues)return;this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(null===this.queues||null===this.tracks)return;const t=this.queues[e];if(t.length){const s=t[0];try{s.execute()}catch(t){var i;if(s.onError(t),null===this.queues||null===this.tracks)return;const a=null==(i=this.tracks[e])?void 0:i.buffer;null!=a&&a.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){null!==this.queues&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return(null==(t=this.queues)?void 0:t[e][0])||null}toString(){const{queues:e,tracks:t}=this;return null===e||null===t?"<destroyed>":`\n${this.list("video")}\n${this.list("audio")}\n${this.list("audiovideo")}}`}list(e){var t,i;return null!=(t=this.queues)&&t[e]||null!=(i=this.tracks)&&i[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;const i=null==(t=this.tracks)?void 0:t[e],s=null==i?void 0:i.buffer;return s?`SourceBuffer${s.updating?" updating":""}${i.ended?" ended":""}${i.ending?" ending":""}`:"none"}listOps(e){var t;return(null==(t=this.queues)?void 0:t[e].map(e=>e.label).join(", "))||""}}const fw=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,mw="HlsJsTrackRemovedError";class vw extends Error{constructor(e){super(e),this.name=mw}}function yw(e){const t=e.querySelectorAll("source");[].slice.call(t).forEach(t=>{e.removeChild(t)})}function bw(e){return"audio"===e?1:0}class ww{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){const{hls:e}=this;e.on(kg.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.on(kg.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(kg.BUFFER_CODECS,this.onBufferCodecs,this),e.on(kg.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){const{hls:e}=this;e.off(kg.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.off(kg.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(kg.BUFFER_CODECS,this.onBufferCodecs,this),e.off(kg.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){const i=this.hls.levels[t.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){const i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&vg(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);const e=this.hls.levels;if(e.length){const t=this.hls,i=this.getMaxLevel(e.length-1);i!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${i}: ${e[i].height}p@${e[i].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=i,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){const t=this.hls.levels;if(!t.length)return-1;const i=t.filter((t,i)=>this.isLevelAllowed(t)&&i<=e);return this.clientRect=null,ww.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;const e=this.media,t={width:0,height:0};if(e){const i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,t.width||t.height||(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height)}static getMaxLevelByMediaSize(e,t,i){if(null==e||!e.length)return-1;const s=(e,t)=>!t||(e.width!==t.width||e.height!==t.height);let a=e.length-1;const r=Math.max(t,i);for(let t=0;t<e.length;t+=1){const i=e[t];if((i.width>=r||i.height>=r)&&s(i,e[t+1])){a=t;break}}return a}}const xw={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",CAPTION:"c",TIMED_TEXT:"tt",KEY:"k",OTHER:"o"},kw={HLS:"h"},Sw="CMCD-Object",Ew="CMCD-Request",Pw="CMCD-Session",Tw="CMCD-Status",Lw={[Sw]:["br","d","ot","tb"],[Ew]:["bl","dl","mtp","nor","nrr","su"],[Pw]:["cid","pr","sf","sid","st","v"],[Tw]:["bs","rtp"]};class Cw{constructor(e,t){Array.isArray(e)&&(e=e.map(e=>e instanceof Cw?e:new Cw(e))),this.value=e,this.params=t}}function _w(e,t,i,s){return new Error(`failed to ${e} "${a=t,Array.isArray(a)?JSON.stringify(a):a instanceof Map?"Map{}":a instanceof Set?"Set{}":"object"==typeof a?JSON.stringify(a):String(a)}" as ${i}`,{cause:s});var a}function Aw(e,t,i){return _w("serialize",e,t,i)}class Rw{constructor(e){this.description=e}}const Iw="Bare Item";function Dw(e){if(!1===ArrayBuffer.isView(e))throw Aw(e,"Byte Sequence");return`:${t=e,btoa(String.fromCharCode(...t))}:`;var t}function Mw(e){if(function(e){return e<-999999999999999||999999999999999<e}(e))throw Aw(e,"Integer");return e.toString()}function Ow(e,t){if(e<0)return-Ow(-e,t);const i=Math.pow(10,t);if(Math.abs(e*i%1-.5)<Number.EPSILON){const t=Math.floor(e*i);return(t%2==0?t:t+1)/i}return Math.round(e*i)/i}function Uw(e){const t=Ow(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw Aw(e,"Decimal");const i=t.toString();return i.includes(".")?i:`${i}.0`}const $w=/[\x00-\x1f\x7f]+/;function Fw(e){const t=(i=e).description||i.toString().slice(7,-1);var i;if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(t))throw Aw(t,"Token");return t}function Nw(e){switch(typeof e){case"number":if(!vg(e))throw Aw(e,Iw);return Number.isInteger(e)?Mw(e):Uw(e);case"string":return function(e){if($w.test(e))throw Aw(e,"String");return`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}(e);case"symbol":return Fw(e);case"boolean":return function(e){if("boolean"!=typeof e)throw Aw(e,"Boolean");return e?"?1":"?0"}(e);case"object":if(e instanceof Date)return function(e){return`@${Mw(e.getTime()/1e3)}`}(e);if(e instanceof Uint8Array)return Dw(e);if(e instanceof Rw)return Fw(e);default:throw Aw(e,Iw)}}function jw(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw Aw(e,"Key");return e}function zw(e){return null==e?"":Object.entries(e).map(([e,t])=>!0===t?`;${jw(e)}`:`;${jw(e)}=${Nw(t)}`).join("")}function Bw(e){return e instanceof Cw?`${Nw(e.value)}${zw(e.params)}`:Nw(e)}function Gw(e,t={whitespace:!0}){if("object"!=typeof e)throw Aw(e,"Dict");const i=e instanceof Map?e.entries():Object.entries(e),s=(null==t?void 0:t.whitespace)?" ":"";return Array.from(i).map(([e,t])=>{t instanceof Cw==!1&&(t=new Cw(t));let i=jw(e);var s;return!0===t.value?i+=zw(t.params):(i+="=",Array.isArray(t.value)?i+=`(${(s=t).value.map(Bw).join(" ")})${zw(s.params)}`:i+=Bw(t)),i}).join(`,${s}`)}const Hw=e=>Math.round(e),Vw=e=>100*Hw(e/100),qw={br:Hw,d:Hw,bl:Vw,dl:Vw,mtp:Vw,nor:(e,t)=>((null==t?void 0:t.baseUrl)&&(e=function(e,t){const i=new URL(e),s=new URL(t);if(i.origin!==s.origin)return e;const a=i.pathname.split("/").slice(1),r=s.pathname.split("/").slice(1,-1);for(;a[0]===r[0];)a.shift(),r.shift();for(;r.length;)r.shift(),a.unshift("..");return a.join("/")}(e,t.baseUrl)),encodeURIComponent(e)),rtp:Vw,tb:Hw};function Kw(e,t){const i={};if(null==e||"object"!=typeof e)return i;const s=Object.keys(e).sort(),a=Dg({},qw,null==t?void 0:t.formatters),r=null==t?void 0:t.filter;return s.forEach(s=>{if(null==r?void 0:r(s))return;let n=e[s];const o=a[s];o&&(n=o(n,t)),"v"===s&&1===n||"pr"==s&&1===n||function(e){return"number"==typeof e?vg(e):null!=e&&""!==e&&!1!==e}(n)&&(function(e){return"ot"===e||"sf"===e||"st"===e}(s)&&"string"==typeof n&&(n=new Rw(n)),i[s]=n)}),i}function Yw(e,t={}){return e?function(e,t){return Gw(e,t)}(Kw(e,t),Dg({whitespace:!1},t)):""}function Ww(e,t,i){return Dg(e,function(e,t={}){const i={};if(!e)return i;const s=Object.entries(e),a=Object.entries(Lw).concat(Object.entries((null==t?void 0:t.customHeaderMap)||{})),r=s.reduce((e,t)=>{var i,s;const[r,n]=t,o=(null===(i=a.find(e=>e[1].includes(r)))||void 0===i?void 0:i[0])||Ew;return null!==(s=e[o])&&void 0!==s||(e[o]={}),e[o][r]=n,e},{});return Object.entries(r).reduce((e,[i,s])=>(e[i]=Yw(s,t),e),i)}(t,i))}const Zw=/CMCD=[^&#]+/;function Qw(e,t,i){const s=function(e,t={}){if(!e)return"";const i=Yw(e,t);return`CMCD=${encodeURIComponent(i)}`}(t,i);if(!s)return e;if(Zw.test(e))return e.replace(Zw,s);const a=e.includes("?")?"&":"?";return`${e}${a}${s}`}function Xw(e,t,i,s){e&&Object.keys(t).forEach(a=>{const r=e.filter(e=>e.groupId===a).map(e=>{const r=Dg({},e);return r.details=void 0,r.attrs=new pv(r.attrs),r.url=r.attrs.URI=Jw(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",i),r.groupId=r.attrs["GROUP-ID"]=t[a],r.attrs["PATHWAY-ID"]=s,r});e.push(...r)})}function Jw(e,t,i,s){const{HOST:a,PARAMS:r,[i]:n}=s;let o;t&&(o=null==n?void 0:n[t],o&&(e=o));const d=new self.URL(e);return a&&!o&&(d.host=a),r&&Object.keys(r).sort().forEach(e=>{e&&d.searchParams.set(e,r[e])}),d.href}function ex(e,t,i){tx(e,t,i),e.addEventListener(t,i)}function tx(e,t,i){e.removeEventListener(t,i)}class ix extends Ug{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=ix.CDMCleanupPromise?[ix.CDMCleanupPromise]:[],this.onMediaEncrypted=e=>{const{initDataType:t,initData:i}=e,s=`"${e.type}" event: init data type: "${t}"`;if(this.debug(s),null!==i){if(!this.keyFormatPromise){let e=Object.keys(this.keySystemAccessPromises);e.length||(e=Ov(this.config));const t=e.map(Mv).filter(e=>!!e);this.keyFormatPromise=this.getKeyFormatPromise(t)}this.keyFormatPromise.then(a=>{const r=Cv(a);let n,o;if("sinf"===t){if(r!==Sv.FAIRPLAY)return void this.warn(`Ignoring unexpected "${e.type}" event with init data type: "${t}" for selected key-system ${r}`);const a=cf(new Uint8Array(i));try{const e=Ef(bv(JSON.parse(a).sinf));if(!e)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");n=new Uint8Array(e.subarray(8,24)),o=Sv.FAIRPLAY}catch(e){return void this.warn(`${s} Failed to parse sinf: ${e}`)}}else{if(r!==Sv.WIDEVINE&&r!==Sv.PLAYREADY)return void this.warn(`Ignoring unexpected "${e.type}" event with init data type: "${t}" for selected key-system ${r}`);const a=function(e){const t=[];if(e instanceof ArrayBuffer){const i=e.byteLength;let s=0;for(;s+32<i;){const i=If(new DataView(e,s));t.push(i),s+=i.size}}return t}(i),d=a.filter(e=>!!e.systemId&&Dv(e.systemId)===r);d.length>1&&this.warn(`${s} Using first of ${d.length} pssh found for selected key-system ${r}`);const l=d[0];if(!l)return void(0===a.length||a.some(e=>!e.systemId)?this.warn(`${s} contains incomplete or invalid pssh data`):this.log(`ignoring ${s} for ${a.map(e=>Dv(e.systemId)).join(",")} pssh data in favor of playlist keys`));if(o=Dv(l.systemId),0===l.version&&l.data)if(o===Sv.WIDEVINE){const e=l.data.length-22;n=new Uint8Array(l.data.subarray(e,e+16))}else o===Sv.PLAYREADY&&(n=Fv(l.data))}if(!o||!n)return;const d=qg(n),{keyIdToKeySessionPromise:l,mediaKeySessions:c}=this;let h=l[d];for(let e=0;e<c.length;e++){const s=c[e],a=s.decryptdata;if(!a.keyId)continue;const r=qg(a.keyId);if(d===r||-1!==a.uri.replace(/-/g,"").indexOf(d)){if(h=l[r],a.pssh)break;delete l[r],a.pssh=new Uint8Array(i),a.keyId=n,h=l[d]=h.then(()=>this.generateRequestWithPreferredKeySession(s,t,i,"encrypted-event-key-match")),h.catch(e=>this.handleError(e));break}}if(!h){if(o!==r)return void this.log(`Ignoring "${e.type}" event with ${o} init data for selected key-system ${r}`);h=l[d]=this.getKeySystemSelectionPromise([o]).then(({keySystem:e,mediaKeys:s})=>{var a;this.throwIfDestroyed();const r=new jv("ISO-23001-7",d,null!=(a=Mv(e))?a:"");return r.pssh=new Uint8Array(i),r.keyId=n,this.attemptSetMediaKeys(e,s).then(()=>{this.throwIfDestroyed();const a=this.createMediaKeySessionContext({decryptdata:r,keySystem:e,mediaKeys:s});return this.generateRequestWithPreferredKeySession(a,t,i,"encrypted-event-no-match")})}),h.catch(e=>this.handleError(e))}})}},this.onWaitingForKey=e=>{this.log(`"${e.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();const e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(kg.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(kg.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(kg.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(kg.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(kg.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(kg.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(kg.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(kg.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){const{drmSystems:t,widevineLicenseUrl:i}=this.config,s=t[e];return s?s.licenseUrl:e===Sv.WIDEVINE&&i?i:void 0}getLicenseServerUrlOrThrow(e){const t=this.getLicenseServerUrl(e);if(void 0===t)throw new Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){const{drmSystems:t}=this.config,i=t[e];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){const t=this.hls.levels,i=(e,t,i)=>!!e&&i.indexOf(e)===t,s=t.map(e=>e.audioCodec).filter(i),a=t.map(e=>e.videoCodec).filter(i);return s.length+a.length===0&&a.push("avc1.42e01e"),new Promise((t,i)=>{const r=e=>{const n=e.shift();this.getMediaKeysPromise(n,s,a).then(e=>t({keySystem:n,mediaKeys:e})).catch(t=>{e.length?r(e):i(t instanceof sx?t:new sx({type:wg.KEY_SYSTEM_ERROR,details:xg.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))})};r(e)})}requestMediaKeySystemAccess(e,t){const{requestMediaKeySystemAccessFunc:i}=this.config;if("function"!=typeof i){let e=`Configured requestMediaKeySystemAccess is not a function ${i}`;return null===Uv&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(new Error(e))}return i(e,t)}getMediaKeysPromise(e,t,i){const s=function(e,t,i,s){let a;switch(e){case Sv.FAIRPLAY:a=["cenc","sinf"];break;case Sv.WIDEVINE:case Sv.PLAYREADY:a=["cenc"];break;case Sv.CLEARKEY:a=["cenc","keyids"];break;default:throw new Error(`Unknown key-system: ${e}`)}return function(e,t,i,s){return[{initDataTypes:e,persistentState:s.persistentState||"optional",distinctiveIdentifier:s.distinctiveIdentifier||"optional",sessionTypes:s.sessionTypes||[s.sessionType||"temporary"],audioCapabilities:t.map(e=>({contentType:`audio/mp4; codecs=${e}`,robustness:s.audioRobustness||"",encryptionScheme:s.audioEncryptionScheme||null})),videoCapabilities:i.map(e=>({contentType:`video/mp4; codecs=${e}`,robustness:s.videoRobustness||"",encryptionScheme:s.videoEncryptionScheme||null}))}]}(a,t,i,s)}(e,t,i,this.config.drmSystemOptions),a=this.keySystemAccessPromises[e];let r=null==a?void 0:a.keySystemAccess;if(!r){this.log(`Requesting encrypted media "${e}" key-system access with config: ${lm(s)}`),r=this.requestMediaKeySystemAccess(e,s);const t=this.keySystemAccessPromises[e]={keySystemAccess:r};return r.catch(t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)}),r.then(i=>{this.log(`Access for key-system "${i.keySystem}" obtained`);const s=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=i.createMediaKeys().then(i=>(this.log(`Media-keys created for "${e}"`),t.hasMediaKeys=!0,s.then(t=>t?this.setMediaKeysServerCertificate(i,e,t):i))),t.mediaKeys.catch(t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)}),t.mediaKeys})}return r.then(()=>a.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:i}){this.log(`Creating key-system session "${t}" keyId: ${qg(e.keyId||[])}`);const s=i.createSession(),a={decryptdata:e,keySystem:t,mediaKeys:i,mediaKeysSession:s,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}renewKeySession(e){const t=e.decryptdata;if(t.pssh){const i=this.createMediaKeySessionContext(e),s=this.getKeyIdString(t),a="cenc";this.keyIdToKeySessionPromise[s]=this.generateRequestWithPreferredKeySession(i,a,t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return qg(e.keyId)}updateKeySession(e,t){var i;const s=e.mediaKeysSession;return this.log(`Updating key-session "${s.sessionId}" for keyID ${qg((null==(i=e.decryptdata)?void 0:i.keyId)||[])}\n      } (data length: ${t?t.byteLength:t})`),s.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Mv(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:e,mediaKeys:t})=>this.attemptSetMediaKeys(e,t))}selectKeySystem(e){return new Promise((t,i)=>this.getKeySystemSelectionPromise(e).then(({keySystem:e})=>{const s=Mv(e);s?t(s):i(new Error(`Unable to find format for key-system "${e}"`))}).catch(i))}selectKeySystemFormat(e){const t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){const t=Ov(this.config),i=e.map(Cv).filter(e=>!!e&&-1!==t.indexOf(e));return this.selectKeySystem(i)}loadKey(e){const t=e.keyInfo.decryptdata,i=this.getKeyIdString(t),s=`(keyId: ${i} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${s}`);let a=this.keyIdToKeySessionPromise[i];if(!a){a=this.getKeySystemForKeyPromise(t).then(({keySystem:i,mediaKeys:a})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${s}`),this.attemptSetMediaKeys(i,a).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:i,mediaKeys:a,decryptdata:t})))));(this.keyIdToKeySessionPromise[i]=a.then(e=>{const i=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(e,"cenc",i,"playlist-key")})).catch(e=>this.handleError(e))}return a}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw new Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof sx?this.hls.trigger(kg.ERROR,e.data):this.hls.trigger(kg.ERROR,{type:wg.KEY_SYSTEM_ERROR,details:xg.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){const t=this.getKeyIdString(e),i=this.keyIdToKeySessionPromise[t];if(!i){const t=Cv(e.keyFormat),i=t?[t]:Ov(this.config);return this.attemptKeySystemAccess(i)}return i}getKeySystemSelectionPromise(e){if(e.length||(e=Ov(this.config)),0===e.length)throw new sx({type:wg.KEY_SYSTEM_ERROR,details:xg.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${lm({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();const i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);const s=Promise.all(i).then(()=>{if(!this.media)throw this.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(s),s.then(()=>{this.log(`Media-keys set for "${e}"`),i.push(s),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(e=>-1===i.indexOf(e))})}generateRequestWithPreferredKeySession(e,t,i,s){var a,r;const n=null==(a=this.config.drmSystems)||null==(r=a[e.keySystem])?void 0:r.generateRequest;if(n)try{const s=n.call(this.hls,t,i,e);if(!s)throw new Error("Invalid response from configured generateRequest filter");t=s.initDataType,i=s.initData?s.initData:null,e.decryptdata.pssh=i?new Uint8Array(i):null}catch(e){var o;if(this.warn(e.message),null!=(o=this.hls)&&o.config.debug)throw e}if(null===i)return this.log(`Skipping key-session request for "${s}" (no initData)`),Promise.resolve(e);const d=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${s}": ${d} (init data type: ${t} length: ${i?i.byteLength:null})`);const l=new Ny,c=e._onmessage=t=>{const i=e.mediaKeysSession;if(!i)return void l.emit("error",new Error("invalid state"));const{messageType:s,message:a}=t;this.log(`"${s}" message event for session "${i.sessionId}" message size: ${a.byteLength}`),"license-request"===s||"license-renewal"===s?this.renewLicense(e,a).catch(e=>{l.eventNames().length?l.emit("error",e):this.handleError(e)}):"license-release"===s?e.keySystem===Sv.FAIRPLAY&&(this.updateKeySession(e,wv("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${s}"`)},h=e._onkeystatuseschange=t=>{if(!e.mediaKeysSession)return void l.emit("error",new Error("invalid state"));this.onKeyStatusChange(e);const i=e.keyStatus;l.emit("keyStatus",i),"expired"===i&&(this.warn(`${e.keySystem} expired for key ${d}`),this.renewKeySession(e))};ex(e.mediaKeysSession,"message",c),ex(e.mediaKeysSession,"keystatuseschange",h);const p=new Promise((e,t)=>{l.on("error",t),l.on("keyStatus",i=>{i.startsWith("usable")?e():"output-restricted"===i?t(new sx({type:wg.KEY_SYSTEM_ERROR,details:xg.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===i?t(new sx({type:wg.KEY_SYSTEM_ERROR,details:xg.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${i}"`)):"expired"===i?t(new Error("key expired while generating request")):this.warn(`unhandled key status change "${i}"`)})});return e.mediaKeysSession.generateRequest(t,i).then(()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${d}`)}).catch(e=>{throw new sx({type:wg.KEY_SYSTEM_ERROR,details:xg.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)}).then(()=>p).catch(t=>{throw l.removeAllListeners(),this.removeSession(e),t}).then(()=>(l.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,i)=>{if("string"==typeof i&&"object"==typeof t){const e=i;i=t,t=e}this.log(`key status change "${t}" for keyStatuses keyId: ${qg("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))} session keyId: ${qg(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){const t=this.config,i=new(0,t.loader)(t),s=this.getServerCertificateUrl(e);return s?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,r)=>{const n={responseType:"arraybuffer",url:s},o=t.certLoadPolicy.default,d={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},l={onSuccess:(e,t,i,s)=>{a(e.data)},onError:(t,i,a,o)=>{r(new sx({type:wg.KEY_SYSTEM_ERROR,details:xg.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:Og({url:n.url,data:void 0},t)},`"${e}" certificate request failed (${s}). Status: ${t.code} (${t.text})`))},onTimeout:(t,i,a)=>{r(new sx({type:wg.KEY_SYSTEM_ERROR,details:xg.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:a,response:{url:n.url,data:void 0}},`"${e}" certificate request timed out (${s})`))},onAbort:(e,t,i)=>{r(new Error("aborted"))}};i.load(n,d,l)})):Promise.resolve()}setMediaKeysServerCertificate(e,t,i){return new Promise((s,a)=>{e.setServerCertificate(i).then(a=>{this.log(`setServerCertificate ${a?"success":"not supported by CDM"} (${null==i?void 0:i.byteLength}) on "${t}"`),s(e)}).catch(e=>{a(new sx({type:wg.KEY_SYSTEM_ERROR,details:xg.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(t=>this.updateKeySession(e,new Uint8Array(t)).catch(e=>{throw new sx({type:wg.KEY_SYSTEM_ERROR,details:xg.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))}unpackPlayReadyKeyMessage(e,t){const i=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!i.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;const s=(new DOMParser).parseFromString(i,"application/xml"),a=s.querySelectorAll("HttpHeader");if(a.length>0){let t;for(let i=0,s=a.length;i<s;i++){var r,n;t=a[i];const s=null==(r=t.querySelector("name"))?void 0:r.textContent,o=null==(n=t.querySelector("value"))?void 0:n.textContent;s&&o&&e.setRequestHeader(s,o)}}const o=s.querySelector("Challenge"),d=null==o?void 0:o.textContent;if(!d)throw new Error("Cannot find <Challenge> in key message");return wv(atob(d))}setupLicenseXHR(e,t,i,s){const a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(!i.decryptdata)throw new Error("Key removed");return a.call(this.hls,e,t,i,s)}).catch(r=>{if(!i.decryptdata)throw r;return e.open("POST",t,!0),a.call(this.hls,e,t,i,s)}).then(i=>{e.readyState||e.open("POST",t,!0);return{xhr:e,licenseChallenge:i||s}}):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:s}))}requestLicense(e,t){const i=this.config.keyLoadPolicy.default;return new Promise((s,a)=>{const r=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${r}`);const n=new XMLHttpRequest;n.responseType="arraybuffer",n.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return a(new Error("invalid state"));if(4===n.readyState)if(200===n.status){this._requestLicenseFailureCount=0;let t=n.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);const i=this.config.licenseResponseCallback;if(i)try{t=i.call(this.hls,n,r,e)}catch(e){this.error(e)}s(t)}else{const o=i.errorRetry,d=o?o.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>d||n.status>=400&&n.status<500)a(new sx({type:wg.KEY_SYSTEM_ERROR,details:xg.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:n,response:{url:r,data:void 0,code:n.status,text:n.statusText}},`License Request XHR failed (${r}). Status: ${n.status} (${n.statusText})`));else{const i=d-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${i} attempts left`),this.requestLicense(e,t).then(s,a)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=n,this.setupLicenseXHR(n,r,e,t).then(({xhr:t,licenseChallenge:i})=>{e.keySystem==Sv.PLAYREADY&&(i=this.unpackPlayReadyKeyMessage(t,i)),t.send(i)})})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;const i=t.media;this.media=i,ex(i,"encrypted",this.onMediaEncrypted),ex(i,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){const e=this.media;e&&(tx(e,"encrypted",this.onMediaEncrypted),tx(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},!this.mediaKeys&&!this.mediaKeySessions.length)return;const t=this.media,i=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,jv.clearKeyUriToKeyIdMap();const s=i.length;ix.CDMCleanupPromise=Promise.all(i.map(e=>this.removeSession(e)).concat(null==t||null==(e=t.setMediaKeys(null))?void 0:e.catch(e=>{var t;this.log(`Could not clear media keys: ${e}`),null==(t=this.hls)||t.trigger(kg.ERROR,{type:wg.OTHER_ERROR,details:xg.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error(`Could not clear media keys: ${e}`)})}))).catch(e=>{var t;this.log(`Could not close sessions and clear media keys: ${e}`),null==(t=this.hls)||t.trigger(kg.ERROR,{type:wg.OTHER_ERROR,details:xg.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close sessions and clear media keys: ${e}`)})}).then(()=>{s&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){const e=t.reduce((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e),[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){const{mediaKeysSession:t,licenseXhr:i}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;const s=this.mediaKeySessions.indexOf(e);s>-1&&this.mediaKeySessions.splice(s,1);const{drmSystemOptions:a}=this.config,r=function(e){var t;return"persistent-license"===e.sessionType||!(null==(t=e.sessionTypes)||!t.some(e=>"persistent-license"===e))}(a)?new Promise((e,i)=>{self.setTimeout(()=>i(new Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(e)}):Promise.resolve();return r.catch(e=>{var t;this.log(`Could not remove session: ${e}`),null==(t=this.hls)||t.trigger(kg.ERROR,{type:wg.OTHER_ERROR,details:xg.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error(`Could not remove session: ${e}`)})}).then(()=>t.close()).catch(e=>{var t;this.log(`Could not close session: ${e}`),null==(t=this.hls)||t.trigger(kg.ERROR,{type:wg.OTHER_ERROR,details:xg.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error(`Could not close session: ${e}`)})})}}}ix.CDMCleanupPromise=void 0;class sx extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=new Error(t)),this.data=e,e.err=e.error}}function ax(e,t){let i;try{i=new Event("addtrack")}catch(e){i=document.createEvent("Event"),i.initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)}function rx(e,t){const i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error(`addCue is failed for: ${t}`)}catch(i){Bg.debug(`[texttrack-utils]: ${i}`);try{const i=new self.TextTrackCue(t.startTime,t.endTime,t.text);i.id=t.id,e.addCue(i)}catch(e){Bg.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${e}`)}}"disabled"===i&&(e.mode=i)}function nx(e,t){const i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues)for(let i=e.cues.length;i--;)t&&e.cues[i].removeEventListener("enter",t),e.removeCue(e.cues[i]);"disabled"===i&&(e.mode=i)}function ox(e,t,i,s){const a=e.mode;if("disabled"===a&&(e.mode="hidden"),e.cues&&e.cues.length>0){const a=function(e,t,i){const s=[],a=function(e,t){if(t<=e[0].startTime)return 0;const i=e.length-1;if(t>e[i].endTime)return-1;let s,a=0,r=i;for(;a<=r;)if(s=Math.floor((r+a)/2),t<e[s].startTime)r=s-1;else{if(!(t>e[s].startTime&&a<i))return s;a=s+1}return e[a].startTime-t<t-e[r].startTime?a:r}(e,t);if(a>-1)for(let r=a,n=e.length;r<n;r++){const a=e[r];if(a.startTime>=t&&a.endTime<=i)s.push(a);else if(a.startTime>i)return s}return s}(e.cues,t,i);for(let t=0;t<a.length;t++)s&&!s(a[t])||e.removeCue(a[t])}"disabled"===a&&(e.mode=a)}function dx(e){const t=[];for(let i=0;i<e.length;i++){const s=e[i];"subtitles"!==s.kind&&"captions"!==s.kind||!s.label||t.push(e[i])}return t}function lx(e){let t=5381,i=e.length;for(;i;)t=33*t^e.charCodeAt(--i);return(t>>>0).toString()}const cx=.025;let hx=function(e){return e[e.Point=0]="Point",e[e.Range=1]="Range",e}({});function px(e,t,i){return`${e.identifier}-${i+1}-${lx(t)}`}class ux{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,null==(e=this.assetListLoader)||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;const i=this.playoutLimit;if(e<=0||isNaN(i))return!1;if(0===i)return!0;return((null==(t=this.assetList[e])?void 0:t.startOffset)||0)>i}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){const e=this.dateRange.startTime;if(this.snapOptions.out){const t=this.dateRange.tagAnchor;if(t)return gx(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(0===this.startTime||this.snapOptions.out)return!0;const e=this.dateRange.tagAnchor;if(e){const t=this.dateRange.startTime;return t-gx(t,e)<.1}return!1}get resumptionOffset(){const e=this.resumeOffset,t=vg(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){const e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){const t=this.resumeAnchor;if(t)return gx(e,t)}return e}get appendInPlace(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<cx))}set appendInPlace(e){this.appendInPlaceStarted?this.resetOnResume=!e:this.appendInPlaceDisabled=!e}get timelineStart(){return null!==this._timelineStart?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){const e=this.playoutLimit;let t;return t=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(e)&&e<t&&(t=e),t}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?hx.Range:hx.Point}get supplementsPrimary(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}get contentMayVary(){return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||null!==this.assetListResponse}toString(){return`["${(e=this).identifier}" ${e.cue.pre?"<pre>":e.cue.post?"<post>":""}${e.timelineStart.toFixed(2)}-${e.resumeTime.toFixed(2)}]`;var e}}function gx(e,t){return e-t.start<t.duration/2&&!(Math.abs(e-(t.start+t.duration))<cx)?t.start:t.start+t.duration}function fx(e,t,i){const s=new self.URL(e,i);return"data:"!==s.protocol&&s.searchParams.set("_HLS_primary_id",t),s}function mx(e,t){for(;null!=(i=e.assetList[++t])&&i.error;)var i;return t}function vx(e){const t=e.timelineStart,i=e.duration||0;return`["${e.identifier}" ${t.toFixed(2)}-${(t+i).toFixed(2)}]`}class yx{constructor(e,t,i,s){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls.trigger(kg.PLAYOUT_LIMIT_REACHED,{})};const a=this.hls=new e(t);this.interstitial=i,this.assetItem=s;let r=s.uri;try{r=fx(r,t.primarySessionId).href}catch(e){}a.loadSource(r);const n=()=>{this.hasDetails=!0};a.once(kg.LEVEL_LOADED,n),a.once(kg.AUDIO_TRACK_LOADED,n),a.once(kg.SUBTITLE_TRACK_LOADED,n),a.on(kg.MEDIA_ATTACHING,(e,{media:t})=>{this.removeMediaListeners(),this.mediaAttached=t;this.interstitial.playoutLimit&&(t.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&a.on(kg.BUFFER_APPENDED,()=>{const e=this.bufferedEnd;this.reachedPlayout(e)&&(this._bufferedEosTime=e,a.trigger(kg.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){var e;return(null==(e=this.interstitial)?void 0:e.appendInPlace)||!1}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if(null!=(t=this.hls)&&t.bufferedToEnd)return!0;if(!e||!this._bufferedEosTime)return!1;const i=this.timelineOffset,s=av.bufferInfo(e,i,0);return this.getAssetTime(s.end)>=this._bufferedEosTime-.02}reachedPlayout(e){const t=this.interstitial.playoutLimit;return this.startOffset+e>=t}get destroyed(){var e;return!(null!=(e=this.hls)&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return(null==(e=this.hls)?void 0:e.media)||null}get bufferedEnd(){const e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;const t=av.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){const e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){const e=this.assetItem.duration;return e||0}get remaining(){const e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return(null==(e=this.hls)?void 0:e.config.timelineOffset)||0}set timelineOffset(e){const t=this.timelineOffset;if(e!==t){const i=e-t;if(Math.abs(i)>1/9e4){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}getAssetTime(e){const t=this.timelineOffset,i=this.duration;return Math.min(Math.max(0,e-t),i)}removeMediaListeners(){const e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){var e;this.mediaAttached&&(null!=(e=this.hls)&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd))}destroy(){this.removeMediaListeners(),this.hls.destroy(),this.hls=this.interstitial=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){this.hls.attachMedia(e)}detachMedia(){this.removeMediaListeners(),this.mediaAttached=null,this.hls.detachMedia()}resumeBuffering(){this.hls.resumeBuffering()}pauseBuffering(){this.hls.pauseBuffering()}transferMedia(){return this.bufferSnapShot(),this.hls.transferMedia()}resetDetails(){const e=this.hls;if(this.hasDetails){e.stopLoad();const t=e=>delete e.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,i){this.hls.on(e,t)}once(e,t,i){this.hls.once(e,t)}off(e,t,i){this.hls.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${vx(this.assetItem)} ${null==(e=this.hls)?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}class bx extends Ug{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((i,s)=>e<=s.startOffset&&t>s.startOffset?(delete s.error,i+1):i,0):0}get duration(){const e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let i=-1;e.nextEvent?i=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(i=this.findEventIndex(e.previousEvent.identifier)+1);const s=this.items;if(s)for(s[i]||(void 0===t&&(t=e.start),i=this.findItemIndexAtTime(t));i>=0&&null!=(a=s[i])&&a.event;){var a;i--}return i}findItemIndexAtTime(e,t){const i=this.items;if(i)for(let s=0;s<i.length;s++){let a=i[s];if(t&&"primary"!==t&&(a=a[t]),e===a.start||e>a.start&&e<a.end)return s}return-1}findJumpRestrictedIndex(e,t){const i=this.items;if(i)for(let s=e;s<=t&&i[s];s++){const e=i[s].event;if(null!=e&&e.restrictions.jump&&!e.appendInPlace)return s}return-1}findEventIndex(e){const t=this.items;if(t)for(let s=t.length;s--;){var i;if((null==(i=t[s].event)?void 0:i.identifier)===e)return s}return-1}findAssetIndex(e,t){const i=e.assetList,s=i.length;if(s>1)for(let e=0;e<s;e++){const s=i[e];if(!s.error){const i=s.timelineStart;if(t===i||t>i&&t<i+(s.duration||0))return e}}return 0}get assetIdAtEnd(){var e,t;const i=null==(e=this.items)||null==(t=e[this.length-1])?void 0:t.event;if(i){const e=i.assetList,t=e[e.length-1];if(t)return t.identifier}return null}parseInterstitialDateRanges(e,t){const i=e.main.details,{dateRanges:s}=i,a=this.events,r=this.parseDateRanges(s,{url:i.url},t),n=Object.keys(s),o=a?a.filter(e=>!n.includes(e.identifier)):[];r.length&&r.sort((e,t)=>{const i=e.cue.pre,s=e.cue.post,a=t.cue.pre,r=t.cue.post;if(i&&!a)return-1;if(a&&!i)return 1;if(s&&!r)return 1;if(r&&!s)return-1;if(!(i||a||s||r)){const i=e.startTime,s=t.startTime;if(i!==s)return i-s}return e.dateRange.tagOrder-t.dateRange.tagOrder}),this.events=r,o.forEach(e=>{this.removeEvent(e)}),this.updateSchedule(e,o)}updateSchedule(e,t=[]){const i=this.events||[];if(i.length||t.length||this.length<2){const s=this.items,a=this.parseSchedule(i,e);(t.length||(null==s?void 0:s.length)!==a.length||a.some((e,t)=>Math.abs(e.playout.start-s[t].playout.start)>.005||Math.abs(e.playout.end-s[t].playout.end)>.005))&&(this.items=a,this.onScheduleUpdate(t,s))}}parseDateRanges(e,t,i){const s=[],a=Object.keys(e);for(let r=0;r<a.length;r++){const n=a[r],o=e[n];if(o.isInterstitial){let e=this.eventMap[n];e?e.setDateRange(o):(e=new ux(o,t),this.eventMap[n]=e,!1===i&&(e.appendInPlace=i)),s.push(e)}}return s}parseSchedule(e,t){const i=[],s=t.main.details,a=s.live?1/0:s.edge;let r=0;if((e=e.filter(e=>!(e.error||e.cue.once&&e.hasPlayed))).length){this.resolveOffsets(e,t);let s=0,o=0;if(e.forEach((t,n)=>{const d=t.cue.pre,l=t.cue.post,c=e[n-1]||null,h=t.appendInPlace,p=l?a:t.startOffset,u=t.duration,g=t.timelineOccupancy===hx.Range?u:0,f=t.resumptionOffset,m=(null==c?void 0:c.startTime)===p,v=p+t.cumulativeDuration;let y=h?v+u:p+f;if(d||!l&&p<=0){const e=o;o+=g,t.timelineStart=v;const s=r;r+=u,i.push({event:t,start:v,end:y,playout:{start:s,end:r},integrated:{start:e,end:o}})}else{if(!(p<=a))return;{if(!m){const a=p-s;if(a>.033){const d=s,l=o;o+=a;const c=r;r+=a;const h={previousEvent:e[n-1]||null,nextEvent:t,start:d,end:d+a,playout:{start:c,end:r},integrated:{start:l,end:o}};i.push(h)}else a>0&&c&&(c.cumulativeDuration+=a,i[i.length-1].end=p)}l&&(y=v),t.timelineStart=v;const a=o;o+=g;const d=r;r+=u,i.push({event:t,start:v,end:y,playout:{start:d,end:r},integrated:{start:a,end:o}})}}const b=t.resumeTime;s=l||b>a?a:b}),s<a){var n;const e=s,t=o,d=a-s;o+=d;const l=r;r+=d,i.push({previousEvent:(null==(n=i[i.length-1])?void 0:n.event)||null,nextEvent:null,start:s,end:e+d,playout:{start:l,end:r},integrated:{start:t,end:o}})}this.setDurations(a,r,o)}else{const e=0;i.push({previousEvent:null,nextEvent:null,start:e,end:a,playout:{start:e,end:a},integrated:{start:e,end:a}}),this.setDurations(a,a,a)}return i}setDurations(e,t,i){this.durations={primary:e,playout:t,integrated:i}}resolveOffsets(e,t){const i=t.main.details,s=i.live?1/0:i.edge;let a=0,r=-1;e.forEach((n,o)=>{const d=n.cue.pre,l=n.cue.post,c=d?0:l?s:n.startTime;this.updateAssetDurations(n);if(r===c?n.cumulativeDuration=a:(a=0,r=c),!l&&n.snapOptions.in&&(n.resumeAnchor=bm(null,i.fragments,n.startOffset+n.resumptionOffset,0,0)||void 0),n.appendInPlace&&!n.appendInPlaceStarted){this.primaryCanResumeInPlaceAt(n,t)||(n.appendInPlace=!1)}if(!n.appendInPlace&&o+1<e.length){e[o+1].startTime-e[o].resumeTime<.033&&(e[o+1].appendInPlace=!1,e[o+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${n}`))}const h=vg(n.resumeOffset)?n.resumeOffset:n.duration;a+=h})}primaryCanResumeInPlaceAt(e,t){const i=e.resumeTime,s=e.startTime+e.resumptionOffset;if(Math.abs(i-s)>cx)return this.log(`"${e.identifier}" resumption ${i} not aligned with estimated timeline end ${s}`),!1;if(!t)return this.log(`"${e.identifier}" resumption ${i} can not be aligned with media (none selected)`),!1;return!Object.keys(t).some(s=>{const a=t[s].details,r=a.edge;if(i>=r)return this.log(`"${e.identifier}" resumption ${i} past ${s} playlist end ${r}`),!1;const n=bm(null,a.fragments,i);if(!n)return this.log(`"${e.identifier}" resumption ${i} does not align with any fragments in ${s} playlist (${a.fragStart}-${a.fragmentEnd})`),!0;const o="audio"===s?.175:0;return!(Math.abs(n.start-i)<cx+o||Math.abs(n.end-i)<cx+o)&&(this.log(`"${e.identifier}" resumption ${i} not aligned with ${s} fragment bounds (${n.start}-${n.end} sn: ${n.sn} cc: ${n.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;const t=e.timelineStart;let i=0,s=!1,a=!1;e.assetList.forEach((e,r)=>{const n=t+i;e.startOffset=i,e.timelineStart=n,s||(s=null===e.duration),a||(a=!!e.error);const o=e.error?0:e.duration||0;i+=o}),e.duration=s&&!a?Math.max(i,e.duration):i}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function wx(e){return`[${e.event?'"'+e.event.identifier+'"':"primary"}: ${e.start.toFixed(2)}-${e.end.toFixed(2)}]`}class xx{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){const i=e.assetListUrl;let s;try{s=fx(i,this.hls.sessionId,e.baseUrl)}catch(t){const s=this.assignAssetListError(e,xg.ASSET_LIST_LOAD_ERROR,t,i);return void this.hls.trigger(kg.ERROR,s)}t&&"data:"!==s.protocol&&s.searchParams.set("_HLS_start_offset",""+t);const a=this.hls.config,r=new(0,a.loader)(a),n={responseType:"json",url:s.href},o=a.interstitialAssetListLoadPolicy.default,d={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},l={onSuccess:(t,i,s,a)=>{const r=t.data,n=null==r?void 0:r.ASSETS;if(!Array.isArray(n)){const t=this.assignAssetListError(e,xg.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),s.url,i,a);return void this.hls.trigger(kg.ERROR,t)}e.assetListResponse=r,this.hls.trigger(kg.ASSET_LIST_LOADED,{event:e,assetListResponse:r,networkDetails:a})},onError:(t,i,s,a)=>{const r=this.assignAssetListError(e,xg.ASSET_LIST_LOAD_ERROR,new Error(`Error loading X-ASSET-LIST: HTTP status ${t.code} ${t.text} (${i.url})`),i.url,a,s);this.hls.trigger(kg.ERROR,r)},onTimeout:(t,i,s)=>{const a=this.assignAssetListError(e,xg.ASSET_LIST_LOAD_TIMEOUT,new Error(`Timeout loading X-ASSET-LIST (${i.url})`),i.url,t,s);this.hls.trigger(kg.ERROR,a)}};return r.load(n,d,l),this.hls.trigger(kg.ASSET_LIST_LOADING,{event:e}),r}assignAssetListError(e,t,i,s,a,r){return e.error=i,{type:wg.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:s,error:i,networkDetails:r,stats:a}}}function kx(e){null==e||e.play().catch(()=>{})}class Sx{constructor(e){this.buffered=void 0;const t=(t,i,s)=>{if((i>>>=0)>s-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${s})`);return e[i][t]};this.buffered={get length(){return e.length},end:i=>t("end",i,e.length),start:i=>t("start",i,e.length)}}}const Ex={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},Px=e=>String.fromCharCode(Ex[e]||e),Tx=15,Lx=100,Cx={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},_x={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Ax={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Rx={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Ix=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class Dx{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){const i="function"==typeof t?t():t;Bg.log(`${this.time} [${e}] ${i}`)}}}const Mx=function(e){const t=[];for(let i=0;i<e.length;i++)t.push(e[i].toString(16));return t};class Ox{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){const t=["foreground","underline","italics","background","flash"];for(let i=0;i<t.length;i++){const s=t[i];e.hasOwnProperty(s)&&(this[s]=e[s])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Ux{constructor(){this.uchar=" ",this.penState=new Ox}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class $x{constructor(e){this.chars=[],this.pos=0,this.currPenState=new Ox,this.cueStartTime=null,this.logger=void 0;for(let e=0;e<Lx;e++)this.chars.push(new Ux);this.logger=e}equals(e){for(let t=0;t<Lx;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<Lx;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<Lx;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Lx&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Lx)}moveCursor(e){const t=this.pos+e;if(e>1)for(let e=this.pos+1;e<t+1;e++)this.chars[e].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();const t=Px(e);this.pos>=Lx?this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))}clearFromPos(e){let t;for(t=e;t<Lx;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){const e=[];let t=!0;for(let i=0;i<Lx;i++){const s=this.chars[i].uchar;" "!==s&&(t=!1),e.push(s)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e);this.chars[this.pos].setPenState(this.currPenState)}}class Fx{constructor(e){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<Tx;t++)this.rows.push(new $x(e));this.logger=e}reset(){for(let e=0;e<Tx;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let i=0;i<Tx;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}copy(e){for(let t=0;t<Tx;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<Tx;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e);this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+lm(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let e=0;e<Tx;e++)this.rows[e].clear();const e=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){const s=i.rows[e].cueStartTime,a=this.logger.time;if(null!==s&&null!==a&&s<a)for(let s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(i.rows[e+s])}}this.currRow=t;const i=this.rows[this.currRow];if(null!==e.indent){const t=e.indent,s=Math.max(t-1,0);i.setCursor(e.indent),e.color=i.chars[s].penState.foreground}const s={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(s)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+lm(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows)return void this.logger.log(3,"roll_up but nrRollUpRows not set yet");this.logger.log(1,()=>this.getDisplayText());const e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;const t=[];let i="",s=-1;for(let i=0;i<Tx;i++){const a=this.rows[i].getTextString();a&&(s=i+1,e?t.push("Row "+s+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i}getTextAndFormat(){return this.rows}}class Nx{constructor(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Fx(i),this.nonDisplayedMemory=new Fx(i),this.lastOutputScreen=new Fx(i),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);const t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){const e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){const t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{const i=Math.floor(e/2)-16,s=["white","green","blue","cyan","red","yellow","magenta"];t.foreground=s[i]}this.logger.log(2,"MIDROW: "+lm(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){const t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}class jx{constructor(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;const s=this.logger=new Dx;this.channels=[null,new Nx(e,t,s),new Nx(e+1,i,s)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let e=0;e<t.length;e+=2){const i=127&t[e],s=127&t[e+1];let a=!1,r=null;if(0===i&&0===s)continue;this.logger.log(3,()=>"["+Mx([t[e],t[e+1]])+"] -> ("+Mx([i,s])+")");const n=this.cmdHistory;if(i>=16&&i<=31){if(Bx(i,s,n)){zx(null,null,n),this.logger.log(3,()=>"Repeated command ("+Mx([i,s])+") is dropped");continue}zx(i,s,this.cmdHistory),a=this.parseCmd(i,s),a||(a=this.parseMidrow(i,s)),a||(a=this.parsePAC(i,s)),a||(a=this.parseBackgroundAttributes(i,s))}else zx(null,null,n);if(!a&&(r=this.parseChars(i,s),r)){const e=this.currentChannel;if(e&&e>0){this.channels[e].insertChars(r)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}a||r||this.logger.log(2,()=>"Couldn't parse cleaned data "+Mx([i,s])+" orig: "+Mx([t[e],t[e+1]]))}}parseCmd(e,t){if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;const i=20===e||21===e||23===e?1:2,s=this.channels[i];return 20===e||21===e||28===e||29===e?32===t?s.ccRCL():33===t?s.ccBS():34===t?s.ccAOF():35===t?s.ccAON():36===t?s.ccDER():37===t?s.ccRU(2):38===t?s.ccRU(3):39===t?s.ccRU(4):40===t?s.ccFON():41===t?s.ccRDC():42===t?s.ccTR():43===t?s.ccRTD():44===t?s.ccEDM():45===t?s.ccCR():46===t?s.ccENM():47===t&&s.ccEOC():s.ccTO(t-32),this.currentChannel=i,!0}parseMidrow(e,t){let i=0;if((17===e||25===e)&&t>=32&&t<=47){if(i=17===e?1:2,i!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;const s=this.channels[i];return!!s&&(s.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+Mx([e,t])+")"),!0)}return!1}parsePAC(e,t){let i;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;const s=e<=23?1:2;i=t>=64&&t<=95?1===s?Cx[e]:Ax[e]:1===s?_x[e]:Rx[e];const a=this.channels[s];return!!a&&(a.setPAC(this.interpretPAC(i,t)),this.currentChannel=s,!0)}interpretPAC(e,t){let i;const s={color:null,italics:!1,indent:null,underline:!1,row:e};return i=t>95?t-96:t-64,s.underline=!(1&~i),i<=13?s.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(s.italics=!0,s.color="white"):s.indent=4*Math.floor((i-16)/2),s}parseChars(e,t){let i,s=null,a=null;if(e>=25?(i=2,a=e-8):(i=1,a=e),a>=17&&a<=19){let e;e=17===a?t+80:18===a?t+112:t+144,this.logger.log(2,()=>"Special char '"+Px(e)+"' in channel "+i),s=[e]}else e>=32&&e<=127&&(s=0===t?[e]:[e,t]);return s&&this.logger.log(3,()=>"Char codes =  "+Mx(s).join(",")),s}parseBackgroundAttributes(e,t){if(!((16===e||24===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=45&&t<=47))return!1;let i;const s={};16===e||24===e?(i=Math.floor((t-32)/2),s.background=Ix[i],t%2==1&&(s.background=s.background+"_semi")):45===t?s.background="transparent":(s.foreground="black",47===t&&(s.underline=!0));const a=e<=23?1:2;return this.channels[a].setBkgData(s),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){const t=this.channels[e];t&&t.reset()}zx(null,null,this.cmdHistory)}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){const i=this.channels[t];i&&i.cueSplitAtTime(e)}}}function zx(e,t,i){i.a=e,i.b=t}function Bx(e,t,i){return i.a===e&&i.b===t}var Gx=function(){if(null!=kv&&kv.VTTCue)return self.VTTCue;const e=["","lr","rl"],t=["start","middle","end","left","right"];function i(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;const i=t.toLowerCase();return!!~e.indexOf(i)&&i}function s(e){return i(t,e)}function a(e,...t){let i=1;for(;i<arguments.length;i++){const t=arguments[i];for(const i in t)e[i]=t[i]}return e}function r(t,r,n){const o=this,d={enumerable:!0};o.hasBeenReset=!1;let l="",c=!1,h=t,p=r,u=n,g=null,f="",m=!0,v="auto",y="start",b=50,w="middle",x=50,k="middle";Object.defineProperty(o,"id",a({},d,{get:function(){return l},set:function(e){l=""+e}})),Object.defineProperty(o,"pauseOnExit",a({},d,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(o,"startTime",a({},d,{get:function(){return h},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");h=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"endTime",a({},d,{get:function(){return p},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");p=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"text",a({},d,{get:function(){return u},set:function(e){u=""+e,this.hasBeenReset=!0}})),Object.defineProperty(o,"region",a({},d,{get:function(){return g},set:function(e){g=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"vertical",a({},d,{get:function(){return f},set:function(t){const s=function(t){return i(e,t)}(t);if(!1===s)throw new SyntaxError("An invalid or illegal string was specified.");f=s,this.hasBeenReset=!0}})),Object.defineProperty(o,"snapToLines",a({},d,{get:function(){return m},set:function(e){m=!!e,this.hasBeenReset=!0}})),Object.defineProperty(o,"line",a({},d,{get:function(){return v},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");v=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"lineAlign",a({},d,{get:function(){return y},set:function(e){const t=s(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");y=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"position",a({},d,{get:function(){return b},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");b=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"positionAlign",a({},d,{get:function(){return w},set:function(e){const t=s(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");w=t,this.hasBeenReset=!0}})),Object.defineProperty(o,"size",a({},d,{get:function(){return x},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");x=e,this.hasBeenReset=!0}})),Object.defineProperty(o,"align",a({},d,{get:function(){return k},set:function(e){const t=s(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");k=t,this.hasBeenReset=!0}})),o.displayState=void 0}return r.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},r}();class Hx{decode(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function Vx(e){function t(e,t,i,s){return 3600*(0|e)+60*(0|t)+(0|i)+parseFloat(s||0)}const i=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return i?parseFloat(i[2])>59?t(i[2],i[3],0,i[4]):t(i[1],i[2],i[3],i[4]):null}class qx{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,i){for(let s=0;s<i.length;++s)if(t===i[s]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){const i=parseFloat(t);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}}function Kx(e,t,i,s){const a=s?e.split(s):[e];for(const e in a){if("string"!=typeof a[e])continue;const s=a[e].split(i);if(2!==s.length)continue;t(s[0],s[1])}}const Yx=new Gx(0,0,""),Wx="middle"===Yx.align?"middle":"center";function Zx(e,t,i){const s=e;function a(){const t=Vx(e);if(null===t)throw new Error("Malformed timestamp: "+s);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function r(){e=e.replace(/^\s+/,"")}if(r(),t.startTime=a(),r(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+s);e=e.slice(3),r(),t.endTime=a(),r(),function(e,t){const s=new qx;Kx(e,function(e,t){let a;switch(e){case"region":for(let a=i.length-1;a>=0;a--)if(i[a].id===t){s.set(e,i[a].region);break}break;case"vertical":s.alt(e,t,["rl","lr"]);break;case"line":a=t.split(","),s.integer(e,a[0]),s.percent(e,a[0])&&s.set("snapToLines",!1),s.alt(e,a[0],["auto"]),2===a.length&&s.alt("lineAlign",a[1],["start",Wx,"end"]);break;case"position":a=t.split(","),s.percent(e,a[0]),2===a.length&&s.alt("positionAlign",a[1],["start",Wx,"end","line-left","line-right","auto"]);break;case"size":s.percent(e,t);break;case"align":s.alt(e,t,["start",Wx,"end","left","right"])}},/:/,/\s/),t.region=s.get("region",null),t.vertical=s.get("vertical","");let a=s.get("line","auto");"auto"===a&&-1===Yx.line&&(a=-1),t.line=a,t.lineAlign=s.get("lineAlign","start"),t.snapToLines=s.get("snapToLines",!0),t.size=s.get("size",100),t.align=s.get("align",Wx);let r=s.get("position","auto");"auto"===r&&50===Yx.position&&(r="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=r}(e,t)}function Qx(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class Xx{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Hx,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){const t=this;function i(){let e=t.buffer,i=0;for(e=Qx(e);i<e.length&&"\r"!==e[i]&&"\n"!==e[i];)++i;const s=e.slice(0,i);return"\r"===e[i]&&++i,"\n"===e[i]&&++i,t.buffer=e.slice(i),s}function s(e){Kx(e,function(e,t){},/:/)}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=i();const s=e.match(/^()?WEBVTT([ \t].*)?$/);if(null==s||!s[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}let a=!1;for(;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:e=i(),t.state){case"HEADER":/:/.test(e)?s(e):e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new Gx(0,0,""),t.state="CUE",-1===e.indexOf("--\x3e")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{Zx(e,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{const i=-1!==e.indexOf("--\x3e");if(!e||i&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){const e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}const Jx=/\r\n|\n\r|\n|\r/g,ek=function(e,t,i=0){return e.slice(i,i+t.length)===t};function tk(e,t,i){return lx(e.toString())+lx(t.toString())+lx(i)}function ik(e,t,i,s,a,r,n){const o=new Xx,d=Vg(new Uint8Array(e)).trim().replace(Jx,"\n").split("\n"),l=[],c=t?function(e,t=1){return Hb(e,9e4,1/t)}(t.baseTime,t.timescale):0;let h,p="00:00.000",u=0,g=0,f=!0;o.oncue=function(e){const r=i[s];let n=i.ccOffset;const o=(u-c)/9e4;if(null!=r&&r.new&&(void 0!==g?n=i.ccOffset=r.start:function(e,t,i){let s=e[t],a=e[s.prevCC];if(!a||!a.new&&s.new)return e.ccOffset=e.presentationOffset=s.start,void(s.new=!1);for(;null!=(r=a)&&r.new;){var r;e.ccOffset+=s.start-a.start,s.new=!1,s=a,a=e[s.prevCC]}e.presentationOffset=i}(i,s,o)),o){if(!t)return void(h=new Error("Missing initPTS for VTT MPEGTS"));n=o-i.presentationOffset}const d=e.endTime-e.startTime,p=Qb(9e4*(e.startTime+n-g),9e4*a)/9e4;e.startTime=Math.max(p,0),e.endTime=Math.max(p+d,0);const f=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(f)),e.id||(e.id=tk(e.startTime,e.endTime,f)),e.endTime>0&&l.push(e)},o.onparsingerror=function(e){h=e},o.onflush=function(){h?n(h):r(l)},d.forEach(e=>{if(f){if(ek(e,"X-TIMESTAMP-MAP=")){f=!1,e.slice(16).split(",").forEach(e=>{ek(e,"LOCAL:")?p=e.slice(6):ek(e,"MPEGTS:")&&(u=parseInt(e.slice(7)))});try{g=function(e){let t=parseInt(e.slice(-3));const i=parseInt(e.slice(-6,-4)),s=parseInt(e.slice(-9,-7)),a=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(vg(t)&&vg(i)&&vg(s)&&vg(a)))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+=1e3*i,t+=6e4*s,t+=36e5*a,t}(p)/1e3}catch(e){h=e}return}""===e&&(f=!1)}o.parse(e+"\n")}),o.flush()}const sk="stpp.ttml.im1t",ak=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,rk=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,nk={left:"start",center:"center",right:"end",start:"start",end:"end"};function ok(e,t,i,s){const a=mf(new Uint8Array(e),["mdat"]);if(0===a.length)return void s(new Error("Could not parse IMSC1 mdat"));const r=a.map(e=>Vg(e)),n=function(e,t,i=1,s=!1){return Hb(e,t,1/i,s)}(t.baseTime,1,t.timescale);try{r.forEach(e=>i(function(e,t){const i=(new DOMParser).parseFromString(e,"text/xml"),s=i.getElementsByTagName("tt")[0];if(!s)throw new Error("Invalid ttml");const a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},r=Object.keys(a).reduce((e,t)=>(e[t]=s.getAttribute(`ttp:${t}`)||a[t],e),{}),n="preserve"!==s.getAttribute("xml:space"),o=lk(dk(s,"styling","style")),d=lk(dk(s,"layout","region")),l=dk(s,"body","[begin]");return[].map.call(l,e=>{const i=ck(e,n);if(!i||!e.hasAttribute("begin"))return null;const s=uk(e.getAttribute("begin"),r),a=uk(e.getAttribute("dur"),r);let l=uk(e.getAttribute("end"),r);if(null===s)throw pk(e);if(null===l){if(null===a)throw pk(e);l=s+a}const c=new Gx(s-t,l-t,i);c.id=tk(c.startTime,c.endTime,c.text);const h=function(e,t,i){const s="http://www.w3.org/ns/ttml#styling";let a=null;const r=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],n=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;n&&i.hasOwnProperty(n)&&(a=i[n]);return r.reduce((i,r)=>{const n=hk(t,s,r)||hk(e,s,r)||hk(a,s,r);return n&&(i[r]=n),i},{})}(d[e.getAttribute("region")],o[e.getAttribute("style")],o),{textAlign:p}=h;if(p){const e=nk[p];e&&(c.lineAlign=e),c.align=p}return Dg(c,h),c}).filter(e=>null!==e)}(e,n)))}catch(e){s(e)}}function dk(e,t,i){const s=e.getElementsByTagName(t)[0];return s?[].slice.call(s.querySelectorAll(i)):[]}function lk(e){return e.reduce((e,t)=>{const i=t.getAttribute("xml:id");return i&&(e[i]=t),e},{})}function ck(e,t){return[].slice.call(e.childNodes).reduce((e,i,s)=>{var a;return"br"===i.nodeName&&s?e+"\n":null!=(a=i.childNodes)&&a.length?ck(i,t):t?e+i.textContent.trim().replace(/\s+/g," "):e+i.textContent},"")}function hk(e,t,i){return e&&e.hasAttributeNS(t,i)?e.getAttributeNS(t,i):null}function pk(e){return new Error(`Could not parse ttml timestamp ${e}`)}function uk(e,t){if(!e)return null;let i=Vx(e);return null===i&&(ak.test(e)?i=function(e,t){const i=ak.exec(e),s=(0|i[4])+(0|i[5])/t.subFrameRate;return 3600*(0|i[1])+60*(0|i[2])+(0|i[3])+s/t.frameRate}(e,t):rk.test(e)&&(i=function(e,t){const i=rk.exec(e),s=Number(i[1]);switch(i[2]){case"h":return 3600*s;case"m":return 60*s;case"ms":return 1e3*s;case"f":return s/t.frameRate;case"t":return s/t.tickRate}return s}(e,t))),i}class gk{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,i){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}function fk(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function mk(e,t){return!!e&&e.kind===fk(t)&&uw(t,e)}function vk(e,t,i,s){return Math.min(t,s)-Math.max(e,i)}const yk=/\s/,bk={newCue(e,t,i,s){const a=[];let r,n,o,d,l;const c=self.VTTCue||self.TextTrackCue;for(let p=0;p<s.rows.length;p++)if(r=s.rows[p],o=!0,d=0,l="",!r.isEmpty()){var h;for(let e=0;e<r.chars.length;e++)yk.test(r.chars[e].uchar)&&o?d++:(l+=r.chars[e].uchar,o=!1);r.cueStartTime=t,t===i&&(i+=1e-4),d>=16?d--:d++;const s=Qx(l.trim()),u=tk(t,i,s);null!=e&&null!=(h=e.cues)&&h.getCueById(u)||(n=new c(t,i,s),n.id=u,n.line=p+1,n.align="left",n.position=10+Math.min(80,10*Math.floor(8*d/32)),a.push(n))}return e&&a.length&&(a.sort((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line),a.forEach(t=>rx(e,t))),a}};const wk=/(\d+)-(\d+)\/(\d+)/;class xk{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||kk,this.controller=new self.AbortController,this.stats=new Qg}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,i){const s=this.stats;if(s.loading.start)throw new Error("Loader can only be used once.");s.loading.start=self.performance.now();const a=function(e,t){const i={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(Dg({},e.headers))};e.rangeEnd&&i.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1));return i}(e,this.controller.signal),r="arraybuffer"===e.responseType,n=r?"byteLength":"length",{maxTimeToFirstByteMs:o,maxLoadTimeMs:d}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,a),self.clearTimeout(this.requestTimeout),t.timeout=o&&vg(o)?o:d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},t.timeout);(rw(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then(i=>{var a;this.response=this.loader=i;const n=Math.max(self.performance.now(),s.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=d,this.requestTimeout=self.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(s,e,this.response))},d-(n-s.loading.start)),!i.ok){const{status:e,statusText:t}=i;throw new Sk(t||"fetch, bad network response",e,i)}s.loading.first=n,s.total=function(e){const t=e.get("Content-Range");if(t){const e=function(e){const t=wk.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(vg(e))return e}const i=e.get("Content-Length");if(i)return parseInt(i)}(i.headers)||s.total;const o=null==(a=this.callbacks)?void 0:a.onProgress;return o&&vg(t.highWaterMark)?this.loadProgressively(i,s,e,t.highWaterMark,o):r?i.arrayBuffer():"json"===e.responseType?i.json():i.text()}).then(i=>{var a,r;const o=this.response;if(!o)throw new Error("loader destroyed");self.clearTimeout(this.requestTimeout),s.loading.end=Math.max(self.performance.now(),s.loading.first);const d=i[n];d&&(s.loaded=s.total=d);const l={url:o.url,data:i,code:o.status},c=null==(a=this.callbacks)?void 0:a.onProgress;c&&!vg(t.highWaterMark)&&c(s,e,i,o),null==(r=this.callbacks)||r.onSuccess(l,s,e,o)}).catch(t=>{var i;if(self.clearTimeout(this.requestTimeout),s.aborted)return;const a=t&&t.code||0,r=t?t.message:null;null==(i=this.callbacks)||i.onError({code:a,text:r},e,t?t.details:null,s)})}getCacheAge(){let e=null;if(this.response){const t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,i,s=0,a){const r=new Oy,n=e.body.getReader(),o=()=>n.read().then(n=>{if(n.done)return r.dataLength&&a(t,i,r.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));const d=n.value,l=d.length;return t.loaded+=l,l<s||r.dataLength?(r.push(d),r.dataLength>=s&&a(t,i,r.flush().buffer,e)):a(t,i,d.buffer,e),o()}).catch(()=>Promise.reject());return o()}}function kk(e,t){return new self.Request(e.url,t)}class Sk extends Error{constructor(e,t,i){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=i}}const Ek=/^age:\s*[\d.]+\s*$/im;class Pk{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new Qg,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){const e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,i){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.loadInternal()}loadInternal(){const{config:e,context:t}=this;if(!e||!t)return;const i=this.loader=new self.XMLHttpRequest,s=this.stats;s.loading.first=0,s.loaded=0,s.aborted=!1;const a=this.xhrSetup;a?Promise.resolve().then(()=>{if(this.loader===i&&!this.stats.aborted)return a(i,t.url)}).catch(e=>{if(this.loader===i&&!this.stats.aborted)return i.open("GET",t.url,!0),a(i,t.url)}).then(()=>{this.loader!==i||this.stats.aborted||this.openAndSendXhr(i,t,e)}).catch(e=>{var a;null==(a=this.callbacks)||a.onError({code:i.status,text:e.message},t,i,s)}):this.openAndSendXhr(i,t,e)}openAndSendXhr(e,t,i){e.readyState||e.open("GET",t.url,!0);const s=t.headers,{maxTimeToFirstByteMs:a,maxLoadTimeMs:r}=i.loadPolicy;if(s)for(const t in s)e.setRequestHeader(t,s[t]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),i.timeout=a&&vg(a)?a:r,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){const{context:e,loader:t,stats:i}=this;if(!e||!t)return;const s=t.readyState,a=this.config;if(!i.aborted&&s>=2&&(0===i.loading.first&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),4===s)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;const s=t.status,d="text"===t.responseType?t.responseText:null;if(s>=200&&s<300){const a=null!=d?d:t.response;if(null!=a){var r,n;i.loading.end=Math.max(self.performance.now(),i.loading.first);const o="arraybuffer"===t.responseType?a.byteLength:a.length;i.loaded=i.total=o,i.bwEstimate=8e3*i.total/(i.loading.end-i.loading.first);const d=null==(r=this.callbacks)?void 0:r.onProgress;d&&d(i,e,a,t);const l={url:t.responseURL,data:a,code:s};return void(null==(n=this.callbacks)||n.onSuccess(l,i,e,t))}}const l=a.loadPolicy.errorRetry;var o;if(Lm(l,i.retry,!1,{url:e.url,data:void 0,code:s}))this.retry(l);else Bg.error(`${s} while loading ${e.url}`),null==(o=this.callbacks)||o.onError({code:s,text:t.statusText},e,t,i)}}loadtimeout(){if(!this.config)return;const e=this.config.loadPolicy.timeoutRetry;if(Lm(e,this.stats.retry,!0))this.retry(e);else{var t;Bg.warn(`timeout while loading ${null==(t=this.context)?void 0:t.url}`);const e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){const{context:t,stats:i}=this;this.retryDelay=Pm(e,i.retry),i.retry++,Bg.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${null==t?void 0:t.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){const t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&Ek.test(this.loader.getAllResponseHeaders())){const t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&new RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}const Tk=Og(Og({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:Pk,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class extends Ug{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.bwEstimator=void 0,this._abandonRulesCheck=e=>{var t;const{fragCurrent:i,partCurrent:s,hls:a}=this,{autoLevelEnabled:r,media:n}=a;if(!i||!n)return;const o=performance.now(),d=s?s.stats:i.stats,l=s?s.duration:i.duration,c=o-d.loading.start,h=a.minAutoLevel,p=i.level,u=this._nextAutoLevel;if(d.aborted||d.loaded&&d.loaded===d.total||p<=h)return this.clearTimer(),void(this._nextAutoLevel=-1);if(!r)return;const g=u>-1&&u!==p,f=!!e||g;if(!f&&(n.paused||!n.playbackRate||!n.readyState))return;const m=a.mainForwardBufferInfo;if(!f&&null===m)return;const v=this.bwEstimator.getEstimateTTFB(),y=Math.abs(n.playbackRate);if(c<=Math.max(v,l/(2*y)*1e3))return;const b=m?m.len/y:0,w=d.loading.first?d.loading.first-d.loading.start:-1,x=d.loaded&&w>-1,k=this.getBwEstimate(),S=a.levels,E=S[p],P=Math.max(d.loaded,Math.round(l*(i.bitrate||E.averageBitrate)/8));let T=x?c-w:c;T<1&&x&&(T=Math.min(c,8*d.loaded/k));const L=x?1e3*d.loaded/T:0,C=v/1e3,_=L?(P-d.loaded)/L:8*P/k+C;if(_<=b)return;const A=L?8*L:k,R=!0===(null==(t=(null==e?void 0:e.details)||this.hls.latestLevelDetails)?void 0:t.live),I=this.hls.config.abrBandWidthUpFactor;let D,M=Number.POSITIVE_INFINITY;for(D=p-1;D>h;D--){const e=S[D].maxBitrate,t=!S[D].details||R;if(M=this.getTimeToLoadFrag(C,A,l*e,t),M<Math.min(b,l+C))break}if(M>=_)return;if(M>10*l)return;x?this.bwEstimator.sample(c-Math.min(v,w),d.loaded):this.bwEstimator.sampleTTFB(c);const O=S[D].maxBitrate;this.getBwEstimate()*I>O&&this.resetEstimator(O);const U=this.findBestLevel(O,h,D,0,b,1,1);U>-1&&(D=U),this.warn(`Fragment ${i.sn}${s?" part "+s.index:""} of level ${p} is loading too slowly;\n      Fragment duration: ${i.duration.toFixed(3)}\n      Time to underbuffer: ${b.toFixed(3)} s\n      Estimated load time for current fragment: ${_.toFixed(3)} s\n      Estimated load time for down switch fragment: ${M.toFixed(3)} s\n      TTFB estimate: ${0|w} ms\n      Current BW estimate: ${vg(k)?0|k:"Unknown"} bps\n      New BW estimate: ${0|this.getBwEstimate()} bps\n      Switching to level ${D} @ ${0|O} bps`),a.nextLoadLevel=a.nextAutoLevel=D,this.clearTimer();const $=()=>{if(this.clearTimer(),this.fragCurrent===i&&this.hls.loadLevel===D&&D>0){const e=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${D>0?"and switching down":""}\n      Fragment duration: ${i.duration.toFixed(3)} s\n      Time to underbuffer: ${e.toFixed(3)} s`),i.abortRequests(),this.fragCurrent=this.partCurrent=null,D>h){let t=this.findBestLevel(this.hls.levels[h].bitrate,h,D,0,e,1,1);-1===t&&(t=h),this.hls.nextLoadLevel=this.hls.nextAutoLevel=t,this.resetEstimator(this.hls.levels[t].bitrate)}}};g||_>2*M?$():this.timer=self.setInterval($,1e3*M),a.trigger(kg.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,part:s,stats:d})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){const e=this.hls.config;return new Rg(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){const{hls:e}=this;e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.FRAG_LOADING,this.onFragLoading,this),e.on(kg.FRAG_LOADED,this.onFragLoaded,this),e.on(kg.FRAG_BUFFERED,this.onFragBuffered,this),e.on(kg.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(kg.LEVEL_LOADED,this.onLevelLoaded,this),e.on(kg.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(kg.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(kg.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e&&(e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.FRAG_LOADING,this.onFragLoading,this),e.off(kg.FRAG_LOADED,this.onFragLoaded,this),e.off(kg.FRAG_BUFFERED,this.onFragBuffered,this),e.off(kg.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(kg.LEVEL_LOADED,this.onLevelLoaded,this),e.off(kg.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(kg.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(kg.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){const i=t.frag;if(!this.ignoreFragment(i)){var s;if(!i.bitrateTest)this.fragCurrent=i,this.partCurrent=null!=(s=t.part)?s:null;this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case xg.BUFFER_ADD_CODEC_ERROR:case xg.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case xg.FRAG_LOAD_TIMEOUT:{const e=t.frag,{fragCurrent:i,partCurrent:s}=this;if(e&&i&&e.sn===i.sn&&e.level===i.level){const t=performance.now(),i=s?s.stats:e.stats,a=t-i.loading.start,r=i.loading.first?i.loading.first-i.loading.start:-1;if(i.loaded&&r>-1){const e=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(a-Math.min(e,r),i.loaded)}else this.bwEstimator.sampleTTFB(a)}break}}}getTimeToLoadFrag(e,t,i,s){return e+i/t+(s?e+this.lastLevelLoadSec:0)}onLevelLoaded(e,t){const i=this.hls.config,{loading:s}=t.stats,a=s.end-s.first;vg(a)&&(this.lastLevelLoadSec=a/1e3),t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:i}){const s=i?i.stats:t.stats;if(t.type===Lg&&this.bwEstimator.sampleTTFB(s.loading.first-s.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){const e=i?i.duration:t.duration,a=this.hls.levels[t.level],r=(a.loaded?a.loaded.bytes:0)+s.loaded,n=(a.loaded?a.loaded.duration:0)+e;a.loaded={bytes:r,duration:n},a.realBitrate=Math.round(8*r/n)}if(t.bitrateTest){const e={stats:s,frag:t,part:i,id:t.type};this.onFragBuffered(kg.FRAG_BUFFERED,e),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){const{frag:i,part:s}=t,a=null!=s&&s.stats.loaded?s.stats:i.stats;if(a.aborted)return;if(this.ignoreFragment(i))return;const r=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(r,a.loaded),a.bwEstimate=this.getBwEstimate(),i.bitrateTest?this.bitrateTestDelay=r/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==Lg||"initSegment"===e.sn}clearTimer(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){const{maxAutoLevel:e,minAutoLevel:t}=this.hls,i=this.getBwEstimate(),s=this.hls.config.maxStarvationDelay,a=this.findBestLevel(i,t,e,0,s,1,1);if(a>-1)return a;const r=this.hls.firstLevel,n=Math.min(Math.max(r,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${r} clamped to ${n}`),n}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){const e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),i=this.lastLoadedFragLevel>-1;if(!(-1===e||t&&i&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return e;const s=t&&i?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){const t=this.hls.levels;if(t.length>Math.max(e,s)&&t[e].loadError<=t[s].loadError)return e}return this._nextAutoLevel=s,this.nextAutoLevelKey=this.getAutoLevelKey(),s}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){const{fragCurrent:e,partCurrent:t,hls:i}=this;if(i.levels.length<=1)return i.loadLevel;const{maxAutoLevel:s,config:a,minAutoLevel:r}=i,n=t?t.duration:e?e.duration:0,o=this.getBwEstimate(),d=this.getStarvationDelay();let l=a.abrBandWidthFactor,c=a.abrBandWidthUpFactor;if(d){const e=this.findBestLevel(o,r,s,d,0,l,c);if(e>=0)return this.rebufferNotice=-1,e}let h=n?Math.min(n,a.maxStarvationDelay):a.maxStarvationDelay;if(!d){const e=this.bitrateTestDelay;if(e){h=(n?Math.min(n,a.maxLoadingDelay):a.maxLoadingDelay)-e,this.info(`bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*h)} ms`),l=c=1}}const p=this.findBestLevel(o,r,s,d,h,l,c);if(this.rebufferNotice!==p&&(this.rebufferNotice=p,this.info(`${d?"rebuffering expected":"buffer is empty"}, optimal quality level ${p}`)),p>-1)return p;const u=i.levels[r],g=i.loadLevelObj;return g&&(null==u?void 0:u.bitrate)<g.bitrate?r:i.loadLevel}getStarvationDelay(){const e=this.hls,t=e.media;if(!t)return 1/0;const i=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,s=e.mainForwardBufferInfo;return(s?s.len:0)/i}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,i,s,a,r,n){var o;const d=s+a,l=this.lastLoadedFragLevel,c=-1===l?this.hls.firstLevel:l,{fragCurrent:h,partCurrent:p}=this,{levels:u,allAudioTracks:g,loadLevel:f,config:m}=this.hls;if(1===u.length)return 0;const v=u[c],y=!(null==(o=this.hls.latestLevelDetails)||!o.live),b=-1===f||-1===l;let w,x="SDR",k=(null==v?void 0:v.frameRate)||0;const{audioPreference:S,videoPreference:E}=m,P=this.audioTracksByGroup||(this.audioTracksByGroup=hm(g));let T=-1;if(b){if(-1!==this.firstSelection)return this.firstSelection;const s=this.codecTiers||(this.codecTiers=function(e,t,i,s){return e.slice(i,s+1).reduce((e,i,s)=>{if(!i.codecSet)return e;const a=i.audioGroups;let r=e[i.codecSet];r||(e[i.codecSet]=r={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:s,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!a,fragmentError:0}),r.minBitrate=Math.min(r.minBitrate,i.bitrate);const n=Math.min(i.height,i.width);return r.minHeight=Math.min(r.minHeight,n),r.minFramerate=Math.min(r.minFramerate,i.frameRate),r.minIndex=Math.min(r.minIndex,s),r.maxScore=Math.max(r.maxScore,i.score),r.fragmentError+=i.fragmentError,r.videoRanges[i.videoRange]=(r.videoRanges[i.videoRange]||0)+1,a&&a.forEach(e=>{if(!e)return;const i=t.groups[e];i&&(r.hasDefaultAudio=r.hasDefaultAudio||t.hasDefaultAudio?i.hasDefault:i.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(i.channels).forEach(e=>{r.channels[e]=(r.channels[e]||0)+i.channels[e]}))}),e},{})}(u,P,t,i)),a=function(e,t,i,s,a){const r=Object.keys(e),n=null==s?void 0:s.channels,o=null==s?void 0:s.audioCodec,d=null==a?void 0:a.videoCodec,l=n&&2===parseInt(n);let c=!1,h=!1,p=1/0,u=1/0,g=1/0,f=1/0,m=0,v=[];const{preferHDR:y,allowedVideoRanges:b}=dm(t,a);for(let t=r.length;t--;){const i=e[r[t]];c||(c=i.channels[2]>0),p=Math.min(p,i.minHeight),u=Math.min(u,i.minFramerate),g=Math.min(g,i.minBitrate),b.filter(e=>i.videoRanges[e]>0).length>0&&(h=!0)}p=vg(p)?p:0,u=vg(u)?u:0;const w=Math.max(1080,p),x=Math.max(30,u);g=vg(g)?g:i,i=Math.max(g,i),h||(t=void 0);const k=r.length>1;return{codecSet:r.reduce((t,s)=>{const a=e[s];if(s===t)return t;if(v=h?b.filter(e=>a.videoRanges[e]>0):[],k){if(a.minBitrate>i)return cm(s,`min bitrate of ${a.minBitrate} > current estimate of ${i}`),t;if(!a.hasDefaultAudio)return cm(s,"no renditions with default or auto-select sound found"),t;if(o&&s.indexOf(o.substring(0,4))%5!=0)return cm(s,`audio codec preference "${o}" not found`),t;if(n&&!l){if(!a.channels[n])return cm(s,`no renditions with ${n} channel sound found (channels options: ${Object.keys(a.channels)})`),t}else if((!o||l)&&c&&0===a.channels[2])return cm(s,"no renditions with stereo sound found"),t;if(a.minHeight>w)return cm(s,`min resolution of ${a.minHeight} > maximum of ${w}`),t;if(a.minFramerate>x)return cm(s,`min framerate of ${a.minFramerate} > maximum of ${x}`),t;if(!v.some(e=>a.videoRanges[e]>0))return cm(s,`no variants with VIDEO-RANGE of ${lm(v)} found`),t;if(d&&s.indexOf(d.substring(0,4))%5!=0)return cm(s,`video codec preference "${d}" not found`),t;if(a.maxScore<m)return cm(s,`max score of ${a.maxScore} < selected max of ${m}`),t}return t&&(jf(s)>=jf(t)||a.fragmentError>e[t].fragmentError)?t:(f=a.minIndex,m=a.maxScore,s)},void 0),videoRanges:v,preferHDR:y,minFramerate:u,minBitrate:g,minIndex:f}}(s,x,e,S,E),{codecSet:r,videoRanges:n,minFramerate:o,minBitrate:d,minIndex:l,preferHDR:c}=a;T=l,w=r,x=c?n[n.length-1]:n[0],k=o,e=Math.max(e,d),this.log(`picked start tier ${lm(a)}`)}else w=null==v?void 0:v.codecSet,x=null==v?void 0:v.videoRange;const L=p?p.duration:h?h.duration:0,C=this.bwEstimator.getEstimateTTFB()/1e3,_=[];for(let o=i;o>=t;o--){var A;const t=u[o],h=o>c;if(!t)continue;if(m.useMediaCapabilities&&!t.supportedResult&&!t.supportedPromise){const i=navigator.mediaCapabilities;"function"==typeof(null==i?void 0:i.decodingInfo)&&(Qf(t,P,x,k,e,S)||Lf(t.videoCodec))?(t.supportedPromise=Xf(t,P,i),t.supportedPromise.then(e=>{if(!this.hls)return;t.supportedResult=e;const i=this.hls.levels,s=i.indexOf(t);e.error?this.warn(`MediaCapabilities decodingInfo error: "${e.error}" for level ${s} ${lm(e)}`):e.supported||(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${s} ${lm(e)}`),s>-1&&i.length>1&&(this.log(`Removing unsupported level ${s}`),this.hls.removeLevel(s),-1===this.hls.loadLevel&&(this.hls.nextLoadLevel=0)))})):t.supportedResult=Yf}if((w&&t.codecSet!==w||x&&t.videoRange!==x||h&&k>t.frameRate||!h&&k>0&&k<t.frameRate||t.supportedResult&&(null==(A=t.supportedResult.decodingInfoResults)||!A[0].smooth))&&(!b||o!==T)){_.push(o);continue}const g=t.details,v=(p?null==g?void 0:g.partTarget:null==g?void 0:g.averagetargetduration)||L;let E;E=h?n*e:r*e;const R=L&&s>=2*L&&0===a?t.averageBitrate:t.maxBitrate,I=this.getTimeToLoadFrag(C,E,R*v,void 0===g);if(E>=R&&(o===l||0===t.loadError&&0===t.fragmentError)&&(I<=C||!vg(I)||y&&!this.bitrateTestDelay||I<d)){const e=this.forcedAutoLevel;return o===f||-1!==e&&e===f||(_.length&&this.trace(`Skipped level(s) ${_.join(",")} of ${i} max with CODECS and VIDEO-RANGE:"${u[_[0]].codecs}" ${u[_[0]].videoRange}; not compatible with "${w}" ${x}`),this.info(`switch candidate:${c}->${o} adjustedbw(${Math.round(E)})-bitrate=${Math.round(E-R)} ttfb:${C.toFixed(1)} avgDuration:${v.toFixed(1)} maxFetchDuration:${d.toFixed(1)} fetchDuration:${I.toFixed(1)} firstSelection:${b} codecSet:${t.codecSet} videoRange:${t.videoRange} hls.loadLevel:${f}`)),b&&(this.firstSelection=o),o}}return-1}set nextAutoLevel(e){const t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){const{maxAutoLevel:t,minAutoLevel:i}=this.hls;return Math.min(Math.max(e,i),t)}},bufferController:class extends Ug{constructor(e,t){var i;super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=e=>{var t;this.hls&&"open"===(null==(t=this.mediaSource)?void 0:t.readyState)&&this.hls.pauseBuffering()},this._onStartStreaming=e=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=e=>{const{media:t,mediaSource:i}=this;e&&this.log("Media source opened"),t&&i&&(i.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(kg.MEDIA_ATTACHED,{media:t,mediaSource:i}),null!==this.mediaSource&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{const{mediaSrc:e,_objectUrl:t}=this;e!==t&&this.error(`Media element src was set while attaching MediaSource (${t} > ${e})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=(i=Gg(e.config.preferManagedMediaSource),"undefined"!=typeof self&&i===self.ManagedMediaSource),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){const{hls:e}=this;e.on(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.on(kg.BUFFER_RESET,this.onBufferReset,this),e.on(kg.BUFFER_APPENDING,this.onBufferAppending,this),e.on(kg.BUFFER_CODECS,this.onBufferCodecs,this),e.on(kg.BUFFER_EOS,this.onBufferEos,this),e.on(kg.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(kg.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(kg.FRAG_PARSED,this.onFragParsed,this),e.on(kg.FRAG_CHANGED,this.onFragChanged,this),e.on(kg.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.off(kg.BUFFER_RESET,this.onBufferReset,this),e.off(kg.BUFFER_APPENDING,this.onBufferAppending,this),e.off(kg.BUFFER_CODECS,this.onBufferCodecs,this),e.off(kg.BUFFER_EOS,this.onBufferEos,this),e.off(kg.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(kg.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(kg.FRAG_PARSED,this.onFragParsed,this),e.off(kg.FRAG_CHANGED,this.onFragChanged,this),e.off(kg.ERROR,this.onError,this)}transferMedia(){const{media:e,mediaSource:t}=this;if(!e)return null;const i={};if(this.operationQueue){const e=this.isUpdating();e||this.operationQueue.removeBlockers();const t=this.isQueued();(e||t)&&this.warn(`Transfering MediaSource with${t?" operations in queue":""}${e?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}const s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===t?Dg(i,s.tracks):this.sourceBuffers.forEach(e=>{const[t]=e;t&&(i[t]=Dg({},this.tracks[t]),this.removeBuffer(t)),e[0]=e[1]=null}),{media:e,mediaSource:t,tracks:i}}initTracks(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var i;let s=2;(t.audio&&!t.video||!t.altAudio)&&(s=1),this.bufferCodecEventsTotal=s,this.log(`${s} bufferCodec event(s) expected.`),null!=(i=this.transferData)&&i.mediaSource&&this.sourceBufferCount&&s&&this.bufferCreated()}onMediaAttaching(e,t){const i=this.media=t.media,s=Gg(this.appendSource);if(this.transferData=this.overrides=void 0,i&&s){const e=!!t.mediaSource;(e||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);const a=this.mediaSource=t.mediaSource||new s;if(this.assignMediaSource(a),e)this._objectUrl=i.src,this.attachTransferred();else{const e=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{i.removeAttribute("src");const t=self.ManagedMediaSource;i.disableRemotePlayback=i.disableRemotePlayback||t&&a instanceof t,yw(i),function(e,t){const i=self.document.createElement("source");i.type="video/mp4",i.src=t,e.appendChild(i)}(i,e),i.load()}catch(t){i.src=e}else i.src=e}i.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,i;this.log(`${(null==(t=this.transferData)?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${null==(i=e.constructor)?void 0:i.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){const e=this.media,t=this.transferData;if(!t||!e)return;const i=this.tracks,s=t.tracks,a=s?Object.keys(s):null,r=a?a.length:0,n=()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()};if(s&&a&&r){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})\nrequired tracks: ${lm(i,(e,t)=>"initSegment"===e?void 0:t)};\ntransfer tracks: ${lm(s,(e,t)=>"initSegment"===e?void 0:t)}}`),!Hg(s,i)){t.mediaSource=null,t.tracks=void 0;const a=e.currentTime,r=this.details,n=Math.max(a,(null==r?void 0:r.fragments[0].start)||0);return n-a>1?void this.log(`attachTransferred: waiting for playback to reach new tracks start time ${a} -> ${n}`):(this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(s)}"->"${Object.keys(i)}") start time: ${n} currentTime: ${a}`),this.onMediaDetaching(kg.MEDIA_DETACHING,{}),this.onMediaAttaching(kg.MEDIA_ATTACHING,t),void(e.currentTime=n))}this.transferData=void 0,a.forEach(e=>{const t=e,i=s[t];if(i){const e=i.buffer;if(e){const s=this.fragmentTracker,a=i.id;if(s.hasFragments(a)||s.hasParts(a)){const i=av.getBuffered(e);s.detectEvictedFragments(t,i,a,null,!0)}const r=bw(t),n=[t,e];this.sourceBuffers[r]=n,e.updating&&this.operationQueue&&this.operationQueue.prependBlocker(t),this.trackSourceBuffer(t,i)}}}),n(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),n()}get mediaSourceOpenOrEnded(){var e;const t=null==(e=this.mediaSource)?void 0:e.readyState;return"open"===t||"ended"===t}onMediaDetaching(e,t){const i=!!t.transferMedia;this.transferData=this.overrides=void 0;const{media:s,mediaSource:a,_objectUrl:r}=this;if(a){if(this.log("media source "+(i?"transferring":"detaching")),i)this.sourceBuffers.forEach(([e])=>{e&&this.removeBuffer(e)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){const e="open"===a.readyState;try{const t=a.sourceBuffers;for(let i=t.length;i--;)e&&t[i].abort(),a.removeSourceBuffer(t[i]);e&&a.endOfStream()}catch(e){this.warn(`onMediaDetaching: ${e.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.removeEventListener("startstreaming",this._onStartStreaming),a.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}s&&(s.removeEventListener("emptied",this._onMediaEmptied),i||(r&&self.URL.revokeObjectURL(r),this.mediaSrc===r?(s.removeAttribute("src"),this.appendSource&&yw(s),s.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(kg.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t;const i=null==(t=this.tracks[e])?void 0:t.buffer;if(this.removeBuffer(e),i)try{var s;null!=(s=this.mediaSource)&&s.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(t){this.warn(`onBufferReset ${e}`,t)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[bw(e)]=[null,null];const t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new gw(this.tracks)}onBufferCodecs(e,t){const i=this.tracks,s=Object.keys(t);this.log(`BUFFER_CODECS: "${s}" (current SB count ${this.sourceBufferCount})`);const a="audiovideo"in t&&(i.audio||i.video)||i.audiovideo&&("audio"in t||"video"in t),r=!a&&this.sourceBufferCount&&this.media&&s.some(e=>!i[e]);a||r?this.warn(`Unsupported transition between "${Object.keys(i)}" and "${s}" SourceBuffers`):(s.forEach(e=>{var s,a,r;const n=t[e],{id:o,codec:d,levelCodec:l,container:c,metadata:h,supplemental:p}=n;let u=i[e];const g=null==(s=this.transferData)||null==(a=s.tracks)?void 0:a[e],f=null!=g&&g.buffer?g:u,m=(null==f?void 0:f.pendingCodec)||(null==f?void 0:f.codec),v=null==f?void 0:f.levelCodec;u||(u=i[e]={buffer:void 0,listeners:[],codec:d,supplemental:p,container:c,levelCodec:l,metadata:h,id:o});const y=Hf(m,v),b=null==y?void 0:y.replace(fw,"$1");let w=Hf(d,l);const x=null==(r=w)?void 0:r.replace(fw,"$1");w&&y&&b!==x&&("audio"===e.slice(0,5)&&(w=Gf(w,this.appendSource)),this.log(`switching codec ${m} to ${w}`),w!==(u.pendingCodec||u.codec)&&(u.pendingCodec=w),u.container=c,this.appendChangeType(e,c,w))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),this.sourceBufferCount||this.mediaSourceOpenOrEnded&&this.checkPendingTracks())}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{const i=this.tracks[t];return e[t]={id:i.id,container:i.container,codec:i.codec,levelCodec:i.levelCodec},e},{})}appendChangeType(e,t,i){const s=`${t};codecs=${i}`,a={label:`change-type=${s}`,execute:()=>{const a=this.tracks[e];if(a){const r=a.buffer;null!=r&&r.changeType&&(this.log(`changing ${e} sourceBuffer type to ${s}`),r.changeType(s),a.codec=i,a.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{this.warn(`Failed to change ${e} SourceBuffer type`,t)}};this.append(a,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;const i=e.start,s=i+.05*e.duration;if(!0===(null==(t=this.fragmentTracker.getAppendedFrag(i,Lg))?void 0:t.gap))return;const a={label:"block-audio",execute:()=>{var e;const t=this.tracks.video;(this.lastVideoAppendEnd>s||null!=t&&t.buffer&&av.isBuffered(t.buffer,s)||!0===(null==(e=this.fragmentTracker.getAppendedFrag(s,Lg))?void 0:e.gap))&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:e=>{this.warn("Error executing block-audio operation",e)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){const{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){const{tracks:i}=this,{data:s,type:a,parent:r,frag:n,part:o,chunkMeta:d}=t,l=d.buffering[a],c=n.sn,h=self.performance.now();l.start=h;const p=n.stats.buffering,u=o?o.stats.buffering:null;0===p.start&&(p.start=h),u&&0===u.start&&(u.start=h);const g=i.audio;let f=!1;"audio"===a&&"audio/mpeg"===(null==g?void 0:g.container)&&(f=!this.lastMpegAudioChunk||1===d.id||this.lastMpegAudioChunk.sn!==d.sn,this.lastMpegAudioChunk=d);const m=this.tracks.video,v=null==m?void 0:m.buffer;if(v&&"initSegment"!==c){const e=o||n,t=this.blockedAudioAppend;if("audio"!==a||"main"===r||this.blockedAudioAppend){if("video"===a){const i=e.end;if(t){const e=t.frag.start;(i>e||i<this.lastVideoAppendEnd||av.isBuffered(v,e))&&this.unblockAudio()}this.lastVideoAppendEnd=i}}else{const t=e.start+.05*e.duration,i=v.buffered,s=this.currentOp("video");i.length||s?!s&&!av.isBuffered(v,t)&&this.lastVideoAppendEnd<t&&this.blockAudio(e):this.blockAudio(e)}}const y=(o||n).start,b={label:`append-${a}`,execute:()=>{if(l.executeStart=self.performance.now(),f){const e=this.tracks[a];if(e){const t=e.buffer;if(t){const e=y-t.timestampOffset;Math.abs(e)>=.1&&(this.log(`Updating audio SourceBuffer timestampOffset to ${y} (delta: ${e}) sn: ${c})`),t.timestampOffset=y)}}}this.appendExecutor(s,a)},onStart:()=>{},onComplete:()=>{const e=self.performance.now();l.executeEnd=l.end=e,0===p.first&&(p.first=e),u&&0===u.first&&(u.first=e);const t={};this.sourceBuffers.forEach(([e,i])=>{e&&(t[e]=av.getBuffered(i))}),this.appendErrors[a]=0,"audio"===a||"video"===a?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(kg.BUFFER_APPENDED,{type:a,frag:n,part:o,chunkMeta:d,parent:n.type,timeRanges:t})},onError:e=>{var t;const i={type:wg.MEDIA_ERROR,parent:n.type,details:xg.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:n,part:o,chunkMeta:d,error:e,err:e,fatal:!1},s=null==(t=this.media)?void 0:t.error;if(e.code===DOMException.QUOTA_EXCEEDED_ERR)i.details=xg.BUFFER_FULL_ERROR;else if(e.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!s)i.errorAction=Om(!0);else if(e.name===mw&&0===this.sourceBufferCount)i.errorAction=Om(!0);else{const e=++this.appendErrors[a];this.warn(`Failed ${e}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer (${s||"no media error"})`),(e>=this.hls.config.appendErrorMaxRetry||s)&&(i.fatal=!0)}this.hls.trigger(kg.ERROR,i)}};this.append(b,a,this.isPending(this.tracks[a]))}getFlushOp(e,t,i){return this.log(`queuing "${e}" remove ${t}-${i}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,i)},onStart:()=>{},onComplete:()=>{this.hls.trigger(kg.BUFFER_FLUSHED,{type:e})},onError:s=>{this.warn(`Failed to remove ${t}-${i} from "${e}" SourceBuffer`,s)}}}onBufferFlushing(e,t){const{type:i,startOffset:s,endOffset:a}=t;i?this.append(this.getFlushOp(i,s,a),i):this.sourceBuffers.forEach(([e])=>{e&&this.append(this.getFlushOp(e,s,a),e)})}onFragParsed(e,t){const{frag:i,part:s}=t,a=[],r=s?s.elementaryStreams:i.elementaryStreams;r[ef]?a.push("audiovideo"):(r[Xg]&&a.push("audio"),r[Jg]&&a.push("video"));0===a.length&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(()=>{const e=self.performance.now();i.stats.buffering.end=e,s&&(s.stats.buffering.end=e);const t=s?s.stats:i.stats;this.hls.trigger(kg.FRAG_BUFFERED,{frag:i,part:s,stats:t,id:i.type})},a).catch(e=>{this.warn(`Fragment buffered callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t,i;return e&&(!(null!=(t=this.tracks[e])&&t.ended)||(null==(i=this.tracks[e])?void 0:i.ending))})}onBufferEos(e,t){var i;this.sourceBuffers.forEach(([e])=>{if(e){const i=this.tracks[e];t.type&&t.type!==e||(i.ending=!0,i.ended||(i.ended=!0,this.log(`${e} buffer reached EOS`)))}});const s=!1!==(null==(i=this.overrides)?void 0:i.endOfStream);this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{var t;return e&&!(null!=(t=this.tracks[e])&&t.ended)})&&(s?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();const{mediaSource:e}=this;e&&"open"===e.readyState?(this.log("Calling mediaSource.endOfStream()"),e.endOfStream(),this.hls.trigger(kg.BUFFERED_TO_END,void 0)):e&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`)})):(this.tracksEnded(),this.hls.trigger(kg.BUFFERED_TO_END,void 0)))}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(null!==e){const t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){const e=this.getDurationAndRange();e&&this.blockUntilOpen(()=>this.updateMediaSource(e))}onError(e,t){if(t.details===xg.BUFFER_APPEND_ERROR&&t.frag){var i;const e=null==(i=t.errorAction)?void 0:i.nextAutoLevel;vg(e)&&e!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){const{hls:e,details:t,media:i}=this;if(!i||null===t)return;if(!this.sourceBufferCount)return;const s=e.config,a=i.currentTime,r=t.levelTargetDuration,n=t.live&&null!==s.liveBackBufferLength?s.liveBackBufferLength:s.backBufferLength;if(vg(n)&&n>=0){const e=Math.max(n,r),t=Math.floor(a/r)*r-e;this.flushBackBuffer(a,r,t)}if(vg(s.frontBufferFlushThreshold)&&s.frontBufferFlushThreshold>0){const e=Math.max(s.maxBufferLength,s.frontBufferFlushThreshold),t=Math.max(e,r),i=Math.floor(a/r)*r+t;this.flushFrontBuffer(a,r,i)}}flushBackBuffer(e,t,i){this.sourceBuffers.forEach(([e,t])=>{if(t){const a=av.getBuffered(t);if(a.length>0&&i>a.start(0)){var s;this.hls.trigger(kg.BACK_BUFFER_REACHED,{bufferEnd:i});const t=this.tracks[e];if(null!=(s=this.details)&&s.live)this.hls.trigger(kg.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else if(null!=t&&t.ended)return void this.log(`Cannot flush ${e} back buffer while SourceBuffer is in ended state`);this.hls.trigger(kg.BUFFER_FLUSHING,{startOffset:0,endOffset:i,type:e})}}})}flushFrontBuffer(e,t,i){this.sourceBuffers.forEach(([t,s])=>{if(s){const a=av.getBuffered(s),r=a.length;if(r<2)return;const n=a.start(r-1),o=a.end(r-1);if(i>n||e>=n&&e<=o)return;this.hls.trigger(kg.BUFFER_FLUSHING,{startOffset:n,endOffset:1/0,type:t})}})}getDurationAndRange(){var e;const{details:t,mediaSource:i}=this;if(!t||!this.media||"open"!==(null==i?void 0:i.readyState))return null;const s=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&t.live&&i.setLiveSeekableRange){const e=Math.max(0,t.fragmentStart);return{duration:1/0,start:e,end:Math.max(e,s)}}return{duration:1/0}}const a=null==(e=this.overrides)?void 0:e.duration;if(a)return vg(a)?{duration:a}:null;const r=this.media.duration;return s>(vg(i.duration)?i.duration:0)&&s>r||!vg(r)?{duration:s}:null}updateMediaSource({duration:e,start:t,end:i}){const s=this.mediaSource;this.media&&s&&"open"===s.readyState&&(s.duration!==e&&(vg(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),s.duration=e),void 0!==t&&void 0!==i&&(this.log(`MediaSource duration is set to ${s.duration}. Setting seekable range to ${t}-${i}.`),s.setLiveSeekableRange(t,i)))}get tracksReady(){const e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){const{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:i}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${lm(i)}`),this.tracksReady){var s;const e=null==(s=this.transferData)?void 0:s.tracks;e&&Object.keys(e).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){const e={};this.sourceBuffers.forEach(([t,i])=>{if(t){const s=this.tracks[t];e[t]={buffer:i,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}}),this.hls.trigger(kg.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([e])=>{this.executeNext(e)})}else{const e=new Error("could not create source buffer for media codec(s)");this.hls.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){const{tracks:e,sourceBuffers:t,mediaSource:i}=this;if(!i)throw new Error("createSourceBuffers called when mediaSource was null");for(const a in e){const r=a,n=e[r];if(this.isPending(n)){const e=this.getTrackCodec(n,r),a=`${n.container};codecs=${e}`;n.codec=e,this.log(`creating sourceBuffer(${a})${this.currentOp(r)?" Queued":""} ${lm(n)}`);try{const e=i.addSourceBuffer(a),s=bw(r),o=[r,e];t[s]=o,n.buffer=e}catch(e){var s;return this.error(`error while trying to add sourceBuffer: ${e.message}`),this.shiftAndExecuteNext(r),null==(s=this.operationQueue)||s.removeBlockers(),delete this.tracks[r],void this.hls.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,sourceBufferName:r,mimeType:a,parent:n.id})}this.trackSourceBuffer(r,n)}}this.bufferCreated()}getTrackCodec(e,t){const i=e.supplemental;let s=e.codec;i&&("video"===t||"audiovideo"===t)&&Uf(i,"video")&&(s=function(e,t){const i=[];if(e){const t=e.split(",");for(let e=0;e<t.length;e++)Of(t[e],"video")||i.push(t[e])}return t&&i.push(t),i.join(",")}(s,i));const a=Hf(s,e.levelCodec);return a?"audio"===t.slice(0,5)?Gf(a,this.appendSource):a:""}trackSourceBuffer(e,t){const i=t.buffer;if(!i)return;const s=this.getTrackCodec(t,e);this.tracks[e]={buffer:i,codec:s,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(e,t)=>{const i=t.removedRanges;null!=i&&i.length&&this.hls.trigger(kg.BUFFER_FLUSHED,{type:e})})}get mediaSrc(){var e,t;const i=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==i?void 0:i.src}onSBUpdateStart(e){const t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if("closed"===(null==(t=this.mediaSource)?void 0:t.readyState))return void this.resetBuffer(e);const i=this.currentOp(e);i&&(i.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var i;const s=new Error(`${e} SourceBuffer error. MediaSource readyState: ${null==(i=this.mediaSource)?void 0:i.readyState}`);this.error(`${s}`,t),this.hls.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:s,fatal:!1});const a=this.currentOp(e);a&&a.onError(s)}removeExecutor(e,t,i){const{media:s,mediaSource:a}=this,r=this.tracks[e],n=null==r?void 0:r.buffer;if(!s||!a||!n)return this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),void this.shiftAndExecuteNext(e);const o=vg(s.duration)?s.duration:1/0,d=vg(a.duration)?a.duration:1/0,l=Math.max(0,t),c=Math.min(i,o,d);c>l&&(!r.ending||r.ended)?(r.ended=!1,this.log(`Removing [${l},${c}] from the ${e} SourceBuffer`),n.remove(l,c)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){const i=this.tracks[t],s=null==i?void 0:i.buffer;if(!s)throw new vw(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);i.ending=!1,i.ended=!1,s.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(e=>{this.warn(`SourceBuffer blocked callback ${e}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(e){this.warn(`Callback run without blocking ${this.operationQueue} ${e}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);const{operationQueue:i}=this,s=t.map(e=>this.appendBlocker(e));return t.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(s).then(t=>{i===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(e=>{var t;const i=null==(t=this.tracks[e])?void 0:t.buffer;i&&!i.updating&&this.shiftAndExecuteNext(e)})}append(e,t,i){this.operationQueue&&this.operationQueue.append(e,t,i)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,i){const s=this.tracks[e];if(!s)return;const a=s.buffer;if(!a)return;const r=i.bind(this,e);s.listeners.push({event:t,listener:r}),a.addEventListener(t,r)}removeBufferListeners(e){const t=this.tracks[e];if(!t)return;const i=t.buffer;i&&(t.listeners.forEach(e=>{i.removeEventListener(e.event,e.listener)}),t.listeners.length=0)}},capLevelController:ww,errorController:class extends Ug{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(kg.ERROR,this.onError,this),e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){const e=this.hls;e&&(e.off(kg.ERROR,this.onError,this),e.off(kg.ERROR,this.onErrorOut,this),e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return(null==e?void 0:e.type)===Lg?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var i;if(t.fatal)return;const s=this.hls,a=t.context;switch(t.details){case xg.FRAG_LOAD_ERROR:case xg.FRAG_LOAD_TIMEOUT:case xg.KEY_LOAD_ERROR:case xg.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case xg.FRAG_PARSING_ERROR:if(null!=(i=t.frag)&&i.gap)return void(t.errorAction=Om());case xg.FRAG_GAP:case xg.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=_m);case xg.LEVEL_EMPTY_ERROR:case xg.LEVEL_PARSING_ERROR:{var r,n;const e=t.parent===Lg?t.level:s.loadLevel;t.details===xg.LEVEL_EMPTY_ERROR&&null!=(r=t.context)&&null!=(n=r.levelDetails)&&n.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case xg.LEVEL_LOAD_ERROR:case xg.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==a?void 0:a.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,a.level)));case xg.AUDIO_TRACK_LOAD_ERROR:case xg.AUDIO_TRACK_LOAD_TIMEOUT:case xg.SUBTITLE_LOAD_ERROR:case xg.SUBTITLE_TRACK_LOAD_TIMEOUT:if(a){const e=s.loadLevelObj;if(e&&(a.type===Pg&&e.hasAudioGroup(a.groupId)||a.type===Tg&&e.hasSubtitleGroup(a.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=_m,void(t.errorAction.flags=Dm)}return;case xg.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{const e=s.loadLevelObj,i=null==e?void 0:e.attrs["HDCP-LEVEL"];i?t.errorAction={action:_m,flags:Mm,hdcpLevel:i}:this.keySystemError(t)}return;case xg.BUFFER_ADD_CODEC_ERROR:case xg.REMUX_ALLOC_ERROR:case xg.BUFFER_APPEND_ERROR:var o;if(!t.errorAction)t.errorAction=this.getLevelSwitchAction(t,null!=(o=t.level)?o:s.loadLevel);return;case xg.INTERNAL_EXCEPTION:case xg.BUFFER_APPENDING_ERROR:case xg.BUFFER_FULL_ERROR:case xg.LEVEL_SWITCH_ERROR:case xg.BUFFER_STALLED_ERROR:case xg.BUFFER_SEEK_OVER_HOLE:case xg.BUFFER_NUDGE_ON_STALL:return void(t.errorAction=Om())}t.type===wg.KEY_SYSTEM_ERROR&&this.keySystemError(t)}keySystemError(e){const t=this.getVariantLevelIndex(e.frag);e.levelRetry=!1,e.errorAction=this.getLevelSwitchAction(e,t)}getPlaylistRetryOrSwitchAction(e,t){const i=Em(this.hls.config.playlistLoadPolicy,e),s=this.playlistError++;if(Lm(i,s,Sm(e),e.response))return{action:Rm,flags:Im,retryConfig:i,retryCount:s};const a=this.getLevelSwitchAction(e,t);return i&&(a.retryConfig=i,a.retryCount=s),a}getFragRetryOrSwitchAction(e){const t=this.hls,i=this.getVariantLevelIndex(e.frag),s=t.levels[i],{fragLoadPolicy:a,keyLoadPolicy:r}=t.config,n=Em(e.details.startsWith("key")?r:a,e),o=t.levels.reduce((e,t)=>e+t.fragmentError,0);if(s){e.details!==xg.FRAG_GAP&&s.fragmentError++;if(Lm(n,o,Sm(e),e.response))return{action:Rm,flags:Im,retryConfig:n,retryCount:o}}const d=this.getLevelSwitchAction(e,i);return n&&(d.retryConfig=n,d.retryCount=o),d}getLevelSwitchAction(e,t){const i=this.hls;null==t&&(t=i.loadLevel);const s=this.hls.levels[t];if(s){var a,r;const t=e.details;s.loadError++,t===xg.BUFFER_APPEND_ERROR&&s.fragmentError++;let d=-1;const{levels:l,loadLevel:c,minAutoLevel:h,maxAutoLevel:p}=i;i.autoLevelEnabled||i.config.preserveManualLevelOnError||(i.loadLevel=-1);const u=null==(a=e.frag)?void 0:a.type,g=(u===Cg&&t===xg.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(t===xg.BUFFER_ADD_CODEC_ERROR||t===xg.BUFFER_APPEND_ERROR))&&l.some(({audioCodec:e})=>s.audioCodec!==e),f="video"===e.sourceBufferName&&(t===xg.BUFFER_ADD_CODEC_ERROR||t===xg.BUFFER_APPEND_ERROR)&&l.some(({codecSet:e,audioCodec:t})=>s.codecSet!==e&&s.audioCodec===t),{type:m,groupId:v}=null!=(r=e.context)?r:{};for(let i=l.length;i--;){const a=(i+c)%l.length;if(a!==c&&a>=h&&a<=p&&0===l[a].loadError){var n,o;const i=l[a];if(t===xg.FRAG_GAP&&u===Lg&&e.frag){const t=l[a].details;if(t){const i=bm(e.frag,t.fragments,e.frag.start);if(null!=i&&i.gap)continue}}else{if(m===Pg&&i.hasAudioGroup(v)||m===Tg&&i.hasSubtitleGroup(v))continue;if(u===Cg&&null!=(n=s.audioGroups)&&n.some(e=>i.hasAudioGroup(e))||u===_g&&null!=(o=s.subtitleGroups)&&o.some(e=>i.hasSubtitleGroup(e))||g&&s.audioCodec===i.audioCodec||!g&&s.audioCodec!==i.audioCodec||f&&s.codecSet===i.codecSet)continue}d=a;break}}if(d>-1&&i.loadLevel!==d)return e.levelRetry=!0,this.playlistError=0,{action:_m,flags:Im,nextAutoLevel:d}}return{action:_m,flags:Dm}}onErrorOut(e,t){var i;switch(null==(i=t.errorAction)?void 0:i.action){case Cm:break;case _m:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===xg.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):t.fatal=!0}t.fatal&&this.hls.stopLoad()}sendAlternateToPenaltyBox(e){const t=this.hls,i=e.errorAction;if(!i)return;const{flags:s,hdcpLevel:a,nextAutoLevel:r}=i;switch(s){case Im:this.switchLevel(e,r);break;case Mm:a&&(t.maxHdcpLevel=Jf[Jf.indexOf(a)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`)}i.resolved||this.switchLevel(e,r)}switchLevel(e,t){if(void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===xg.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&"audiovideo"!==e.sourceBufferName)){const t=Kf(e.mimeType),i=this.hls.levels;for(let s=i.length;s--;)i[s][`${e.sourceBufferName}Codec`]===t&&this.hls.removeLevel(s)}}},fpsController:class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(kg.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(kg.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){const i=this.hls.config;if(i.capLevelOnFPSDrop){const e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"==typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,i){const s=performance.now();if(t){if(this.lastTime){const e=s-this.lastTime,a=i-this.lastDroppedFrames,r=t-this.lastDecodedFrames,n=1e3*a/e,o=this.hls;if(o.trigger(kg.FPS_DROP,{currentDropped:a,currentDecoded:r,totalDroppedFrames:i}),n>0&&a>o.config.fpsDroppedMonitoringThreshold*r){let e=o.currentLevel;o.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===o.autoLevelCapping||o.autoLevelCapping>=e)&&(e-=1,o.trigger(kg.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:o.currentLevel}),o.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=s,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}checkFPSInterval(){const e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){const t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Uv,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:bk,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends Dy{constructor(e,t,i){super(e,t,i,"subtitle-stream-controller",_g),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(kg.LEVEL_LOADED,this.onLevelLoaded,this),e.on(kg.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(kg.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(kg.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(kg.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(kg.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(kg.LEVEL_LOADED,this.onLevelLoaded,this),e.off(kg.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(kg.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(kg.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(kg.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(kg.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=ky,this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){const{frag:i,success:s}=t;if(sf(i)&&(this.fragPrevious=i),this.state=ky,!s)return;const a=this.tracksBuffered[this.currentTrackId];if(!a)return;let r;const n=i.start;for(let e=0;e<a.length;e++)if(n>=a[e].start&&n<=a[e].end){r=a[e];break}const o=i.start+i.duration;r?r.end=o:(r={start:n,end:o},a.push(r)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(e,t){const{startOffset:i,endOffset:s}=t;if(0===i&&s!==Number.POSITIVE_INFINITY){const e=s-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach(t=>{for(let i=0;i<t.length;)if(t[i].end<=e)t.shift();else{if(!(t[i].start<e))break;t[i].start=e,i++}}),this.fragmentTracker.removeFragmentsInRange(i,e,_g)}}onError(e,t){const i=t.frag;(null==i?void 0:i.type)===_g&&(t.details===xg.FRAG_GAP&&this.fragmentTracker.fragBuffered(i,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==xy&&(this.state=ky))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){this.levels&&hw(this.levels,t)?this.levels=t.map(e=>new nm(e)):(this.tracksBuffered=[],this.levels=t.map(e=>{const t=new nm(e);return this.tracksBuffered[t.id]=[],t}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,_g),this.fragPrevious=null,this.mediaBuffer=null)}onSubtitleTrackSwitch(e,t){var i;if(this.currentTrackId=t.id,null==(i=this.levels)||!i.length||-1===this.currentTrackId)return void this.clearInterval();const s=this.levels[this.currentTrackId];null!=s&&s.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,s&&this.state!==xy&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var i;const{currentTrackId:s,levels:a}=this,{details:r,id:n}=t;if(!a)return void this.warn(`Subtitle tracks were reset while loading level ${n}`);const o=a[n];if(n>=a.length||!o)return;this.log(`Subtitle track ${n} loaded [${r.startSN},${r.endSN}]${r.lastPartSn?`[part-${r.lastPartSn}-${r.lastPartIndex}]`:""},duration:${r.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let d=0;if(r.live||null!=(i=o.details)&&i.live){const e=this.mainDetails;if(r.deltaUpdateFailed||!e)return;const t=e.fragments[0];var l;if(o.details)d=this.alignPlaylists(r,o.details,null==(l=this.levelLastLoaded)?void 0:l.details),0===d&&t&&(d=t.start,ly(r,d));else r.hasProgramDateTime&&e.hasProgramDateTime?(by(r,e),d=r.fragmentStart):t&&(d=t.start,ly(r,d))}if(o.details=r,this.levelLastLoaded=o,n===s&&(this.hls.trigger(kg.SUBTITLE_TRACK_UPDATED,{details:r,id:n,groupId:t.groupId}),this.tick(),r.live&&!this.fragCurrent&&this.media&&this.state===ky)){bm(null,r.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)}}_handleFragmentLoadComplete(e){const{frag:t,payload:i}=e,s=t.decryptdata,a=this.hls;if(!this.fragContextChanged(t)&&i&&i.byteLength>0&&null!=s&&s.key&&s.iv&&vv(s.method)){const e=performance.now();this.decrypter.decrypt(new Uint8Array(i),s.key.buffer,s.iv.buffer,yv(s.method)).catch(e=>{throw a.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e}).then(i=>{const s=performance.now();a.trigger(kg.FRAG_DECRYPTED,{frag:t,payload:i,stats:{tstart:e,tdecrypt:s}})}).catch(e=>{this.warn(`${e.name}: ${e.message}`),this.state=ky})}}doTick(){if(this.media){if(this.state===ky){const{currentTrackId:e,levels:t}=this,i=null==t?void 0:t[e];if(!i||!t.length||!i.details)return;if(this.waitForLive(i))return;const{config:s}=this,a=this.getLoadPosition(),r=av.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,s.maxBufferHole),{end:n,len:o}=r,d=i.details;if(o>this.hls.maxBufferLength+d.levelTargetDuration)return;const l=d.fragments,c=l.length,h=d.edge;let p=null;const u=this.fragPrevious;if(n<h){const e=s.maxFragLookUpTolerance,t=n>h-e?0:e;p=bm(u,l,Math.max(l[0].start,n),t),!p&&u&&u.start<l[0].start&&(p=l[0])}else p=l[c-1];if(p=this.filterReplacedPrimary(p,i.details),!p)return;const g=l[p.sn-d.startSN-1];if(g&&g.cc===p.cc&&this.fragmentTracker.getState(g)===Um&&(p=g),this.fragmentTracker.getState(p)===Um){const e=this.mapToInitFragWhenRequired(p);e&&this.loadFragment(e,i,n)}}}else this.state=ky}loadFragment(e,t,i){sf(e)?super.loadFragment(e,t,i):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new Sx(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends cw{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=null;const t=dx(this.media.textTracks);for(let i=0;i<t.length;i++)if("hidden"===t[i].mode)e=t[i];else if("showing"===t[i].mode){e=t[i];break}const i=this.findTrackForTextTrack(e);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){const{hls:e}=this;e.on(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.on(kg.LEVEL_LOADING,this.onLevelLoading,this),e.on(kg.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(kg.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(kg.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.off(kg.LEVEL_LOADING,this.onLevelLoading,this),e.off(kg.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(kg.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(kg.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){const i=this.media;if(!i)return;const s=!!t.transferMedia;if(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||i.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,s)return;dx(i.textTracks).forEach(e=>{nx(e)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){const{id:i,groupId:s,details:a}=t,r=this.tracksInGroup[i];if(!r||r.groupId!==s)return void this.warn(`Subtitle track with id:${i} and group:${s} not found in active group ${null==r?void 0:r.groupId}`);const n=r.details;r.details=t.details,this.log(`Subtitle track ${i} "${r.name}" lang:${r.lang} group:${s} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,n)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.subtitleGroups||null,s=this.groupIds;let a=this.currentTrack;if(!i||(null==s?void 0:s.length)!==(null==i?void 0:i.length)||null!=i&&i.some(e=>-1===(null==s?void 0:s.indexOf(e)))){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!i||-1!==i.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.subtitlePreference;if(!a&&t){this.selectDefaultTrack=!1;const i=um(t,e);if(i>-1)a=e[i];else{const e=um(t,this.tracks);a=this.tracks[e]}}let s=this.findTrackId(a);-1===s&&a&&(s=this.findTrackId(null));const r={subtitleTracks:e};this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${null==i?void 0:i.join(",")}" group-id`),this.hls.trigger(kg.SUBTITLE_TRACKS_UPDATED,r),-1!==s&&-1===this.trackId&&this.setSubtitleTrack(s)}}findTrackId(e){const t=this.tracksInGroup,i=this.selectDefaultTrack;for(let s=0;s<t.length;s++){const a=t[s];if((!i||a.default)&&(i||e)&&(!e||gm(a,e)))return s}if(e){for(let i=0;i<t.length;i++){const s=t[i];if(pw(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<t.length;i++){const s=t[i];if(pw(e.attrs,s.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(e){if(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){if(uw(t[i],e))return i}}return-1}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Tg||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(-1===e.id)return this.setSubtitleTrack(-1),null;const t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){const i=this.currentTrack;if(i&&gm(e,i))return i;const s=um(e,this.tracksInGroup);if(s>-1){const e=this.tracksInGroup[s];return this.setSubtitleTrack(s),e}if(i)return null;{const i=um(e,t);if(i>-1)return t[i]}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=e.id,s=e.groupId,a=this.getUrlWithDirectives(e.url,t),r=e.details,n=null==r?void 0:r.age;this.log(`Loading subtitle ${i} "${e.name}" lang:${e.lang} group:${s}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${n&&r.live?" age "+n.toFixed(1)+(r.type&&" "+r.type||""):""} ${a}`),this.hls.trigger(kg.SUBTITLE_TRACK_LOADING,{url:a,id:i,groupId:s,deliveryDirectives:t||null,track:e})}toggleTrackModes(){const{media:e}=this;if(!e)return;const t=dx(e.textTracks),i=this.currentTrack;let s;if(i&&(s=t.filter(e=>uw(i,e))[0],s||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`)),[].slice.call(t).forEach(e=>{"disabled"!==e.mode&&e!==s&&(e.mode="disabled")}),s){const e=this.subtitleDisplay?"showing":"hidden";s.mode!==e&&(s.mode=e)}}setSubtitleTrack(e){const t=this.tracksInGroup;if(!this.media)return void(this.queuedDefaultTrack=e);if(e<-1||e>=t.length||!vg(e))return void this.warn(`Invalid subtitle track id: ${e}`);this.selectDefaultTrack=!1;const i=this.currentTrack,s=t[e]||null;if(this.trackId=e,this.currentTrack=s,this.toggleTrackModes(),!s)return void this.hls.trigger(kg.SUBTITLE_TRACK_SWITCH,{id:e});const a=!!s.details&&!s.details.live;if(e===this.trackId&&s===i&&a)return;this.log(`Switching to subtitle-track ${e}`+(s?` "${s.name}" lang:${s.lang} group:${s.groupId}`:""));const{id:r,groupId:n="",name:o,type:d,url:l}=s;this.hls.trigger(kg.SUBTITLE_TRACK_SWITCH,{id:r,groupId:n,name:o,type:d,url:l});const c=this.switchParams(s.url,null==i?void 0:i.details,s.details);this.loadPlaylist(c)}},timelineController:class{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(kg.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(kg.FRAG_LOADING,this.onFragLoading,this),e.on(kg.FRAG_LOADED,this.onFragLoaded,this),e.on(kg.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(kg.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(kg.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(kg.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(kg.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){const{hls:e}=this;e.off(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(kg.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(kg.FRAG_LOADING,this.onFragLoading,this),e.off(kg.FRAG_LOADED,this.onFragLoaded,this),e.off(kg.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(kg.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(kg.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(kg.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(kg.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){const e=new gk(this,"textTrack1"),t=new gk(this,"textTrack2"),i=new gk(this,"textTrack3"),s=new gk(this,"textTrack4");this.cea608Parser1=new jx(1,e,t),this.cea608Parser2=new jx(3,i,s)}addCues(e,t,i,s,a){let r=!1;for(let e=a.length;e--;){const s=a[e],n=vk(s[0],s[1],t,i);if(n>=0&&(s[0]=Math.min(s[0],t),s[1]=Math.max(s[1],i),r=!0,n/(i-t)>.5))return}if(r||a.push([t,i]),this.config.renderTextTracksNatively){const a=this.captionsTracks[e];this.Cues.newCue(a,t,i,s)}else{const a=this.Cues.newCue(null,t,i,s);this.hls.trigger(kg.CUES_PARSED,{type:"captions",cues:a,track:e})}}onInitPtsFound(e,{frag:t,id:i,initPTS:s,timescale:a}){const{unparsedVttFrags:r}=this;i===Lg&&(this.initPTS[t.cc]={baseTime:s,timescale:a}),r.length&&(this.unparsedVttFrags=[],r.forEach(e=>{this.onFragLoaded(kg.FRAG_LOADED,e)}))}getExistingTrack(e,t){const{media:i}=this;if(i)for(let s=0;s<i.textTracks.length;s++){const a=i.textTracks[s];if(mk(a,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return a}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;const{captionsProperties:t,captionsTracks:i,media:s}=this,{label:a,languageCode:r}=t[e],n=this.getExistingTrack(a,r);if(n)i[e]=n,nx(i[e]),ax(i[e],s);else{const t=this.createTextTrack("captions",a,r);t&&(t[e]=!0,i[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;const t=this.captionsProperties[e];if(!t)return;const i={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=i,this.hls.trigger(kg.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[i]})}createTextTrack(e,t,i){const s=this.media;if(s)return s.addTextTrack(e,t,i)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){const i=!!t.transferMedia;if(this.media=null,i)return;const{captionsTracks:s}=this;Object.keys(s).forEach(e=>{nx(s[e]),delete s[e]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){const{media:e}=this;if(!e)return;const t=e.textTracks;if(t)for(let e=0;e<t.length;e++)nx(t[e])}onSubtitleTracksUpdated(e,t){const i=t.subtitleTracks||[],s=i.some(e=>e.textCodec===sk);if(this.config.enableWebVTT||s&&this.config.enableIMSC1){if(hw(this.tracks,i))return void(this.tracks=i);if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){const e=this.media,t=e?dx(e.textTracks):null;if(this.tracks.forEach((e,i)=>{let s;if(t){let i=null;for(let s=0;s<t.length;s++)if(t[s]&&mk(t[s],e)){i=t[s],t[s]=null;break}i&&(s=i)}if(s)nx(s);else{const t=fk(e);s=this.createTextTrack(t,e.name,e.lang),s&&(s.mode="disabled")}s&&this.textTracks.push(s)}),null!=t&&t.length){const e=t.filter(e=>null!==e).map(e=>e.label);e.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${e.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){const e=this.tracks.map(e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}));this.hls.trigger(kg.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(e=>{const t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;const i=`textTrack${t[1]}`,s=this.captionsProperties[i];s&&(s.label=e.name,e.lang&&(s.languageCode=e.lang),s.media=e)})}closedCaptionsForLevel(e){const t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===Lg){var i,s;const{cea608Parser1:e,cea608Parser2:a,lastSn:r}=this,{cc:n,sn:o}=t.frag,d=null!=(i=null==(s=t.part)?void 0:s.index)?i:-1;e&&a&&(o!==r+1||o===r&&d!==this.lastPartIndex+1||n!==this.lastCc)&&(e.reset(),a.reset()),this.lastCc=n,this.lastSn=o,this.lastPartIndex=d}}onFragLoaded(e,t){const{frag:i,payload:s}=t;if(i.type===_g)if(s.byteLength){const e=i.decryptdata,a="stats"in t;if(null==e||!e.encrypted||a){const e=this.tracks[i.level],a=this.vttCCs;a[i.cc]||(a[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),e&&e.textCodec===sk?this._parseIMSC1(i,s):this._parseVTTs(t)}}else this.hls.trigger(kg.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:new Error("Empty subtitle payload")})}_parseIMSC1(e,t){const i=this.hls;ok(t,this.initPTS[e.cc],t=>{this._appendCues(t,e.level),i.trigger(kg.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},t=>{i.logger.log(`Failed to parse IMSC1: ${t}`),i.trigger(kg.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})})}_parseVTTs(e){var t;const{frag:i,payload:s}=e,{initPTS:a,unparsedVttFrags:r}=this,n=a.length-1;if(!a[i.cc]&&-1===n)return void r.push(e);const o=this.hls;ik(null!=(t=i.initSegment)&&t.data?Pf(i.initSegment.data,new Uint8Array(s)).buffer:s,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,e=>{this._appendCues(e,i.level),o.trigger(kg.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},t=>{const a="Missing initPTS for VTT MPEGTS"===t.message;a?r.push(e):this._fallbackToIMSC1(i,s),o.logger.log(`Failed to parse VTT cue: ${t}`),a&&n>i.cc||o.trigger(kg.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:t})})}_fallbackToIMSC1(e,t){const i=this.tracks[e.level];i.textCodec||ok(t,this.initPTS[e.cc],()=>{i.textCodec=sk,this._parseIMSC1(e,t)},()=>{i.textCodec="wvtt"})}_appendCues(e,t){const i=this.hls;if(this.config.renderTextTracksNatively){const i=this.textTracks[t];if(!i||"disabled"===i.mode)return;e.forEach(e=>rx(i,e))}else{const s=this.tracks[t];if(!s)return;const a=s.default?"default":"subtitles"+t;i.trigger(kg.CUES_PARSED,{type:"subtitles",cues:e,track:a})}}onFragDecrypted(e,t){const{frag:i}=t;i.type===_g&&this.onFragLoaded(kg.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;const{frag:i,samples:s}=t;if(i.type!==Lg||"NONE"!==this.closedCaptionsForLevel(i))for(let e=0;e<s.length;e++){const t=s[e].bytes;if(t){this.cea608Parser1||this.initCea608Parsers();const i=this.extractCea608Data(t);this.cea608Parser1.addData(s[e].pts,i[0]),this.cea608Parser2.addData(s[e].pts,i[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:i,endOffsetSubtitles:s,type:a}){const{media:r}=this;if(r&&!(r.currentTime<i)){if(!a||"video"===a){const{captionsTracks:e}=this;Object.keys(e).forEach(s=>ox(e[s],t,i))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==s){const{textTracks:e}=this;Object.keys(e).forEach(i=>ox(e[i],t,s))}}}extractCea608Data(e){const t=[[],[]],i=31&e[0];let s=2;for(let a=0;a<i;a++){const i=e[s++],a=127&e[s++],r=127&e[s++];if(0===a&&0===r)continue;if(!!(4&i)){const e=3&i;0!==e&&1!==e||(t[e].push(a),t[e].push(r))}}return t}},audioStreamController:class extends Dy{constructor(e,t,i){super(e,t,i,"audio-stream-controller",Cg),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(kg.LEVEL_LOADED,this.onLevelLoaded,this),e.on(kg.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(kg.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(kg.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(kg.BUFFER_RESET,this.onBufferReset,this),e.on(kg.BUFFER_CREATED,this.onBufferCreated,this),e.on(kg.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(kg.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(kg.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(kg.FRAG_LOADING,this.onFragLoading,this),e.on(kg.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){const{hls:e}=this;e&&(super.unregisterListeners(),e.off(kg.LEVEL_LOADED,this.onLevelLoaded,this),e.off(kg.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(kg.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(kg.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(kg.BUFFER_RESET,this.onBufferReset,this),e.off(kg.BUFFER_CREATED,this.onBufferCreated,this),e.off(kg.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(kg.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(kg.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(kg.FRAG_LOADING,this.onFragLoading,this),e.off(kg.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:i,initPTS:s,timescale:a}){if(i===Lg){const e=t.cc,i=this.fragCurrent;if(this.initPTS[e]={baseTime:s,timescale:a},this.log(`InitPTS for cc: ${e} found from main: ${s}/${a}`),this.mainAnchor=t,this.state===Ry){const i=this.waitingData;(!i&&!this.loadingParts||i&&i.frag.cc!==e)&&this.syncWithAnchor(t,null==i?void 0:i.frag)}else!this.hls.hasEnoughToStart&&i&&i.cc!==e?(i.abortRequests(),this.syncWithAnchor(t,i)):this.state===ky&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var i;const s=(null==(i=this.mainFragLoading)?void 0:i.frag)||null;if(t&&(null==s?void 0:s.cc)===t.cc)return;const a=(s||e).cc,r=km(this.getLevelDetails(),a,this.getLoadPosition());r&&(this.log(`Waiting fragment cc (${null==t?void 0:t.cc}) cancelled because video is at cc ${e.cc}`),this.startFragRequested=!1,this.nextLoadPosition=r.start,this.resetLoadingState(),this.state===ky&&this.doTickIdle())}startLoad(e,t){if(!this.levels)return this.startPosition=e,void(this.state=xy);const i=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),i>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i,this.state=ky):this.state=Ty,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case ky:this.doTickIdle();break;case Ty:{const{levels:e,trackId:t}=this,i=null==e?void 0:e[t],s=null==i?void 0:i.details;if(s&&!this.waitForLive(i)){if(this.waitForCdnTuneIn(s))break;this.state=Ry}break}case Py:{var e;const t=performance.now(),i=this.retryDate;if(!i||t>=i||null!=(e=this.media)&&e.seeking){const{levels:e,trackId:t}=this;this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded((null==e?void 0:e[t])||null),this.state=ky}break}case Ry:{const e=this.waitingData;if(e){const{frag:t,part:i,cache:s,complete:a}=e,r=this.mainAnchor;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.state=Ey;const e={frag:t,part:i,payload:s.flush().buffer,networkDetails:null};this._handleFragmentLoadProgress(e),a&&super._handleFragmentLoadComplete(e)}else r&&r.cc!==e.frag.cc&&this.syncWithAnchor(r,e.frag)}else this.state=ky}}this.onTickEnd()}resetLoadingState(){const e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){const{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;const{hls:t,levels:i,media:s,trackId:a}=this,r=t.config;if(!this.buffering||!s&&!this.primaryPrefetch&&(this.startFragRequested||!r.startFragPrefetch)||null==i||!i[a])return;const n=i[a],o=n.details;if(!o||this.waitForLive(n)||this.waitForCdnTuneIn(o))return this.state=Ty,void(this.startFragRequested=!1);const d=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&d&&(this.bufferFlushed=!1,this.afterBufferFlushed(d,Xg,Cg));const l=this.getFwdBufferInfo(d,Cg);if(null===l)return;if(!this.switchingTrack&&this._streamEnded(l,o))return t.trigger(kg.BUFFER_EOS,{type:"audio"}),void(this.state=_y);const c=l.len,h=t.maxBufferLength,p=o.fragments,u=p[0].start,g=this.getLoadPosition(),f=this.flushing?g:l.end;if(this.switchingTrack&&s){const e=g;o.PTSKnown&&e<u&&(l.end>u||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),s.currentTime=u+.05)}if(c>=h&&!this.switchingTrack&&f<p[p.length-1].start)return;let m=this.getNextFragment(f,o);if(m&&this.isLoopLoading(m,f)&&(m=this.getNextFragmentLoopLoading(m,o,l,Lg,h)),!m)return void(this.bufferFlushed=!0);let v=(null==(e=this.mainFragLoading)?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&v&&sf(m)&&!m.endList&&(!o.live||!this.loadingParts&&f<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(v)===Nm&&(this.mainFragLoading=v=null),v&&sf(v))){if(m.start>v.end){const e=this.fragmentTracker.getFragAtPos(f,Lg);e&&e.end>v.end&&(v=e,this.mainFragLoading={frag:e,targetBufferTime:null})}if(m.start>v.end)return}this.loadFragment(m,n,f)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(e=>new nm(e))}onAudioTrackSwitching(e,t){const i=!!t.url;this.trackId=t.id;const{fragCurrent:s}=this;s&&(s.abortRequests(),this.removeUnbufferedFrags(s.start)),this.resetLoadingState(),i?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==xy&&(this.setInterval(100),this.state=ky,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;const i=this.cachedTrackLoadedData;i&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(kg.AUDIO_TRACK_LOADED,i))}onAudioTrackLoaded(e,t){var i;const{levels:s}=this,{details:a,id:r,groupId:n,track:o}=t;if(!s)return void this.warn(`Audio tracks reset while loading track ${r} "${o.name}" of "${n}"`);const d=this.mainDetails;if(!d||a.endCC>d.endCC||d.expired)return this.cachedTrackLoadedData=t,void(this.state!==xy&&(this.state=Ty));this.cachedTrackLoadedData=null,this.log(`Audio track ${r} "${o.name}" of "${n}" loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""},duration:${a.totalduration}`);const l=s[r];let c=0;if(a.live||null!=(i=l.details)&&i.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;var h;if(l.details)c=this.alignPlaylists(a,l.details,null==(h=this.levelLastLoaded)?void 0:h.details);a.alignedSliding||(yy(a,d),a.alignedSliding||by(a,d),c=a.fragmentStart)}l.details=a,this.levelLastLoaded=l,this.startFragRequested||this.setStartPosition(d,c),this.hls.trigger(kg.AUDIO_TRACK_UPDATED,{details:a,id:r,groupId:t.groupId}),this.state!==Ty||this.waitForCdnTuneIn(a)||(this.state=ky),this.tick()}_handleFragmentLoadProgress(e){var t;const i=e.frag,{part:s,payload:a}=e,{config:r,trackId:n,levels:o}=this;if(!o)return void this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const d=o[n];if(!d)return void this.warn("Audio track is undefined on fragment load progress");const l=d.details;if(!l)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(i.start);const c=r.defaultAudioCodec||d.audioCodec||"mp4a.40.2";let h=this.transmuxer;h||(h=this.transmuxer=new lw(this.hls,Cg,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));const p=this.initPTS[i.cc],u=null==(t=i.initSegment)?void 0:t.data;if(void 0!==p){const e=!1,t=s?s.index:-1,r=-1!==t,n=new iv(i.level,i.sn,i.stats.chunkCount,a.byteLength,t,r);h.push(a,u,c,"",i,s,l.totalduration,e,n,p)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${l.startSN} ,${l.endSN}],track ${n}`);const{cache:e}=this.waitingData=this.waitingData||{frag:i,part:s,cache:new Oy,complete:!1};e.push(new Uint8Array(a)),this.state!==xy&&(this.state=Ry)}}_handleFragmentLoadComplete(e){this.waitingData?this.waitingData.complete=!0:super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;const i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===Lg&&sf(t.frag)&&(this.mainFragLoading=t,this.state===ky&&this.tick())}onFragBuffered(e,t){const{frag:i,part:s}=t;if(i.type===Cg)if(this.fragContextChanged(i))this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);else{if(sf(i)){this.fragPrevious=i;const e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(kg.AUDIO_TRACK_SWITCHED,Og({},e)))}this.fragBufferedComplete(i,s),this.media&&this.tick()}else this.audioOnly||i.type!==Lg||i.elementaryStreams.video||i.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null)}onError(e,t){var i;if(t.fatal)this.state=Ay;else switch(t.details){case xg.FRAG_GAP:case xg.FRAG_PARSING_ERROR:case xg.FRAG_DECRYPT_ERROR:case xg.FRAG_LOAD_ERROR:case xg.FRAG_LOAD_TIMEOUT:case xg.KEY_LOAD_ERROR:case xg.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Cg,t);break;case xg.AUDIO_TRACK_LOAD_ERROR:case xg.AUDIO_TRACK_LOAD_TIMEOUT:case xg.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Ty||(null==(i=t.context)?void 0:i.type)!==Pg||(this.state=ky);break;case xg.BUFFER_ADD_CODEC_ERROR:case xg.BUFFER_APPEND_ERROR:if("audio"!==t.parent)return;this.resetLoadingState();break;case xg.BUFFER_FULL_ERROR:if("audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case xg.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushing(e,{type:t}){t!==Jg&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==Jg){this.flushing=!1,this.bufferFlushed=!0,this.state===_y&&(this.state=ky);const e=this.mediaBuffer||this.media;e&&(this.afterBufferFlushed(e,t,Cg),this.tick())}}_handleTransmuxComplete(e){var t;const i="audio",{hls:s}=this,{remuxResult:a,chunkMeta:r}=e,n=this.getCurrentContext(r);if(!n)return void this.resetWhenMissingContext(r);const{frag:o,part:d,level:l}=n,{details:c}=l,{audio:h,text:p,id3:u,initSegment:g}=a;if(!this.fragContextChanged(o)&&c){if(this.state=Ly,this.switchingTrack&&h&&this.completeAudioSwitch(this.switchingTrack),null!=g&&g.tracks){const e=o.initSegment||o;this._bufferInitSegment(l,g.tracks,e,r),s.trigger(kg.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:i,tracks:g.tracks})}if(h){const{startPTS:e,endPTS:t,startDTS:i,endDTS:s}=h;d&&(d.elementaryStreams[Xg]={startPTS:e,endPTS:t,startDTS:i,endDTS:s}),o.setElementaryStreamInfo(Xg,e,t,i,s),this.bufferFragmentData(h,o,d,r)}if(null!=u&&null!=(t=u.samples)&&t.length){const e=Dg({id:i,frag:o,details:c},u);s.trigger(kg.FRAG_PARSING_METADATA,e)}if(p){const e=Dg({id:i,frag:o,details:c},p);s.trigger(kg.FRAG_PARSING_USERDATA,e)}}else this.fragmentTracker.removeFragment(o)}_bufferInitSegment(e,t,i,s){if(this.state!==Ly)return;if(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio)return;const a=t.audio;a.id=Cg;const r=e.audioCodec;this.log(`Init audio buffer, container:${a.container}, codecs[level/parsed]=[${r}/${a.codec}]`),r&&1===r.split(",").length&&(a.levelCodec=r),this.hls.trigger(kg.BUFFER_CODECS,t);const n=a.initSegment;if(null!=n&&n.byteLength){const e={type:"audio",frag:i,part:null,chunkMeta:s,parent:i.type,data:n};this.hls.trigger(kg.BUFFER_APPENDING,e)}this.tickImmediate()}loadFragment(e,t,i){const s=this.fragmentTracker.getState(e);var a;if(this.switchingTrack||s===Um||s===Fm)if(sf(e))if(null!=(a=t.details)&&a.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Ry;const i=this.mainDetails;i&&i.fragmentStart!==t.details.fragmentStart&&by(t.details,i)}else super.loadFragment(e,t,i);else this._loadInitSegment(e,t);else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){const{name:t,lang:i,assocLang:s,characteristics:a,audioCodec:r,channels:n}=this.bufferedTrack;gm({name:t,lang:i,assocLang:s,characteristics:a,audioCodec:r,channels:n},e,fm)||(vm(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){const{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(kg.AUDIO_TRACK_SWITCHED,Og({},e))}},audioTrackController:class extends cw{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){const{hls:e}=this;e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.on(kg.LEVEL_LOADING,this.onLevelLoading,this),e.on(kg.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(kg.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(kg.ERROR,this.onError,this)}unregisterListeners(){const{hls:e}=this;e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.off(kg.LEVEL_LOADING,this.onLevelLoading,this),e.off(kg.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(kg.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(kg.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){const{id:i,groupId:s,details:a}=t,r=this.tracksInGroup[i];if(!r||r.groupId!==s)return void this.warn(`Audio track with id:${i} and group:${s} not found in active group ${null==r?void 0:r.groupId}`);const n=r.details;r.details=t.details,this.log(`Audio track ${i} "${r.name}" lang:${r.lang} group:${s} loaded [${a.startSN}-${a.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,n)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){const t=this.hls.levels[e];if(!t)return;const i=t.audioGroups||null,s=this.groupIds;let a=this.currentTrack;if(!i||(null==s?void 0:s.length)!==(null==i?void 0:i.length)||null!=i&&i.some(e=>-1===(null==s?void 0:s.indexOf(e)))){this.groupIds=i,this.trackId=-1,this.currentTrack=null;const e=this.tracks.filter(e=>!i||-1!==i.indexOf(e.groupId));if(e.length)this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),e.forEach((e,t)=>{e.id=t});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=e;const t=this.hls.config.audioPreference;if(!a&&t){const i=um(t,e,fm);if(i>-1)a=e[i];else{const e=um(t,this.tracks);a=this.tracks[e]}}let s=this.findTrackId(a);-1===s&&a&&(s=this.findTrackId(null));const n={audioTracks:e};this.log(`Updating audio tracks, ${e.length} track(s) found in group(s): ${null==i?void 0:i.join(",")}`),this.hls.trigger(kg.AUDIO_TRACKS_UPDATED,n);const o=this.trackId;if(-1!==s&&-1===o)this.setAudioTrack(s);else if(e.length&&-1===o){var r;const t=new Error(`No audio track selected for current audio group-ID(s): ${null==(r=this.groupIds)?void 0:r.join(",")} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}}onError(e,t){!t.fatal&&t.context&&(t.context.type!==Pg||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){const t=this.hls;if(t.config.audioPreference=e,e){const i=this.allAudioTracks;if(this.selectDefaultTrack=!1,i.length){const s=this.currentTrack;if(s&&gm(e,s,fm))return s;const a=um(e,this.tracksInGroup,fm);if(a>-1){const e=this.tracksInGroup[a];return this.setAudioTrack(a),e}if(s){let s=t.loadLevel;-1===s&&(s=t.firstAutoLevel);const a=function(e,t,i,s,a){const r=t[s],n=t.reduce((e,t,i)=>{const s=t.uri;return(e[s]||(e[s]=[])).push(i),e},{}),o=n[r.uri];o.length>1&&(s=Math.max.apply(Math,o));const d=r.videoRange,l=r.frameRate,c=r.codecSet.substring(0,4),h=mm(t,s,t=>{if(t.videoRange!==d||t.frameRate!==l||t.codecSet.substring(0,4)!==c)return!1;const s=t.audioGroups,r=i.filter(e=>!s||-1!==s.indexOf(e.groupId));return um(e,r,a)>-1});return h>-1?h:mm(t,s,t=>{const s=t.audioGroups,r=i.filter(e=>!s||-1!==s.indexOf(e.groupId));return um(e,r,a)>-1})}(e,t.levels,i,s,fm);if(-1===a)return null;t.nextLoadLevel=a}if(e.channels||e.audioCodec){const t=um(e,i);if(t>-1)return i[t]}}}return null}setAudioTrack(e){const t=this.tracksInGroup;if(e<0||e>=t.length)return void this.warn(`Invalid audio track id: ${e}`);this.selectDefaultTrack=!1;const i=this.currentTrack,s=t[e],a=s.details&&!s.details.live;if(e===this.trackId&&s===i&&a)return;if(this.log(`Switching to audio-track ${e} "${s.name}" lang:${s.lang} group:${s.groupId} channels:${s.channels}`),this.trackId=e,this.currentTrack=s,this.hls.trigger(kg.AUDIO_TRACK_SWITCHING,Og({},s)),a)return;const r=this.switchParams(s.url,null==i?void 0:i.details,s.details);this.loadPlaylist(r)}findTrackId(e){const t=this.tracksInGroup;for(let i=0;i<t.length;i++){const s=t[i];if((!this.selectDefaultTrack||s.default)&&(!e||gm(e,s,fm)))return i}if(e){const{name:i,lang:s,assocLang:a,characteristics:r,audioCodec:n,channels:o}=e;for(let e=0;e<t.length;e++){if(gm({name:i,lang:s,assocLang:a,characteristics:r,audioCodec:n,channels:o},t[e],fm))return e}for(let i=0;i<t.length;i++){const s=t[i];if(pw(e.attrs,s.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<t.length;i++){const s=t[i];if(pw(e.attrs,s.attrs,["LANGUAGE"]))return i}}return-1}loadPlaylist(e){super.loadPlaylist();const t=this.currentTrack;this.shouldLoadPlaylist(t)&&vm(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=e.id,s=e.groupId,a=this.getUrlWithDirectives(e.url,t),r=e.details,n=null==r?void 0:r.age;this.log(`Loading audio-track ${i} "${e.name}" lang:${e.lang} group:${s}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${n&&r.live?" age "+n.toFixed(1)+(r.type&&" "+r.type||""):""} ${a}`),this.hls.trigger(kg.AUDIO_TRACK_LOADING,{url:a,id:i,groupId:s,deliveryDirectives:t||null,track:e})}},emeController:ix,cmcdController:class{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:xw.MANIFEST,su:!this.initialized})}catch(e){this.hls.logger.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=e=>{try{const{frag:t,part:i}=e,s=this.hls.levels[t.level],a=this.getObjectType(t),r={d:1e3*(i||t).duration,ot:a};a!==xw.VIDEO&&a!==xw.AUDIO&&a!=xw.MUXED||(r.br=s.bitrate/1e3,r.tb=this.getTopBandwidth(a)/1e3,r.bl=this.getBufferLength(a));const n=i?this.getNextPart(i):this.getNextFrag(t);null!=n&&n.url&&n.url!==t.url&&(r.nor=n.url),this.apply(e,r)}catch(e){this.hls.logger.warn("Could not generate segment CMCD data.",e)}},this.hls=e;const t=this.config=e.config,{cmcd:i}=t;null!=i&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||e.sessionId,this.cid=i.contentId,this.useHeaders=!0===i.useHeaders,this.includeKeys=i.includeKeys,this.registerListeners())}registerListeners(){const e=this.hls;e.on(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(kg.MEDIA_DETACHED,this.onMediaDetached,this),e.on(kg.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){const e=this.hls;e.off(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(kg.MEDIA_DETACHED,this.onMediaDetached,this),e.off(kg.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var i,s;this.audioBuffer=null==(i=t.tracks.audio)?void 0:i.buffer,this.videoBuffer=null==(s=t.tracks.video)?void 0:s.buffer}createData(){var e;return{v:1,sf:kw.HLS,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){Dg(t,this.createData());const i=t.ot===xw.INIT||t.ot===xw.VIDEO||t.ot===xw.MUXED;this.starved&&i&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);const{includeKeys:s}=this;s&&(t=Object.keys(t).reduce((e,i)=>(s.includes(i)&&(e[i]=t[i]),e),{}));const a={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),Ww(e.headers,t,a)):e.url=Qw(e.url,t,a)}getNextFrag(e){var t;const i=null==(t=this.hls.levels[e.level])?void 0:t.details;if(i){const t=e.sn-i.startSN;return i.fragments[t+1]}}getNextPart(e){var t,i;const{index:s,fragment:a}=e,r=null==(t=this.hls.levels[a.level])||null==(i=t.details)?void 0:i.partList;if(r){const{sn:e}=a;for(let t=r.length-1;t>=0;t--){const i=r[t];if(i.index===s&&i.fragment.sn===e)return r[t+1]}}}getObjectType(e){const{type:t}=e;return"subtitle"===t?xw.TIMED_TEXT:"initSegment"===e.sn?xw.INIT:"audio"===t?xw.AUDIO:"main"===t?this.hls.audioTracks.length?xw.VIDEO:xw.MUXED:void 0}getTopBandwidth(e){let t,i=0;const s=this.hls;if(e===xw.AUDIO)t=s.audioTracks;else{const e=s.maxAutoLevel,i=e>-1?e+1:s.levels.length;t=s.levels.slice(0,i)}return t.forEach(e=>{e.bitrate>i&&(i=e.bitrate)}),i>0?i:NaN}getBufferLength(e){const t=this.media,i=e===xw.AUDIO?this.audioBuffer:this.videoBuffer;if(!i||!t)return NaN;return 1e3*av.bufferInfo(i,t.currentTime,this.config.maxBufferHole).len}createPlaylistLoader(){const{pLoader:e}=this.config,t=this.applyPlaylistData,i=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new i(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,i,s){t(e),this.loader.load(e,i,s)}}}createFragmentLoader(){const{fLoader:e}=this.config,t=this.applyFragmentData,i=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new i(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,i,s){t(e),this.loader.load(e,i,s)}}}},contentSteeringController:class extends Ug{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){const e=this.hls;e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.on(kg.ERROR,this.onError,this)}unregisterListeners(){const e=this.hls;e&&(e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.off(kg.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){const e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){const t=this.levels;t&&(this.levels=t.filter(t=>t!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){const{contentSteering:i}=t;null!==i&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){const{errorAction:i}=t;if((null==i?void 0:i.action)===_m&&i.flags===Dm){const e=this.levels;let s=this._pathwayPriority,a=this.pathwayId;if(t.context){const{groupId:i,pathwayId:s,type:r}=t.context;i&&e?a=this.getPathwayForGroupId(i,r,a):s&&(a=s)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!s&&e&&(s=this.pathways()),s&&s.length>1&&(this.updatePathwayPriority(s),i.resolved=this.pathwayId!==a),i.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${a} levels: ${e?e.length:e} priorities: ${lm(s)} penalized: ${lm(this.penalizedPathways)}`)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){const i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),t=this.getLevelsForPathway(i),this.pathwayId=i}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){let t;this._pathwayPriority=e;const i=this.penalizedPathways,s=performance.now();Object.keys(i).forEach(e=>{s-i[e]>3e5&&delete i[e]});for(let s=0;s<e.length;s++){const a=e[s];if(a in i)continue;if(a===this.pathwayId)return;const r=this.hls.nextLoadLevel,n=this.hls.levels[r];if(t=this.getLevelsForPathway(a),t.length>0){this.log(`Setting Pathway to "${a}"`),this.pathwayId=a,gy(t),this.hls.trigger(kg.LEVELS_UPDATED,{levels:t});const e=this.hls.levels[r];n&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==n.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==n.bitrate&&this.log(`Unstable Pathways change from bitrate ${n.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=r);break}}}getPathwayForGroupId(e,t,i){const s=this.getLevelsForPathway(i).concat(this.levels||[]);for(let i=0;i<s.length;i++)if(t===Pg&&s[i].hasAudioGroup(e)||t===Tg&&s[i].hasSubtitleGroup(e))return s[i].pathwayId;return i}clonePathways(e){const t=this.levels;if(!t)return;const i={},s={};e.forEach(e=>{const{ID:a,"BASE-ID":r,"URI-REPLACEMENT":n}=e;if(t.some(e=>e.pathwayId===a))return;const o=this.getLevelsForPathway(r).map(e=>{const t=new pv(e.attrs);t["PATHWAY-ID"]=a;const r=t.AUDIO&&`${t.AUDIO}_clone_${a}`,o=t.SUBTITLES&&`${t.SUBTITLES}_clone_${a}`;r&&(i[t.AUDIO]=r,t.AUDIO=r),o&&(s[t.SUBTITLES]=o,t.SUBTITLES=o);const d=Jw(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",n),l=new nm({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:d,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(let t=1;t<e.audioGroups.length;t++)l.addGroupId("audio",`${e.audioGroups[t]}_clone_${a}`);if(e.subtitleGroups)for(let t=1;t<e.subtitleGroups.length;t++)l.addGroupId("text",`${e.subtitleGroups[t]}_clone_${a}`);return l});t.push(...o),Xw(this.audioTracks,i,n,a),Xw(this.subtitleTracks,s,n,a)})}loadSteeringManifest(e){const t=this.hls.config,i=t.loader;let s;this.loader&&this.loader.destroy(),this.loader=new i(t);try{s=new self.URL(e)}catch(t){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest URI: ${e}`)}if("data:"!==s.protocol){const e=0|(this.hls.bandwidthEstimate||t.abrEwmaDefaultEstimate);s.searchParams.set("_HLS_pathway",this.pathwayId),s.searchParams.set("_HLS_throughput",""+e)}const a={responseType:"json",url:s.href},r=t.steeringManifestLoadPolicy.default,n=r.errorRetry||r.timeoutRetry||{},o={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:n.maxNumRetry||0,retryDelay:n.retryDelayMs||0,maxRetryDelay:n.maxRetryDelayMs||0},d={onSuccess:(e,t,i,a)=>{this.log(`Loaded steering manifest: "${s}"`);const r=e.data;if(1!==(null==r?void 0:r.VERSION))return void this.log(`Steering VERSION ${r.VERSION} not supported!`);this.updated=performance.now(),this.timeToLoad=r.TTL;const{"RELOAD-URI":n,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":d}=r;if(n)try{this.uri=new self.URL(n,s).href}catch(e){return this.enabled=!1,void this.log(`Failed to parse Steering Manifest RELOAD-URI: ${n}`)}this.scheduleRefresh(this.uri||i.url),o&&this.clonePathways(o);const l={steeringManifest:r,url:s.toString()};this.hls.trigger(kg.STEERING_MANIFEST_LOADED,l),d&&this.updatePathwayPriority(d)},onError:(e,t,i,s)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code)return this.enabled=!1,void this.log(`Steering manifest ${t.url} no longer available`);let a=1e3*this.timeToLoad;if(429===e.code){const e=this.loader;if("function"==typeof(null==e?void 0:e.getResponseHeader)){const t=e.getResponseHeader("Retry-After");t&&(a=1e3*parseFloat(t))}return void this.log(`Steering manifest ${t.url} rate limited`)}this.scheduleRefresh(this.uri||t.url,a)},onTimeout:(e,t,i)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}};this.log(`Requesting steering manifest: ${s}`),this.loader.load(a,o,d)}scheduleRefresh(e,t=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=self.setTimeout(()=>{var t;const i=null==(t=this.hls)?void 0:t.media;!i||i.ended?this.scheduleRefresh(e,1e3*this.timeToLoad):this.loadSteeringManifest(e)},t)}},interstitialsController:class extends Ug{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{const e=this.currentTime;if(void 0===e||this.playbackDisabled)return;const t=e-this.timelinePos;if(Math.abs(t)<1/7056e5)return;const i=t<=-.01;this.timelinePos=e,this.bufferedPos=e;const s=this.playingItem;if(!s)return void this.checkBuffer();if(i){this.schedule.resetErrorsInRange(e,e-t)&&this.updateSchedule()}if(this.checkBuffer(),i&&e<s.start||e>=s.end){var a;const e=this.schedule.findItemIndexAtTime(this.timelinePos);if(!this.isInterstitial(s)&&null!=(a=this.media)&&a.paused&&(this.shouldPlay=!1),!i){const t=this.findItemIndex(s);if(e>t){const i=this.schedule.findJumpRestrictedIndex(t+1,e);if(i>t)return void this.setSchedulePosition(i)}}return void this.setSchedulePosition(e)}const r=this.playingAsset;if(!r){if(this.playingLastItem&&this.isInterstitial(s)){const t=s.event.assetList[0];t&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(e,t))}return}const n=r.timelineStart,o=r.duration||0;(i&&e<n||e>=n+o)&&this.setScheduleToAssetAtTime(e,r)},this.onTimeupdate=()=>{const e=this.currentTime;if(void 0===e||this.playbackDisabled)return;if(!(e>this.timelinePos))return;this.timelinePos=e,e>this.bufferedPos&&this.checkBuffer();const t=this.playingItem;if(!t||this.playingLastItem)return;if(e>=t.end){this.timelinePos=t.end;const e=this.findItemIndex(t);this.setSchedulePosition(e+1)}const i=this.playingAsset;if(!i)return;e>=i.timelineStart+(i.duration||0)&&this.setScheduleToAssetAtTime(e,i)},this.onScheduleUpdate=(e,t)=>{const i=this.schedule,s=this.playingItem,a=i.events||[],r=i.items||[],n=i.durations,o=e.map(e=>e.identifier),d=!(!a.length&&!o.length);(d||t)&&this.log(`INTERSTITIALS_UPDATED (${a.length}): ${a}\nSchedule: ${r.map(e=>wx(e))} pos: ${this.timelinePos}`),o.length&&this.log(`Removed events ${o}`),this.playerQueue.forEach(e=>{if(e.interstitial.appendInPlace){const t=e.assetItem.timelineStart,i=e.timelineOffset-t;if(i)try{e.timelineOffset=t}catch(s){Math.abs(i)>cx&&this.warn(`${s} ("${e.assetId}" ${e.timelineOffset}->${t})`)}}});let l=null;if(s){const e=this.updateItem(s,this.timelinePos);this.itemsMatch(s,e)&&(this.playingItem=e,this.waitingItem=this.endedItem=null,l=()=>this.trimInPlace(e,s))}else this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);const c=this.bufferingItem;if(c){const e=this.updateItem(c,this.bufferedPos);this.itemsMatch(c,e)?(this.bufferingItem=e,l||(l=()=>this.trimInPlace(e,c))):c.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(c.event,null))}if(e.forEach(e=>{e.assetList.forEach(e=>{this.clearAssetPlayer(e.identifier,null)})}),d||t){if(this.hls.trigger(kg.INTERSTITIALS_UPDATED,{events:a.slice(0),schedule:r.slice(0),durations:n,removedIds:o}),this.isInterstitial(s)&&o.includes(s.event.identifier))return this.warn(`Interstitial "${s.event.identifier}" removed while playing`),void this.primaryFallback(s.event);l&&l(),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new xx(e),this.schedule=new bx(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){const e=this.hls;e.on(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(kg.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(kg.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(kg.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(kg.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(kg.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(kg.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(kg.BUFFER_APPENDED,this.onBufferAppended,this),e.on(kg.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(kg.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(kg.MEDIA_ENDED,this.onMediaEnded,this),e.on(kg.ERROR,this.onError,this),e.on(kg.DESTROYING,this.onDestroying,this)}unregisterListeners(){const e=this.hls;e&&(e.off(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(kg.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(kg.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(kg.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(kg.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(kg.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(kg.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(kg.BUFFER_CODECS,this.onBufferCodecs,this),e.off(kg.BUFFER_APPENDED,this.onBufferAppended,this),e.off(kg.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(kg.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(kg.MEDIA_ENDED,this.onMediaEnded,this),e.off(kg.ERROR,this.onError,this),e.off(kg.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;null==(e=this.getBufferingPlayer())||e.resumeBuffering()}pauseBuffering(){var e;null==(e=this.getBufferingPlayer())||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.manager=null,this.hls=this.HlsPlayerClass=this.schedule=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){const e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){tx(e,"play",this.onPlay),tx(e,"pause",this.onPause),tx(e,"seeking",this.onSeeking),tx(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){const i=this.media=t.media;ex(i,"seeking",this.onSeeking),ex(i,"timeupdate",this.onTimeupdate),ex(i,"play",this.onPlay),ex(i,"pause",this.onPause)}onMediaAttached(e,t){const i=this.effectivePlayingItem,s=this.detachedData;if(this.detachedData=null,null===i)this.checkStart();else if(!s){this.clearScheduleState();const e=this.findItemIndex(i);this.setSchedulePosition(e)}}clearScheduleState(){this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){const i=!!t.transferMedia,s=this.media;if(this.media=null,!i&&(s&&this.removeMediaListeners(s),this.detachedData)){const e=this.getBufferingPlayer();e&&(this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,e.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.manager){if(!this.hls)return null;const e=this,t=()=>e.bufferingItem||e.waitingItem,i=t=>t?e.getAssetPlayer(t.identifier):t,s=(t,s,a,n,o)=>{if(t){let d=t[s].start;const l=t.event;if(l){if("playout"===s||l.timelineOccupancy!==hx.Point){const e=i(a);(null==e?void 0:e.interstitial)===l&&(d+=e.assetItem.startOffset+e[o])}}else{d+=("bufferedPos"===n?r():e[n])-t.start}return d}return 0},a=(t,i)=>{if(0!==t&&"primary"!==i&&e.schedule.length){var s;const a=e.schedule.findItemIndexAtTime(t),r=null==(s=e.schedule.items)?void 0:s[a];if(r){return t+(r[i].start-r.start)}}return t},r=()=>{const t=e.bufferedPos;return t===Number.MAX_VALUE?n("primary"):Math.max(t,0)},n=t=>{var i;return null!=(i=e.primaryDetails)&&i.live?e.primaryDetails.edge:e.schedule.durations[t]},o=(t,a)=>{var r,n;const o=e.effectivePlayingItem;if(null!=o&&null!=(r=o.event)&&r.restrictions.skip)return;e.log(`seek to ${t} "${a}"`);const d=e.effectivePlayingItem,l=e.schedule.findItemIndexAtTime(t,a),c=null==(n=e.schedule.items)?void 0:n[l],h=e.getBufferingPlayer(),p=null==h?void 0:h.interstitial,u=null==p?void 0:p.appendInPlace,g=d&&e.itemsMatch(d,c);if(d&&(u||g)){const r=i(e.playingAsset),n=(null==r?void 0:r.media)||e.primaryMedia;if(n){const i="primary"===a?n.currentTime:s(d,a,e.playingAsset,"timelinePos","currentTime"),o=t-i,l=(u?i:n.currentTime)+o;if(l>=0&&(!r||u||l<=r.duration))return void(n.currentTime=l)}}if(c){let i=t;if("primary"!==a){const e=t-c[a].start;i=c.start+e}const s=!e.isInterstitial(c);if(e.isInterstitial(d)&&!d.event.appendInPlace||!s&&!c.event.appendInPlace){if(d){const r=e.findItemIndex(d);if(l>r){const t=e.schedule.findJumpRestrictedIndex(r+1,l);if(t>r)return void e.setSchedulePosition(t)}let n=0;if(s)e.timelinePos=i,e.checkBuffer();else{var f;const e=null==c||null==(f=c.event)?void 0:f.assetList;if(e){const i=t-(c[a]||c).start;for(let t=e.length;t--;){const s=e[t];if(s.duration&&i>=s.startOffset&&i<s.startOffset+s.duration){n=t;break}}}}e.setSchedulePosition(l,n)}}else{const t=e.media||(u?null==h?void 0:h.media:null);t&&(t.currentTime=i)}}},d=()=>{const i=e.effectivePlayingItem;if(e.isInterstitial(i))return i;const s=t();return e.isInterstitial(s)?s:null},l={get currentTime(){const t=d(),i=e.effectivePlayingItem;return i&&i===t?s(i,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-i.playout.start:0},set currentTime(t){const i=d(),s=e.effectivePlayingItem;s&&s===i&&o(t+s.playout.start,"playout")},get duration(){const e=d();return e?e.playout.end-e.playout.start:0},get assetPlayers(){var t;const i=null==(t=d())?void 0:t.event.assetList;return i?i.map(t=>e.getAssetPlayer(t.identifier)):[]},get playingIndex(){var t;const i=null==(t=d())?void 0:t.event;return i&&e.effectivePlayingAsset?i.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return d()}};this.manager={get events(){var t,i;return(null==(t=e.schedule)||null==(i=t.events)?void 0:i.slice(0))||[]},get schedule(){var t,i;return(null==(t=e.schedule)||null==(i=t.items)?void 0:i.slice(0))||[]},get interstitialPlayer(){return d()?l:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){const i=t();return e.findItemIndex(i)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){const t=e.effectivePlayingItem;return e.findItemIndex(t)},primary:{get bufferedEnd(){return r()},get currentTime(){const t=e.timelinePos;return t>0?t:0},set currentTime(e){o(e,"primary")},get duration(){return n("primary")},get seekableStart(){var t;return(null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0}},integrated:{get bufferedEnd(){return s(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return s(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(e){o(e,"integrated")},get duration(){return n("integrated")},get seekableStart(){var t;return a((null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0,"integrated")}},skip:()=>{const t=e.effectivePlayingItem,i=null==t?void 0:t.event;if(i&&!i.restrictions.skip){const s=e.findItemIndex(t);if(i.appendInPlace){const e=t.playout.start+t.event.duration;o(e+.001,"playout")}else e.advanceAfterAssetEnded(i,s,1/0)}}}}return this.manager}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;const t=this.playingItem,i=null==(e=this.schedule)?void 0:e.items;return!!(this.playbackStarted&&t&&i)&&this.findItemIndex(t)===i.length-1}get playbackStarted(){return null!==this.effectivePlayingItem}get currentTime(){var e,t,i;if(null===this.mediaSelection)return;const s=this.waitingItem||this.playingItem;if(this.isInterstitial(s)&&!s.event.appendInPlace)return;let a=this.media;!a&&null!=(e=this.bufferingItem)&&null!=(t=e.event)&&t.appendInPlace&&(a=this.primaryMedia);const r=null==(i=a)?void 0:i.currentTime;return void 0!==r&&vg(r)?r:void 0}get primaryMedia(){var e;return this.media||(null==(e=this.detachedData)?void 0:e.media)||null}isInterstitial(e){return!(null==e||!e.event)}retreiveMediaSource(e,t){const i=this.getAssetPlayer(e);i&&this.transferMediaFromPlayer(i,t)}transferMediaFromPlayer(e,t){const i=e.interstitial.appendInPlace,s=e.media;if(i&&s===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&s)return void(this.detachedData={media:s});const i=e.transferMedia();this.log(`transfer MediaSource from ${e} ${lm(i)}`),this.detachedData=i}else t&&s&&(this.shouldPlay||(this.shouldPlay=!s.paused))}transferMediaTo(e,t){var i,s;if(e.media===t)return;let a=null;const r=this.hls,n=e!==r,o=n&&e.interstitial.appendInPlace,d=null==(i=this.detachedData)?void 0:i.mediaSource;let l;if(r.media)o&&(a=r.transferMedia(),this.detachedData=a),l="Primary";else if(d){const e=this.getBufferingPlayer();e?(a=e.transferMedia(),l=`${e}`):l="detached MediaSource"}else l="detached media";if(!a)if(d)a=this.detachedData,this.log(`using detachedData: MediaSource ${lm(a)}`);else if(!this.detachedData||r.media===t){const e=this.playerQueue;e.length>1&&e.forEach(e=>{if(n&&e.interstitial.appendInPlace!==o){const t=e.interstitial;this.clearInterstitial(e.interstitial,null),t.appendInPlace=!1,t.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${t}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}const c=a&&"mediaSource"in a&&"closed"!==(null==(s=a.mediaSource)?void 0:s.readyState),h=c&&a?a:t;if(this.log(`${c?"transfering MediaSource":"attaching media"} to ${n?e:"Primary"} from ${l}`),h===a){const t=n&&e.assetId===this.schedule.assetIdAtEnd;h.overrides={duration:this.schedule.duration,endOfStream:!n||t,cueRemoval:!n}}e.attachMedia(h)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){const e=this.schedule,t=e.events;if(!t||this.playbackDisabled||!this.media)return;-1===this.bufferedPos&&(this.bufferedPos=0);const i=this.timelinePos,s=this.effectivePlayingItem;if(-1===i){const i=this.hls.startPosition;if(this.timelinePos=i,t.length&&t[0].cue.pre){const i=e.findEventIndex(t[0].identifier);this.setSchedulePosition(i)}else if(i>=0||!this.primaryLive){const t=this.timelinePos=i>0?i:0,s=e.findItemIndexAtTime(t);this.setSchedulePosition(s)}}else if(s&&!this.playingItem){const t=e.findItemIndex(s);this.setSchedulePosition(t)}}advanceAfterAssetEnded(e,t,i){const s=mx(e,i);if(e.isAssetPastPlayoutLimit(s)){const i=this.schedule.items;if(i){const s=t+1;if(s>=i.length)return void this.setSchedulePosition(-1);const a=e.resumeTime;this.timelinePos<a&&(this.timelinePos=a,this.checkBuffer()),this.setSchedulePosition(s)}}else this.setSchedulePosition(t,s)}setScheduleToAssetAtTime(e,t){const i=this.schedule,s=t.parentIdentifier,a=i.getEvent(s);if(a){const t=i.findEventIndex(s),r=i.findAssetIndex(a,e);this.advanceAfterAssetEnded(a,t,r-1)}}setSchedulePosition(e,t){const i=this.schedule.items;if(!i||this.playbackDisabled)return;this.log(`setSchedulePosition ${e}, ${t}`);const s=e>=0?i[e]:null,a=this.playingItem,r=this.playingLastItem;if(this.isInterstitial(a)){var n;const d=a.event,l=this.playingAsset,c=null==l?void 0:l.identifier,h=c?this.getAssetPlayer(c):null;if(h&&c&&(!this.eventItemsMatch(a,s)||void 0!==t&&c!==(null==(n=d.assetList)?void 0:n[t].identifier))){var o;const t=d.findAssetIndex(l);this.log(`INTERSTITIAL_ASSET_ENDED ${t+1}/${d.assetList.length} ${vx(l)}`),this.endedAsset=l,this.playingAsset=null,this.hls.trigger(kg.INTERSTITIAL_ASSET_ENDED,{asset:l,assetListIndex:t,event:d,schedule:i.slice(0),scheduleIndex:e,player:h}),this.retreiveMediaSource(c,s),!h.media||null!=(o=this.detachedData)&&o.mediaSource||h.detachMedia()}if(!this.eventItemsMatch(a,s)&&(this.endedItem=a,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${d} ${wx(a)}`),d.hasPlayed=!0,this.hls.trigger(kg.INTERSTITIAL_ENDED,{event:d,schedule:i.slice(0),scheduleIndex:e}),d.cue.once)){this.updateSchedule();const e=this.schedule.items;if(s&&e){const i=this.schedule.findItemIndex(s);this.advanceSchedule(i,e,t,a,r)}return}}this.advanceSchedule(e,i,t,a,r)}advanceSchedule(e,t,i,s,a){const r=e>=0?t[e]:null,n=this.primaryMedia,o=this.playerQueue;if(o.length&&o.forEach(t=>{const i=t.interstitial,s=this.schedule.findEventIndex(i.identifier);(s<e||s>e+1)&&this.clearInterstitial(i,r)}),this.isInterstitial(r)){this.timelinePos=Math.min(Math.max(this.timelinePos,r.start),r.end);const a=r.event;if(void 0===i){const t=mx(a,(i=this.schedule.findAssetIndex(a,this.timelinePos))-1);if(a.isAssetPastPlayoutLimit(t))return void this.advanceAfterAssetEnded(a,e,i);i=t}const o=this.waitingItem;this.assetsBuffered(r,n)||this.setBufferingItem(r);let d=this.preloadAssets(a,i);if(this.eventItemsMatch(r,o||s)||(this.waitingItem=r,this.log(`INTERSTITIAL_STARTED ${wx(r)} ${a.appendInPlace?"append in place":""}`),this.hls.trigger(kg.INTERSTITIAL_STARTED,{event:a,schedule:t.slice(0),scheduleIndex:e})),!a.assetListLoaded)return void this.log(`Waiting for ASSET-LIST to complete loading ${a}`);if(a.assetListLoader&&(a.assetListLoader.destroy(),a.assetListLoader=void 0),!n)return void this.log(`Waiting for attachMedia to start Interstitial ${a}`);this.waitingItem=this.endedItem=null,this.playingItem=r;const l=a.assetList[i];if(!l){const s=t[e+1],r=this.media;return s&&r&&!this.isInterstitial(s)&&r.currentTime<s.start&&(r.currentTime=this.timelinePos=s.start),void this.advanceAfterAssetEnded(a,e,i||0)}if(d||(d=this.getAssetPlayer(l.identifier)),null===d||d.destroyed){const e=a.assetList.length;this.warn(`asset ${i+1}/${e} player destroyed ${a}`),d=this.createAssetPlayer(a,l,i)}if(!this.eventItemsMatch(r,this.bufferingItem)&&a.appendInPlace&&this.isAssetBuffered(l))return;this.startAssetPlayer(d,i,t,e,n),this.shouldPlay&&kx(d.media)}else null!==r?(this.resumePrimary(r,e,s),this.shouldPlay&&kx(this.hls.media)):a&&this.isInterstitial(s)&&(this.endedItem=null,this.playingItem=s,s.event.appendInPlace||this.attachPrimary(this.schedule.durations.primary,null))}get playbackDisabled(){return!1===this.hls.config.enableInterstitialPlayback}get primaryDetails(){var e,t;return null==(e=this.mediaSelection)||null==(t=e.main)?void 0:t.details}get primaryLive(){var e;return!(null==(e=this.primaryDetails)||!e.live)}resumePrimary(e,t,i){var s;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${wx(e)}`),null==(s=this.detachedData)||!s.mediaSource){let i=this.timelinePos;(i<e.start||i>=e.end)&&(i=this.getPrimaryResumption(e,t),this.timelinePos=i),this.attachPrimary(i,e)}if(!i)return;const a=this.schedule.items;a&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${wx(e)}`),this.hls.trigger(kg.INTERSTITIALS_PRIMARY_RESUMED,{schedule:a.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){const i=e.start;if(this.primaryLive){const e=this.primaryDetails;if(0===t)return this.hls.startPosition;if(e&&(i<e.fragmentStart||i>e.edge))return this.hls.liveSyncPosition||-1}return i}isAssetBuffered(e){const t=this.getAssetPlayer(e.identifier);if(null!=t&&t.hls)return t.hls.bufferedToEnd;return av.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,i){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;const s=this.primaryMedia;if(!s)return;const a=this.hls;a.media?this.checkBuffer():(this.transferMediaTo(a,s),i&&this.startLoadingPrimaryAt(e,i)),i||(this.timelinePos=e,this.startLoadingPrimaryAt(e,i))}startLoadingPrimaryAt(e,t){var i;const s=this.hls;!s.loadingEnabled||!s.media||Math.abs(((null==(i=s.mainForwardBufferInfo)?void 0:i.start)||s.media.currentTime)-e)>.5?s.startLoad(e,t):s.bufferingEnabled||s.resumeBuffering()}onManifestLoading(){this.stopLoad(),this.schedule.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(kg.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(kg.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(-1===t.level)return;const i=this.hls.levels[t.level],s=Og(Og({},this.mediaSelection||this.altSelection),{},{main:i});this.mediaSelection=s,this.schedule.parseInterstitialDateRanges(s,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){const i=this.hls.audioTracks[t.id],s=this.mediaSelection;if(!s)return void(this.altSelection=Og(Og({},this.altSelection),{},{audio:i}));const a=Og(Og({},s),{},{audio:i});this.mediaSelection=a}onSubtitleTrackUpdated(e,t){const i=this.hls.subtitleTracks[t.id],s=this.mediaSelection;if(!s)return void(this.altSelection=Og(Og({},this.altSelection),{},{subtitles:i}));const a=Og(Og({},s),{},{subtitles:i});this.mediaSelection=a}onAudioTrackSwitching(e,t){const i=pm(t);this.playerQueue.forEach(e=>e.hls.setAudioOption(t)||e.hls.setAudioOption(i))}onSubtitleTrackSwitch(e,t){const i=pm(t);this.playerQueue.forEach(e=>e.hls.setSubtitleOption(t)||-1!==t.id&&e.hls.setSubtitleOption(i))}onBufferCodecs(e,t){const i=t.tracks;i&&(this.requiredTracks=i)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){const i=this.playingItem;if(i&&!this.itemsMatch(i,this.bufferingItem)&&!this.isInterstitial(i)){const e=this.timelinePos;this.bufferedPos=e,this.checkBuffer()}}onBufferedToEnd(e){const t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let e=0;e<t.length;e++){const s=t[e];if(s.cue.post){var i;const e=this.schedule.findEventIndex(s.identifier),t=null==(i=this.schedule.items)?void 0:i[e];this.isInterstitial(t)&&this.eventItemsMatch(t,this.bufferingItem)&&this.bufferedToItem(t,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){const t=this.playingItem;if(!this.playingLastItem&&t){const e=this.findItemIndex(t);this.setSchedulePosition(e+1)}else this.shouldPlay=!1}updateItem(e,t){const i=this.schedule.items;if(e&&i){return i[this.findItemIndex(e,t)]||null}return null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((t,i)=>{e.event.isAssetPastPlayoutLimit(i)&&this.clearAssetPlayer(t.identifier,null)});const t=e.end+.25,i=av.bufferInfo(this.primaryMedia,t,0);(i.end>t||(i.nextStart||0)>t)&&(this.attachPrimary(t,null),this.flushFrontBuffer(t))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var i;return!!t&&(e===t||e.event.identifier===(null==(i=t.event)?void 0:i.identifier))}findItemIndex(e,t){return e?this.schedule.findItemIndex(e,t):-1}updateSchedule(){const e=this.mediaSelection;e&&this.schedule.updateSchedule(e,[])}checkBuffer(e){const t=this.schedule.items;if(!t)return;const i=av.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=i.len<1),this.updateBufferedPos(i.end,t,e)}updateBufferedPos(e,t,i){const s=this.schedule,a=this.bufferingItem;if(this.bufferedPos>e)return;if(1===t.length&&this.itemsMatch(t[0],a))return void(this.bufferedPos=e);const r=this.playingItem,n=this.findItemIndex(r);let o=s.findItemIndexAtTime(e);if(this.bufferedPos<e){var d,l;const i=this.findItemIndex(a),s=Math.min(i+1,t.length-1),r=t[s];if((-1===o&&a&&e>=a.end||null!=(d=r.event)&&d.appendInPlace&&e+.01>=r.start)&&(o=s),s-n>1&&!1===(null==a||null==(l=a.event)?void 0:l.appendInPlace))return;if(this.bufferedPos=e,o>i&&o>n)this.bufferedToItem(r);else{const t=this.primaryDetails;this.primaryLive&&t&&e>t.edge-t.targetduration&&r.start<t.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(r)&&this.preloadAssets(r.event,0)}}else i&&r&&!this.itemsMatch(r,a)&&(o===n?this.bufferedToItem(r):o===n+1&&this.bufferedToItem(t[o]))}assetsBuffered(e,t){return 0!==e.event.assetList.length&&!e.event.assetList.some(e=>{const i=this.getAssetPlayer(e.identifier);return!(null!=i&&i.bufferedInPlaceToEnd(t))})}setBufferingItem(e){const t=this.bufferingItem,i=this.schedule;if(this.itemsMatch(e,t))this.bufferingItem!==e&&(this.bufferingItem=e);else{const{items:s,events:a}=i;if(!s||!a)return t;const r=this.isInterstitial(e),n=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));const o=n?n.remaining:t?t.end-this.timelinePos:0;this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${wx(e)}`+(t?` (${o.toFixed(2)} remaining)`:"")),this.playbackDisabled||(r?e.event.assetList.forEach(e=>{const t=this.getAssetPlayer(e.identifier);t&&t.resumeBuffering()}):(this.hls.resumeBuffering(),this.playerQueue.forEach(e=>e.pauseBuffering()))),this.hls.trigger(kg.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:a.slice(0),schedule:s.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}return t}bufferedToItem(e,t=0){const i=this.setBufferingItem(e);if(!this.playbackDisabled)if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(null!==i){this.bufferingAsset=null;const t=this.detachedData;if(t)if(t.mediaSource){const t=!0;this.attachPrimary(e.start,e,t)}else this.preloadPrimary(e);else this.preloadPrimary(e)}}preloadPrimary(e){const t=this.findItemIndex(e),i=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(i)}bufferedToEvent(e,t){const i=e.event,s=0===i.assetList.length&&!i.assetListLoader,a=i.cue.once;if(s||!a){const e=this.preloadAssets(i,t);if(null!=e&&e.interstitial.appendInPlace){const s=i.assetList[t],a=this.primaryMedia;s&&a&&this.bufferAssetPlayer(e,a)}}}preloadAssets(e,t){const i=e.assetUrl,s=e.assetList.length,a=0===s&&!e.assetListLoader,r=e.cue.once;if(a){const a=e.timelineStart;if(e.appendInPlace){var n;const t=this.playingItem;this.isInterstitial(t)||(null==t||null==(n=t.nextEvent)?void 0:n.identifier)!==e.identifier||this.flushFrontBuffer(a+.25)}let r,o=0;if(!this.playingItem&&this.primaryLive&&(o=this.hls.startPosition,-1===o&&(o=this.hls.liveSyncPosition||0)),o&&!e.cue.pre&&!e.cue.post){const e=o-a;e>0&&(r=Math.round(1e3*e)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${i?1:s} ${e}${r?` live-start: ${o} start-offset: ${r}`:""}`),i)return this.createAsset(e,0,0,a,e.duration,i);const d=this.assetListLoader.loadAssetList(e,r);d&&(e.assetListLoader=d)}else if(!r&&s){for(let i=t;i<s;i++){const t=e.assetList[i],s=this.getAssetPlayerQueueIndex(t.identifier);-1!==s&&!this.playerQueue[s].destroyed||t.error||this.createAssetPlayer(e,t,i)}return this.getAssetPlayer(e.assetList[t].identifier)}return null}flushFrontBuffer(e){const t=this.requiredTracks;if(!t)return;this.log(`Removing front buffer starting at ${e}`);Object.keys(t).forEach(t=>{this.hls.trigger(kg.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:t})})}getAssetPlayerQueueIndex(e){const t=this.playerQueue;for(let i=0;i<t.length;i++)if(e===t[i].assetId)return i;return-1}getAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){const{playerQueue:e,primaryMedia:t}=this;if(t)for(let i=0;i<e.length;i++)if(e[i].media===t)return e[i];return null}createAsset(e,t,i,s,a,r){const n={parentIdentifier:e.identifier,identifier:px(e,r,t),duration:a,startOffset:i,timelineStart:s,uri:r};return this.createAssetPlayer(e,n,t)}createAssetPlayer(e,t,i){const s=this.hls,a=s.userConfig;let r=a.videoPreference;const n=s.loadLevelObj||s.levels[s.currentLevel];(r||n)&&(r=Dg({},r),n.videoCodec&&(r.videoCodec=n.videoCodec),n.videoRange&&(r.allowedVideoRanges=[n.videoRange]));const o=s.audioTracks[s.audioTrack],d=s.subtitleTracks[s.subtitleTrack];let l=0;if(this.primaryLive||e.appendInPlace){const e=this.timelinePos-t.timelineStart;if(e>1){const i=t.duration;i&&e<i&&(l=e)}}const c=t.identifier,h=Og(Og({},a),{},{autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:s.sessionId,assetPlayerId:c,abrEwmaDefaultEstimate:s.bandwidthEstimate,interstitialsController:void 0,startPosition:l,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:r,audioPreference:o||a.audioPreference,subtitlePreference:d||a.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(h.timelineOffset=t.timelineStart));const p=h.cmcd;null!=p&&p.sessionId&&p.contentId&&(h.cmcd=Dg({},p,{contentId:lx(t.uri)})),this.getAssetPlayer(c)&&this.warn(`Duplicate date range identifier ${e} and asset ${c}`);const u=new yx(this.HlsPlayerClass,h,e,t);this.playerQueue.push(u),e.assetList[i]=t;const g=s=>{if(s.live){const t=new Error(`Interstitials MUST be VOD assets ${e}`),s={fatal:!0,type:wg.OTHER_ERROR,details:xg.INTERSTITIAL_ASSET_ITEM_ERROR,error:t};return void this.handleAssetItemError(s,e,this.schedule.findEventIndex(e.identifier),i,t.message)}const a=s.edge-s.fragmentStart,r=t.duration;(null===r||a>r)&&(this.log(`Interstitial asset "${c}" duration change ${r} > ${a}`),t.duration=a,this.updateSchedule())};u.on(kg.LEVEL_UPDATED,(e,{details:t})=>g(t)),u.on(kg.LEVEL_PTS_UPDATED,(e,{details:t})=>g(t));const f=(e,t)=>{const i=this.getAssetPlayer(c);if(i&&t.tracks){i.off(kg.BUFFER_CODECS,f),i.tracks=t.tracks;const e=this.primaryMedia;this.bufferingAsset===i.assetItem&&e&&!i.media&&this.bufferAssetPlayer(i,e)}};u.on(kg.BUFFER_CODECS,f);const m=()=>{var i;const s=this.getAssetPlayer(c);if(this.log(`buffered to end of asset ${s}`),!s)return;const a=this.schedule.findEventIndex(e.identifier),r=null==(i=this.schedule.items)?void 0:i[a];if(this.isInterstitial(r)){const i=e.findAssetIndex(t),s=mx(e,i);if(e.isAssetPastPlayoutLimit(s)){var n;const e=null==(n=this.schedule.items)?void 0:n[a+1];e&&this.bufferedToItem(e)}else this.bufferedToItem(r,s)}};u.on(kg.BUFFERED_TO_END,m);const v=t=>()=>{if(!this.getAssetPlayer(c))return;this.shouldPlay=!0;const i=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,i,t)};return u.once(kg.MEDIA_ENDED,v(i)),u.once(kg.PLAYOUT_LIMIT_REACHED,v(1/0)),u.on(kg.ERROR,(t,s)=>{const a=this.getAssetPlayer(c);if(s.details!==xg.BUFFER_STALLED_ERROR)this.handleAssetItemError(s,e,this.schedule.findEventIndex(e.identifier),i,`Asset player error ${s.error} ${e}`);else if(null!=a&&a.media){const t=a.currentTime,i=a.duration-t;t&&e.appendInPlace&&i/a.media.playbackRate<.5?(this.log(`Advancing buffer past end of asset ${c} ${e} at ${a.media.currentTime}`),m()):(this.warn(`Stalled at ${t} of ${t+i} in asset ${c} ${e}`),this.onTimeupdate(),this.checkBuffer(!0))}}),u.on(kg.DESTROYING,()=>{if(!this.getAssetPlayer(c))return;const t=new Error(`Asset player destroyed unexpectedly ${c}`),s={fatal:!0,type:wg.OTHER_ERROR,details:xg.INTERSTITIAL_ASSET_ITEM_ERROR,error:t};this.handleAssetItemError(s,e,this.schedule.findEventIndex(e.identifier),i,t.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${vx(t)}`),this.hls.trigger(kg.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:i,event:e,player:u}),u}clearInterstitial(e,t){e.assetList.forEach(e=>{this.clearAssetPlayer(e.identifier,t)}),e.reset()}resetAssetPlayer(e){const t=this.getAssetPlayerQueueIndex(e);if(-1!==t){this.log(`reset asset player "${e}" after error`);const i=this.playerQueue[t];this.transferMediaFromPlayer(i,null),i.resetDetails()}}clearAssetPlayer(e,t){const i=this.getAssetPlayerQueueIndex(e);if(-1!==i){this.log(`clear asset player "${e}" toSegment: ${t?wx(t):t}`);const s=this.playerQueue[i];this.transferMediaFromPlayer(s,t),this.playerQueue.splice(i,1),s.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,i,s,a){const{interstitial:r,assetItem:n,assetId:o}=e,d=r.assetList.length,l=this.playingAsset;this.endedAsset=null,this.playingAsset=n,l&&l.identifier===o||(l&&(this.clearAssetPlayer(l.identifier,i[s]),delete l.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${d} ${vx(n)}`),this.hls.trigger(kg.INTERSTITIAL_ASSET_STARTED,{asset:n,assetListIndex:t,event:r,schedule:i.slice(0),scheduleIndex:s,player:e})),this.bufferAssetPlayer(e,a)}bufferAssetPlayer(e,t){var i,s;const{interstitial:a,assetItem:r}=e,n=this.schedule.findEventIndex(a.identifier),o=null==(i=this.schedule.items)?void 0:i[n];if(!o)return;this.setBufferingItem(o),this.bufferingAsset=r;const d=this.getBufferingPlayer();if(d===e)return;const l=a.appendInPlace;if(l&&!1===(null==d?void 0:d.interstitial.appendInPlace))return;const c=(null==d?void 0:d.tracks)||(null==(s=this.detachedData)?void 0:s.tracks)||this.requiredTracks;if(l&&r!==this.playingAsset){if(!e.tracks)return;if(c&&!Hg(c,e.tracks)){const t=new Error(`Asset ${vx(r)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(c)}')`),i={fatal:!0,type:wg.OTHER_ERROR,details:xg.INTERSTITIAL_ASSET_ITEM_ERROR,error:t},s=a.findAssetIndex(r);return void this.handleAssetItemError(i,a,n,s,t.message)}}this.transferMediaTo(e,t)}handleAssetItemError(e,t,i,s,a){if(e.details===xg.BUFFER_STALLED_ERROR)return;const r=t.assetList[s];this.warn(`INTERSTITIAL_ASSET_ERROR ${r?vx(r):r} ${e.error}`);const n=null==r?void 0:r.identifier,o=this.getAssetPlayerQueueIndex(n),d=this.playerQueue[o]||null,l=this.schedule.items,c=Dg({},e,{fatal:!1,errorAction:Om(!0),asset:r,assetListIndex:s,event:t,schedule:l,scheduleIndex:i,player:d});if(this.hls.trigger(kg.INTERSTITIAL_ASSET_ERROR,c),!e.fatal)return;const h=this.playingAsset,p=new Error(a);if(r&&(this.clearAssetPlayer(n,null),r.error=p),t.assetList.some(e=>!e.error)){if(t.appendInPlace){for(let e=s;e<t.assetList.length;e++)this.resetAssetPlayer(t.assetList[e].identifier);this.updateSchedule()}}else t.error=p;t.error?this.primaryFallback(t):h&&h.identifier===n&&this.advanceAfterAssetEnded(t,i,s)}primaryFallback(e){const t=e.timelineStart,i=this.effectivePlayingItem;if(this.updateSchedule(),i){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${i?wx(i):"<none>"} error: ${e.error}`);let s=this.timelinePos;-1===s&&(s=this.hls.startPosition);const a=this.updateItem(i,s);this.itemsMatch(i,a)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t));const r=this.schedule.findItemIndexAtTime(s);this.setSchedulePosition(r)}else this.checkStart()}onAssetListLoaded(e,t){var i;const s=t.event,a=s.identifier,r=t.assetListResponse.ASSETS;if(!this.schedule.hasEvent(a))return;const n=s.timelineStart,o=s.duration;let d=0;r.forEach((e,t)=>{const i=parseFloat(e.DURATION);this.createAsset(s,t,d,n+d,i,e.URI),d+=i}),s.duration=d,this.log(`Loaded asset-list with duration: ${d} (was: ${o}) ${s}`);const l=this.waitingItem,c=(null==l?void 0:l.event.identifier)===a;this.updateSchedule();const h=null==(i=this.bufferingItem)?void 0:i.event;if(c){var p;const e=this.schedule.findEventIndex(a),t=null==(p=this.schedule.items)?void 0:p[e];if(t){if(!this.playingItem&&this.timelinePos>t.end){if(this.schedule.findItemIndexAtTime(this.timelinePos)!==e)return s.error=new Error(`Interstitial no longer within playback range ${this.timelinePos} ${s}`),void this.primaryFallback(s)}this.setBufferingItem(t)}this.setSchedulePosition(e)}else if((null==h?void 0:h.identifier)===a&&h.appendInPlace){const e=s.assetList[0],t=this.getAssetPlayer(e.identifier),i=this.primaryMedia;e&&t&&i&&this.bufferAssetPlayer(t,i)}}onError(e,t){switch(t.details){case xg.ASSET_LIST_PARSING_ERROR:case xg.ASSET_LIST_LOAD_ERROR:case xg.ASSET_LIST_LOAD_TIMEOUT:{const e=t.interstitial;e&&this.primaryFallback(e);break}case xg.BUFFER_STALLED_ERROR:this.onTimeupdate(),this.checkBuffer(!0)}}}});function Lk(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(Lk):Object.keys(e).reduce((t,i)=>(t[i]=Lk(e[i]),t),{}):e}function Ck(e,t){const i=e.loader;if(i!==xk&&i!==Pk)t.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1;else{(function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1})()&&(e.loader=xk,e.progressive=!0,e.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}}class _k extends tv{constructor(e,t){super("gap-controller",e.logger),this.hls=null,this.fragmentTracker=null,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var e;null!=(e=this.media)&&e.seeking||(this.waiting=self.performance.now(),this.tick())},this.onMediaEnded=()=>{var e;this.hls&&(this.ended=(null==(e=this.media)?void 0:e.currentTime)||1,this.hls.trigger(kg.MEDIA_ENDED,{stalled:!1}))},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){const{hls:e}=this;e&&(e.on(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(kg.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(kg.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(100),this.mediaSource=t.mediaSource;const i=this.media=t.media;ex(i,"playing",this.onMediaPlaying),ex(i,"waiting",this.onMediaWaiting),ex(i,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();const{media:i}=this;i&&(tx(i,"playing",this.onMediaPlaying),tx(i,"waiting",this.onMediaWaiting),tx(i,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(null==(e=this.media)||!e.readyState||!this.hasBuffered)return;const t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var i,s;const a=null==(i=this.hls)?void 0:i.config;if(!a)return;const r=this.media;if(!r)return;const{seeking:n}=r,o=this.seeking&&!n,d=!this.seeking&&n,l=r.paused&&!n||r.ended||0===r.playbackRate;if(this.seeking=n,e!==t)return t&&(this.ended=0),this.moved=!0,n||(this.nudgeRetry=0,a.nudgeOnVideoHole&&!l&&e>t&&this.nudgeOnVideoHole(e,t)),void(0===this.waiting&&this.stallResolved(e));if(d||o)return void(o&&this.stallResolved(e));if(l)return this.nudgeRetry=0,this.stallResolved(e),void(!this.ended&&r.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(kg.MEDIA_ENDED,{stalled:!1})));if(!av.getBuffered(r).length)return void(this.nudgeRetry=0);const c=av.bufferInfo(r,e,0),h=c.nextStart||0,p=this.fragmentTracker;if(n&&p&&this.hls){const t=Ak(this.hls.inFlightFragments,e),i=c.len>2,s=!h||t||h-e>2&&!p.getPartialFragment(e);if(i||s)return;this.moved=!1}const u=null==(s=this.hls)?void 0:s.latestLevelDetails;if(!this.moved&&null!==this.stalled&&p){if(!(c.len>0)&&!h)return;const t=Math.max(h,c.start||0)-e,i=!(null==u||!u.live)?2*u.targetduration:2,s=p.getPartialFragment(e);if(t>0&&(t<=i||s))return void(r.paused||this._trySkipBufferHole(s))}const g=a.detectStallWithCurrentTimeMs,f=self.performance.now(),m=this.waiting;let v=this.stalled;if(null===v){if(!(m>0&&f-m<g))return void(this.stalled=f);v=this.stalled=m}const y=f-v;if(!n&&(y>=g||m)&&this.hls){var b;if("ended"===(null==(b=this.mediaSource)?void 0:b.readyState)&&(null==u||!u.live)&&Math.abs(e-((null==u?void 0:u.edge)||0))<1){if(this.ended)return;return this.ended=e||1,void this.hls.trigger(kg.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(c),!this.media||!this.hls)return}const w=av.bufferInfo(r,e,a.maxBufferHole);this._tryFixBufferStall(w,y,e)}stallResolved(e){const t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){const i=self.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(i)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(kg.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var i;const s=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(i=this.buffered.audio)&&i.length&&s&&s.length>1&&e>s.end(0)){const i=av.bufferedInfo(av.timeRangesToArray(this.buffered.audio),e,0);if(i.len>1&&t>=i.start){const i=av.timeRangesToArray(s),a=av.bufferedInfo(i,t,0).bufferedIndex;if(a>-1&&a<i.length-1){const t=av.bufferedInfo(i,e,0).bufferedIndex,s=i[a].end,r=i[a+1].start;if((-1===t||t>a)&&r-s<1&&e-s<2){const i=new Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${s} -> ${r} buffered index: ${t}`);this.warn(i.message),this.media.currentTime+=1e-6;const a=this.fragmentTracker.getPartialFragment(e)||void 0,n=av.bufferInfo(this.media,e,0);this.hls.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:i,reason:i.message,frag:a,buffer:n.len,bufferInfo:n})}}}}}_tryFixBufferStall(e,t,i){var s,a;const{fragmentTracker:r,media:n}=this,o=null==(s=this.hls)?void 0:s.config;if(!n||!r||!o)return;const d=null==(a=this.hls)?void 0:a.latestLevelDetails,l=r.getPartialFragment(i);if(l||null!=d&&d.live&&i<d.fragmentStart){if(this._trySkipBufferHole(l)||!this.media)return}const c=e.buffered,h=this.adjacentTraversal(e,i);(c&&c.length>1&&e.len>o.maxBufferHole||e.nextStart&&(e.nextStart-i<o.maxBufferHole||h))&&(t>1e3*o.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){const i=this.fragmentTracker,s=e.nextStart;if(i&&s){const e=i.getFragAtPos(t,Lg),a=i.getFragAtPos(s,Lg);if(e&&a)return a.sn-e.sn<2}return!1}_reportStall(e){const{hls:t,media:i,stallReported:s,stalled:a}=this;if(!s&&null!==a&&i&&t){this.stallReported=!0;const s=new Error(`Playback stalling at @${i.currentTime} due to low buffer (${lm(e)})`);this.warn(s.message),t.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.BUFFER_STALLED_ERROR,fatal:!1,error:s,buffer:e.len,bufferInfo:e,stalled:{start:a}})}}_trySkipBufferHole(e){var t;const{fragmentTracker:i,media:s}=this,a=null==(t=this.hls)?void 0:t.config;if(!s||!i||!a)return 0;const r=s.currentTime,n=av.bufferInfo(s,r,0),o=r<n.start?n.start:n.nextStart;if(o&&this.hls){const t=n.len<=a.maxBufferHole,l=n.len>0&&n.len<1&&s.readyState<3,c=o-r;if(c>0&&(t||l)){if(c>a.maxBufferHole){let t=!1;if(0===r){const e=i.getAppendedFrag(0,Lg);e&&o<e.end&&(t=!0)}if(!t){const t=e||i.getAppendedFrag(r,Lg);if(t){var d;if(null==(d=this.hls.loadLevelObj)||!d.details)return 0;if(Ak(this.hls.inFlightFragments,o))return 0;let e=!1,s=t.end;for(;s<o;){const t=i.getPartialFragment(s);if(!t){e=!0;break}s+=t.duration}if(e)return 0}}}const t=Math.max(o+.05,r+.1);if(this.warn(`skipping hole, adjusting currentTime from ${r} to ${t}`),this.moved=!0,s.currentTime=t,null==e||!e.gap){const i=new Error(`fragment loaded with buffer holes, seeking from ${r} to ${t}`);this.hls.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:i,reason:i.message,frag:e||void 0,buffer:n.len,bufferInfo:n})}return t}}return 0}_tryNudgeBuffer(e){const{hls:t,media:i,nudgeRetry:s}=this,a=null==t?void 0:t.config;if(!i||!a)return 0;const r=i.currentTime;if(this.nudgeRetry++,s<a.nudgeMaxRetry){const n=r+(s+1)*a.nudgeOffset,o=new Error(`Nudging 'currentTime' from ${r} to ${n}`);this.warn(o.message),i.currentTime=n,t.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.BUFFER_NUDGE_ON_STALL,error:o,fatal:!1,buffer:e.len,bufferInfo:e})}else{const i=new Error(`Playhead still not moving while enough data buffered @${r} after ${a.nudgeMaxRetry} nudges`);this.error(i.message),t.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.BUFFER_STALLED_ERROR,error:i,fatal:!0,buffer:e.len,bufferInfo:e})}}}function Ak(e,t){const i=Rk(e.main);if(i&&i.start<=t)return i;const s=Rk(e.audio);return s&&s.start<=t?s:null}function Rk(e){if(!e)return null;switch(e.state){case ky:case xy:case _y:case Ay:return null}return e.frag}function Ik(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function Dk(e,t,i,s,a){let r=new e(t,i,"");try{r.value=s,a&&(r.type=a)}catch(n){r=new e(t,i,lm(a?Og({type:a},s):s))}return r}const Mk=(()=>{const e=Ik();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function Ok(e){return Uint8Array.from(e.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}class Uk{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(kg.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){const{hls:e}=this;e.on(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(kg.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(kg.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(kg.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}_unregisterListeners(){const{hls:e}=this;e.off(kg.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(kg.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(kg.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(kg.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this)}onMediaAttaching(e,t){var i;this.media=t.media,!1===(null==(i=t.overrides)?void 0:i.cueRemoval)&&(this.removeCues=!1)}onMediaAttached(){const e=this.hls.latestLevelDetails;e&&this.updateDateRangeCues(e)}onMediaDetaching(e,t){this.media=null;!!t.transferMedia||(this.id3Track&&(this.removeCues&&nx(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){const t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){const i=e[t];if("metadata"===i.kind&&"id3"===i.label)return ax(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;const{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:s}}}=this;if(!i&&!s)return;const{samples:a}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));const r=Ik();if(r)for(let e=0;e<a.length;e++){const t=a[e].type;if(t===lb.emsg&&!i||!s)continue;const n=rb(a[e].data);if(n){const i=a[e].pts;let s=i+a[e].duration;s>Mk&&(s=Mk);s-i<=0&&(s=i+.25);for(let e=0;e<n.length;e++){const a=n[e];if(!nb(a)){this.updateId3CueEnds(i,t);const e=Dk(r,i,s,a,t);e&&this.id3Track.addCue(e)}}}}}updateId3CueEnds(e,t){var i;const s=null==(i=this.id3Track)?void 0:i.cues;if(s)for(let i=s.length;i--;){const a=s[i];a.type===t&&a.startTime<e&&a.endTime===Mk&&(a.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:i,type:s}){const{id3Track:a,hls:r}=this;if(!r)return;const{config:{enableEmsgMetadataCues:n,enableID3MetadataCues:o}}=r;if(a&&(n||o)){let e;e="audio"===s?e=>e.type===lb.audioId3&&o:"video"===s?e=>e.type===lb.emsg&&n:e=>e.type===lb.audioId3&&o||e.type===lb.emsg&&n,ox(a,t,i,e)}}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){if(!this.media||!e.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;const{id3Track:i}=this,{dateRanges:s}=e,a=Object.keys(s);let r=this.dateRangeCuesAppended;var n;if(i&&t)if(null!=(n=i.cues)&&n.length){const e=Object.keys(r).filter(e=>!a.includes(e));for(let t=e.length;t--;){const s=e[t],a=r[s].cues;delete r[s],Object.keys(a).forEach(e=>{try{const t=a[e];t.removeEventListener("enter",this.onEventCueEnter),i.removeCue(t)}catch(e){}})}}else r=this.dateRangeCuesAppended={};const o=e.fragments[e.fragments.length-1];if(0===a.length||!vg(null==o?void 0:o.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));const d=Ik();for(let e=0;e<a.length;e++){const t=a[e],i=s[t],n=i.startTime,o=r[t],l=(null==o?void 0:o.cues)||{};let c=(null==o?void 0:o.durationKnown)||!1,h=Mk;const{duration:p,endDate:u}=i;if(u&&null!==p)h=n+p,c=!0;else if(i.endOnNext&&!c){const e=a.reduce((e,t)=>{if(t!==i.id){const a=s[t];if(a.class===i.class&&a.startDate>i.startDate&&(!e||i.startDate<e.startDate))return a}return e},null);e&&(h=e.startTime,c=!0)}const g=Object.keys(i.attr);for(let e=0;e<g.length;e++){const s=g[e];if(!uv(s))continue;const a=l[s];if(a)c&&!o.durationKnown?a.endTime=h:Math.abs(a.startTime-n)>.01&&(a.startTime=n,a.endTime=h);else if(d){let e=i.attr[s];gv(s)&&(e=Ok(e));const a=Dk(d,n,h,{key:s,data:e},lb.dateRange);a&&(a.id=t,this.id3Track.addCue(a),l[s]=a,this.hls.config.interstitialsController&&("X-ASSET-LIST"!==s&&"X-ASSET-URL"!==s||a.addEventListener("enter",this.onEventCueEnter)))}}r[t]={cues:l,dateRange:i,durationKnown:c}}}}class $k{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{const{media:e}=this,t=this.levelDetails;if(!e||!t)return;this.currentTime=e.currentTime;const i=this.computeLatency();if(null===i)return;this._latency=i;const{lowLatencyMode:s,maxLiveSyncPlaybackRate:a}=this.config;if(!s||1===a||!t.live)return;const r=this.targetLatency;if(null===r)return;const n=i-r;if(n<Math.min(this.maxLatency,r+t.targetduration)&&n>.05&&this.forwardBufferLength>1){const t=Math.min(2,Math.max(1,a)),i=Math.round(2/(1+Math.exp(-.75*n-this.edgeStalled))*20)/20,s=Math.min(t,Math.max(1,i));this.changeMediaPlaybackRate(e,s)}else 1!==e.playbackRate&&0!==e.playbackRate&&this.changeMediaPlaybackRate(e,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return(null==(e=this.hls)?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){const{config:e}=this;if(void 0!==e.liveMaxLatencyDuration)return e.liveMaxLatencyDuration;const t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){const e=this.levelDetails;if(null===e||null===this.hls)return null;const{holdBack:t,partHoldBack:i,targetduration:s}=e,{liveSyncDuration:a,liveSyncDurationCount:r,lowLatencyMode:n}=this.config,o=this.hls.userConfig;let d=n&&i||t;(this._targetLatencyUpdated||o.liveSyncDuration||o.liveSyncDurationCount||0===d)&&(d=void 0!==a?a:r*s);const l=s;return d+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,l)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){const e=this.estimateLiveEdge(),t=this.targetLatency;if(null===e||null===t)return null;const i=this.levelDetails;if(null===i)return null;const s=i.edge,a=e-t-this.edgeStalled,r=s-i.totalduration,n=s-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(r,a),n)}get drift(){const e=this.levelDetails;return null===e?1:e.drift}get edgeStalled(){const e=this.levelDetails;if(null===e)return 0;const t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){const{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;const i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){const{hls:e}=this;e&&(e.on(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(kg.ERROR,this.onError,this))}unregisterListeners(){const{hls:e}=this;e&&(e.off(kg.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(kg.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(kg.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var i;t.details===xg.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(i=this.levelDetails)&&i.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var i,s;e.playbackRate!==t&&(null==(i=this.hls)||i.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${null==(s=this.targetLatency)?void 0:s.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){const e=this.levelDetails;return null===e?null:e.edge+e.age}computeLatency(){const e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}class Fk extends cw{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){const{hls:e}=this;e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(kg.LEVEL_LOADED,this.onLevelLoaded,this),e.on(kg.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(kg.FRAG_BUFFERED,this.onFragBuffered,this),e.on(kg.ERROR,this.onError,this)}_unregisterListeners(){const{hls:e}=this;e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(kg.LEVEL_LOADED,this.onLevelLoaded,this),e.off(kg.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(kg.FRAG_BUFFERED,this.onFragBuffered,this),e.off(kg.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){const i=this.hls.config.preferManagedMediaSource,s=[],a={},r={};let n=!1,o=!1,d=!1;t.levels.forEach(e=>{const t=e.attrs;let{audioCodec:l,videoCodec:c}=e;l&&(e.audioCodec=l=Gf(l,i)||void 0),c&&(c=e.videoCodec=function(e){const t=e.split(",");for(let e=0;e<t.length;e++){const i=t[e].split(".");i.length>2&&"avc1"===i[0]&&(t[e]=`avc1.${parseInt(i[1]).toString(16)}${("000"+parseInt(i[2]).toString(16)).slice(-4)}`)}return t.join(",")}(c));const{width:h,height:p,unknownCodecs:u}=e;let g=u?u.length:0;if(u)for(let t=g;t--;){const i=u[t];this.isAudioSupported(i)?(e.audioCodec=l=l?`${l},${i}`:i,g--,Mf.audio[l.substring(0,4)]=2):this.isVideoSupported(i)&&(e.videoCodec=c=c?`${c},${i}`:i,g--,Mf.video[c.substring(0,4)]=2)}if(n||(n=!(!h||!p)),o||(o=!!c),d||(d=!!l),g||l&&!this.isAudioSupported(l)||c&&!this.isVideoSupported(c))return void this.log(`Some or all CODECS not supported "${t.CODECS}"`);const{CODECS:f,"FRAME-RATE":m,"HDCP-LEVEL":v,"PATHWAY-ID":y,RESOLUTION:b,"VIDEO-RANGE":w}=t,x=`${`${y||"."}-`}${e.bitrate}-${b}-${m}-${f}-${w}-${v}`;if(a[x])if(a[x].uri===e.url||e.attrs["PATHWAY-ID"])a[x].addGroupId("audio",t.AUDIO),a[x].addGroupId("text",t.SUBTITLES);else{const t=r[x]+=1;e.attrs["PATHWAY-ID"]=new Array(t+1).join(".");const i=this.createLevel(e);a[x]=i,s.push(i)}else{const t=this.createLevel(e);a[x]=t,r[x]=1,s.push(t)}}),this.filterAndSortMediaOptions(s,t,n,o,d)}createLevel(e){const t=new nm(e),i=e.supplemental;if(null!=i&&i.videoCodec&&!this.isVideoSupported(i.videoCodec)){const e=new Error(`SUPPLEMENTAL-CODECS not supported "${i.videoCodec}"`);this.log(e.message),t.supportedResult=Wf(e,[])}return t}isAudioSupported(e){return Uf(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Uf(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,i,s,a){let r=[],n=[],o=e;if((i||s)&&a&&(o=o.filter(({videoCodec:e,videoRange:t,width:i,height:s})=>{return(!!e||!(!i||!s))&&(!!(a=t)&&em.indexOf(a)>-1);var a})),0===o.length)return void Promise.resolve().then(()=>{if(this.hls){let e="no level with compatible codecs found in manifest",i=e;t.levels.length&&(i=`one or more CODECS in variant not supported: ${lm(t.levels.map(e=>e.attrs.CODECS).filter((e,t,i)=>i.indexOf(e)===t))}`,this.warn(i),e+=` (${i})`);const s=new Error(e);this.hls.trigger(kg.ERROR,{type:wg.MEDIA_ERROR,details:xg.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:s,reason:i})}});t.audioTracks&&(r=t.audioTracks.filter(e=>!e.audioCodec||this.isAudioSupported(e.audioCodec)),Nk(r)),t.subtitles&&(n=t.subtitles,Nk(n));const d=o.slice(0);o.sort((e,t)=>{if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(i&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return em.indexOf(e.videoRange)-em.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){const i=Nf(e.videoCodec),s=Nf(t.videoCodec);if(i!==s)return s-i}if(e.uri===t.uri&&e.codecSet!==t.codecSet){const i=jf(e.codecSet),s=jf(t.codecSet);if(i!==s)return s-i}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0});let l=d[0];if(this.steering&&(o=this.steering.filterParsedLevels(o),o.length!==d.length))for(let e=0;e<d.length;e++)if(d[e].pathwayId===o[0].pathwayId){l=d[e];break}this._levels=o;for(let e=0;e<o.length;e++)if(o[e]===l){var c;this._firstLevel=e;const t=l.bitrate,i=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${o.length} level(s) found, first bitrate: ${t}`),void 0===(null==(c=this.hls.userConfig)?void 0:c.abrEwmaDefaultEstimate)){const e=Math.min(t,this.hls.config.abrEwmaDefaultEstimateMax);e>i&&i===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=e)}break}const h=a&&!s,p=this.hls.config,u=!(!p.audioStreamController||!p.audioTrackController),g={levels:o,audioTracks:r,subtitleTracks:n,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:s,altAudio:u&&!h&&r.some(e=>!!e.url)};this.hls.trigger(kg.MANIFEST_PARSED,g)}get levels(){return 0===this._levels.length?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){const t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){const i=new Error("invalid level idx"),s=e<0;if(this.hls.trigger(kg.ERROR,{type:wg.OTHER_ERROR,details:xg.LEVEL_SWITCH_ERROR,level:e,fatal:s,error:i,reason:i.message}),s)return;e=Math.min(e,t.length-1)}const i=this.currentLevelIndex,s=this.currentLevel,a=s?s.attrs["PATHWAY-ID"]:void 0,r=t[e],n=r.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=r,i===e&&s&&a===n)return;this.log(`Switching to level ${e} (${r.height?r.height+"p ":""}${r.videoRange?r.videoRange+" ":""}${r.codecSet?r.codecSet+" ":""}@${r.bitrate})${n?" with Pathway "+n:""} from level ${i}${a?" with Pathway "+a:""}`);const o={level:e,attrs:r.attrs,details:r.details,bitrate:r.bitrate,averageBitrate:r.averageBitrate,maxBitrate:r.maxBitrate,realBitrate:r.realBitrate,width:r.width,height:r.height,codecSet:r.codecSet,audioCodec:r.audioCodec,videoCodec:r.videoCodec,audioGroups:r.audioGroups,subtitleGroups:r.subtitleGroups,loaded:r.loaded,loadError:r.loadError,fragmentError:r.fragmentError,name:r.name,id:r.id,uri:r.uri,url:r.url,urlId:0,audioGroupIds:r.audioGroupIds,textGroupIds:r.textGroupIds};this.hls.trigger(kg.LEVEL_SWITCHING,o);const d=r.details;if(!d||d.live){const e=this.switchParams(r.uri,null==s?void 0:s.details,d);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0===this._startLevel){const e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){const t=this.steering.pathways(),i=e.filter(e=>-1!==t.indexOf(e));if(e.length<1)return void this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);this.steering.pathwayPriority=i}}onError(e,t){!t.fatal&&t.context&&t.context.type===Eg&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(void 0!==t&&t.type===Lg){const e=t.elementaryStreams;if(!Object.keys(e).some(t=>!!e[t]))return;const i=this._levels[t.level];null!=i&&i.loadError&&(this.log(`Resetting level error count of ${i.loadError} on frag buffered`),i.loadError=0)}}onLevelLoaded(e,t){var i;const{level:s,details:a}=t,r=t.levelInfo;var n;if(!r)return this.warn(`Invalid level index ${s}`),void(null!=(n=t.deliveryDirectives)&&n.skip&&(a.deltaUpdateFailed=!0));if(r===this.currentLevel||t.withoutMultiVariant){0===r.fragmentError&&(r.loadError=0);let e=r.details;e===t.details&&e.advanced&&(e=void 0),this.playlistLoaded(s,t,e)}else null!=(i=t.deliveryDirectives)&&i.skip&&(a.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);const i=this.getUrlWithDirectives(e.uri,t),s=this.currentLevelIndex,a=e.attrs["PATHWAY-ID"],r=e.details,n=null==r?void 0:r.age;this.log(`Loading level index ${s}${void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:""}${a?" Pathway "+a:""}${n&&r.live?" age "+n.toFixed(1)+(r.type&&" "+r.type||""):""} ${i}`),this.hls.trigger(kg.LEVEL_LOADING,{url:i,level:s,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(1===this._levels.length)return;const i=this._levels.filter((t,i)=>i!==e||(this.steering&&this.steering.removeLevel(t),t===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,t.details&&t.details.fragments.forEach(e=>e.level=-1)),!1));gy(i),this._levels=i,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);const s=i.length-1;this._firstLevel=Math.min(this._firstLevel,s),this._startLevel&&(this._startLevel=Math.min(this._startLevel,s)),this.hls.trigger(kg.LEVELS_UPDATED,{levels:i})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){const{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:i}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(kg.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:i}))}}function Nk(e){const t={};e.forEach(e=>{const i=e.groupId||"";e.id=t[i]=t[i]||0,t[i]++})}function jk(){return self.SourceBuffer||self.WebKitSourceBuffer}function zk(){if(!Gg())return!1;const e=jk();return!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove}class Bk extends Dy{constructor(e,t,i){super(e,t,i,"stream-controller",Lg),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{const e=this.media,t=e?e.currentTime:null;if(null===t||!vg(t))return;if(this.log(`Media seeked to ${t.toFixed(3)}`),!this.getBufferedFrag(t))return;const i=this.getFwdBufferInfoAtPos(e,t,Lg,0);null!==i&&0!==i.len?this.tick():this.warn(`Main forward buffer length at ${t} on "seeked" event ${i?i.len:"empty"})`)},this.registerListeners()}registerListeners(){super.registerListeners();const{hls:e}=this;e.on(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.on(kg.LEVEL_LOADING,this.onLevelLoading,this),e.on(kg.LEVEL_LOADED,this.onLevelLoaded,this),e.on(kg.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(kg.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(kg.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(kg.BUFFER_CREATED,this.onBufferCreated,this),e.on(kg.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(kg.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(kg.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();const{hls:e}=this;e.off(kg.MANIFEST_PARSED,this.onManifestParsed,this),e.off(kg.LEVEL_LOADED,this.onLevelLoaded,this),e.off(kg.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(kg.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(kg.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(kg.BUFFER_CREATED,this.onBufferCreated,this),e.off(kg.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(kg.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(kg.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){const{lastCurrentTime:i,hls:s}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let e=s.startLevel;-1===e&&(s.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=s.firstAutoLevel),s.nextLoadLevel=e,this.level=s.loadLevel,this._hasEnoughToStart=!!t}i>0&&-1===e&&!t&&(this.log(`Override startPosition with lastCurrentTime @${i.toFixed(3)}`),e=i),this.state=ky,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=xy}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Iy:{const{levels:e,level:t}=this,i=null==e?void 0:e[t],s=null==i?void 0:i.details;if(s&&(!s.live||this.levelLastLoaded===i&&!this.waitForLive(i))){if(this.waitForCdnTuneIn(s))break;this.state=ky;break}if(this.hls.nextLoadLevel!==this.level){this.state=ky;break}break}case Py:{var e;const t=self.performance.now(),i=this.retryDate;if(!i||t>=i||null!=(e=this.media)&&e.seeking){const{levels:e,level:t}=this,i=null==e?void 0:e[t];this.resetStartWhenNotLoaded(i||null),this.state=ky}}}this.state===ky&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),null!=(e=this.media)&&e.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){const{hls:e,levelLastLoaded:t,levels:i,media:s}=this;if(null===t||!s&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch))return;if(this.altAudio&&this.audioOnly)return;const a=this.buffering?e.nextLoadLevel:e.loadLevel;if(null==i||!i[a])return;const r=i[a],n=this.getMainFwdBufferInfo();if(null===n)return;const o=this.getLevelDetails();if(o&&this._streamEnded(n,o)){const e={};return 2===this.altAudio&&(e.type="video"),this.hls.trigger(kg.BUFFER_EOS,e),void(this.state=_y)}if(!this.buffering)return;e.loadLevel!==a&&-1===e.manualLevel&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;const d=r.details;if(!d||this.state===Iy||this.waitForLive(r))return this.level=a,this.state=Iy,void(this.startFragRequested=!1);const l=n.len,c=this.getMaxBufferLength(r.maxBitrate);if(l>=c)return;this.backtrackFragment&&this.backtrackFragment.start>n.end&&(this.backtrackFragment=null);const h=this.backtrackFragment?this.backtrackFragment.start:n.end;let p=this.getNextFragment(h,d);if(this.couldBacktrack&&!this.fragPrevious&&p&&sf(p)&&this.fragmentTracker.getState(p)!==Nm){var u;const e=(null!=(u=this.backtrackFragment)?u:p).sn-d.startSN,t=d.fragments[e-1];t&&p.cc===t.cc&&(p=t,this.fragmentTracker.removeFragment(t))}else this.backtrackFragment&&n.len&&(this.backtrackFragment=null);if(p&&this.isLoopLoading(p,h)){if(!p.gap){const e=this.audioOnly&&!this.altAudio?Xg:Jg,t=(e===Jg?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,Lg)}p=this.getNextFragmentLoopLoading(p,d,n,Lg,c)}p&&(!p.initSegment||p.initSegment.data||this.bitrateTest||(p=p.initSegment),this.loadFragment(p,r,h))}loadFragment(e,t,i){const s=this.fragmentTracker.getState(e);s===Um||s===Fm?sf(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,i):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,Lg)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){const{levels:e,media:t}=this;if(null!=t&&t.readyState){let i;const s=this.getAppendedFrag(t.currentTime);s&&s.start>1&&this.flushMainBuffer(0,s.start-1);const a=this.getLevelDetails();if(null!=a&&a.live){const e=this.getMainFwdBufferInfo();if(!e||e.len<2*a.targetduration)return}if(!t.paused&&e){const t=e[this.hls.nextLoadLevel],s=this.fragLastKbps;i=s&&this.fragCurrent?this.fragCurrent.duration*t.maxBitrate/(1e3*s)+1:0}else i=0;const r=this.getBufferedFrag(t.currentTime+i);if(r){const e=this.followingBufferedFrag(r);if(e){this.abortCurrentFrag();const t=e.maxStartPTS?e.maxStartPTS:e.start,i=e.duration,s=Math.max(r.end,t+Math.min(Math.max(i-this.config.maxFragLookUpTolerance,i*(this.couldBacktrack?.5:.125)),i*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(s,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){const e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Sy:case Ey:case Py:case Ly:case Cy:this.state=ky}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,2===this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);const i=t.media;ex(i,"playing",this.onMediaPlaying),ex(i,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){const{media:i}=this;i&&(tx(i,"playing",this.onMediaPlaying),tx(i,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t);!!t.transferMedia||(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(kg.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let i=!1,s=!1;t.levels.forEach(e=>{const t=e.audioCodec;t&&(i=i||-1!==t.indexOf("mp4a.40.2"),s=s||-1!==t.indexOf("mp4a.40.5"))}),this.audioCodecSwitch=i&&s&&!function(){var e;const t=jk();return"function"==typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){const{levels:i}=this;if(!i||this.state!==ky)return;const s=t.levelInfo;(!s.details||s.details.live&&(this.levelLastLoaded!==s||s.details.expired)||this.waitForCdnTuneIn(s.details))&&(this.state=Iy)}onLevelLoaded(e,t){var i;const{levels:s,startFragRequested:a}=this,r=t.level,n=t.details,o=n.totalduration;if(!s)return void this.warn(`Levels were reset while loading level ${r}`);this.log(`Level ${r} loaded [${n.startSN},${n.endSN}]${n.lastPartSn?`[part-${n.lastPartSn}-${n.lastPartIndex}]`:""}, cc [${n.startCC}, ${n.endCC}] duration:${o}`);const d=t.levelInfo,l=this.fragCurrent;!l||this.state!==Ey&&this.state!==Py||l.level!==t.level&&l.loader&&this.abortCurrentFrag();let c=0;if(n.live||null!=(i=d.details)&&i.live){var h;if(this.checkLiveUpdate(n),n.deltaUpdateFailed)return;c=this.alignPlaylists(n,d.details,null==(h=this.levelLastLoaded)?void 0:h.details)}if(d.details=n,this.levelLastLoaded=d,a||this.setStartPosition(n,c),this.hls.trigger(kg.LEVEL_UPDATED,{details:n,level:r}),this.state===Iy){if(this.waitForCdnTuneIn(n))return;this.state=ky}a&&n.live&&this.synchronizeToLiveEdge(n),this.tick()}synchronizeToLiveEdge(e){const{config:t,media:i}=this;if(!i)return;const s=this.hls.liveSyncPosition,a=this.getLoadPosition(),r=e.fragmentStart,n=e.edge,o=a>=r-t.maxFragLookUpTolerance&&a<=n;if(null!==s&&i.duration>s&&(a<s||!o)){const r=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!o&&i.readyState<4||a<n-r)&&(this._hasEnoughToStart||(this.nextLoadPosition=s),i.readyState))if(this.warn(`Playback: ${a.toFixed(3)} is located too far from the end of live sliding playlist: ${n}, reset currentTime to : ${s.toFixed(3)}`),"buffered"===this.config.liveSyncMode){var d;const e=av.bufferInfo(i,s,0);if(null==e||null==(d=e.buffered)||!d.length)return void(i.currentTime=s);if(e.start<=a)return void(i.currentTime=s);const{nextStart:t}=av.bufferedInfo(e.buffered,a,0);t&&(i.currentTime=t)}else i.currentTime=s}}_handleFragmentLoadProgress(e){var t;const i=e.frag,{part:s,payload:a}=e,{levels:r}=this;if(!r)return void this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);const n=r[i.level];if(!n)return void this.warn(`Level ${i.level} not found on progress`);const o=n.details;if(!o)return this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),void this.fragmentTracker.removeFragment(i);const d=n.videoCodec,l=o.PTSKnown||!o.live,c=null==(t=i.initSegment)?void 0:t.data,h=this._getAudioCodec(n),p=this.transmuxer=this.transmuxer||new lw(this.hls,Lg,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),u=s?s.index:-1,g=-1!==u,f=new iv(i.level,i.sn,i.stats.chunkCount,a.byteLength,u,g),m=this.initPTS[i.cc];p.push(a,c,h,d,i,s,o.totalduration,l,f,m)}onAudioTrackSwitching(e,t){const i=this.hls,s=2===this.altAudio;if(vm(t.url,i))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;const e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(s)return this.fragmentTracker.removeAllFragments(),i.once(kg.BUFFER_FLUSHED,()=>{var e;null==(e=this.hls)||e.trigger(kg.AUDIO_TRACK_SWITCHED,t)}),void i.trigger(kg.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});i.trigger(kg.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){const i=vm(t.url,this.hls);if(i){const e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=i?2:0,this.tick()}onBufferCreated(e,t){const i=t.tracks;let s,a,r=!1;for(const e in i){const t=i[e];if("main"===t.id){if(a=e,s=t,"video"===e){const t=i[e];t&&(this.videoBuffer=t.buffer)}}else r=!0}r&&s?(this.log(`Alternate track found, use ${a}.buffered to schedule main fragment loading`),this.mediaBuffer=s.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){const{frag:i,part:s}=t,a=i.type===Lg;if(a){if(this.fragContextChanged(i))return this.warn(`Fragment ${i.sn}${s?" p: "+s.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),void(this.state===Cy&&(this.state=ky));const e=s?s.stats:i.stats;this.fragLastKbps=Math.round(8*e.total/(e.buffering.end-e.loading.first)),sf(i)&&(this.fragPrevious=i),this.fragBufferedComplete(i,s)}const r=this.media;r&&(!this._hasEnoughToStart&&av.getBuffered(r).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),a&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var i;if(t.fatal)this.state=Ay;else switch(t.details){case xg.FRAG_GAP:case xg.FRAG_PARSING_ERROR:case xg.FRAG_DECRYPT_ERROR:case xg.FRAG_LOAD_ERROR:case xg.FRAG_LOAD_TIMEOUT:case xg.KEY_LOAD_ERROR:case xg.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(Lg,t);break;case xg.LEVEL_LOAD_ERROR:case xg.LEVEL_LOAD_TIMEOUT:case xg.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Iy||(null==(i=t.context)?void 0:i.type)!==Eg||(this.state=ky);break;case xg.BUFFER_ADD_CODEC_ERROR:case xg.BUFFER_APPEND_ERROR:if("main"!==t.parent)return;this.resetLoadingState();break;case xg.BUFFER_FULL_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case xg.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onFragLoadEmergencyAborted(){this.state=ky,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==Xg||!this.altAudio){const e=(t===Jg?this.videoBuffer:this.mediaBuffer)||this.media;e&&(this.afterBufferFlushed(e,t,Lg),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){const{media:e}=this;if(!e)return;const t=e.currentTime;let i=this.startPosition;if(i>=0&&t<i){if(e.seeking)return void this.log(`could not seek to ${i}, already seeking at ${t}`);const s=this.timelineOffset;s&&i&&(i+=s);const a=this.getLevelDetails(),r=av.getBuffered(e),n=r.length?r.start(0):0,o=n-i,d=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||o>0&&(o<d||this.loadingParts&&o<2*((null==a?void 0:a.partTarget)||0)))&&(this.log(`adjusting start position by ${o} to match buffer start`),i+=o,this.startPosition=i),t<i&&(this.log(`seek to target start position ${i} from current time ${t} buffer start ${n}`),e.currentTime=i)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(e=>{const{hls:i}=this,s=null==e?void 0:e.frag;if(!s||this.fragContextChanged(s))return;t.fragmentError=0,this.state=ky,this.startFragRequested=!1,this.bitrateTest=!1;const a=s.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),i.trigger(kg.FRAG_LOADED,e),s.bitrateTest=!1})}_handleTransmuxComplete(e){var t;const i=this.playlistType,{hls:s}=this,{remuxResult:a,chunkMeta:r}=e,n=this.getCurrentContext(r);if(!n)return void this.resetWhenMissingContext(r);const{frag:o,part:d,level:l}=n,{video:c,text:h,id3:p,initSegment:u}=a,{details:g}=l,f=this.altAudio?void 0:a.audio;if(this.fragContextChanged(o))this.fragmentTracker.removeFragment(o);else{if(this.state=Ly,u){if(null!=u&&u.tracks){const e=o.initSegment||o;this._bufferInitSegment(l,u.tracks,e,r),s.trigger(kg.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:i,tracks:u.tracks})}const e=u.initPTS,t=u.timescale;vg(e)&&(this.initPTS[o.cc]={baseTime:e,timescale:t},s.trigger(kg.INIT_PTS_FOUND,{frag:o,id:i,initPTS:e,timescale:t}))}if(c&&g){f&&"audiovideo"===c.type&&this.logMuxedErr(o);const e=g.fragments[o.sn-1-g.startSN],t=o.sn===g.startSN,i=!e||o.cc>e.cc;if(!1!==a.independent){const{startPTS:e,endPTS:s,startDTS:a,endDTS:n}=c;if(d)d.elementaryStreams[c.type]={startPTS:e,endPTS:s,startDTS:a,endDTS:n};else if(c.firstKeyFrame&&c.independent&&1===r.id&&!i&&(this.couldBacktrack=!0),c.dropped&&c.independent){const a=this.getMainFwdBufferInfo(),r=(a?a.end:this.getLoadPosition())+this.config.maxBufferHole,d=c.firstKeyFramePTS?c.firstKeyFramePTS:e;if(!t&&r<d-this.config.maxBufferHole&&!i)return void this.backtrack(o);i&&(o.gap=!0),o.setElementaryStreamInfo(c.type,o.start,s,o.start,n,!0)}else t&&e-(g.appliedTimelineOffset||0)>2&&(o.gap=!0);o.setElementaryStreamInfo(c.type,e,s,a,n),this.backtrackFragment&&(this.backtrackFragment=o),this.bufferFragmentData(c,o,d,r,t||i)}else{if(!t&&!i)return void this.backtrack(o);o.gap=!0}}if(f){const{startPTS:e,endPTS:t,startDTS:i,endDTS:s}=f;d&&(d.elementaryStreams[Xg]={startPTS:e,endPTS:t,startDTS:i,endDTS:s}),o.setElementaryStreamInfo(Xg,e,t,i,s),this.bufferFragmentData(f,o,d,r)}if(g&&null!=p&&null!=(t=p.samples)&&t.length){const e={id:i,frag:o,details:g,samples:p.samples};s.trigger(kg.FRAG_PARSING_METADATA,e)}if(g&&h){const e={id:i,frag:o,details:g,samples:h.samples};s.trigger(kg.FRAG_PARSING_USERDATA,e)}}}logMuxedErr(e){this.warn(`${sf(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,i,s){if(this.state!==Ly)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(i));const{audio:a,video:r,audiovideo:n}=t;if(a){let i=Hf(a.codec,e.audioCodec);"mp4a"===i&&(i="mp4a.40.5");const s=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){i&&(i=-1!==i.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");const e=a.metadata;e&&"channelCount"in e&&1!==(e.channelCount||1)&&-1===s.indexOf("firefox")&&(i="mp4a.40.5")}i&&-1!==i.indexOf("mp4a.40.5")&&-1!==s.indexOf("android")&&"audio/mpeg"!==a.container&&(i="mp4a.40.2",this.log(`Android: force audio codec to ${i}`)),e.audioCodec&&e.audioCodec!==i&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${i}"`),a.levelCodec=i,a.id=Lg,this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${i||""}/${e.audioCodec||""}/${a.codec}]`),delete t.audiovideo}if(r){r.levelCodec=e.videoCodec,r.id=Lg;const i=r.codec;if(4===(null==i?void 0:i.length))switch(i){case"hvc1":case"hev1":r.codec="hvc1.1.6.L120.90";break;case"av01":r.codec="av01.0.04M.08";break;case"avc1":r.codec="avc1.42e01e"}this.log(`Init video buffer, container:${r.container}, codecs[level/parsed]=[${e.videoCodec||""}/${i}]${r.codec!==i?" parsed-corrected="+r.codec:""}${r.supplemental?" supplemental="+r.supplemental:""}`),delete t.audiovideo}n&&(this.log(`Init audiovideo buffer, container:${n.container}, codecs[level/parsed]=[${e.codecs}/${n.codec}]`),delete t.video,delete t.audio);const o=Object.keys(t);if(o.length){if(this.hls.trigger(kg.BUFFER_CODECS,t),!this.hls)return;o.forEach(e=>{const a=t[e].initSegment;null!=a&&a.byteLength&&this.hls.trigger(kg.BUFFER_APPENDING,{type:e,data:a,frag:i,part:null,chunkMeta:s,parent:i.type})})}this.tickImmediate()}getMainFwdBufferInfo(){const e=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,Lg)}get maxBufferLength(){const{levels:e,level:t}=this,i=null==e?void 0:e[t];return i?this.getMaxBufferLength(i.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=ky}checkFragmentChanged(){const e=this.media;let t=null;if(e&&e.readyState>1&&!1===e.seeking){const i=e.currentTime;if(av.isBuffered(e,i)?t=this.getAppendedFrag(i):av.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){this.backtrackFragment=null;const e=this.fragPlaying,i=t.level;e&&t.sn===e.sn&&e.level===i||(this.fragPlaying=t,this.hls.trigger(kg.FRAG_CHANGED,{frag:t}),e&&e.level===i||this.hls.trigger(kg.LEVEL_SWITCHED,{level:i}))}}}get nextLevel(){const e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;const t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;return vg(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;const t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;if(vg(t)){const e=this.getLevelDetails(),i=this.currentFrag||(e?bm(null,e.fragments,t):null);if(i){const e=i.programDateTime;if(null!==e){const s=e+1e3*(t-i.start);return new Date(s)}}}return null}get currentLevel(){const e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){const e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class Gk{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(const i in this.keyUriToKeyInfo){const s=this.keyUriToKeyInfo[i].loader;if(s){var t;if(e&&e!==(null==(t=s.context)?void 0:t.frag.type))return;s.abort()}}}detach(){for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){this.detach();for(const e in this.keyUriToKeyInfo){const t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=xg.KEY_LOAD_ERROR,i,s,a){return new ev({type:wg.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:a,error:i,networkDetails:s})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length)if(t.length){const{sn:i,cc:s}=e;for(let e=0;e<t.length;e++){const a=t[e];if(s<=a.cc&&("initSegment"===i||"initSegment"===a.sn||i<a.sn))return this.emeController.selectKeySystemFormat(a).then(e=>{if(a.setKeyFormat(e),this.emeController&&this.config.requireKeySystemAccessOnStart){const t=Cv(e);if(t)return this.emeController.getKeySystemAccess([t])}})}}else if(this.config.requireKeySystemAccessOnStart){const e=Ov(this.config);if(e.length)return this.emeController.getKeySystemAccess(e)}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var i,s;t&&e.setKeyFormat(t);const a=e.decryptdata;if(!a){const i=new Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,xg.KEY_LOAD_ERROR,i))}const r=a.uri;if(!r)return Promise.reject(this.createKeyLoadError(e,xg.KEY_LOAD_ERROR,new Error(`Invalid key URI: "${r}"`)));let n=this.keyUriToKeyInfo[r];if(null!=(i=n)&&i.decryptdata.key)return a.key=n.decryptdata.key,Promise.resolve({frag:e,keyInfo:n});var o;if(null!=(s=n)&&s.keyLoadPromise)switch(null==(o=n.mediaKeySessionContext)?void 0:o.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return n.keyLoadPromise.then(t=>(a.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:n}))}switch(n=this.keyUriToKeyInfo[r]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===a.keyFormat?this.loadKeyHTTP(n,e):this.loadKeyEME(n,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(n,e);default:return Promise.reject(this.createKeyLoadError(e,xg.KEY_LOAD_ERROR,new Error(`Key supplied with unsupported METHOD: "${a.method}"`)))}}loadKeyEME(e,t){const i={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){const t=this.emeController.loadKey(i);if(t)return(e.keyLoadPromise=t.then(t=>(e.mediaKeySessionContext=t,i))).catch(t=>{throw e.keyLoadPromise=null,t})}return Promise.resolve(i)}loadKeyHTTP(e,t){const i=this.config,s=new(0,i.loader)(i);return t.keyLoader=e.loader=s,e.keyLoadPromise=new Promise((a,r)=>{const n={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},o=i.keyLoadPolicy.default,d={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},l={onSuccess:(e,t,i,s)=>{const{frag:n,keyInfo:o,url:d}=i;if(!n.decryptdata||o!==this.keyUriToKeyInfo[d])return r(this.createKeyLoadError(n,xg.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),s));o.decryptdata.key=n.decryptdata.key=new Uint8Array(e.data),n.keyLoader=null,o.loader=null,a({frag:n,keyInfo:o})},onError:(e,i,s,a)=>{this.resetLoader(i),r(this.createKeyLoadError(t,xg.KEY_LOAD_ERROR,new Error(`HTTP Error ${e.code} loading key ${e.text}`),s,Og({url:n.url,data:void 0},e)))},onTimeout:(e,i,s)=>{this.resetLoader(i),r(this.createKeyLoadError(t,xg.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),s))},onAbort:(e,i,s)=>{this.resetLoader(i),r(this.createKeyLoadError(t,xg.INTERNAL_ABORTED,new Error("key loading aborted"),s))}};s.load(n,d,l)})}resetLoader(e){const{frag:t,keyInfo:i,url:s}=e,a=i.loader;t.keyLoader===a&&(t.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[s],a&&a.destroy()}}function Hk(e){const{type:t}=e;switch(t){case Pg:return Cg;case Tg:return _g;default:return Lg}}function Vk(e,t){let i=e.url;return void 0!==i&&0!==i.indexOf("data:")||(i=t.url),i}class qk{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){const{hls:e}=this;e.on(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.on(kg.LEVEL_LOADING,this.onLevelLoading,this),e.on(kg.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(kg.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(kg.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){const{hls:e}=this;e.off(kg.MANIFEST_LOADING,this.onManifestLoading,this),e.off(kg.LEVEL_LOADING,this.onLevelLoading,this),e.off(kg.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(kg.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(kg.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){const t=this.hls.config,i=t.pLoader,s=t.loader,a=new(i||s)(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(const e in this.loaders){const t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){const{url:i}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:Sg,url:i,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){const{id:i,level:s,pathwayId:a,url:r,deliveryDirectives:n,levelInfo:o}=t;this.load({id:i,level:s,pathwayId:a,responseType:"text",type:Eg,url:r,deliveryDirectives:n,levelOrTrack:o})}onAudioTrackLoading(e,t){const{id:i,groupId:s,url:a,deliveryDirectives:r,track:n}=t;this.load({id:i,groupId:s,level:null,responseType:"text",type:Pg,url:a,deliveryDirectives:r,levelOrTrack:n})}onSubtitleTrackLoading(e,t){const{id:i,groupId:s,url:a,deliveryDirectives:r,track:n}=t;this.load({id:i,groupId:s,level:null,responseType:"text",type:Tg,url:a,deliveryDirectives:r,levelOrTrack:n})}onLevelsUpdated(e,t){const i=this.loaders[Eg];if(i){const e=i.context;e&&!t.levels.some(t=>t===e.levelOrTrack)&&(i.abort(),delete this.loaders[Eg])}}load(e){var t;const i=this.hls.config;let s,a=this.getInternalLoader(e);if(a){const t=this.hls.logger,i=a.context;if(i&&i.levelOrTrack===e.levelOrTrack&&(i.url===e.url||i.deliveryDirectives&&!e.deliveryDirectives))return void(i.url===e.url?t.log(`[playlist-loader]: ignore ${e.url} ongoing request`):t.log(`[playlist-loader]: ignore ${e.url} in favor of ${i.url}`));t.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),a.abort()}if(s=e.type===Sg?i.manifestLoadPolicy.default:Dg({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),a=this.createInternalLoader(e),vg(null==(t=e.deliveryDirectives)?void 0:t.part)){let t;if(e.type===Eg&&null!==e.level?t=this.hls.levels[e.level].details:e.type===Pg&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===Tg&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){const e=t.partTarget,i=t.targetduration;if(e&&i){const t=1e3*Math.max(3*e,.8*i);s=Dg({},s,{maxTimeToFirstByteMs:Math.min(t,s.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,s.maxTimeToFirstByteMs)})}}}const r=s.errorRetry||s.timeoutRetry||{},n={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:r.maxNumRetry||0,retryDelay:r.retryDelayMs||0,maxRetryDelay:r.maxRetryDelayMs||0},o={onSuccess:(e,t,i,s)=>{const a=this.getInternalLoader(i);this.resetInternalLoader(i.type);const r=e.data;0===r.indexOf("#EXTM3U")?(t.parsing.start=performance.now(),qv.isMediaPlaylist(r)||i.type!==Sg?this.handleTrackOrLevelPlaylist(e,t,i,s||null,a):this.handleMasterPlaylist(e,t,i,s)):this.handleManifestParsingError(e,i,new Error("no EXTM3U delimiter"),s||null,t)},onError:(e,t,i,s)=>{this.handleNetworkError(t,i,!1,e,s)},onTimeout:(e,t,i)=>{this.handleNetworkError(t,i,!0,void 0,e)}};a.load(e,n,o)}checkAutostartLoad(){if(!this.hls)return;const{config:{autoStartLoad:e,startPosition:t},forceStartLoad:i}=this.hls;(e||i)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,i,s){const a=this.hls,r=e.data,n=Vk(e,i),o=qv.parseMasterPlaylist(r,n);if(o.playlistParsingError)return void this.handleManifestParsingError(e,i,o.playlistParsingError,s,t);const{contentSteering:d,levels:l,sessionData:c,sessionKeys:h,startTimeOffset:p,variableList:u}=o;this.variableList=u;const{AUDIO:g=[],SUBTITLES:f,"CLOSED-CAPTIONS":m}=qv.parseMasterPlaylistMedia(r,n,o);if(g.length){g.some(e=>!e.url)||!l[0].audioCodec||l[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),g.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new pv({}),bitrate:0,url:""}))}a.trigger(kg.MANIFEST_LOADED,{levels:l,audioTracks:g,subtitles:f,captions:m,contentSteering:d,url:n,stats:t,networkDetails:s,sessionData:c,sessionKeys:h,startTimeOffset:p,variableList:u})}handleTrackOrLevelPlaylist(e,t,i,s,a){const r=this.hls,{id:n,level:o,type:d}=i,l=Vk(e,i),c=vg(o)?o:vg(n)?n:0,h=Hk(i),p=qv.parseLevelPlaylist(e.data,l,c,h,0,this.variableList);if(d===Sg){const e={attrs:new pv({}),bitrate:0,details:p,name:"",url:l};p.requestScheduled=t.loading.start+cy(p,0),r.trigger(kg.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:l,stats:t,networkDetails:s,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),i.levelDetails=p,this.handlePlaylistLoaded(p,e,t,i,s,a)}handleManifestParsingError(e,t,i,s,a){this.hls.trigger(kg.ERROR,{type:wg.NETWORK_ERROR,details:xg.MANIFEST_PARSING_ERROR,fatal:t.type===Sg,url:e.url,err:i,error:i,reason:i.message,response:e,context:t,networkDetails:s,stats:a})}handleNetworkError(e,t,i=!1,s,a){let r=`A network ${i?"timeout":"error"+(s?" (status "+s.code+")":"")} occurred while loading ${e.type}`;e.type===Eg?r+=`: ${e.level} id: ${e.id}`:e.type!==Pg&&e.type!==Tg||(r+=` id: ${e.id} group-id: "${e.groupId}"`);const n=new Error(r);this.hls.logger.warn(`[playlist-loader]: ${r}`);let o=xg.UNKNOWN,d=!1;const l=this.getInternalLoader(e);switch(e.type){case Sg:o=i?xg.MANIFEST_LOAD_TIMEOUT:xg.MANIFEST_LOAD_ERROR,d=!0;break;case Eg:o=i?xg.LEVEL_LOAD_TIMEOUT:xg.LEVEL_LOAD_ERROR,d=!1;break;case Pg:o=i?xg.AUDIO_TRACK_LOAD_TIMEOUT:xg.AUDIO_TRACK_LOAD_ERROR,d=!1;break;case Tg:o=i?xg.SUBTITLE_TRACK_LOAD_TIMEOUT:xg.SUBTITLE_LOAD_ERROR,d=!1}l&&this.resetInternalLoader(e.type);const c={type:wg.NETWORK_ERROR,details:o,fatal:d,url:e.url,loader:l,context:e,error:n,networkDetails:t,stats:a};if(s){const i=(null==t?void 0:t.url)||e.url;c.response=Og({url:i,data:void 0},s)}this.hls.trigger(kg.ERROR,c)}handlePlaylistLoaded(e,t,i,s,a,r){const n=this.hls,{type:o,level:d,id:l,groupId:c,deliveryDirectives:h}=s,p=Vk(t,s),u=Hk(s),g="number"==typeof s.level&&u===Lg?d:void 0;if(!e.fragments.length){const r=e.playlistParsingError=new Error("No Segments found in Playlist");return void n.trigger(kg.ERROR,{type:wg.NETWORK_ERROR,details:xg.LEVEL_EMPTY_ERROR,fatal:!1,url:p,error:r,reason:r.message,response:t,context:s,level:g,parent:u,networkDetails:a,stats:i})}e.targetduration||(e.playlistParsingError=new Error("Missing Target Duration"));const f=e.playlistParsingError;if(f){if(this.hls.logger.warn(f),!n.config.ignorePlaylistParsingErrors)return void n.trigger(kg.ERROR,{type:wg.NETWORK_ERROR,details:xg.LEVEL_PARSING_ERROR,fatal:!1,url:p,error:f,reason:f.message,response:t,context:s,level:g,parent:u,networkDetails:a,stats:i});e.playlistParsingError=null}switch(e.live&&r&&(r.getCacheAge&&(e.ageHeader=r.getCacheAge()||0),r.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),o){case Sg:case Eg:n.trigger(kg.LEVEL_LOADED,{details:e,levelInfo:s.levelOrTrack||n.levels[0],level:g||0,id:l||0,stats:i,networkDetails:a,deliveryDirectives:h,withoutMultiVariant:o===Sg});break;case Pg:n.trigger(kg.AUDIO_TRACK_LOADED,{details:e,track:s.levelOrTrack,id:l||0,groupId:c||"",stats:i,networkDetails:a,deliveryDirectives:h});break;case Tg:n.trigger(kg.SUBTITLE_TRACK_LOADED,{details:e,track:s.levelOrTrack,id:l||0,groupId:c||"",stats:i,networkDetails:a,deliveryDirectives:h})}}}class Kk{static get version(){return jy}static isMSESupported(){return zk()}static isSupported(){return function(){if(!zk())return!1;const e=Gg();return"function"==typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>e.isTypeSupported(Ff(t,"video")))||["mp4a.40.2","fLaC"].some(t=>e.isTypeSupported(Ff(t,"audio"))))}()}static getMediaSource(){return Gg()}static get Events(){return kg}static get MetadataSchema(){return lb}static get ErrorTypes(){return wg}static get ErrorDetails(){return xg}static get DefaultConfig(){return Kk.defaultConfig?Kk.defaultConfig:Tk}static set DefaultConfig(e){Kk.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new Ny,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;const t=this.logger=function(e,t,i){const s=Ng();if("object"==typeof console&&!0===e||"object"==typeof e){const a=["debug","log","info","warn","error"];a.forEach(t=>{s[t]=jg(t,e,i)});try{s.log(`Debug logs enabled for "${t}" in hls.js version 1.6.5`)}catch(e){return Ng()}a.forEach(t=>{zg[t]=jg(t,e)})}else Dg(zg,s);return s}(e.debug||!1,"Hls instance",e.assetPlayerId),i=this.config=function(e,t,i){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');const s=Lk(e),a=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach(e=>{const r=`${"level"===e?"playlist":e}LoadPolicy`,n=void 0===t[r],o=[];a.forEach(i=>{const a=`${e}Loading${i}`,d=t[a];if(void 0!==d&&n){o.push(a);const e=s[r].default;switch(t[r]={default:e},i){case"TimeOut":e.maxLoadTimeMs=d,e.maxTimeToFirstByteMs=d;break;case"MaxRetry":e.errorRetry.maxNumRetry=d,e.timeoutRetry.maxNumRetry=d;break;case"RetryDelay":e.errorRetry.retryDelayMs=d,e.timeoutRetry.retryDelayMs=d;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=d,e.timeoutRetry.maxRetryDelayMs=d}}}),o.length&&i.warn(`hls.js config: "${o.join('", "')}" setting(s) are deprecated, use "${r}": ${lm(t[r])}`)}),Og(Og({},s),t)}(Kk.DefaultConfig,e,t);this.userConfig=e,i.progressive&&Ck(i,t);const{abrController:s,bufferController:a,capLevelController:r,errorController:n,fpsController:o}=i,d=new n(this),l=this.abrController=new s(this),c=new jm(this),h=i.interstitialsController,p=h?this.interstitialsController=new h(this,Kk):null,u=this.bufferController=new a(this,c),g=this.capLevelController=new r(this),f=new o(this),m=new qk(this),v=i.contentSteeringController,y=v?new v(this):null,b=this.levelController=new Fk(this,y),w=new Uk(this),x=new Gk(this.config),k=this.streamController=new Bk(this,c,x),S=this.gapController=new _k(this,c);g.setStreamController(k),f.setStreamController(k);const E=[m,b,k];p&&E.splice(1,0,p),y&&E.splice(1,0,y),this.networkControllers=E;const P=[l,u,S,g,f,w,c];this.audioTrackController=this.createController(i.audioTrackController,E);const T=i.audioStreamController;T&&E.push(this.audioStreamController=new T(this,c,x)),this.subtitleTrackController=this.createController(i.subtitleTrackController,E);const L=i.subtitleStreamController;L&&E.push(this.subtititleStreamController=new L(this,c,x)),this.createController(i.timelineController,P),x.emeController=this.emeController=this.createController(i.emeController,P),this.cmcdController=this.createController(i.cmcdController,P),this.latencyController=this.createController($k,P),this.coreComponents=P,E.push(d);const C=d.onErrorOut;"function"==typeof C&&this.on(kg.ERROR,C,d),this.on(kg.MANIFEST_LOADED,m.onManifestLoaded,m)}createController(e,t){if(e){const i=new e(this);return t&&t.push(i),i}return null}on(e,t,i=this){this._emitter.on(e,t,i)}once(e,t,i=this){this._emitter.once(e,t,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,i=this,s){this._emitter.off(e,t,i,s)}listeners(e){return this._emitter.listeners(e)}emit(e,t,i){return this._emitter.emit(e,t,i)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),!this.triggeringException){this.triggeringException=!0;const i=e===kg.ERROR;this.trigger(kg.ERROR,{type:wg.OTHER_ERROR,details:xg.INTERNAL_EXCEPTION,fatal:i,event:e,error:t}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(kg.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;const e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){const t=new Error(`attachMedia failed: invalid argument (${e})`);return void this.trigger(kg.ERROR,{type:wg.OTHER_ERROR,details:xg.ATTACH_MEDIA_ERROR,fatal:!0,error:t})}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());const t="media"in e,i=t?e.media:e,s=t?e:{media:i};this._media=i,this.trigger(kg.MEDIA_ATTACHING,s)}detachMedia(){this.logger.log("detachMedia"),this.trigger(kg.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;const e=this.bufferController.transferMedia();return this.trigger(kg.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();const t=this.media,i=this._url,s=this._url=Zg.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${s}`),t&&i&&(i!==s||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(kg.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let i=0;i<this.networkControllers.length&&(this.networkControllers[i].startLoad(e,t),this.started&&this.networkControllers);i++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!this.started&&this.networkControllers);e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){const e={[Lg]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[Cg]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[_g]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");const e=this._media,t=null==e?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=function(){try{return crypto.randomUUID()}catch(e){try{const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}catch(e){let t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const i=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?i:3&i|8).toString(16)})}}}()),e}get levels(){const e=this.levelController.levels;return e||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){const e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){const t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){const{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){const{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){(function(e){return Jf.indexOf(e)>-1})(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return-1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){const{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;const i=e.length;for(let s=0;s<i;s++)if(e[s].maxBitrate>=t)return s;return 0}get maxAutoLevel(){const{levels:e,autoLevelCapping:t,maxHdcpLevel:i}=this;let s;if(s=-1===t&&null!=e&&e.length?e.length-1:t,i)for(let t=s;t--;){const s=e[t].attrs["HDCP-LEVEL"];if(s&&s<=i)return t}return s}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return(null==(t=this.audioTrackController)?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return(null==(t=this.subtitleTrackController)?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){const e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){const e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){const e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){const t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){const e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){const e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){const e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){const t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){const e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){const t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!(null==(e=this.bufferController)||!e.bufferedToEnd)}get interstitialsManager(){var e;return(null==(e=this.interstitialsController)?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){return Xf(e,hm(t),navigator.mediaCapabilities)}}function Yk(e){const t=Math.floor(e/3600),i=Math.floor(e%3600/60),s=Math.floor(e%60);return t>0?`${t}:${i.toString().padStart(2,"0")}:${s.toString().padStart(2,"0")}`:`${i}:${s.toString().padStart(2,"0")}`}Kk.defaultConfig=void 0;var Wk=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Zk=class{constructor(e){o(this,e),this.dyteAPIError=W(this,"dyteAPIError",7),this.statsIntervalTimer=null,this.t=Ht(),this.iconPack=Vt,this.isSupported=!0,this.playerState=at.IDLE,this.livestreamState="IDLE",this.livestreamId=null,this.audioPlaybackError=!1,this.qualityLevels=[],this.selectedQuality=-1,this.currentTime=0,this.duration=0,this.hideControls=!0,this.hideControlsTimeout=null,this.livestreamUpdateListener=e=>{this.playbackUrl=this.meeting.livestream.playbackUrl,this.livestreamState=e},this.updateProgress=()=>{this.currentTime=this.videoRef.currentTime},this.updateHlsStatsPeriodically=()=>{var e,t;this.duration=((null===(e=this.videoRef)||void 0===e?void 0:e.currentTime)||0)+((null===(t=this.hls)||void 0===t?void 0:t.latency)||0)},this.fastForwardToLatest=()=>{this.videoRef.currentTime=this.duration-1},this.togglePlay=()=>{this.videoRef.paused?(this.videoRef.play(),this.playerState=at.PLAYING):(this.videoRef.pause(),this.playerState=at.IDLE)},this.changeQuality=e=>{this.selectedQuality=e,this.hls&&(this.hls.currentLevel=e)},this.cleanupPlayer=()=>{var e;this.playerState=at.IDLE,this.videoRef&&(null===(e=this.hls)||void 0===e||e.destroy(),this.hls=null)},this.onMouseMovePlayer=()=>{this.hideControls=!1,clearTimeout(this.hideControlsTimeout),this.hideControlsTimeout=setTimeout(()=>{this.hideControls=!0},5e3)},this.getLoadingState=()=>{let e="",t=!1,i=!1;switch(this.livestreamState){case"IDLE":e=this.t("livestream.idle"),t=!0,i=!1;break;case"STARTING":e=this.t("livestream.starting"),t=!0,i=!0;break;case"STOPPING":e=this.t("livestream.stopping"),t=!0,i=!0;break;case"LIVESTREAMING":this.playerState!==at.PLAYING&&this.playerState!==at.PAUSED&&(e=this.t("livestream.starting"),i=!0,t=!0);break;default:t=!1,e=this.t(""),i=!0}return{isLoading:t,loadingMessage:e,showIcon:i}},this.getErrorState=()=>{var e,t;let i=!1,s="";return"LIVESTREAMING"!==this.livestreamState?(i=!1,s=this.t(""),{isError:i,errorMessage:s}):(this.isSupported||(i=!0,s=this.t("livestream.error.not_supported")),this.playbackUrl||(i=!0,s=this.t("livestream.error.not_found")),this.playerError&&(i=!0,s=this.t(null!==(t=null===(e=this.playerError)||void 0===e?void 0:e.message)&&void 0!==t?t:"livestream.error.unknown")),{isError:i,errorMessage:s})},this.initialiseAndPlayStream=async()=>{try{this.meeting.__internals__.logger.info(`dyte-livestream-player:: About to initialise HLS. VideoRef? ${!!this.videoRef} playbackUrl: ${this.playbackUrl}`),Kk.isSupported()?(this.meeting.__internals__.logger.info("dyte-livestream-player:: Initialising HLS. HLS is Supported"),this.hls=new Kk({lowLatencyMode:!1}),window.dyte_hls=this.hls,this.meeting.__internals__.logger.info("dyte-livestream-player:: Loading source"),this.hls.loadSource(this.playbackUrl),this.meeting.__internals__.logger.info("dyte-livestream-player:: Attaching video element to HLS"),this.hls.attachMedia(this.videoRef),this.meeting.__internals__.logger.info("dyte-livestream-player:: Waiting async for HLS manifest parsing"),this.hls.on(Kk.Events.ERROR,(e,t)=>{if(t.fatal){if(this.meeting.__internals__.logger.error(`dyte-livestream-player:: fatal error: ${t.details}`,{error:t.error}),this.playbackUrl&&"LIVESTREAMING"===this.livestreamState)return void setTimeout(()=>{this.playbackUrl&&"LIVESTREAMING"===this.livestreamState&&(this.meeting.__internals__.logger.info("dyte-livestream-player:: Retrying playbackUrl"),this.hls.loadSource(this.playbackUrl))},5e3)}else this.meeting.__internals__.logger.warn(`dyte-livestream-player:: non-fatal error: ${t.details}`,{error:t.error})}),this.hls.on(Kk.Events.MEDIA_ATTACHED,()=>{this.meeting.__internals__.logger.info("dyte-livestream-player:: media attached")}),this.hls.on(Kk.Events.MEDIA_DETACHED,()=>{this.meeting.__internals__.logger.info("dyte-livestream-player:: media detached")}),this.hls.on(Kk.Events.DESTROYING,()=>{this.meeting.__internals__.logger.info("dyte-livestream-player:: hls is getting destroyed")}),this.hls.on(Kk.Events.MANIFEST_PARSED,async(e,t)=>{this.meeting.__internals__.logger.info("dyte-livestream-player:: HLS manifest parsed");const{levels:i,autoLevelChangeAllowed:s}=function({meeting:e,hlsLevels:t}){let i=e.self.config.livestreamViewerQualities||[];if(!i.length)return{autoLevelChangeAllowed:!0,levels:t};const s=t.filter(e=>i.includes(e.height));return s.length?{autoLevelChangeAllowed:!1,levels:s}:{autoLevelChangeAllowed:!0,levels:t}}({meeting:this.meeting,hlsLevels:t.levels});this.qualityLevels=i.map((e,t)=>({level:t,resolution:e.height?`${e.height}p`:"auto"})),s&&(this.qualityLevels=[{level:-1,resolution:"Auto"},...this.qualityLevels]),this.hls.currentLevel=this.qualityLevels[0].level;try{this.meeting.__internals__.logger.info("dyte-livestream-player:: About to start video."),await this.videoRef.play(),this.meeting.__internals__.logger.info("dyte-livestream-player:: Video has started playing."),this.playerState=at.PLAYING}catch(e){this.audioPlaybackError=!0,this.meeting.__internals__.logger.error("dyte-livestream-player:: Video couldn't start. Trying with user gesture again.",{error:e})}}),this.videoRef.addEventListener("timeupdate",this.updateProgress),this.statsIntervalTimer=setInterval(this.updateHlsStatsPeriodically,1e3)):this.isSupported=!1}catch(e){this.meeting.__internals__.logger.error("dyte-livestream-player:: HLS couldn't initialise.",{error:e})}}}async updateLivestreamId(){const e=this.meeting.livestream.playbackUrl;if(!e||"LIVESTREAMING"!==this.livestreamState)return this.playbackUrl=null,this.livestreamId=null,void this.cleanupPlayer();const t=e.split("/"),i=t.findIndex(e=>"manifest"===e),s=t[i-1];this.livestreamId=s,await this.conditionallyStartLivestreamViewer()}async conditionallyStartLivestreamViewer(){this.videoRef&&this.playbackUrl&&!this.hls&&await this.initialiseAndPlayStream()}async connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.meeting.livestream.removeListener("livestreamUpdate",this.livestreamUpdateListener),this.videoRef.removeEventListener("timeupdate",this.updateProgress),clearInterval(this.statsIntervalTimer),this.videoRef=null,this.hls&&this.hls.destroy(),window.dyte_hls=null}meetingChanged(e){null!=e&&(this.playbackUrl=this.meeting.livestream.playbackUrl,this.livestreamState=this.meeting.livestream.state,this.meeting.livestream.on("livestreamUpdate",this.livestreamUpdateListener))}render(){var e,t;if(!st(this.meeting))return;const{isError:i,errorMessage:s}=this.getErrorState(),{isLoading:a,loadingMessage:r,showIcon:n}=this.getLoadingState();return z(G,null,z("div",{class:"player-container h-full max-h-full min-h-full w-full min-w-full max-w-full"},z("div",{ref:async e=>{this.videoContainerRef=e},class:"video-container relative flex h-full w-full flex-col items-center justify-center pb-20"},z("video",{onMouseMove:this.onMouseMovePlayer,ref:async e=>{this.videoRef=e,await this.conditionallyStartLivestreamViewer()},id:"livestream-video",style:{height:`${null===(e=this.el)||void 0===e?void 0:e.clientHeight}px`},controls:!1,onPlay:()=>{this.playerState===at.PAUSED&&(this.playerState=at.PLAYING)},onPause:()=>this.playerState=at.PAUSED}),this.playerState!==at.IDLE&&!this.hideControls&&z("div",{class:"control-bar",style:{width:`${null===(t=this.videoRef)||void 0===t?void 0:t.clientWidth}px`}},z("div",{class:"control-groups"},z("dyte-icon",{id:"playPause",onClick:this.togglePlay,size:"lg",class:"control-btn",icon:this.playerState===at.PLAYING?this.iconPack.pause:this.iconPack.play}),z("dyte-icon",{size:"lg",class:"control-btn",icon:this.iconPack.fastForward,onClick:this.fastForwardToLatest}),z("span",{class:"timings"},Yk(this.currentTime)," /"," ",Yk(this.duration))),z("div",{class:"control-groups"},z("select",{class:"level-select",onChange:e=>this.changeQuality(parseInt(e.target.value))},this.qualityLevels.map(e=>z("option",{value:e.level,selected:this.selectedQuality===e.level},e.resolution))),z("dyte-fullscreen-toggle",{id:"fullscreen",class:"control-btn fullscreen-btn",targetElement:this.videoContainerRef,size:"sm",iconPack:this.iconPack,t:this.t,ref:e=>{var t;const i=document.createElement("style");i.textContent="\n                        dyte-controlbar-button {\n                          display: contents;\n                          background-color: var(--bg-brand-500);\n                          color: var(--text-text-on-brand);\n                        }\n                      ",null===(t=null==e?void 0:e.shadowRoot)||void 0===t||t.appendChild(i)}})))),this.audioPlaybackError&&z("div",{class:"unmute-popup"},z("h3",null,this.t("audio_playback.title")),z("p",null,this.t("audio_playback.description")),z("dyte-button",{kind:"wide",onClick:()=>{this.audioPlaybackError=!1,this.videoRef&&(this.videoRef.muted=!1,this.videoRef.play(),this.playerState=at.PLAYING)},title:this.t("audio_playback")},this.t("audio_playback"))),i&&z("div",{class:"loader"},z("dyte-icon",{icon:this.iconPack.warning}),z("p",null,s)),!i&&a&&z("div",{class:"loader"},n&&z("dyte-spinner",{id:"icon",part:"spinner",iconPack:this.iconPack,size:"md"}),z("p",null,r))))}get el(){return Y(this)}static get watchers(){return{livestreamState:["updateLivestreamId"],meeting:["meetingChanged"]}}};Wk([si()],Zk.prototype,"meeting",void 0),Wk([si()],Zk.prototype,"size",void 0),Wk([si()],Zk.prototype,"t",void 0),Wk([si()],Zk.prototype,"iconPack",void 0),Zk.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:100%;max-height:100%;min-height:100%;width:100%;min-width:100%;max-width:100%;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}.player-container{position:relative;margin:var(--dyte-space-4, 16px);display:flex;flex-grow:1;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-md, 8px)}.loader{position:absolute;z-index:10;height:100%;width:100%;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));display:flex;flex-direction:column;align-items:center;justify-content:center}p{margin-top:var(--dyte-space-1, 4px);margin-bottom:var(--dyte-space-1, 4px);font-size:16px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.unmute-popup{position:absolute;z-index:30 !important;display:flex;width:var(--dyte-space-72, 288px);flex-direction:column;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));padding:var(--dyte-space-4, 16px);text-align:center;max-width:70%}.unmute-popup h3{margin:var(--dyte-space-0, 0px);font-size:16px;font-weight:500}.unmute-popup p{margin-top:var(--dyte-space-3, 12px);margin-bottom:var(--dyte-space-3, 12px);font-size:14px}.control-bar{position:absolute;bottom:0;display:flex;height:auto;justify-content:space-between;align-items:center;padding:10px 10px 0px 10px;z-index:10;}.timings{color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.control-btn{border:none;margin-right:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));cursor:pointer;font-size:24px;height:30px;width:30px}.fullscreen-btn{margin-right:20px;height:30px}.control-btn:hover{opacity:0.8}.control-btn:focus{outline:none}.control-groups{display:flex;align-items:center;justify-content:space-around}#livestream-video{aspect-ratio:16/9;max-width:100%;min-width:100%;left:var(--dyte-space-0, 0px);z-index:20;aspect-ratio:16 / 9;width:auto;border-radius:var(--dyte-border-radius-md, 8px);border-width:0px}.level-select{border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)));border:none;padding:5px 10px;font-size:14px;height:30px;cursor:pointer;border-radius:5px;margin-right:10px}.level-select:focus{outline:none}.level-select option{border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-1000, var(--dyte-colors-text-1000, 255 255 255)))}.volume-control-holder{display:flex;justify-content:center;align-items:center}";var Qk=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const Xk=class{constructor(e){o(this,e),this.variant="primary",this.iconPack=Vt,this.t=Ht(),this.viewerCount=0,this.disconnectMeeting=e=>{var t;null!=e&&null!=this.countListener&&(null===(t=e.livestream)||void 0===t||t.removeListener("viewerCountUpdate",this.countListener))}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){this.disconnectMeeting(this.meeting)}meetingChanged(e,t){var i;this.disconnectMeeting(t),null!=e&&(this.countListener=()=>{var t;this.viewerCount=null===(t=e.livestream)||void 0===t?void 0:t.viewerCount},this.countListener(),null===(i=e.livestream)||void 0===i||i.addListener("viewerCountUpdate",this.countListener))}render(){return st(this.meeting)?z(G,{tabIndex:0,role:"log","aria-label":`${this.viewerCount} ${this.t("viewers")}`},z("dyte-icon",{icon:this.iconPack.viewers,tabIndex:-1,"aria-hidden":!0,part:"icon"}),this.viewerCount," ",this.t("viewers")):null}static get watchers(){return{meeting:["meetingChanged"]}}};Qk([si()],Xk.prototype,"meeting",void 0),Qk([si()],Xk.prototype,"iconPack",void 0),Qk([si()],Xk.prototype,"t",void 0),Xk.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-left:var(--dyte-space-2, 8px);margin-right:var(--dyte-space-2, 8px);display:inline-flex;height:var(--dyte-space-10, 40px);-webkit-user-select:none;-moz-user-select:none;user-select:none;align-items:center;font-size:14px}:host([size='sm']){margin-left:var(--dyte-space-1, 4px);margin-right:var(--dyte-space-1, 4px);font-size:12px}dyte-icon{margin-right:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px)}:host([size='sm']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}:host([variant='embedded']){--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));opacity:0.5;margin-top:var(--dyte-space-1, 4px);margin-left:var(--dyte-space-1, 4px);height:var(--dyte-space-5, 20px);border-radius:var(--dyte-border-radius-sm, 4px);padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);font-size:12px}:host([variant='embedded']) dyte-icon{height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}";var Jk=Object.freeze({__proto__:null,dyte_livestream_indicator:mg,dyte_livestream_player:Zk,dyte_viewer_count:Xk});var eS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const tS=class{constructor(e){o(this,e),this.isScreenShare=!1,this.variant="default",this.iconPack=Vt,this.t=Ht(),this.length=13}sizeChanged(e){this.length="sm"===e?8:13}formatNameTag(e,t){return this.isScreenShare?t?`${this.t("screen")} - ${ai(e,this.length-3)} (${this.t("you")})`:`${this.t("screen")} - ${ai(e,this.length)}`:t?`${ai(e,this.length-3)} (${this.t("you")})`:ai(e,this.length)}render(){var e,t,i;const s=oi((null===(e=this.participant)||void 0===e?void 0:e.name)||""),a=(null===(t=this.participant)||void 0===t?void 0:t.id)===(null===(i=this.meeting)||void 0===i?void 0:i.self.id);return z(G,{key:"48c89f27ad186be7c0d06c38c6e640aacd83c822",title:s},z("slot",{key:"71ccde71840ab4c6e16b3e7ba52ba341a1c5154e",name:"start"}),z("span",{key:"30df6dcb1ed2fd4039f6d77d958797af2195af78",class:"name"},this.formatNameTag(s,a)),z("slot",{key:"2ad35bca0ed791fcaa1689db6de2293a0a91bb89",name:"end"}))}static get watchers(){return{size:["sizeChanged"]}}};eS([si()],tS.prototype,"meeting",void 0),eS([si()],tS.prototype,"size",void 0),eS([si()],tS.prototype,"iconPack",void 0),eS([si()],tS.prototype,"t",void 0),tS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:inline-flex;-webkit-user-select:none;-moz-user-select:none;user-select:none;align-items:center;padding-top:var(--dyte-space-1, 4px);padding-bottom:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-1\\.5, 6px);padding-right:var(--dyte-space-1\\.5, 6px);font-size:14px;border-radius:var(--dyte-border-radius-sm, 4px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}span.name{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}::slotted(dyte-audio-visualizer[slot='start']){margin-right:var(--dyte-space-1\\.5, 6px)}::slotted(dyte-audio-visualizer[slot='end']){margin-left:var(--dyte-space-1\\.5, 6px)}:host([size='sm']){font-size:12px;--tw-bg-opacity:0.6}:host([variant='text']){background-color:transparent;padding:var(--dyte-space-0, 0px)}";var iS=Object.freeze({__proto__:null,dyte_name_tag:tS});var sS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const aS=class{constructor(e){o(this,e),this.config=Ft,this.hideHeader=!1,this.iconPack=Vt,this.view="sidebar",this.t=Ht(),this.search="",this.participants=[],this.createParticipantNode=e=>{const t={meeting:this.meeting,view:this.view,t:this.t,config:this.config,states:this.states,size:this.size,iconPack:this.iconPack};return z("div",null,z(ls,{element:"dyte-participant",defaults:t,props:{role:"listitem",participant:e,key:e.id},childProps:Object.assign(Object.assign({},t),{participant:e,size:this.size}),deepProps:!0}))},this.updateStageList=()=>{this.getParticipants(this.search)}}connectedCallback(){this.meetingChanged(this.meeting),this.searchChanged(this.search)}disconnectedCallback(){const{participants:e,stage:t}=this.meeting;null!=this.meeting&&(this.participantJoinedListener&&this.meeting.participants.joined.removeListener("participantJoined",this.participantJoinedListener),this.participantLeftListener&&this.meeting.participants.joined.removeListener("participantLeft",this.participantLeftListener),e.joined.removeListener("stageStatusUpdate",this.updateStageList),null==t||t.removeListener("stageStatusUpdate",this.updateStageList))}meetingChanged(e){null!=e&&(this.participantJoinedListener=e=>{if("ON_STAGE"!==e.stageStatus)return;const t=this.search.toLowerCase();e.name.toLowerCase().includes(t)&&e.id.toLowerCase().includes(t)&&(this.participants=[...this.participants.filter(t=>t.id!==e.id),e])},this.participantLeftListener=e=>{this.participants=this.participants.filter(t=>t.id!==e.id)},e.participants.joined.addListener("participantJoined",this.participantJoinedListener),e.participants.joined.addListener("participantLeft",this.participantLeftListener),this.updateStageList(),null==e||e.participants.joined.on("stageStatusUpdate",this.updateStageList),null==e||e.stage.on("stageStatusUpdate",this.updateStageList))}searchChanged(e){this.getParticipants(e)}getParticipants(e=this.search){let t="ON_STAGE"===this.meeting.stage.status?[this.meeting.self]:[];t=[...t,...this.meeting.participants.joined.toArray().filter(e=>"ON_STAGE"===e.stageStatus)],this.participants=""===e?t:t.filter(t=>{var i;return(null!==(i=t.name)&&void 0!==i?i:t.id).toLowerCase().includes(e.toLowerCase())})}render(){return z(G,{key:"1cfe52f6c91528ce8d5e733beba07f1bb7d3e080"},z("div",{key:"5883133588f2b11d045244d30b5a0fa118dd4d4c",class:"participants-container"},!this.hideHeader&&z("div",{key:"5bc3c5b64c68496d32abd2e8921c45c0a1c078a5",class:"heading-count",part:"heading-count"},this.t("participants")," (",this.participants.length,")"),z("dyte-virtualized-participant-list",{key:"4e709fdb9c5b04920f9ce06a7ca359e6c57d84e5",items:this.participants,renderItem:this.createParticipantNode,part:"participants",class:"participants",emptyListElement:z("div",{class:"empty-stage-list"},this.search.length>0?this.t("search.could_not_find"):this.t("search.empty"))})))}static get watchers(){return{meeting:["meetingChanged"],search:["searchChanged"]}}};sS([si()],aS.prototype,"meeting",void 0),sS([si()],aS.prototype,"states",void 0),sS([si()],aS.prototype,"size",void 0),sS([si()],aS.prototype,"iconPack",void 0),sS([si()],aS.prototype,"t",void 0),aS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;width:100%;flex-direction:column;font-size:14px}.participants-container{margin-bottom:var(--dyte-space-4, 16px);height:100%;width:100%}h3,.heading-count{margin:var(--dyte-space-0, 0px);display:flex;align-items:center;justify-content:center;padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:400;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));text-align:center}.heading-count{font-size:14px}.participants{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.empty-stage-list{margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-4, 16px);text-align:center;font-size:12px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}dyte-participant{width:100%}";var rS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const nS=class{constructor(e){o(this,e),this.config=Ft,this.iconPack=Vt,this.view="sidebar",this.t=Ht(),this.stageRequestedParticipants=[],this.updateStageRequestedParticipants=()=>{this.stageRequestedParticipants=this.meeting.participants.joined.toArray().filter(e=>"REQUESTED_TO_JOIN_STAGE"===e.stageStatus)},this.acceptStageRequest=async e=>{const{userId:t}=e;await this.meeting.stage.grantAccess([t]),this.updateStageRequestedParticipants()},this.rejectStageRequest=async e=>{const{userId:t}=e;await this.meeting.stage.denyAccess([t]),this.updateStageRequestedParticipants()},this.acceptAllStageRequest=async()=>{await this.meeting.stage.grantAccess(this.stageRequestedParticipants.map(e=>e.userId)),this.updateStageRequestedParticipants()},this.denyAllStageRequest=async()=>{var e;await(null===(e=this.meeting.stage)||void 0===e?void 0:e.denyAccess(this.stageRequestedParticipants.map(e=>e.userId))),this.updateStageRequestedParticipants()},this.shouldShowStageRequests=()=>this.meeting.self.permissions.stageEnabled&&this.meeting.self.permissions.acceptStageRequests&&this.stageRequestedParticipants.length>0,this.updateRequestList=async e=>{var t,i,s,a,r,n,o;this.meeting.self.permissions.acceptStageRequests&&this.meeting.self.permissions.stageEnabled?"LIVESTREAM"===this.meeting.meta.viewType||"HIVE"===(null===(s=null===(i=null===(t=this.meeting)||void 0===t?void 0:t.self)||void 0===i?void 0:i.permissions)||void 0===s?void 0:s.mediaRoomType)?(e||(e=null!==(n=null===(r=await(null===(a=this.meeting.stage)||void 0===a?void 0:a.getAccessRequests()))||void 0===r?void 0:r.stageRequests)&&void 0!==n?n:[]),this.stageRequestedParticipants=e.map(e=>Object.assign(Object.assign({},e),{name:e.displayName}))):this.stageRequestedParticipants=null===(o=[this.meeting.self,...this.meeting.participants.joined.toArray()])||void 0===o?void 0:o.filter(e=>"REQUESTED_TO_JOIN_STAGE"===e.stageStatus):this.stageRequestedParticipants=[]}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){const{stage:e}=this.meeting;null==e||e.removeListener("stageAccessRequestUpdate",this.updateRequestList)}meetingChanged(e){var t;null!=e&&(this.updateRequestList(),null===(t=e.stage)||void 0===t||t.on("stageAccessRequestUpdate",this.updateRequestList))}render(){if("sidebar"===this.view&&this.shouldShowStageRequests())return z("div",{class:"stage-requested-participants"},z("div",{class:"heading-count",part:"staged-heading-count"},this.t("stage_request.header_title")," (",this.stageRequestedParticipants.length,")"),z("ul",{class:"participants",part:"staged-participants"},this.stageRequestedParticipants.map(e=>z("li",{class:"waiting-participant",key:e.id},z("div",{class:"participant-details"},z("dyte-avatar",{participant:e,size:"sm",iconPack:this.iconPack,t:this.t}),z("p",{class:"name",title:e.name},e.name)),z("div",{class:"waitlist-controls"},z("dyte-tooltip",{label:this.t("stage_request.deny_request"),variant:"secondary"},z("dyte-button",{variant:"secondary",kind:"icon",onClick:()=>this.rejectStageRequest(e)},z("dyte-icon",{class:"deny",icon:this.iconPack.dismiss}))),z("dyte-tooltip",{label:this.t("stage_request.accept_request"),variant:"secondary"},z("dyte-button",{variant:"secondary",kind:"icon",onClick:()=>this.acceptStageRequest(e)},z("dyte-icon",{class:"accept",icon:this.iconPack.checkmark}))))))),z("div",{class:"bulk-actions"},z("dyte-button",{class:"accept-all-button",variant:"secondary",onClick:this.acceptAllStageRequest},this.t("stage_request.accept_all")),z("dyte-button",{class:"deny-all-button",variant:"danger",onClick:this.denyAllStageRequest},this.t("stage_request.deny_all"))))}static get watchers(){return{meeting:["meetingChanged"]}}};rS([si()],nS.prototype,"meeting",void 0),rS([si()],nS.prototype,"size",void 0),rS([si()],nS.prototype,"iconPack",void 0),rS([si()],nS.prototype,"t",void 0),nS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-top:var(--dyte-space-2, 8px);display:flex;width:100%;flex-direction:column;font-size:14px}.stage-requested-participants{margin-bottom:var(--dyte-space-8, 32px)}.stage-requested-participants .bulk-actions{display:flex;gap:var(--dyte-space-2, 8px)}.stage-requested-participants .bulk-actions .accept-all-button{--tw-text-opacity:1;color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-text-opacity))}.stage-requested-participants .bulk-actions dyte-button{flex:1 1 0%}h3,.heading-count{margin:var(--dyte-space-0, 0px);display:flex;align-items:center;justify-content:center;padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:400;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));text-align:center}.heading-count{font-size:14px}.participants{margin-top:var(--dyte-space-2, 8px);padding:var(--dyte-space-0, 0px)}.waiting-participant{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);display:flex;align-items:center}.waiting-participant .participant-details{margin-right:auto;display:flex;align-items:center}.waiting-participant .participant-details dyte-avatar{margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);flex-shrink:0;font-size:14px}.waiting-participant .participant-details .name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88))}@media (min-width: 1080px){.waiting-participant .participant-details .name{max-width:var(--dyte-space-40, 160px)}}.waiting-participant .waitlist-controls{display:flex}.waiting-participant .waitlist-controls dyte-button{margin-left:var(--dyte-space-2, 8px);cursor:pointer;border-radius:var(--dyte-border-radius-sm, 4px)}.waiting-participant .waitlist-controls dyte-icon.accept{--tw-text-opacity:1;color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-text-opacity))}.waiting-participant .waitlist-controls dyte-icon.deny{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}";var oS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const dS=class{constructor(e){o(this,e),this.updateStageViewers=()=>{this.getViewers(this.search)},this.config=Ft,this.hideHeader=!1,this.iconPack=Vt,this.view="sidebar",this.search="",this.t=Ht(),this.stageViewers=[],this.createParticipantNode=e=>z("dyte-participant",{role:"listitem",key:e.id,meeting:this.meeting,participant:e,view:this.view,iconPack:this.iconPack,config:this.config,t:this.t}),this.shouldShowViewers=()=>{var e,t,i;return null===(i=null===(t=null===(e=this.meeting)||void 0===e?void 0:e.self)||void 0===t?void 0:t.permissions)||void 0===i?void 0:i.stageEnabled}}connectedCallback(){this.meetingChanged(this.meeting),this.searchChanged(this.search)}meetingChanged(e){null!=e&&(this.participantJoinedListener=e=>{if("ON_STAGE"===e.stageStatus)return;const t=this.search.toLowerCase();t.length>0&&!e.name.toLowerCase().includes(t)||(this.stageViewers=[...this.stageViewers.filter(t=>t.id!==e.id),e])},this.participantLeftListener=e=>{this.stageViewers=this.stageViewers.filter(t=>t.id!==e.id)},e.participants.joined.addListener("participantJoined",this.participantJoinedListener),e.participants.joined.addListener("participantLeft",this.participantLeftListener),e.participants.joined.on("stageStatusUpdate",this.updateStageViewers),e.stage.on("stageStatusUpdate",this.updateStageViewers))}searchChanged(e){this.getViewers(e)}disconnectedCallback(){const{participants:e,stage:t}=this.meeting;this.participantJoinedListener&&this.meeting.participants.joined.removeListener("participantJoined",this.participantJoinedListener),this.participantLeftListener&&this.meeting.participants.joined.removeListener("participantLeft",this.participantLeftListener),e.joined.removeListener("stageStatusUpdate",this.updateStageViewers),t.removeListener("stageStatusUpdate",this.updateStageViewers)}getViewers(e){let t="ON_STAGE"===this.meeting.stage.status?[]:[this.meeting.self];t=[...t,...this.meeting.participants.joined.toArray()].filter(e=>"ON_STAGE"!==e.stageStatus),this.stageViewers=""===e?t:t.filter(t=>{var i;return(null!==(i=t.name)&&void 0!==i?i:t.id).toLowerCase().includes(e.toLowerCase())})}render(){if("sidebar"===this.view&&this.shouldShowViewers())return z("div",{class:"list"},!this.hideHeader&&z("div",{class:"heading-count",part:"heading-count"},this.t("viewers")," (",this.stageViewers.length,")"),z("dyte-virtualized-participant-list",{items:this.stageViewers,renderItem:this.createParticipantNode,class:"participants",part:"participants",style:{height:"100%"},emptyListElement:z("div",{class:"empty-viewers-list"},this.search.length>0?this.t("participants.errors.empty_results"):this.t("participants.empty_list"))}))}static get watchers(){return{meeting:["meetingChanged"],search:["searchChanged"]}}};oS([si()],dS.prototype,"meeting",void 0),oS([si()],dS.prototype,"size",void 0),oS([si()],dS.prototype,"iconPack",void 0),oS([si()],dS.prototype,"t",void 0),dS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:100%;width:100%;flex-direction:column;font-size:14px}.list{margin-bottom:var(--dyte-space-4, 16px);display:flex;height:100%;flex-direction:column}h3,.heading-count{margin:var(--dyte-space-0, 0px);align-items:center;justify-content:center;padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:400;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));text-align:center}.heading-count{font-size:14px}.participants{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.empty-viewers-list{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);text-align:center;font-size:12px;color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}";var lS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const cS=class{constructor(e){o(this,e),this.config=Ft,this.iconPack=Vt,this.view="sidebar",this.t=Ht(),this.acceptWaitingRoomRequest=async e=>{await this.meeting.participants.acceptWaitingRoomRequest(e)},this.waitlistedParticipants=[],this.acceptAllWaitingRoomRequests=async()=>{await this.meeting.participants.acceptAllWaitingRoomRequest(this.waitlistedParticipants.map(e=>e.id))},this.rejectWaitingRoomRequest=async e=>{await this.meeting.participants.rejectWaitingRoomRequest(e)},this.shouldShowWaitlist=()=>"LIVESTREAM"!==this.meeting.meta.viewType&&(this.meeting.self.permissions.acceptWaitingRequests&&0!==this.waitlistedParticipants.length)}disconnectedCallback(){const{participants:e}=this.meeting;this.waitlistedParticipantJoinedListener&&e.waitlisted.removeListener("participantJoined",this.waitlistedParticipantJoinedListener),this.waitlistedParticipantLeftListener&&e.waitlisted.removeListener("participantLeft",this.waitlistedParticipantLeftListener),this.waitlistedParticipantsClearedListener&&e.waitlisted.removeListener("participantsCleared",this.waitlistedParticipantsClearedListener)}connectedCallback(){this.meetingChanged(this.meeting)}meetingChanged(e){null!=e&&(this.waitlistedParticipants=e.participants.waitlisted.toArray(),this.waitlistedParticipantJoinedListener=e=>{this.waitlistedParticipants.some(t=>t.id===e.id)||(this.waitlistedParticipants=[...this.waitlistedParticipants,e])},this.waitlistedParticipantLeftListener=e=>{this.waitlistedParticipants=this.waitlistedParticipants.filter(t=>t.id!==e.id)},this.waitlistedParticipantsClearedListener=()=>{this.waitlistedParticipants=[]},e.participants.waitlisted.addListener("participantJoined",this.waitlistedParticipantJoinedListener),e.participants.waitlisted.addListener("participantLeft",this.waitlistedParticipantLeftListener),e.participants.waitlisted.addListener("participantsCleared",this.waitlistedParticipantsClearedListener))}render(){if("sidebar"===this.view&&this.shouldShowWaitlist())return z("div",{class:"waiting-participants"},z("div",{class:"heading-count",part:"waitlisted-heading-count"},this.t("waitlist.header_title")," (",this.waitlistedParticipants.length,")"),z("ul",{class:"participants",part:"waitlisted-participants"},this.waitlistedParticipants.map(e=>z("li",{class:"waiting-participant",key:e.id},z("div",{class:"participant-details"},z("dyte-avatar",{participant:e,size:"sm",iconPack:this.iconPack,t:this.t}),z("p",{class:"name",title:e.name},e.name)),z("div",{class:"waitlist-controls"},z("dyte-tooltip",{label:this.t("waitlist.deny_request"),variant:"secondary"},z("dyte-button",{variant:"secondary",kind:"icon",onClick:()=>this.rejectWaitingRoomRequest(e.id)},z("dyte-icon",{class:"deny",icon:this.iconPack.dismiss}))),z("dyte-tooltip",{label:this.t("waitlist.accept_request"),variant:"secondary"},z("dyte-button",{variant:"secondary",kind:"icon",onClick:()=>this.acceptWaitingRoomRequest(e.id)},z("dyte-icon",{class:"accept",icon:this.iconPack.checkmark}))))))),z("dyte-button",{class:"accept-all-button",variant:"secondary",kind:"wide",onClick:this.acceptAllWaitingRoomRequests},this.t("waitlist.accept_all")))}static get watchers(){return{meeting:["meetingChanged"]}}};lS([si()],cS.prototype,"meeting",void 0),lS([si()],cS.prototype,"size",void 0),lS([si()],cS.prototype,"iconPack",void 0),lS([si()],cS.prototype,"t",void 0),cS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{margin-top:var(--dyte-space-4, 16px);margin-bottom:calc(var(--dyte-space-2, 8px) * -1);display:flex;width:100%;flex-direction:column;font-size:14px}.waiting-participants{margin-bottom:var(--dyte-space-8, 32px)}.waiting-participants .accept-all-button{--tw-text-opacity:1;color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-text-opacity))}h3,.heading-count{margin:var(--dyte-space-0, 0px);display:flex;align-items:center;justify-content:center;padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:400;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));text-align:center}.heading-count{font-size:14px}.participants{margin-top:var(--dyte-space-2, 8px);padding:var(--dyte-space-0, 0px)}.waiting-participant{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);display:flex;align-items:center}.waiting-participant .participant-details{margin-right:auto;display:flex;align-items:center}.waiting-participant .participant-details dyte-avatar{margin-right:var(--dyte-space-2, 8px);height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);flex-shrink:0;font-size:14px}.waiting-participant .participant-details .name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@media (min-width: 1080px){.waiting-participant .participant-details .name{max-width:var(--dyte-space-40, 160px)}}.waiting-participant .waitlist-controls{display:flex}.waiting-participant .waitlist-controls dyte-button{margin-left:var(--dyte-space-2, 8px);cursor:pointer;border-radius:var(--dyte-border-radius-sm, 4px)}.waiting-participant .waitlist-controls dyte-icon.accept{--tw-text-opacity:1;color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-text-opacity))}.waiting-participant .waitlist-controls dyte-icon.deny{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}";var hS=Object.freeze({__proto__:null,dyte_participants_stage_list:aS,dyte_participants_stage_queue:nS,dyte_participants_viewer_list:dS,dyte_participants_waiting_list:cS});var pS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const uS=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht(),this.canClosePlugin=!1,this.viewModeEnabled=!1,this.onIframeRef=e=>{var t;e!==this.iframeEl&&(this.iframeEl=e,null===(t=this.plugin)||void 0===t||t.addPluginView(e,"plugin-main"))},this.canInteractWithPlugin=()=>{const e=this.plugin.id;if(!e)return!0;const t=this.meeting.self.permissions.plugins.config[e];return!t||(!t.accessControl||"FULL_ACCESS"===t.accessControl)}}componentDidLoad(){this.meetingChanged(this.meeting),this.pluginChanged(this.plugin)}meetingChanged(e){if(null==e)return;const t=this.canInteractWithPlugin();this.viewModeEnabled=!t,P(()=>{this.canClosePlugin=e.self.permissions.plugins.canClose||this.plugin.enabledBy===e.self.id})}pluginChanged(e){this.toggleViewModeListener=e=>{this.canInteractWithPlugin()||(this.viewModeEnabled=e)},null!=e&&(this.iframeEl&&e.addPluginView(this.iframeEl,"plugin-main"),e.addListener("toggleViewMode",this.toggleViewModeListener))}disconnectedCallback(){var e,t;null===(e=this.plugin)||void 0===e||e.removePluginView("plugin-main"),null===(t=this.plugin)||void 0===t||t.removeListener("toggleViewMode",this.toggleViewModeListener)}render(){return null==this.plugin?null:z(G,null,z("header",{part:"header"},z("div",null,this.plugin.name),this.canClosePlugin&&z("div",null,z("dyte-button",{kind:"icon",onClick:()=>this.plugin.deactivate(),part:"button"},z("dyte-icon",{icon:this.iconPack.dismiss})))),z("div",{class:"iframe-container"},!this.canInteractWithPlugin()&&this.viewModeEnabled?z("div",{class:"block-inputs"}):null,z("iframe",{ref:e=>this.onIframeRef(e),part:"iframe"})))}static get watchers(){return{meeting:["meetingChanged"],plugin:["pluginChanged"]}}};pS([si()],uS.prototype,"meeting",void 0),pS([si()],uS.prototype,"iconPack",void 0),pS([si()],uS.prototype,"t",void 0),uS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:flex;height:100%;width:100%;flex-direction:column;overflow:hidden;border-radius:var(--dyte-border-radius-lg, 12px);color:rgb(var(--dyte-colors-text-1000, 255 255 255))}header{display:flex;height:var(--dyte-space-8, 32px);align-items:center;justify-content:space-between;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity))}header>div{display:flex;align-items:center}dyte-button{display:flex;height:var(--dyte-space-5, 20px);width:var(--dyte-space-5, 20px);flex-direction:column;align-items:center;border-radius:9999px}dyte-button dyte-icon{height:var(--dyte-space-3, 12px);width:var(--dyte-space-3, 12px)}iframe{display:block;flex:1 1 0%;margin:var(--dyte-space-0, 0px);border-width:var(--dyte-border-width-none, 0);border-style:none;padding:var(--dyte-space-0, 0px);outline:2px solid transparent;outline-offset:2px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-video-bg, 24 24 24) / var(--tw-bg-opacity))}.iframe-container{position:relative;height:100%;width:100%}.block-inputs{position:absolute;z-index:10;height:100%;width:100%;border-left-width:var(--dyte-border-width-none, 0);border-top-width:var(--dyte-border-width-lg, 4px);border-style:solid;--tw-border-opacity:1;border-color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-border-opacity))}iframe{height:100%;width:100%}";var gS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const fS=class{constructor(e){o(this,e),this.tabChange=W(this,"tabChange",7),this.config=Ft,this.layout="row",this.iconPack=Vt,this.t=Ht(),this.tabs=[]}render(){return z(G,{key:"8bdec657a4b6635cc2d3d73e79b4be08db404cb9"},z("dyte-spotlight-indicator",{key:"958fa41423f075e8110d272ea521cbfc8aa67aa4",meeting:this.meeting,iconPack:this.iconPack,t:this.t,size:this.size}),this.tabs.map(e=>{var t,i,s,a,r;let n=!1;if(("plugin"===(null===(t=this.activeTab)||void 0===t?void 0:t.type)&&e.plugin&&(null===(i=this.activeTab)||void 0===i?void 0:i.plugin.id)===e.plugin.id||"screenshare"===(null===(s=this.activeTab)||void 0===s?void 0:s.type)&&e.participant&&(null===(a=this.activeTab)||void 0===a?void 0:a.participant.id)===e.participant.id)&&(n=!0),"screenshare"===e.type){const t=e.participant,i=oi(t.name);return z("dyte-button",{title:`${i}'s Screen Share`,key:e.participant.id,kind:"icon",variant:n?"primary":"secondary",class:{tab:!0,active:n},onClick:()=>this.tabChange.emit(e)},z("div",{class:"center col"},z("dyte-icon",{icon:this.iconPack.share_screen_person}),z("span",{class:"name"},t.id===(null===(r=this.meeting)||void 0===r?void 0:r.self.id)?this.t("you"):ai(i,6))))}if("plugin"===e.type){const t=e.plugin;return z("dyte-button",{title:t.name,key:t.id,kind:"icon",variant:n?"primary":"secondary",class:{tab:!0,active:n},onClick:()=>this.tabChange.emit(e)},z("div",{class:"center col"},z("img",{src:t.picture}),z("span",{class:"name"},ai(t.name,6))))}}))}};gS([si()],fS.prototype,"size",void 0),gS([si()],fS.prototype,"meeting",void 0),gS([si()],fS.prototype,"states",void 0),gS([si()],fS.prototype,"iconPack",void 0),gS([si()],fS.prototype,"t",void 0),fS.style=".scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{box-sizing:border-box;display:flex;height:100%;width:var(--dyte-space-16, 64px);flex-direction:column;gap:var(--dyte-space-2, 8px);overflow-y:auto;font-family:var(--dyte-font-family, sans-serif)}dyte-button{z-index:10}.col{display:flex;flex-direction:column;align-items:center}.tab{display:flex;height:var(--dyte-space-16, 64px);width:var(--dyte-space-16, 64px);align-items:center;justify-content:center;margin-bottom:var(--dyte-space-2, 8px);font-size:12px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}.tab.active{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity))}.tab img{height:var(--dyte-space-7, 28px);width:var(--dyte-space-7, 28px);border-radius:var(--dyte-border-radius-sm, 4px)}.tab .name{margin-top:var(--dyte-space-0\\.5, 2px)}:host([size='sm']){flex-direction:column;margin-top:var(--dyte-space-4, 16px);height:var(--dyte-space-16, 64px);width:100%;flex-direction:row;gap:var(--dyte-space-2, 8px);overflow-x:auto}:host([size='sm']) .tab{margin:var(--dyte-space-0, 0px);text-overflow:clip;min-width:100px;height:40px}:host([size='sm']) .tab .col{display:flex;flex-direction:row;align-items:center;gap:var(--dyte-space-2, 8px)}:host([size='sm']) .tab .col img,:host([size='sm']) .tab .col dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}:host([size='sm']) .tab .col .name{gap:var(--dyte-space-1, 4px)}:host([layout='column']){flex-direction:column}:host([layout='column']) .aside{flex:2;max-width:100%;width:100%}@media (orientation: portrait){:host([size='sm']){margin-top:var(--dyte-space-2, 8px);height:var(--dyte-space-16, 64px);width:100%;flex-direction:row;transition:all 0.3s linear}:host([size='md']){height:var(--dyte-space-24, 96px);width:100%;flex-direction:row;transition:all 0.3s linear}:host .tab{margin:var(--dyte-space-0, 0px)}}@media (orientation: landscape){:host([size='sm']){margin-right:var(--dyte-space-4, 16px);height:100%;width:var(--dyte-space-14, 56px);flex-direction:row;gap:var(--dyte-space-2, 8px);overflow-y:auto;overflow-x:hidden;transition:all 0.3s linear}:host([size='md']){margin-right:var(--dyte-space-4, 16px);height:100%;width:var(--dyte-space-14, 56px);flex-direction:row;gap:var(--dyte-space-2, 8px);overflow-y:auto;overflow-x:hidden;transition:all 0.3s linear}:host .tab{margin:var(--dyte-space-0, 0px)}:host([size='sm']) .tab{margin:var(--dyte-space-0, 0px);width:100%;text-overflow:clip;min-width:0px;min-height:40px}:host([size='sm']) .tab .col{display:flex;flex-direction:column;align-items:center;gap:var(--dyte-space-2, 8px);font-size:10px}:host([size='sm']) .tab .col img,:host([size='sm']) .tab .col dyte-icon{height:var(--dyte-space-3, 12px);width:var(--dyte-space-3, 12px)}:host([size='sm']) .tab .col .name{gap:var(--dyte-space-1, 4px)}}";var mS=Object.freeze({__proto__:null,dyte_plugin_main:uS,dyte_tab_bar:fS});var vS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const yS=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.plugins=[],this.canStartPlugins=!1,this.canClosePlugins=!1,this.activatedPluginsId=[],this.close=()=>{this.stateUpdate.emit({activeSidebar:!1,sidebar:void 0})}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e;null===(e=this.meeting)||void 0===e||e.plugins.all.removeListener("stateUpdate",this.updateActivePlugins)}meetingChanged(e){null!=e&&(this.canStartPlugins=e.self.permissions.plugins.canStart,this.canClosePlugins=e.self.permissions.plugins.canClose,this.plugins=e.plugins.all.toArray().filter(t=>{var i;return!(null===(i=e.self.config.disabledPlugins)||void 0===i?void 0:i.includes(t.id))}),this.updateActivePlugins=()=>{this.activatedPluginsId=e.plugins.active.toArray().map(e=>e.id)},this.updateActivePlugins(),e.plugins.all.addListener("stateUpdate",this.updateActivePlugins))}render(){return z(G,{key:"2bca2470b4a694420b70f85c42c16c5e8ec9f079"},z("ul",{key:"c9d0ce582decd898e158375a42a428c404f11288",class:"scrollbar"},this.plugins.map(e=>z("li",{key:e.name,class:"plugin"},z("div",{class:"metadata"},z("img",{src:e.picture}),z("div",{class:"name"},e.name)),!this.activatedPluginsId.includes(e.id)&&this.canStartPlugins&&z("div",{class:"buttons"},z("dyte-button",{kind:"icon",size:"lg",onClick:()=>{e.activate(),this.close()},"aria-label":`${this.t("activate")} ${e.name}`},z("dyte-icon",{icon:this.iconPack.rocket,tabIndex:-1,"aria-hidden":!0}))),this.activatedPluginsId.includes(e.id)&&this.canClosePlugins&&z("div",{class:"buttons"},z("dyte-button",{kind:"icon",size:"lg",onClick:()=>{e.deactivate()},"aria-label":`${this.t("close")} ${e.name}`},z("dyte-icon",{icon:this.iconPack.dismiss,tabIndex:-1,"aria-hidden":!0})))))))}static get watchers(){return{meeting:["meetingChanged"]}}};vS([si()],yS.prototype,"meeting",void 0),vS([si()],yS.prototype,"size",void 0),vS([si()],yS.prototype,"iconPack",void 0),vS([si()],yS.prototype,"t",void 0),yS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{margin-top:var(--dyte-space-2, 8px);margin-bottom:var(--dyte-space-2, 8px);display:flex;height:100%;width:100%;flex-direction:column;font-size:14px;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}h3{margin-left:var(--dyte-space-0, 0px);margin-right:var(--dyte-space-0, 0px);margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-4, 16px);display:block;padding:var(--dyte-space-0, 0px);font-size:16px;font-weight:400;color:rgb(var(--dyte-colors-text-900, 255 255 255 / 0.88));text-align:center}ul{overflow-y:auto;padding:var(--dyte-space-0, 0px);flex-grow:1;flex-basis:0}.metadata{display:flex;align-items:center}.metadata img{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);border-radius:var(--dyte-border-radius-sm, 4px)}.metadata .name{margin-left:var(--dyte-space-2, 8px);font-weight:500}.plugin{display:flex;align-items:center;justify-content:space-between;padding-left:var(--dyte-space-4, 16px);padding-right:var(--dyte-space-4, 16px);padding-top:var(--dyte-space-2, 8px);padding-bottom:var(--dyte-space-2, 8px)}.plugin .buttons{display:flex;align-items:center}dyte-button:hover{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000);--tw-ring-opacity:1;--tw-ring-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-ring-opacity));--tw-ring-offset-width:2px;--tw-ring-offset-color:rgb(var(--dyte-colors-background-1000, 8 8 8))}";var bS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const wS=class{constructor(e){o(this,e),this.config=Ft,this.iconPack=Vt,this.t=Ht(),this.create=!1,this.onPollsUpdate=e=>{this.polls=[...e.polls]},this.onUpdatePermissions=()=>{this.permissions=this.meeting.self.permissions}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e;null!=this.meeting&&(null===(e=this.meeting.polls)||void 0===e||e.removeListener("pollsUpdate",this.onPollsUpdate),this.meeting.self.permissions.removeListener("pollsUpdate",this.onUpdatePermissions))}meetingChanged(e){null!=e&&(e&&!e.polls||(this.permissions=this.meeting.self.permissions,this.polls=[...e.polls.items],e.polls.addListener("pollsUpdate",this.onPollsUpdate),this.meeting.self.permissions.addListener("pollsUpdate",this.onUpdatePermissions),this.onCreate=async t=>{this.create=!1,await e.polls.create(t.question,t.options,t.anonymous,t.hideVotes)},this.onVote=async(t,i)=>{await e.polls.vote(t,i)}))}toggleCreateState(){this.create=!this.create}componentDidRender(){rs(this.pollEl)}render(){return z(G,{key:"a0488904cbdbdbe67b2ec50da2bfa318cff4f493"},z("div",{key:"05f6bdf2b6a1eeaff40abf9b9ea7c3f13da3d0da",class:"ctr",part:"container"},z("div",{key:"ec21f4d593a30189e5b8891cd7d9bc1cbca6f0c2",class:"polls-view scrollbar",ref:e=>this.pollEl=e,part:"polls"},0==this.polls.length&&!0!==this.create&&z("div",{key:"1f76f9fcb60d8e0e862a673c2582e23bacbd6009",class:"empty-polls"},this.t("polls.empty")),this.polls.map(e=>{var t;return z("dyte-poll",{key:e.id,poll:e,onDyteVotePoll:e=>{this.onVote(e.detail.id,e.detail.index)},self:null===(t=this.meeting)||void 0===t?void 0:t.self.userId,iconPack:this.iconPack,t:this.t,permissions:this.permissions})}),this.create&&z("dyte-poll-form",{key:"51d1a36308edaf71cf4bb2b607ff50c362ec55ed",part:"poll-form",onDyteCreatePoll:e=>{this.onCreate(e.detail)},iconPack:this.iconPack,t:this.t})),this.permissions.polls.canCreate&&z("dyte-button",{key:"8bb94218977ac5b90e5e5365aad490916ac62f65",kind:"wide",onClick:()=>this.toggleCreateState(),variant:this.create?"secondary":"primary",part:"button"},this.create?this.t("polls.cancel"):this.t("polls.create"))))}static get watchers(){return{meeting:["meetingChanged"]}}};bS([si()],wS.prototype,"meeting",void 0),bS([si()],wS.prototype,"size",void 0),bS([si()],wS.prototype,"iconPack",void 0),bS([si()],wS.prototype,"t",void 0),wS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}:host{margin-top:var(--dyte-space-2, 8px);display:flex;height:100%;width:100%;flex-direction:column;font-size:14px}*{box-sizing:border-box}.ctr{box-sizing:border-box;padding:var(--dyte-space-3, 12px);padding-top:var(--dyte-space-0, 0px);display:flex;flex:1 1 0%;flex-direction:column}.polls-view{overflow-y:auto;flex:1 1 0%;flex-basis:0}.empty-polls{display:flex;height:100%;width:100%;align-items:center;justify-content:center}";var xS=Object.freeze({__proto__:null,dyte_plugins:yS,dyte_polls:wS});const kS=class{constructor(e){o(this,e),this.dismiss=W(this,"dyteTranscriptDismiss",7),this.t=Ht()}connectedCallback(){this.transcriptChanged(this.transcript)}transcriptChanged(e,t){if((null==t?void 0:t.renderedId)===e.renderedId&&(null==t?void 0:t.transcript)===e.transcript)return;if(clearTimeout(this.timeout),!(null==e?void 0:e.name)||!(null==e?void 0:e.transcript))return;const{id:i,renderedId:s}=e;this.timeout=setTimeout(()=>{this.dismiss.emit({id:i,renderedId:s})},1e4)}render(){return z(G,{key:"45824f40e948a34c138417969042157d6a43643b"},z("div",{key:"e82cf7acd7d52810941ab8debae55c87216003f6",class:"ctr"},z("p",{key:"5be2f02fe841b3a54776c978fb9e5b19c1a17f88",class:"message"},z("span",{key:"cc581a69a6cca46dc07d698ccf1b10bc71d16f56",class:"name"},this.transcript.name),": ",this.transcript.transcript)))}static get watchers(){return{transcript:["transcriptChanged"]}}};!function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);r>3&&n&&Object.defineProperty(t,i,n)}([si()],kS.prototype,"t",void 0),kS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{pointer-events:none;display:block;color:rgb(var(--dyte-colors-text-1000, 255 255 255));display:flex;justify-content:center;vertical-align:middle;animation:show 0.4s ease;transition:0.4s;z-index:5;width:100%}.ctr{box-sizing:border-box;display:inline-flex;height:100%;align-items:center;padding-left:var(--dyte-space-3, 12px);padding-right:var(--dyte-space-3, 12px);-webkit-user-select:none;-moz-user-select:none;user-select:none;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);--tw-shadow-color:rgb(var(--dyte-colors-background-1000, 8 8 8));--tw-shadow:var(--tw-shadow-colored);pointer-events:auto;padding:var(--dyte-space-3, 12px);overflow:auto;max-width:50%}.message{margin:var(--dyte-space-0, 0px);display:inline-block;justify-content:center;max-width:100%;text-wrap:wrap;line-height:1.5rem}.message .name{font-weight:bold}:host(.exit){animation:exit 0.4s ease}@keyframes show{0%{opacity:0;transform:translateY(120px)}100%{opacity:1;transform:translateY(0px)}}@keyframes exit{0%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-120px)}}:host([size='sm']){font-size:14px}";var SS=Object.freeze({__proto__:null,dyte_transcript:kS});var ES=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const PS=class{constructor(e){o(this,e),this.stateUpdate=W(this,"dyteStateUpdate",7),this.variant="button",this.iconPack=Vt,this.t=Ht(),this.fullScreenActive=!1,this.isFullScreenSupported=!0,this.onFullScreenchange=()=>{this.fullScreenActive=Kp()},this.toggleFullScreen=()=>{let e=this.targetElement||document.querySelector("dyte-meeting");e&&(this.fullScreenActive?(qp(),this.fullScreenActive=!1):(Vp(e),this.fullScreenActive=!0),this.stateUpdate.emit({activeMoreMenu:!1}))}}connectedCallback(){this.isFullScreenSupported=Yp(),this.onFullScreenchange(),window.addEventListener("webkitfullscreenchange",this.onFullScreenchange),window.addEventListener("fullscreenchange",this.onFullScreenchange)}disconnectedCallback(){window.removeEventListener("webkitfullscreenchange",this.onFullScreenchange),window.removeEventListener("fullscreenchange",this.onFullScreenchange)}render(){return this.isFullScreenSupported?z(G,{title:this.t("full_screen")},z("dyte-controlbar-button",{size:this.size,iconPack:this.iconPack,onClick:this.toggleFullScreen,icon:this.fullScreenActive?this.iconPack.full_screen_minimize:this.iconPack.full_screen_maximize,label:this.fullScreenActive?this.t("full_screen.exit"):this.t("full_screen"),variant:this.variant})):z(G,{"data-hidden":!0})}};ES([si()],PS.prototype,"states",void 0),ES([si()],PS.prototype,"size",void 0),ES([si()],PS.prototype,"iconPack",void 0),ES([si()],PS.prototype,"t",void 0),PS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{display:block}:host([data-hidden]){display:none}";var TS=Object.freeze({__proto__:null,dyte_fullscreen_toggle:PS});var LS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const CS=class{constructor(e){o(this,e),this.dyteSendNotification=W(this,"dyteSendNotification",7),this.pinnedListener=({isPinned:e})=>{this.isPinned=e},this.toggleTileListener=({hidden:e})=>{this.isHidden=e},this.stageListener=({stageStatus:e})=>{this.isOnStage="ON_STAGE"===e},this.view="sidebar",this.iconPack=Vt,this.t=Ht(),this.config=Ft,this.audioEnabled=!1,this.videoEnabled=!1,this.isPinned=!1,this.isHidden=!1,this.isOnStage=!1,this.canDisableParticipantAudio=!1,this.canDisableParticipantVideo=!1,this.canKickParticipant=!1,this.canPinParticipant=!1,this.canAllowParticipantOnStage=!1,this.menuOpen=!1,this.permissionsUpdateListener=()=>{this.meetingChanged(this.meeting)},this.inviteToStageToggle=async()=>{const e=this.participant,{stage:t}=this.meeting;"ACCEPTED_TO_JOIN_STAGE"!==e.stageStatus?(this.isOnStage?(e.isPinned&&e.unpin(),await t.kick([e.userId])):(await t.grantAccess([e.userId]),this.dyteSendNotification.emit({message:`${e.name} ${this.t("stage.invited_notification")}`,trace:`join-stage-invite-${e.id}`})),this.isOnStage="ON_STAGE"===e.stageStatus):this.dyteSendNotification.emit({message:`${e.name} ${this.t("stage.invited_notification")}`,trace:`join-stage-${e.id}`})},this.handleOutsideClick=e=>{!e.composedPath().includes(this.host)&&this.menuOpen&&(this.menuOpen=!1)},this.update=()=>{const e=this.host.shadowRoot.getElementById("trigger"),t=this.host.shadowRoot.getElementById("menu-list");Xn(e,t,{placement:"bottom-end",middleware:[Kn({allowedPlacements:["bottom-end","top-end"],alignment:"end"}),qn(4),Yn({padding:8}),Zn()]}).then(({x:e,y:i,placement:s})=>{let a=null;a="bottom-end"===s?{right:`${e}px`,top:`${i}px`}:{right:`${e}px`,bottom:`${i}px`},Object.assign(t.style,a)})},this.onMenuToggle=()=>{this.menuOpen=!this.menuOpen,this.menuOpen&&this.update()}}connectedCallback(){this.meetingChanged(this.meeting),this.participantChanged(this.participant),document.addEventListener("click",this.handleOutsideClick)}disconnectedCallback(){var e;document.removeEventListener("click",this.handleOutsideClick),null===(e=this.meeting)||void 0===e||e.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener),null!=this.participant&&null!=this.participant.removeListener&&(this.audioUpdateListener&&this.participant.removeListener("audioUpdate",this.audioUpdateListener),this.videoUpdateListener&&this.participant.removeListener("videoUpdate",this.videoUpdateListener),this.participant.removeListener("pinned",this.pinnedListener),this.participant.removeListener("unpinned",this.pinnedListener),this.participant.removeListener("stageStatusUpdate",this.stageListener),this.participant.removeListener("toggleTile",this.toggleTileListener))}meetingChanged(e){var t,i,s,a,r,n,o;if(null!=e){const{self:d}=e;this.canDisableParticipantAudio=d.permissions.canAllowParticipantAudio||d.permissions.canDisableParticipantAudio,this.canDisableParticipantVideo=d.permissions.canAllowParticipantVideo||d.permissions.canDisableParticipantVideo,this.canKickParticipant=d.permissions.kickParticipant&&!0!==(null===(t=this.meeting)||void 0===t?void 0:t.__internals__.features.hasFeature(dt))&&(!0!==(null===(i=this.meeting)||void 0===i?void 0:i.__internals__.features.hasFeature(lt))||"webinar_admin"!==(null===(s=this.participant)||void 0===s?void 0:s.presetName)),this.canPinParticipant=d.permissions.pinParticipant,this.canAllowParticipantOnStage=d.permissions.acceptStageRequests&&d.permissions.stageEnabled&&(!0!==(null===(a=this.meeting)||void 0===a?void 0:a.__internals__.features.hasFeature(lt))||"webinar_admin"!==(null===(r=this.participant)||void 0===r?void 0:r.presetName))&&(!0!==(null===(n=this.meeting)||void 0===n?void 0:n.__internals__.features.hasFeature(ct))||"webinar_viewer"!==(null===(o=this.participant)||void 0===o?void 0:o.presetName)),e.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener)}}participantChanged(e){var t;if(null!=e){if(this.audioEnabled=e.audioEnabled,this.videoEnabled=e.videoEnabled,this.isPinned=e.isPinned,this.isHidden=null!==(t=e.hidden)&&void 0!==t&&t,this.isOnStage="ON_STAGE"===e.stageStatus,this.audioUpdateListener=({audioEnabled:e})=>{this.audioEnabled=e},this.videoUpdateListener=({videoEnabled:e})=>{this.videoEnabled=e},null==e.addListener)return;e.addListener("audioUpdate",this.audioUpdateListener),e.addListener("videoUpdate",this.videoUpdateListener),e.addListener("pinned",this.pinnedListener),e.addListener("unpinned",this.pinnedListener),e.addListener("stageStatusUpdate",this.stageListener),this.participant.addListener("toggleTile",this.toggleTileListener)}}render(){var e,t,i,s,a,r,n,o,d;const l="AUDIO_ROOM"===(null===(e=this.meeting)||void 0===e?void 0:e.meta.viewType),c=(null===(t=this.meeting)||void 0===t?void 0:t.self.id)===this.participant.id,h=this.canDisableParticipantAudio&&this.audioEnabled||this.canDisableParticipantVideo&&this.videoEnabled&&!l||this.canKickParticipant||this.canPinParticipant&&this.isOnStage||this.canAllowParticipantOnStage,p=oi((null===(i=this.participant)||void 0===i?void 0:i.name)||""),u=this.isOnStage||["GROUP_CALL","AUDIO_ROOM"].includes(null===(s=this.meeting)||void 0===s?void 0:s.meta.viewType),g={meeting:this.meeting,size:"sm",states:this.states,config:this.config,iconPack:this.iconPack,t:this.t};return z(G,{key:"6d2a340a09306d4981227b3048faeed243a14cce"},z("div",{class:"left",key:null===(a=this.participant)||void 0===a?void 0:a.id},z("dyte-avatar",{key:"bc8453dc32910051b58cf61fdd282a32955d1612",participant:this.participant,size:"sm",iconPack:this.iconPack,t:this.t}),z("p",{key:"ca4a796d5354d0fbe8d3358a321245a3d841a3f1",class:"name",title:p},ai(p,16)," ",(null===(r=this.meeting)||void 0===r?void 0:r.self.id)===(null===(n=this.participant)||void 0===n?void 0:n.id)&&this.t("(you)"))),"sidebar"===this.view&&z("div",{key:"febaee3e2c6c2fd398d1fb05f846fbef796d73fd",class:"right"},u&&z("dyte-icon",{key:"7eeb84f4a67cd6fdc4b2175ac5de5e32afd50486",class:{red:!this.audioEnabled},icon:this.audioEnabled?this.iconPack.mic_on:this.iconPack.mic_off}),u&&!l&&z("dyte-icon",{key:"21aaa6cca2ed53deb8b1276f8f1786c1089e2dd6",class:{red:!this.videoEnabled},icon:this.videoEnabled?this.iconPack.video_on:this.iconPack.video_off}),(h||(({element:e,defaults:t,props:i={},elementProps:s={}})=>{var a;const{config:r,size:n,states:o}=t;let d,l={},c=[];Array.isArray(e)?[d,l,...c]=e:d=e;const h=null===(a=null==r?void 0:r.root)||void 0===a?void 0:a[d];null!=h&&"props"in h&&(i=Object.assign(Object.assign({},h.props),i)),i=Object.assign(Object.assign({},i),l),d in s&&(i=Object.assign(Object.assign({},i),s[d]));const p=ns({element:d,size:n,states:o,config:r});return os({selectors:p,root:r.root}).length})({element:"dyte-participant",defaults:g,childProps:{participant:this.participant}})>0)&&z("div",{key:"6c7cc6c9a02e83fb1c87416b601dd1e016c3a549",class:"menu"},z("span",{key:"0dc87f46b4f0ceb1100a1a204f3b0dc92e042b12",id:"trigger",onClick:this.onMenuToggle},z("dyte-button",{key:"6e15059d18d929005ec8c820011de9046d69c5c6",variant:"ghost",kind:"icon",slot:"trigger"},z("dyte-icon",{key:"2424eb5e59c79fff940435486befc709b24dd5f5",class:"more",icon:this.iconPack.more_vertical}))),z("span",{key:"972e9250b7b434b1a6673b3924563535def9f114",id:"menu-list"},this.menuOpen&&z("dyte-menu-list",{key:"eb12f27f3eec66530257a9dc653f049a9b691569",iconPack:this.iconPack,t:this.t},this.canPinParticipant&&u&&!l&&z("dyte-menu-item",{key:"6fd8046b97eb6d97a872cf9b6b8d550d853aeaed",onClick:()=>{this.isPinned?this.participant.unpin():this.participant.pin()},iconPack:this.iconPack,t:this.t},z("dyte-icon",{key:"80f2a8d9b3a6ec7c4da6ca162865b296949ab07b",icon:this.isPinned?this.iconPack.pin_off:this.iconPack.pin,slot:"start"}),this.isPinned?this.t("unpin"):this.t("pin")),c&&z("dyte-menu-item",{key:"e784419ef130de759f507650de1bc92c6ac07c2a",iconPack:this.iconPack,t:this.t,onClick:()=>{this.isHidden?this.participant.show():this.participant.hide()}},z("dyte-icon",{key:"b349973219fb497d83b2a8852da0fc8558a1a51c",icon:this.isHidden?this.iconPack.minimize:this.iconPack.maximize,slot:"start"}),this.meeting.self.hidden?this.t("maximize"):this.t("minimize")),this.canDisableParticipantAudio&&u&&this.audioEnabled&&z("dyte-menu-item",{key:"a6aa845f9ed193e7aaecb8dfc13390b2aab672c3",iconPack:this.iconPack,t:this.t,onClick:()=>{this.participant.disableAudio()}},z("dyte-icon",{key:"e0ac24333a670684d60802edc085c0eb918571c0",icon:this.iconPack.mic_off,slot:"start"}),this.t("mute")),this.canDisableParticipantVideo&&u&&this.videoEnabled&&z("dyte-menu-item",{key:"07ec0b852abd9dc7739343ce5953fbdc8c4e9408",iconPack:this.iconPack,t:this.t,onClick:()=>{this.participant.disableVideo()}},z("dyte-icon",{key:"1cccc03618c740983971502a9bbb50ab86947170",icon:this.iconPack.video_off,slot:"start"}),this.t("participants.turn_off_video")),this.canAllowParticipantOnStage&&(null===(o=this.participant)||void 0===o?void 0:o.id)!==(null===(d=this.meeting)||void 0===d?void 0:d.self.id)&&z("dyte-menu-item",{key:"2ee271afaf0b99eb6b793abe337777251b4d2ce8",iconPack:this.iconPack,t:this.t,class:this.isOnStage?"red":"",onClick:this.inviteToStageToggle},z("dyte-icon",{key:"3734c9fa9bb9654d2c7d1b75bf53ad051020a88d",icon:this.isOnStage?this.iconPack.leave_stage:this.iconPack.join_stage,slot:"start"}),this.isOnStage?this.t("stage.remove_from_stage"):this.t("stage.add_to_stage")),!c&&this.canKickParticipant&&z("dyte-menu-item",{key:"2ecb4ee36b844bd605c72a13049d1508d6bc9e62",iconPack:this.iconPack,t:this.t,class:"red",onClick:()=>{var e,t;null===(e=this.meeting)||void 0===e||e.participants.kick(null===(t=this.participant)||void 0===t?void 0:t.id)}},z("dyte-icon",{key:"1e328de97168baf6c5bf66eb56eb3c6017ff4f90",icon:this.iconPack.dismiss,slot:"start"}),this.t("kick")),z("slot",{key:"73c6d605b84d57666f083484660f269a8bc9b36e"},z(ls,{key:"8dbbbf398d6ff4cd6d98d353ebb31326e99f4742",element:"dyte-participant",defaults:g,childProps:{participant:this.participant},deepProps:!0,onlyChildren:!0})))))))}get host(){return Y(this)}static get watchers(){return{meeting:["meetingChanged"],participant:["participantChanged"]}}};LS([si()],CS.prototype,"meeting",void 0),LS([si()],CS.prototype,"states",void 0),LS([si()],CS.prototype,"iconPack",void 0),LS([si()],CS.prototype,"t",void 0),CS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{position:relative;display:flex;height:var(--dyte-space-14, 56px);align-items:center;justify-content:space-between;cursor:pointer;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}:host dyte-avatar{height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);font-size:14px}.left{display:flex;align-items:center}.left>*{margin-right:var(--dyte-space-2, 8px)}.left>*:last-child{margin-right:var(--dyte-space-0, 0px)}.right{display:flex;align-items:center;justify-content:flex-end}.right>*{margin-left:var(--dyte-space-2, 8px)}.right>*:first-child{margin-left:var(--dyte-space-0, 0px)}.name{overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-6, 24px)}dyte-icon.red{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}dyte-icon.more{cursor:pointer}.menu{position:relative;display:inline-block;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}#menu-list{position:absolute;top:var(--dyte-space-8, 32px) !important;right:var(--dyte-space-4, 16px) !important;z-index:20}";const _S=class{constructor(e){o(this,e),this.items=[],this.itemHeight=55,this.bufferedItemsCount=5,this.emptyListElement=null,this.visibleStart=0,this.visibleEnd=0,this.containerHeight=0,this.lastScrollTop=0,this.recalculatePositioning=()=>{this.updateContainerHeight(),requestAnimationFrame(()=>{this.updateItemHeight()})},this.updateContainerHeight=()=>{this.el.querySelector(".virtual-list-container").clientHeight&&(requestAnimationFrame(()=>{this.updateItemHeight()}),this.containerHeight=this.el.querySelector(".virtual-list-container").clientHeight,this.updateVisibleRange())},this.onScroll=Oi(()=>{const e=this.el.querySelector(".virtual-list-container").scrollTop;e>this.lastScrollTop&&this.visibleEnd===this.items.length||(this.lastScrollTop=e,this.updateVisibleRange())})}itemsChanged(){this.recalculatePositioning()}componentDidLoad(){this.recalculatePositioning(),this.el.querySelector(".virtual-list-container").addEventListener("scroll",this.onScroll),window.addEventListener("resize",this.recalculatePositioning)}componentDidUpdate(){this.updateItemHeight()}disconnectedCallback(){this.el.querySelector(".virtual-list-container").removeEventListener("scroll",this.onScroll),window.removeEventListener("resize",this.recalculatePositioning)}updateVisibleRange(){const e=this.el.querySelector(".virtual-list-container").scrollTop,t=Math.floor(e/this.itemHeight),i=Math.ceil(this.containerHeight/this.itemHeight),s=Math.min(this.items.length,t+i+this.bufferedItemsCount);this.visibleStart=t,this.visibleEnd=s,this.el.querySelector(".virtual-list-container").scrollTop=this.lastScrollTop}updateItemHeight(){const e=this.el.querySelector(".virtual-list-item");if(e){const t=e.style.height;e.style.height="auto";const i=e.getBoundingClientRect().height;t&&(e.style.height=t),i&&Math.floor(i)!==Math.floor(this.itemHeight)&&(this.itemHeight=i)}}renderItems(){return this.items.slice(this.visibleStart,this.visibleEnd).map((e,t)=>{const i=this.visibleStart+t;return z("div",{class:"virtual-list-item",key:e.id,style:{position:"absolute",top:i*this.itemHeight+"px",height:`${this.itemHeight}px`,width:"100%"}},this.renderItem(e,i))})}render(){var e;const t=this.items.length*this.itemHeight;return z("div",{key:"1b37d3baa0af9ff413be304f5368849d20a47b23",class:"virtual-list-container",style:{position:"relative",height:"100%",overflowX:"hidden",overflowY:"auto"}},z("div",{key:"6bfd8b0993b3a78ea2317715e54c68cb4458ec5a",style:{height:`${t}px`,position:"relative"}},(null===(e=this.items)||void 0===e?void 0:e.length)?this.renderItems():this.emptyListElement),z("div",{key:"c6917ed47b4f3d579809f0b620f94aaf25779137",style:{height:`${this.itemHeight}px`}}))}get el(){return Y(this)}static get watchers(){return{items:["itemsChanged"]}}};_S.style=":host{height:100%;width:100%}";var AS=Object.freeze({__proto__:null,dyte_participant:CS,dyte_virtualized_participant_list:_S});var RS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const IS=class{constructor(e){o(this,e),this.onVote=W(this,"dyteVotePoll",7),this.iconPack=Vt,this.t=Ht(),this.MAX_VOTES_RENDER=10}vote(e,t){this.poll.voted.includes(this.self)?e.preventDefault():this.onVote.emit({id:this.poll.id,index:t})}render(){const e=this.poll.voted.includes(this.self);return z(G,{key:"d112ad1e82a81151c92e65892fc7de73e7293e13"},z("div",{key:"093a24d77c5a80b9ab0c92e766ecba29f23cd71b",class:"ctr"},z("p",{key:"4a92f6f8fca96e4ffeb0e196201e032a4e1240e9",class:"poll-title"},this.t("polls.by")," ",ai(oi(this.poll.createdBy),20)),z("div",{key:"1c822be138ff7ac8588a7def4a8f9bcc6c7dfacc",class:"poll"},z("p",{key:"59462f18d8018ed2ea8b175da135f144d43424f5",class:"poll-question"},this.poll.question),z("div",{key:"0dc955a9a6b3751f87ec2d9eaf5d9c36d9178601",class:"poll-answers"},z("span",{key:"5c32c86d1129884185d0778bf8f98f09542d8349"},this.t("polls.answers")),z("span",{key:"a0d07807de9040dad6ccb5c37a97095911ef4b5e"},this.poll.voted.length)),this.poll.options.map((t,i)=>z("div",{class:{active:t.votes.some(e=>e.id===this.self),"open-vote":this.permissions.polls.canVote&&!e,"poll-option":!0}},z("div",{class:"poll-option-header","data-disabled":!this.permissions.polls.canVote},z("label",null,!e&&z("input",{disabled:!this.permissions.polls.canVote,readOnly:e,type:"radio",checked:t.votes.some(e=>e.id===this.self),onClick:e=>this.vote(e,i)}),z("p",null,t.text)),z("span",{class:"counter"},t.count)),z("div",{class:"votes"},t.votes.slice(0,this.MAX_VOTES_RENDER).map(e=>{if(!this.poll.anonymous||this.self===this.poll.createdByUserId)return z("dyte-tooltip",{label:e.name},z("div",{class:"vote"},ci(e.name)))}),t.votes.length>this.MAX_VOTES_RENDER&&z("dyte-tooltip",{label:`+${t.votes.length-this.MAX_VOTES_RENDER} more `},z("div",{class:"vote"},"+",t.votes.length-this.MAX_VOTES_RENDER))))))))}};RS([si()],IS.prototype,"iconPack",void 0),RS([si()],IS.prototype,"t",void 0),IS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}.ctr{margin-bottom:var(--dyte-space-3, 12px);display:flex;width:100%;flex-direction:column;color:rgb(var(--dyte-colors-text-1000, 255 255 255))}.poll-title{margin-top:var(--dyte-space-3, 12px);margin-bottom:var(--dyte-space-3, 12px);margin-right:var(--dyte-space-4, 16px);font-size:12px}.poll{border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity));display:flex;flex-direction:column;padding:var(--dyte-space-4, 16px)}.poll-question{padding-left:var(--dyte-space-2, 8px);padding-right:var(--dyte-space-2, 8px);font-size:14px;overflow-wrap:break-word}.poll-answers{display:flex;flex-direction:row;justify-content:space-between;font-size:12px;margin-top:var(--dyte-space-4, 16px);margin-bottom:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-1, 4px);padding-right:var(--dyte-space-3, 12px)}.poll-option{display:flex;flex-direction:column;margin-top:var(--dyte-space-2, 8px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity));padding:var(--dyte-space-2, 8px);word-break:break-word}.poll-option.open-vote:hover{cursor:pointer}.poll-option label{display:flex;flex-direction:row;cursor:inherit}.poll-option-header{display:flex;flex-direction:row;justify-content:space-between;padding:var(--dyte-space-1, 4px)}.poll-option-header[data-disabled='true']:hover{cursor:default}.poll-option-header input{margin-top:var(--dyte-space-0, 0px);margin-bottom:var(--dyte-space-0, 0px);margin-left:var(--dyte-space-0\\.5, 2px);margin-right:var(--dyte-space-2, 8px);cursor:inherit}.poll-option-header .counter{color:rgb(var(--dyte-colors-text-1000, 255 255 255));font-size:12px}.votes{margin-top:var(--dyte-space-1, 4px);display:flex;flex-direction:row;flex-wrap:wrap}.vote{margin-right:var(--dyte-space-1, 4px);height:var(--dyte-space-8, 32px);width:var(--dyte-space-8, 32px);display:flex;align-items:center;justify-content:center;border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-video-bg, 24 24 24) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-1000, 255 255 255));border-radius:var(--dyte-border-radius-none, 0);clip-path:circle()}.active{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-on-brand-900, var(--dyte-colors-text-900, 255 255 255 / 0.88)))}.active .counter{color:rgb(var(--dyte-colors-text-on-brand-900, var(--dyte-colors-text-900, 255 255 255 / 0.88)))}";var DS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const MS=class{constructor(e){o(this,e),this.onCreate=W(this,"dyteCreatePoll",7),this.iconPack=Vt,this.t=Ht(),this.options=["",""],this.anonymous=!1,this.hideVotes=!0}removeOption(e){var t;this.options=this.options.filter((t,i)=>i!==e),1===(null===(t=this.error)||void 0===t?void 0:t.code)&&(this.error=void 0)}addOption(){this.options=[...this.options,""]}updateOption(e,t){var i;this.options[t]=e.target.value,1===(null===(i=this.error)||void 0===i?void 0:i.code)&&(this.error=void 0)}handleSubmit(){const e={question:this.question.value,options:this.options,anonymous:this.anonymous,hideVotes:!!this.anonymous||this.hideVotes};e.question?this.options.filter(e=>""===e.trim()).length>0?this.error={code:1,message:this.t("polls.errors.empty_option")}:this.onCreate.emit(e):this.error={code:0,message:this.t("polls.errors.question_required")}}render(){return z(G,{key:"b8a741187cb2d4d623d38d29c327c840ffe55170"},z("div",{key:"e438423cfea105fa66b64e5d853af419f64f0ef5",class:"create-poll"},z("p",{key:"e9fa70ea1bbfd5b183a1c1479442626753419cb2"},this.t("polls.question")),z("textarea",{key:"21178467f9f1b99be4dacfa04885e2e08a83ad9a",onInput:()=>{this.error&&0===this.error.code&&(this.error=void 0)},ref:e=>this.question=e,placeholder:this.t("polls.question.placeholder")}),this.options.map((e,t)=>z("div",{class:"option"},z("input",{placeholder:this.t("polls.option.placeholder"),value:e,onInput:e=>this.updateOption(e,t)}),t>1&&z("dyte-button",{kind:"icon",class:"auto remove-option",variant:"secondary",onClick:()=>this.removeOption(t)},z("dyte-icon",{icon:this.iconPack.subtract})))),z("dyte-button",{key:"bf5fdfa5c59b24f7fa63307ad5bf17928a813216",class:"add-option",variant:"secondary",onClick:()=>this.addOption()},this.t("polls.option")),z("label",{key:"822775583078aed4459d585947c563c21b5aa2c7"},z("input",{key:"f9a2c4ea5ccc3bd617b8f651d1bf9c9a0448d471",id:"anonymous",type:"checkbox",onChange:e=>this.anonymous=e.target.checked}),this.t("polls.results.anon")),z("label",{key:"697bb7f1e0a680b0b4e9abecd406714f6e1d8d64"},z("input",{key:"281eb7fac7a60ca8916f4ce604503f7ffa5f4294",id:"hideVotes",type:"checkbox",disabled:this.anonymous,checked:!!this.anonymous||this.hideVotes,onChange:e=>this.hideVotes=e.target.checked}),this.t("polls.results.hide")),z("dyte-button",{key:"f95fc843148dc84713c2d086f2ea867eb3247aa7",kind:"wide",onClick:()=>this.handleSubmit()},this.t("polls.create")),this.error&&z("span",{key:"266bc8776464b0c1c122bf68e14d197418b54d02",class:"error-text"},this.error.message)))}};DS([si()],MS.prototype,"iconPack",void 0),DS([si()],MS.prototype,"t",void 0),MS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}.scrollbar{scrollbar-width:thin;scrollbar-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))\n    var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar{height:var(--dyte-space-1\\.5, 6px);width:var(--dyte-space-1\\.5, 6px);border-radius:9999px;background-color:var(--dyte-scrollbar-background, transparent)}.scrollbar::-webkit-scrollbar-thumb{border-radius:9999px;background-color:var(--dyte-scrollbar-color, rgb(var(--dyte-colors-background-600, 60 60 60)))}.create-poll{margin-top:var(--dyte-space-3, 12px);margin-bottom:var(--dyte-space-3, 12px);display:flex;flex:1 1 0%;flex-direction:column;padding:var(--dyte-space-3, 12px);border-radius:var(--dyte-border-radius-md, 8px);--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}.create-poll p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px);text-align:center}.create-poll textarea{display:flex;border-radius:var(--dyte-border-radius-sm, 4px);padding:var(--dyte-space-2, 8px);font-family:var(--dyte-font-family, sans-serif);border-width:var(--dyte-border-width-none, 0);border-style:none;font-weight:500;outline:2px solid transparent;outline-offset:2px;margin-top:var(--dyte-space-3, 12px);margin-bottom:var(--dyte-space-3, 12px);resize:vertical;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.create-poll textarea:focus{outline-style:solid;outline-offset:2px;outline-color:rgb(var(--dyte-colors-background-600, 60 60 60))}.option{display:flex;flex-direction:row;align-items:center;margin-bottom:var(--dyte-space-3, 12px);width:100%}.option input{width:100%;border-radius:var(--dyte-border-radius-sm, 4px);padding:var(--dyte-space-2, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;outline:2px solid transparent;outline-offset:2px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));color:rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64))}.remove-option{margin-left:var(--dyte-space-2, 8px);width:var(--dyte-space-10, 40px);border-radius:var(--dyte-border-radius-sm, 4px)}.add-option{margin-bottom:var(--dyte-space-3, 12px)}label{margin-bottom:var(--dyte-space-3, 12px)}.error-text{margin-top:var(--dyte-space-3, 12px);text-align:center;font-size:12px;--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}";var OS=Object.freeze({__proto__:null,dyte_poll:IS,dyte_poll_form:MS});const US=class{constructor(e){o(this,e),this.tabChange=W(this,"tabChange",7),this.sidebarClose=W(this,"sidebarClose",7),this.view="sidebar",this.tabs=[],this.hideHeader=!1,this.hideCloseAction=!1,this.iconPack=Vt,this.t=Ht(),this.onClose=()=>{this.sidebarClose.emit()}}render(){const e="full-screen"===this.view,t=this.tabs.find(e=>e.id===this.currentTab);return z(G,{key:"3cc819dfdd7a7afb27c4d5c0caad190e744416e5",class:this.view},!this.hideCloseAction&&z("dyte-button",{key:"49f610426277037837150d9b5f732c86a8a008df",variant:"ghost",kind:"icon",class:"close",onClick:this.onClose,"aria-label":this.t("close")},z("dyte-icon",{key:"6c5f8cbb8d2e4b12e2e924aa7881811a5c6afa32",icon:this.iconPack.dismiss})),t&&!this.hideHeader&&z("header",{key:"f55415f94849e74606dd21973822dd9495d01327",class:"main-header"},z("h3",{key:"f240ff5fa5fe71e83d1c43ab705ec75903720c89"},t.name),z("slot",{key:"f4d05f1edd487c5d1c731914b94dae796cf1daf6",name:"pinned-state"})),e&&z("header",{key:"9a782da10bf0f63523ef96a5bd98708853489beb",class:"mobile-tabs"},this.tabs.map(e=>z("button",{onClick:()=>{this.tabChange.emit(e.id)},class:{active:this.currentTab===e.id}},e.name))),z("slot",{key:"2656a53d4f0ce0c8b4001292b667e5efa2adcc9d",name:this.currentTab}))}};!function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);r>3&&n&&Object.defineProperty(t,i,n)}([si()],US.prototype,"t",void 0),US.style=":host {\n  line-height: initial;\n  font-family: var(--dyte-font-family, sans-serif);\n\n  font-feature-settings: normal;\n  font-variation-settings: normal;\n}\n\np {\n  margin: var(--dyte-space-0, 0px);\n  padding: var(--dyte-space-0, 0px);\n}\n\n\n:host {\n  position: relative;\n  height: 100%;\n  width: 100%;\n  font-family: var(--dyte-font-family, sans-serif);\n  z-index: 50;\n  display: flex;\n  flex-direction: column;\n\n  container-type: size;\n  container-name: sidebarui;\n}\n\n@container sidebarui (height < 370px) {\n  .main-header {\n    height: var(--dyte-space-8, 32px) !important;\n  }\n  .close {\n    top: var(--dyte-space-0\\.5, 2px) !important;\n    left: var(--dyte-space-0, 0px) !important;\n    color: rgba(var(--dyte-colors-danger, 255 45 45) / 0.6);\n  }\n}\n\n:host([view='sidebar']) {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-900, 26 26 26) / var(--tw-bg-opacity));\n}\n\n:host([view='full-screen']) {\n  position: absolute;\n  top: var(--dyte-space-0, 0px);\n  right: var(--dyte-space-0, 0px);\n  bottom: var(--dyte-space-0, 0px);\n  left: var(--dyte-space-0, 0px);\n  max-width: 100%;\n  border: none;\n}\n\n::slotted(*) {\n  flex-grow: 1;\n}\n\n.close {\n  position: absolute;\n  top: var(--dyte-space-2, 8px);\n  left: var(--dyte-space-2, 8px);\n  z-index: 10;\n}\n\n.main-header {\n  position: relative;\n  display: flex;\n  height: var(--dyte-space-12, 48px);\n  place-items: center;\n  justify-content: center;\n}\n\n.main-header, \n.mobile-tabs {\n  flex-shrink: 0;\n}\n\n.mobile-tabs {\n  display: flex;\n  place-items: center;\n  justify-content: space-evenly;\n  border-bottom: 1px solid rgb(var(--dyte-colors-background-700, 44 44 44));\n}\n\n.mobile-tabs button {\n  margin: var(--dyte-space-0, 0px);\n  border-width: var(--dyte-border-width-none, 0);\n  border-style: none;\n  background-color: transparent;\n  padding: var(--dyte-space-0, 0px);\n  color: rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52));\n  height: var(--dyte-space-10, 40px);\n  cursor: pointer;\n  padding-left: var(--dyte-space-4, 16px);\n  padding-right: var(--dyte-space-4, 16px);\n  font-weight: 500;\n  border-bottom: 1px solid transparent;\n}\n\n.mobile-tabs button.active {\n  --tw-border-opacity: 1;\n  border-color: rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-border-opacity));\n  --tw-text-opacity: 1;\n  color: rgba(var(--dyte-colors-brand-300, 73 124 253) / var(--tw-text-opacity));\n}\n\nheader h3 {\n  font-size: 14px;\n  font-weight: 500;\n}\n\n@media only screen and (max-device-height: 480px) and (orientation: landscape) {\n  .main-header {\n    display: none !important;\n  }\n}\n\n.tab-participant-count-badge {\n  display: inline-block;\n  padding: 2px 5px;\n  border-radius: 9999px;\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-bg-opacity));\n  font-size: 12px;\n  color: rgb(var(--dyte-colors-text-700, 255 255 255 / 0.64));\n}\n\n.tab-participant-count-badge:not(.selected-tab) {\n  --tw-bg-opacity: 1;\n  background-color: rgba(var(--dyte-colors-background-600, 60 60 60) / var(--tw-bg-opacity));\n}\n\n.tab-participant-count-badge.requests-pending{\n  background-color: rgba(var(--dyte-colors-danger));\n}";var $S=Object.freeze({__proto__:null,dyte_sidebar_ui:US});var FS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const NS=class{constructor(e){o(this,e),this.iconPack=Vt,this.t=Ht(),this.permissionsUpdateListener=()=>{this.canSpotlight=this.meeting.self.permissions.canSpotlight}}connectedCallback(){this.meetingChanged(this.meeting)}disconnectedCallback(){var e;null===(e=this.meeting)||void 0===e||e.self.permissions.removeListener("permissionsUpdate",this.permissionsUpdateListener)}meetingChanged(e){var t,i;null!=e&&(this.canSpotlight=e.self.permissions.canSpotlight,this.isSpotlighted=null!==(i=null===(t=e.meta)||void 0===t?void 0:t.broadcastTabChanges)&&void 0!==i&&i,e.self.permissions.addListener("permissionsUpdate",this.permissionsUpdateListener))}updateSpotlightState(e){var t;try{null===(t=this.meeting.meta)||void 0===t||t.setBroadcastTabChanges(e),this.isSpotlighted=e}catch(e){console.error(e)}}render(){if(this.canSpotlight)return z(G,null,z("dyte-tooltip",{size:"md",label:this.t("remote_access.indicator")},z("div",{id:"sync-button",class:{tab:!0,active:this.isSpotlighted},onClick:()=>this.updateSpotlightState(!this.isSpotlighted)},z("span",{class:"name"},"Sync"),z("dyte-icon",{id:"icon",icon:this.isSpotlighted?this.iconPack.checkmark:this.iconPack.warning,tabIndex:-1,"aria-hidden":!0}))))}static get watchers(){return{meeting:["meetingChanged"]}}};FS([si()],NS.prototype,"meeting",void 0),FS([si()],NS.prototype,"iconPack",void 0),FS([si()],NS.prototype,"t",void 0),FS([si()],NS.prototype,"size",void 0),NS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{font-size:12px}#sync-button{flex-direction:row;border-radius:var(--dyte-border-radius-sm, 4px);padding-left:var(--dyte-space-1, 4px);display:flex;align-items:center;justify-content:center;margin-bottom:var(--dyte-space-1, 4px);font-size:12px;--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-700, 44 44 44) / var(--tw-bg-opacity))}:host([size='sm']) dyte-tooltip,:host([size='md']) dyte-tooltip{width:100%}:host([size='sm'])>#sync-button{height:var(--dyte-space-8, 32px);width:var(--dyte-space-16, 64px);padding-left:var(--dyte-space-0, 0px)}:host([size='md'])>#sync-button{height:var(--dyte-space-8, 32px);width:var(--dyte-space-16, 64px)}:host([size='lg'])>#sync-button{flex-direction:row;height:var(--dyte-space-8, 32px);width:var(--dyte-space-16, 64px)}@media (orientation: portrait){:host([size='lg']) #sync-button{flex-direction:column-reverse;height:var(--dyte-space-16, 64px);width:var(--dyte-space-16, 64px)}:host([size='md']) #sync-button{height:var(--dyte-space-16, 64px);width:var(--dyte-space-16, 64px)}:host([size='sm']) #sync-button{height:var(--dyte-space-10, 40px);width:var(--dyte-space-16, 64px);flex-direction:row}}#sync-button>dyte-icon{max-height:14px}#sync-button dyte-icon{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}:host([size='sm']) #sync-button>dyte-icon{width:auto}#sync-button.active dyte-icon{color:rgb(var(--dyte-colors-text-1000, 255 255 255))}div{align-content:center;line-height:2rem}dyte-icon{height:var(--dyte-space-6, 24px);width:var(--dyte-space-8, 32px)}#sync-button.active{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-success, 98 165 4) / var(--tw-bg-opacity))}";var jS=Object.freeze({__proto__:null,dyte_spotlight_indicator:NS});var zS=function(e,t,i,s){var a,r=arguments.length,n=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,s);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(n=(r<3?a(n):r>3?a(t,i,n):a(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};const BS=class{constructor(e){o(this,e),this.variant="button",this.showWarning=!1,this.disabled=!1,this.iconPack=Vt,this.brandIcon=!1}render(){return z(G,{key:"106768342cdfefe6b850dce971b861b9522eccd8"},z("button",{key:"51da1cbac6b462605d2a3746fb733072d3ff3a9a","aria-label":this.label,part:"button"},this.isLoading?z("dyte-spinner",{id:"icon",part:"spinner",iconPack:this.iconPack}):z("dyte-icon",{id:"icon",icon:this.icon,tabIndex:-1,"aria-hidden":!0,part:"icon"}),z("span",{key:"cd06da56f4a0ffa201463977f5fbb3d76434442a",class:"label",part:"label"},this.label),this.showWarning&&z("dyte-icon",{key:"36b6f5927ed22c3bff973e546aca5158790c2ef3",id:"warning-indicator",icon:this.iconPack.warning,part:"warning-indicator"})))}};zS([si()],BS.prototype,"size",void 0),zS([si()],BS.prototype,"iconPack",void 0),BS.style=":host{line-height:initial;font-family:var(--dyte-font-family, sans-serif);font-feature-settings:normal;font-variation-settings:normal}p{margin:var(--dyte-space-0, 0px);padding:var(--dyte-space-0, 0px)}:host{--background-color:var(\n    --dyte-controlbar-button-background-color,\n    rgb(var(--dyte-colors-background-1000, 8 8 8))\n  );--icon-size:var(--dyte-controlbar-button-icon-size, var(--dyte-space-7, 28px));position:relative;box-sizing:border-box;display:inline-flex;height:100%;width:auto;min-width:var(--dyte-space-20, 80px);-webkit-user-select:none;-moz-user-select:none;user-select:none;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms;color:rgb(var(--dyte-colors-text-1000, 255 255 255));background-color:var(--background-color)}button{padding:var(--dyte-space-1, 4px)}:host(.red-icon) #icon{--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}:host([disabled]){color:rgb(var(--dyte-colors-text-600, 255 255 255 / 0.52))}button{box-sizing:border-box;display:inline-flex;height:100%;width:100%;flex:1 1 0%;flex-direction:column;gap:var(--dyte-space-1, 4px);padding-left:var(--dyte-space-1, 4px);padding-right:var(--dyte-space-1, 4px);align-items:center;justify-content:center;cursor:pointer;border-radius:var(--dyte-border-radius-md, 8px);border-width:var(--dyte-border-width-none, 0);border-style:none;background-color:transparent;color:inherit;outline-offset:-2px;border:var(--dyte-border-width-md, 2px) solid transparent}.label{text-align:center;font-size:12px;overflow:hidden;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1}#warning-indicator{position:absolute;top:var(--dyte-space-1, 4px);right:var(--dyte-space-2, 8px);height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px);--tw-text-opacity:1;color:rgba(var(--dyte-colors-warning, 255 205 7) / var(--tw-text-opacity))}:host([size='sm']) #warning-indicator{right:var(--dyte-space-0, 0px);top:var(--dyte-space-0, 0px);height:var(--dyte-space-3, 12px);width:var(--dyte-space-3, 12px)}:host(:hover) button{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-800, 30 30 30) / var(--tw-bg-opacity))}#icon{width:var(--icon-size);height:var(--icon-size)}:host(.leave:hover) button{--tw-bg-opacity:1;background-color:rgba(var(--dyte-colors-background-1000, 8 8 8) / var(--tw-bg-opacity));--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity));border:var(--dyte-border-width-md, 2px) solid rgb(var(--dyte-colors-danger, 255 45 45))}:host(.active) button{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-400, 53 110 253) / var(--tw-text-opacity));border:var(--dyte-border-width-md, 2px) solid rgb(var(--dyte-colors-brand-400, 53 110 253))}button:focus-visible{outline:2px solid rgb(var(--dyte-colors-brand-400, 53 110 253))}:host(.active-livestream){--tw-text-opacity:1;color:rgba(var(--dyte-colors-danger, 255 45 45) / var(--tw-text-opacity))}:host([size='sm']){min-width:var(--dyte-space-14, 56px)}:host([size='sm']) .label{display:none}:host([variant='horizontal']){width:100%}:host([variant='horizontal']) button{border-radius:7px;height:var(--dyte-space-12, 48px);width:100%;padding-left:var(--dyte-space-5, 20px);padding-right:var(--dyte-space-5, 20px);padding-top:var(--dyte-space-3, 12px);padding-bottom:var(--dyte-space-3, 12px);flex-direction:row;justify-content:flex-start;gap:var(--dyte-space-3, 12px)}:host([variant='horizontal']) #icon{width:var(--dyte-space-6, 24px)}:host([variant='horizontal']) .label{display:block;font-size:14px;line-height:1.25rem}:host([variant='horizontal']) #warning-indicator{right:auto;left:var(--dyte-space-4, 16px)}:host([brand-icon]) dyte-icon#icon{--tw-text-opacity:1;color:rgba(var(--dyte-colors-brand-500, 33 96 253) / var(--tw-text-opacity))}@media only screen and (max-device-height: 480px) and (orientation: landscape){:host .label{display:none}:slotted(dyte-icon){height:var(--dyte-space-4, 16px);width:var(--dyte-space-4, 16px)}}";var GS=Object.freeze({__proto__:null,dyte_controlbar_button:BS});return e.defineCustomElements=async(e,t)=>{if("undefined"!=typeof window)return await void 0,Ge(JSON.parse('[["dyte-audio-visualizer_64",[[1,"dyte-meeting",{"loadConfigFromPreset":[1028,"load-config-from-preset"],"applyDesignSystem":[1028,"apply-design-system"],"mode":[513],"leaveOnUnmount":[4,"leave-on-unmount"],"meeting":[16],"showSetupScreen":[1028,"show-setup-screen"],"t":[16],"config":[1040],"size":[1537],"gridLayout":[1,"grid-layout"],"iconPack":[16]},[[0,"dyteStateUpdate","listenState"]],{"meeting":["meetingChanged"]}],[1,"dyte-chat",{"meeting":[16],"config":[16],"size":[513],"iconPack":[16],"t":[16],"disablePrivateChat":[4,"disable-private-chat"],"privatePresetFilter":[16],"displayFilter":[16],"canPinMessages":[32],"unreadCountGroups":[32],"chatGroups":[32],"selectedGroup":[32],"now":[32],"dropzoneActivated":[32],"showLatestMessageButton":[32],"canSend":[32],"canSendTextMessage":[32],"canSendFiles":[32],"canPrivateMessage":[32],"canSendPrivateTexts":[32],"canSendPrivateFiles":[32],"emojiPickerEnabled":[32],"chatRecipientId":[32],"participants":[32],"selectedParticipant":[32],"channels":[32],"selectedChannelId":[32],"editingMessage":[32],"replyMessage":[32],"searchQuery":[32],"selectorState":[32],"creatingChannel":[32],"showPinnedMessages":[32]},[[8,"editMessageInit","onEditMessageInit"],[0,"switchChannel","channelSwitchListener"]],{"meeting":["meetingChanged"],"chatGroups":["chatGroupsChanged"],"displayFilter":["onDisplayFilterChanged"]}],[1,"dyte-dialog-manager",{"meeting":[16],"config":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16]},null,{"meeting":["meetingChanged"]}],[1,"dyte-chat-messages-ui",{"selectedGroup":[1,"selected-group"],"messages":[16],"selfUserId":[1,"self-user-id"],"canPinMessages":[4,"can-pin-messages"],"size":[513],"iconPack":[16],"t":[16],"now":[32],"showLatestMessageButton":[32]},null,{"messages":["chatChanged"],"selectedGroup":["selectedBucketChanged"]}],[1,"dyte-chat-messages-ui-paginated",{"meeting":[16],"selectedChannel":[16],"selectedChannelId":[1,"selected-channel-id"],"size":[513],"iconPack":[16],"t":[16],"leftAlign":[4,"left-align"],"children":[32],"permissionsChanged":[32]},null,{"meeting":["meetingChanged"],"selectedChannelId":["channelChanged"]}],[1,"dyte-chat-search-results",{"meeting":[16],"query":[1],"channelId":[1,"channel-id"],"iconPack":[16],"t":[16]}],[1,"dyte-chat-composer-view",{"canSendTextMessage":[4,"can-send-text-message"],"canSendFiles":[4,"can-send-files"],"message":[1],"quotedMessage":[1,"quoted-message"],"storageKey":[1,"storage-key"],"inputTextPlaceholder":[1,"input-text-placeholder"],"isEditing":[4,"is-editing"],"iconPack":[16],"t":[16],"maxLength":[2,"max-length"],"disableEmojiPicker":[4,"disable-emoji-picker"],"rateLimits":[16],"fileToUpload":[32],"isEmojiPickerOpen":[32],"disableSendButton":[32],"rateLimitsBreached":[32]}],[0,"dyte-channel-header",{"meeting":[16],"channel":[16],"iconPack":[16],"t":[16],"showBackButton":[4,"show-back-button"],"showChannelDetailsDialog":[32],"showSearchBar":[32],"members":[32]},null,{"channel":["onChannelChanged"]}],[1,"dyte-channel-selector-view",{"channels":[16],"selectedChannelId":[1,"selected-channel-id"],"disableSearch":[4,"disable-search"],"hideAvatar":[4,"hide-avatar"],"iconPack":[16],"t":[16],"viewAs":[1,"view-as"],"searchQuery":[32],"showDropdown":[32]}],[1,"dyte-notifications",{"meeting":[16],"states":[16],"config":[16],"t":[16],"size":[513],"iconPack":[16],"notifications":[32]},[[8,"dyteAPIError","apiErrorListener"],[8,"dyteSendNotification","sendNotificationListener"]],{"meeting":["meetingChanged"],"config":["configChanged"],"states":["statesChanged"]}],[1,"dyte-chat-message",{"message":[16],"isContinued":[4,"is-continued"],"child":[16],"isUnread":[4,"is-unread"],"size":[513],"iconPack":[16],"t":[16],"isSelf":[4,"is-self"],"canEdit":[4,"can-edit"],"canDelete":[4,"can-delete"],"canReply":[4,"can-reply"],"canPin":[4,"can-pin"],"disableControls":[4,"disable-controls"],"alignRight":[4,"align-right"],"senderDisplayPicture":[1,"sender-display-picture"],"hideAvatar":[4,"hide-avatar"],"leftAlign":[4,"left-align"],"now":[32]}],[1,"dyte-settings",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"activeTab":[32],"isMobileMainVisible":[32],"networkStatus":[32],"canProduceVideo":[32]},null,{"meeting":["meetingChanged"]}],[1,"dyte-breakout-rooms-manager",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16],"loading":[32],"roomConfig":[32],"draftState":[32],"assigningParticipants":[32],"selectedParticipants":[32],"ephemeralStatusText":[32],"isDragMode":[32]},[[0,"participantDelete","onParticipantDelete"],[0,"participantsDragging","toggleDragMode"],[0,"selectedParticipantsUpdate","updateSelectedParticipants"],[0,"allParticipantsToggleUpdate","updateAllParticipants"]],{"selectedParticipants":["onSelectedParticipantsChanged"]}],[1,"dyte-debugger",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"activeTab":[32],"isMobileMainVisible":[32],"progress":[32]},[[0,"testProgress","progressUpdate"]]],[1,"dyte-channel-creator",{"meeting":[16],"t":[16],"iconPack":[16],"channelName":[32],"searchQuery":[32],"step":[32],"loading":[32],"selectedMemberIds":[32],"focusedMemberIndex":[32],"showAllMembersList":[32]}],[1,"dyte-channel-details",{"channel":[16],"t":[16],"iconPack":[16],"members":[16]}],[1,"dyte-draft-attachment-view",{"iconPack":[16],"t":[16],"attachment":[16],"filePreview":[32]},null,{"attachment":["onAttachmentChange"]}],[1,"dyte-emoji-picker-button",{"iconPack":[16],"t":[16],"isActive":[4,"is-active"]}],[1,"dyte-file-picker-button",{"filter":[1],"label":[1],"icon":[1],"iconPack":[16],"t":[16]}],[1,"dyte-broadcast-message-modal",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16],"messagePayload":[32],"successMessage":[32]}],[1,"dyte-image-viewer",{"image":[16],"size":[513],"t":[16],"iconPack":[16]}],[1,"dyte-join-stage",{"meeting":[16],"config":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"dataConfig":[16],"isLoading":[32]}],[1,"dyte-notification",{"notification":[16],"size":[513],"iconPack":[16],"t":[16],"imageState":[32]},null,{"notification":["notificationChanged"]}],[1,"dyte-permissions-message",{"meeting":[16],"t":[16],"iconPack":[16],"states":[16],"device":[32],"currentStep":[32],"svgSteps":[32]},null,{"meeting":["meetingChanged"]}],[1,"dyte-confirmation-modal",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16]}],[1,"dyte-leave-meeting",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16],"canEndMeeting":[32]},null,{"meeting":["meetingChanged"]}],[1,"dyte-mute-all-confirmation",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16],"allowUnmute":[32]}],[1,"dyte-overlay-modal",{"meeting":[16],"states":[16],"iconPack":[16],"t":[16]}],[1,"dyte-text-composer-view",{"disabled":[4],"placeholder":[1],"value":[1],"maxLength":[2,"max-length"],"rateLimitBreached":[4,"rate-limit-breached"],"keyDownHandler":[16],"iconPack":[16],"t":[16],"maxLengthBreached":[32],"setText":[64]}],[1,"dyte-message-view",{"actions":[16],"variant":[1],"viewType":[1,"view-type"],"avatarUrl":[1,"avatar-url"],"hideAvatar":[4,"hide-avatar"],"authorName":[1,"author-name"],"hideAuthorName":[4,"hide-author-name"],"hideMetadata":[4,"hide-metadata"],"time":[16],"iconPack":[16]}],[1,"dyte-settings-audio",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16]}],[1,"dyte-breakout-room-manager",{"meeting":[16],"assigningParticipants":[4,"assigning-participants"],"mode":[1],"states":[16],"allowDelete":[4,"allow-delete"],"iconPack":[16],"t":[16],"isDragMode":[4,"is-drag-mode"],"room":[16],"defaultExpanded":[4,"default-expanded"],"editingTitleRoomId":[32],"newTitle":[32],"showExpandedCard":[32],"glowingCard":[32]}],[1,"dyte-breakout-room-participants",{"meeting":[16],"participantIds":[16],"iconPack":[16],"t":[16],"selectedParticipantIds":[16],"search":[32],"participantsToShow":[32],"isDragging":[32]},null,{"meeting":["meetingChanged"],"participantIds":["participantsChanged"],"search":["searchChanged"]}],[1,"dyte-settings-video",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"videoEnabled":[32]},null,{"meeting":["meetingChanged"]}],[1,"dyte-emoji-picker",{"iconPack":[16],"t":[16],"focusWhenOpened":[4,"focus-when-opened"],"emojiList":[32],"filterVal":[32],"filteredEmojis":[32]}],[0,"dyte-image-message",{"message":[16],"now":[16],"isContinued":[516,"is-continued"],"iconPack":[16],"t":[16],"showBubble":[4,"show-bubble"],"status":[32]}],[1,"dyte-image-message-view",{"url":[1],"iconPack":[16],"t":[16],"status":[32]}],[1,"dyte-paginated-list",{"pageSize":[2,"page-size"],"pagesAllowed":[2,"pages-allowed"],"fetchData":[16],"createNodes":[16],"selectedItemId":[1,"selected-item-id"],"autoScroll":[4,"auto-scroll"],"iconPack":[16],"t":[16],"emptyListLabel":[1,"empty-list-label"],"isLoading":[32],"rerenderBoolean":[32],"shouldRenderNewNodes":[32],"hasNewNodesToRender":[32],"showEmptyListLabel":[32],"onNewNode":[64],"onNodeDelete":[64],"onNodeUpdate":[64]},null,{"selectedItemId":["onItemChanged"]}],[1,"dyte-counter",{"size":[513],"value":[2],"minValue":[2,"min-value"],"iconPack":[16],"t":[16],"input":[32]},null,{"input":["watchStateHandler"]}],[0,"dyte-file-message",{"message":[16],"now":[16],"isContinued":[516,"is-continued"],"iconPack":[16],"t":[16],"showBubble":[4,"show-bubble"]}],[1,"dyte-file-message-view",{"name":[1],"size":[2],"url":[1],"iconPack":[16]}],[1,"dyte-debugger-audio",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"isNetworkOpen":[32],"isDevicesOpen":[32],"audioProducerFormattedStats":[32],"audioProducerScoreStats":[32],"networkBasedMediaHealth":[32],"devicesHealth":[32]},null,{"audioProducerScoreStats":["audioProducerScoreStatsChanged"],"meeting":["meetingChanged"]}],[1,"dyte-debugger-screenshare",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"isNetworkOpen":[32],"isDevicesOpen":[32],"videoProducerFormattedStats":[32],"videoProducerScoreStats":[32],"audioProducerFormattedStats":[32],"audioProducerScoreStats":[32],"networkBasedMediaHealth":[32]},null,{"videoProducerScoreStats":["videoProducerScoreStatsChanged"],"audioProducerScoreStats":["audioProducerScoreStatsChanged"],"meeting":["meetingChanged"]}],[1,"dyte-debugger-system",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"isBatterySectionOpen":[32],"batterySectionHealth":[32],"battery":[32],"batteryFormattedStats":[32]},null,{"meeting":["meetingChanged"]}],[1,"dyte-debugger-video",{"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"isNetworkOpen":[32],"isDevicesOpen":[32],"videoProducerFormattedStats":[32],"videoProducerScoreStats":[32],"networkBasedMediaHealth":[32],"devicesHealth":[32]},null,{"videoProducerScoreStats":["videoProducerScoreStatsChanged"],"meeting":["meetingChanged"]}],[0,"dyte-text-message",{"message":[16],"now":[16],"isContinued":[516,"is-continued"],"iconPack":[16],"t":[16],"showBubble":[4,"show-bubble"]}],[1,"dyte-dialog",{"hideCloseButton":[4,"hide-close-button"],"disableEscapeKey":[4,"disable-escape-key"],"meeting":[16],"config":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"open":[1540]}],[1,"dyte-audio-visualizer",{"variant":[513],"participant":[16],"size":[513],"iconPack":[16],"t":[16],"hideMuted":[4,"hide-muted"],"isScreenShare":[4,"is-screen-share"],"audioEnabled":[32],"volume":[32]},null,{"participant":["participantChanged"]}],[1,"dyte-participant-tile",{"nameTagPosition":[513,"name-tag-position"],"isPreview":[4,"is-preview"],"participant":[16],"meeting":[16],"states":[16],"config":[16],"variant":[513],"size":[513],"iconPack":[16],"t":[16],"isPinned":[32],"mediaConnectionError":[32]},null,{"meeting":["meetingChanged"],"participant":["participantsChanged"]}],[1,"dyte-logo",{"logoUrl":[1025,"logo-url"],"config":[16],"meeting":[16],"t":[16]},null,{"config":["configChanged"],"meeting":["meetingChanged"]}],[1,"dyte-speaker-selector",{"meeting":[16],"states":[16],"variant":[1],"size":[513],"iconPack":[16],"t":[16],"speakerDevices":[32],"currentDevices":[32]},null,{"meeting":["meetingChanged"]}],[1,"dyte-camera-selector",{"meeting":[16],"size":[513],"iconPack":[16],"variant":[1],"t":[16],"videoDevices":[32],"currentDevice":[32],"canProduceVideo":[32]},null,{"meeting":["meetingChanged"]}],[1,"dyte-microphone-selector",{"meeting":[16],"size":[513],"iconPack":[16],"variant":[1],"t":[16],"audioinputDevices":[32],"canProduceAudio":[32],"currentDevices":[32]},null,{"meeting":["meetingChanged"]}],[0,"dyte-text-message-view",{"text":[1],"isMarkdown":[4,"is-markdown"]}],[1,"dyte-switch",{"checked":[1028],"readonly":[4],"disabled":[516],"iconPack":[16],"t":[16]},null,{"checked":["checkedChange"]}],[1,"dyte-markdown-view",{"text":[1],"maxLength":[2,"max-length"]}],[1,"dyte-menu",{"size":[513],"placement":[1],"offset":[2],"iconPack":[16],"t":[16]}],[1,"dyte-menu-item",{"size":[513],"iconPack":[16],"t":[16]}],[1,"dyte-menu-list",{"iconPack":[16],"t":[16]}],[1,"dyte-avatar",{"participant":[16],"variant":[513],"size":[513],"iconPack":[16],"t":[16],"imageState":[32]}],[1,"dyte-tooltip",{"label":[1],"variant":[513],"disabled":[516],"open":[516],"kind":[513],"size":[513],"placement":[1],"delay":[2],"isInFocus":[32]},null,{"open":["openChanged"]}],[1,"dyte-spinner",{"iconPack":[16],"size":[513]}],[1,"dyte-button",{"size":[513],"variant":[513],"kind":[513],"reverse":[516],"disabled":[516],"type":[513]}],[1,"dyte-icon",{"icon":[1],"variant":[513],"size":[513]}]]],["dyte-participants",[[1,"dyte-participants",{"meeting":[16],"states":[16],"config":[16],"size":[513],"iconPack":[16],"defaultParticipantsTabId":[1,"default-participants-tab-id"],"t":[16],"currentParticipantsTabId":[32],"tabs":[32],"hasRequests":[32],"search":[32]},null,{"meeting":["meetingChanged"],"currentParticipantsTabId":["currentParticipantsTabIdChanged"]}]]],["dyte-grid",[[1,"dyte-grid",{"layout":[513],"aspectRatio":[513,"aspect-ratio"],"meeting":[16],"gap":[514],"size":[513],"states":[16],"config":[16],"iconPack":[16],"t":[16],"gridSize":[16],"overrides":[8],"participants":[32],"pinnedParticipants":[32],"screenShareParticipants":[32],"plugins":[32],"emptyStage":[32],"showLiveStreamPlayer":[32],"canCurrentPeerHost":[32],"pipSupported":[32],"pipEnabled":[32],"hidden":[32],"roomState":[32]},null,{"meeting":["meetingChanged"],"overrides":["overridesChanged"],"screenShareParticipants":["screenShareParticipantsChanged"],"plugins":["pluginsChanged"],"pinnedParticipants":["pinnedParticipantsChanged"]}]]],["dyte-sidebar",[[1,"dyte-sidebar",{"enabledSections":[1040],"defaultSection":[1,"default-section"],"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"t":[16],"size":[513],"view":[513],"currentTab":[32],"isFloating":[32],"enablePinning":[32]},null,{"meeting":["meetingChanged"],"states":["statesChanged"],"view":["viewChanged"]}]]],["dyte-chat-composer-ui",[[1,"dyte-chat-composer-ui",{"canSendTextMessage":[4,"can-send-text-message"],"canSendFiles":[4,"can-send-files"],"size":[513],"iconPack":[16],"t":[16],"disableEmojiPicker":[4,"disable-emoji-picker"],"prefill":[16],"members":[16],"channelId":[1,"channel-id"],"emojiPickerActive":[32],"mentionQuery":[32],"focusedMemberIndex":[32],"filePreview":[32]},null,{"channelId":["onChannelChanged"]}]]],["dyte-mixed-grid",[[1,"dyte-mixed-grid",{"layout":[513],"participants":[16],"pinnedParticipants":[16],"screenShareParticipants":[16],"plugins":[16],"aspectRatio":[1,"aspect-ratio"],"gap":[2],"size":[513],"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"t":[16],"gridSize":[16],"activeTab":[32],"initialised":[32]},null,{"meeting":["meetingChanged"],"screenShareParticipants":["screenShareParticipantsChanged"],"plugins":["pluginsChanged"]}]]],["dyte-setup-screen",[[1,"dyte-setup-screen",{"meeting":[16],"states":[16],"size":[513],"config":[16],"iconPack":[16],"t":[16],"displayName":[32],"isJoining":[32],"canEditName":[32],"canProduceAudio":[32],"connectionState":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-audio-tile",[[1,"dyte-audio-tile",{"meeting":[16],"config":[16],"size":[513],"states":[16],"iconPack":[16],"t":[16],"participant":[16],"audioEnabled":[32],"volume":[32]},null,{"participant":["participantChanged"]}]]],["dyte-camera-toggle",[[1,"dyte-camera-toggle",{"variant":[513],"meeting":[16],"size":[513],"iconPack":[16],"t":[16],"videoEnabled":[32],"canProduceVideo":[32],"cameraPermission":[32],"stageStatus":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-channel-selector-ui",[[1,"dyte-channel-selector-ui",{"channels":[16],"selectedChannelId":[1,"selected-channel-id"],"iconPack":[16],"t":[16],"showRecentMessage":[4,"show-recent-message"],"isHidden":[32],"searchQuery":[32]}]]],["dyte-mic-toggle",[[1,"dyte-mic-toggle",{"variant":[513],"meeting":[16],"size":[513],"iconPack":[16],"t":[16],"audioEnabled":[32],"canProduceAudio":[32],"micPermission":[32],"stageStatus":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-mute-all-button",[[1,"dyte-mute-all-button",{"variant":[513],"meeting":[16],"size":[513],"iconPack":[16],"t":[16],"canDisable":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-screen-share-toggle",[[1,"dyte-screen-share-toggle",{"states":[16],"variant":[513],"meeting":[16],"size":[513],"iconPack":[16],"t":[16],"maxScreenShareCount":[32],"screenShareCount":[32],"screenShareEnabled":[32],"canScreenShare":[32],"shareScreenPermission":[32],"screenShareState":[32],"stageStatus":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-stage-toggle",[[1,"dyte-stage-toggle",{"variant":[513],"meeting":[16],"size":[513],"iconPack":[16],"states":[16],"t":[16],"stageStatus":[32],"state":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-ai",[[1,"dyte-ai",{"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"t":[16],"size":[513],"view":[513]},null,{"view":["viewChanged"]}]]],["dyte-ai-toggle",[[1,"dyte-ai-toggle",{"variant":[513],"states":[16],"meeting":[16],"size":[513],"iconPack":[16],"t":[16],"aiActive":[32]},null,{"states":["statesChanged"]}]]],["dyte-breakout-rooms-toggle",[[1,"dyte-breakout-rooms-toggle",{"variant":[513],"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"canToggle":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-caption-toggle",[[1,"dyte-caption-toggle",{"variant":[513],"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"size":[513],"t":[16],"captionEnabled":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-chat-toggle",[[1,"dyte-chat-toggle",{"variant":[513],"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"unreadMessageCount":[32],"chatActive":[32],"canViewChat":[32],"hasNewMessages":[32]},null,{"meeting":["meetingChanged"],"states":["statesChanged"]}]]],["dyte-debugger-toggle",[[1,"dyte-debugger-toggle",{"variant":[513],"meeting":[16],"states":[16],"t":[16],"iconPack":[16],"size":[513]}]]],["dyte-grid-pagination",[[1,"dyte-grid-pagination",{"meeting":[16],"states":[16],"size":[513],"variant":[513],"iconPack":[16],"t":[16],"page":[32],"pageCount":[32],"activeCount":[32],"activeComputedCount":[32],"showPagination":[32]},null,{"meeting":["meetingChanged"],"size":["sizeChanged"]}]]],["dyte-idle-screen",[[1,"dyte-idle-screen",{"meeting":[16],"config":[16],"iconPack":[16],"t":[16]}]]],["dyte-leave-button",[[1,"dyte-leave-button",{"variant":[513],"size":[513],"iconPack":[16],"t":[16]}]]],["dyte-livestream-toggle",[[1,"dyte-livestream-toggle",{"variant":[513],"meeting":[16],"size":[513],"iconPack":[16],"t":[16],"livestreamState":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-more-toggle",[[1,"dyte-more-toggle",{"states":[16],"size":[513],"iconPack":[16],"t":[16]}]]],["dyte-participants-audio",[[1,"dyte-participants-audio",{"meeting":[16],"iconPack":[16],"t":[16],"preloadedAudioElem":[16],"showPlayDialog":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-participants-toggle",[[1,"dyte-participants-toggle",{"variant":[513],"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"participantsActive":[32],"waitlistedParticipants":[32],"stageRequestedParticipants":[32],"badgeCount":[32],"canViewParticipants":[32]},null,{"meeting":["meetingChanged"],"states":["statesChanged"]}]]],["dyte-pip-toggle",[[1,"dyte-pip-toggle",{"variant":[513],"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"size":[513],"t":[16],"pipSupported":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-plugins-toggle",[[1,"dyte-plugins-toggle",{"variant":[513],"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"pluginsActive":[32],"canViewPlugins":[32]},null,{"meeting":["meetingChanged"],"states":["statesChanged"]}]]],["dyte-polls-toggle",[[1,"dyte-polls-toggle",{"variant":[513],"meeting":[16],"states":[16],"size":[513],"iconPack":[16],"t":[16],"pollsActive":[32],"unreadPollsCount":[32],"canViewPolls":[32]},null,{"meeting":["meetingChanged"],"states":["statesChanged"]}]]],["dyte-recording-toggle",[[1,"dyte-recording-toggle",{"variant":[513],"meeting":[16],"t":[16],"iconPack":[16],"size":[513],"disabled":[4],"recordingState":[32],"canRecord":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-screenshare-view",[[1,"dyte-screenshare-view",{"hideFullScreenButton":[4,"hide-full-screen-button"],"nameTagPosition":[513,"name-tag-position"],"participant":[16],"meeting":[16],"variant":[513],"size":[513],"iconPack":[16],"t":[16],"videoExpanded":[32],"screenShareEnabled":[32],"isFullScreen":[32],"remoteControlInfo":[32]},null,{"participant":["participantChanged"]}]]],["dyte-settings-toggle",[[1,"dyte-settings-toggle",{"variant":[513],"states":[16],"size":[513],"iconPack":[16],"t":[16]}]]],["dyte-ended-screen",[[1,"dyte-ended-screen",{"config":[16],"size":[513],"states":[16],"t":[16],"iconPack":[16],"meeting":[16],"icon":[32],"message":[32]},null,{"states":["statesChanged"]}]]],["dyte-message-list-view",[[0,"dyte-message-list-view",{"messages":[16],"renderer":[16],"loadMore":[16],"visibleItemsCount":[2,"visible-items-count"],"estimateItemSize":[2,"estimate-item-size"],"iconPack":[16],"range":[32],"isFetching":[32],"autoScroll":[32],"totalHeight":[32]},null,{"messages":["messagesUpdated"]}]]],["dyte-chat-selector-ui",[[1,"dyte-chat-selector-ui",{"selfUserId":[1,"self-user-id"],"selectedGroupId":[1,"selected-group-id"],"unreadCounts":[16],"groups":[16],"iconPack":[16],"t":[16],"showParticipantsPanel":[32],"query":[32]}]]],["dyte-clock",[[1,"dyte-clock",{"meeting":[16],"iconPack":[16],"startedTime":[32],"timeDiff":[32]},null,{"meeting":["meetingChanged"],"startedTime":["startedTimeChanged"]}]]],["dyte-file-dropzone",[[1,"dyte-file-dropzone",{"hostEl":[16],"iconPack":[16],"t":[16],"dropzoneActivated":[32]}]]],["dyte-information-tooltip",[[1,"dyte-information-tooltip",{"iconPack":[16]}]]],["dyte-meeting-title",[[1,"dyte-meeting-title",{"meeting":[16],"iconPack":[16],"t":[16]}]]],["dyte-network-indicator",[[1,"dyte-network-indicator",{"participant":[16],"meeting":[16],"iconPack":[16],"t":[16],"isScreenShare":[4,"is-screen-share"],"score":[32]},null,{"participant":["participantChanged"]}]]],["dyte-participant-count",[[1,"dyte-participant-count",{"meeting":[16],"iconPack":[16],"t":[16],"size":[513],"participantCount":[32],"isViewer":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-recording-indicator",[[1,"dyte-recording-indicator",{"meeting":[16],"size":[513],"t":[16],"iconPack":[16],"isRecording":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-transcripts",[[1,"dyte-transcripts",{"meeting":[16],"states":[16],"config":[16],"t":[16],"transcripts":[32],"listenerAttached":[32]},null,{"meeting":["meetingChanged"],"states":["statesChanged"]}]]],["dyte-waiting-screen",[[1,"dyte-waiting-screen",{"meeting":[16],"config":[16],"iconPack":[16],"t":[16]}]]],["dyte-audio-grid",[[1,"dyte-audio-grid",{"meeting":[16],"config":[16],"states":[16],"iconPack":[16],"size":[513],"t":[16],"hideSelf":[4,"hide-self"],"activeParticipants":[32],"onStageParticipants":[32],"offStageParticipants":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-controlbar",[[1,"dyte-controlbar",{"variant":[513],"disableRender":[4,"disable-render"],"meeting":[16],"config":[16],"states":[16],"iconPack":[16],"t":[16],"size":[513]}]]],["dyte-header",[[1,"dyte-header",{"variant":[513],"disableRender":[4,"disable-render"],"meeting":[16],"config":[16],"states":[16],"iconPack":[16],"t":[16],"size":[513]}]]],["dyte-participant-setup",[[1,"dyte-participant-setup",{"nameTagPosition":[513,"name-tag-position"],"isPreview":[4,"is-preview"],"participant":[16],"states":[16],"config":[16],"variant":[513],"size":[513],"iconPack":[16],"t":[16],"videoState":[32],"isPinned":[32]},null,{"participant":["participantsChanged"],"videoState":["videoStateChanged"]}]]],["dyte-simple-grid",[[1,"dyte-simple-grid",{"participants":[16],"aspectRatio":[1,"aspect-ratio"],"gap":[2],"size":[513],"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"t":[16],"dimensions":[32],"mediaConnection":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-spotlight-grid",[[1,"dyte-spotlight-grid",{"layout":[513],"participants":[16],"pinnedParticipants":[16],"aspectRatio":[1,"aspect-ratio"],"gap":[2],"size":[513],"meeting":[16],"states":[16],"config":[16],"iconPack":[16],"t":[16],"gridSize":[16]}]]],["dyte-stage",[[1,"dyte-stage",{"iconPack":[16],"t":[16]}]]],["dyte-ui-provider",[[4,"dyte-ui-provider",{"meeting":[16],"iconPack":[16],"t":[16],"config":[16],"size":[1537],"showSetupScreen":[4,"show-setup-screen"],"noRenderUntilMeeting":[4,"no-render-until-meeting"]},[[0,"dyteStateUpdate","listenState"]],{"meeting":["onMeetingChange"],"iconPack":["onIconPackChange"],"t":["onTChange"],"config":["onConfigChange"],"size":["onSizeChange"]}]]],["dyte-ai-transcriptions",[[1,"dyte-ai-transcriptions",{"t":[16],"meeting":[16],"initialTranscriptions":[16],"participantQuery":[32],"isProcessing":[32],"transcriptions":[32]},null,{"meeting":["meetingChanged"],"transcriptions":["transcriptionsChanged"]}]]],["dyte-name-tag",[[1,"dyte-name-tag",{"participant":[16],"meeting":[16],"size":[513],"isScreenShare":[4,"is-screen-share"],"variant":[513],"iconPack":[16],"t":[16],"length":[32]},null,{"size":["sizeChanged"]}]]],["dyte-transcript",[[1,"dyte-transcript",{"transcript":[16],"t":[16],"timeout":[32]},null,{"transcript":["transcriptChanged"]}]]],["dyte-plugins_2",[[1,"dyte-polls",{"meeting":[16],"config":[16],"size":[513],"iconPack":[16],"t":[16],"create":[32],"polls":[32],"permissions":[32]},null,{"meeting":["meetingChanged"]}],[1,"dyte-plugins",{"meeting":[16],"config":[16],"size":[513],"iconPack":[16],"t":[16],"plugins":[32],"canStartPlugins":[32],"canClosePlugins":[32],"activatedPluginsId":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-plugin-main_2",[[1,"dyte-tab-bar",{"size":[513],"meeting":[16],"states":[16],"config":[16],"layout":[513],"iconPack":[16],"t":[16],"activeTab":[16],"tabs":[16]}],[1,"dyte-plugin-main",{"meeting":[16],"plugin":[16],"iconPack":[16],"t":[16],"canClosePlugin":[32],"viewModeEnabled":[32]},null,{"meeting":["meetingChanged"],"plugin":["pluginChanged"]}]]],["dyte-fullscreen-toggle",[[1,"dyte-fullscreen-toggle",{"states":[16],"targetElement":[16],"variant":[513],"size":[513],"iconPack":[16],"t":[16],"fullScreenActive":[32],"isFullScreenSupported":[32]}]]],["dyte-sidebar-ui",[[1,"dyte-sidebar-ui",{"view":[513],"tabs":[16],"hideHeader":[4,"hide-header"],"hideCloseAction":[4,"hide-close-action"],"currentTab":[1,"current-tab"],"iconPack":[16],"t":[16]}]]],["dyte-spotlight-indicator",[[1,"dyte-spotlight-indicator",{"meeting":[16],"iconPack":[16],"t":[16],"size":[513],"canSpotlight":[32],"isSpotlighted":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-controlbar-button",[[1,"dyte-controlbar-button",{"variant":[513],"showWarning":[4,"show-warning"],"size":[513],"label":[1],"icon":[1],"isLoading":[4,"is-loading"],"disabled":[516],"iconPack":[16],"brandIcon":[516,"brand-icon"]}]]],["dyte-livestream-indicator_3",[[1,"dyte-livestream-player",{"meeting":[16],"size":[513],"t":[16],"iconPack":[16],"playbackUrl":[32],"isSupported":[32],"playerState":[32],"livestreamState":[32],"playerError":[32],"livestreamId":[32],"audioPlaybackError":[32],"qualityLevels":[32],"selectedQuality":[32],"currentTime":[32],"duration":[32],"hideControls":[32]},null,{"livestreamState":["updateLivestreamId"],"meeting":["meetingChanged"]}],[1,"dyte-livestream-indicator",{"meeting":[16],"size":[513],"t":[16],"iconPack":[16],"isLivestreaming":[32]},null,{"meeting":["meetingChanged"]}],[1,"dyte-viewer-count",{"meeting":[16],"variant":[513],"iconPack":[16],"t":[16],"viewerCount":[32]},null,{"meeting":["meetingChanged"]}]]],["dyte-participant_2",[[1,"dyte-participant",{"meeting":[16],"states":[16],"view":[1],"participant":[16],"iconPack":[16],"t":[16],"config":[16],"audioEnabled":[32],"videoEnabled":[32],"isPinned":[32],"isHidden":[32],"isOnStage":[32],"canDisableParticipantAudio":[32],"canDisableParticipantVideo":[32],"canKickParticipant":[32],"canPinParticipant":[32],"canAllowParticipantOnStage":[32],"menuOpen":[32]},null,{"meeting":["meetingChanged"],"participant":["participantChanged"]}],[0,"dyte-virtualized-participant-list",{"items":[16],"renderItem":[16],"itemHeight":[1026,"item-height"],"bufferedItemsCount":[2,"buffered-items-count"],"emptyListElement":[16],"visibleStart":[32],"visibleEnd":[32]},null,{"items":["itemsChanged"]}]]],["dyte-participants-stage-list_4",[[1,"dyte-participants-viewer-list",{"meeting":[16],"config":[16],"size":[513],"hideHeader":[4,"hide-header"],"iconPack":[16],"view":[1],"search":[1],"t":[16],"stageViewers":[32]},null,{"meeting":["meetingChanged"],"search":["searchChanged"]}],[1,"dyte-participants-stage-queue",{"meeting":[16],"config":[16],"size":[513],"iconPack":[16],"view":[1],"t":[16],"stageRequestedParticipants":[32]},null,{"meeting":["meetingChanged"]}],[1,"dyte-participants-waiting-list",{"meeting":[16],"config":[16],"size":[513],"iconPack":[16],"view":[1],"t":[16],"waitlistedParticipants":[32]},null,{"meeting":["meetingChanged"]}],[1,"dyte-participants-stage-list",{"meeting":[16],"states":[16],"config":[16],"size":[513],"hideHeader":[4,"hide-header"],"iconPack":[16],"view":[1],"t":[16],"search":[1],"participants":[32]},null,{"meeting":["meetingChanged"],"search":["searchChanged"]}]]],["dyte-poll_2",[[1,"dyte-poll-form",{"iconPack":[16],"t":[16],"options":[32],"anonymous":[32],"hideVotes":[32],"error":[32]}],[1,"dyte-poll",{"poll":[16],"self":[1],"permissions":[16],"iconPack":[16],"t":[16]}]]]]'),t)},e.setNonce=e=>f.$nonce$=e,e}({});
